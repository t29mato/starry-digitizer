var T3=Object.defineProperty;var M3=(st,m,Nt)=>m in st?T3(st,m,{enumerable:!0,configurable:!0,writable:!0,value:Nt}):st[m]=Nt;var Ie=(st,m,Nt)=>(M3(st,typeof m!="symbol"?m+"":m,Nt),Nt),Hp=(st,m,Nt)=>{if(!m.has(st))throw TypeError("Cannot "+Nt)};var Je=(st,m,Nt)=>(Hp(st,m,"read from private field"),Nt?Nt.call(st):m.get(st)),ar=(st,m,Nt)=>{if(m.has(st))throw TypeError("Cannot add the same private member more than once");m instanceof WeakSet?m.add(st):m.set(st,Nt)},Na=(st,m,Nt,po)=>(Hp(st,m,"write to private field"),po?po.call(st,Nt):m.set(st,Nt),Nt);var X0=(st,m,Nt)=>(Hp(st,m,"access private method"),Nt);(function(st,m){typeof exports=="object"&&typeof module<"u"?m(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],m):(st=typeof globalThis<"u"?globalThis:st||self,m(st["starry-digitizer"]={},st.Vue))})(this,function(st,m){var ph,q0,sr,or,ot,ir;"use strict";var Nt=!1;function po(n,e,t){return Array.isArray(n)?(n.length=Math.max(n.length,e),n.splice(e,1,t),t):(n[e]=t,t)}function vh(n,e){if(Array.isArray(n)){n.splice(e,1);return}delete n[e]}/*!
 * pinia v2.1.6
 * (c) 2023 Eduardo San Martin Morote
 * @license MIT
 */let lr;const Ha=n=>lr=n,Q0=process.env.NODE_ENV!=="production"?Symbol("pinia"):Symbol();function wo(n){return n&&typeof n=="object"&&Object.prototype.toString.call(n)==="[object Object]"&&typeof n.toJSON!="function"}var cr;(function(n){n.direct="direct",n.patchObject="patch object",n.patchFunction="patch function"})(cr||(cr={}));const bh=typeof window<"u",Rh=(process.env.NODE_ENV!=="production"||!1)&&process.env.NODE_ENV!=="test"&&bh;function kp(n,e){for(const t in e){const s=e[t];if(!(t in n))continue;const o=n[t];wo(o)&&wo(s)&&!m.isRef(s)&&!m.isReactive(s)?n[t]=kp(o,s):n[t]=s}return n}const Lp=()=>{};function Vp(n,e,t,s=Lp){n.push(e);const o=()=>{const r=n.indexOf(e);r>-1&&(n.splice(r,1),s())};return!t&&m.getCurrentScope()&&m.onScopeDispose(o),o}function ii(n,...e){n.slice().forEach(t=>{t(...e)})}const J0=n=>n();function Eh(n,e){n instanceof Map&&e instanceof Map&&e.forEach((t,s)=>n.set(s,t)),n instanceof Set&&e instanceof Set&&e.forEach(n.add,n);for(const t in e){if(!e.hasOwnProperty(t))continue;const s=e[t],o=n[t];wo(o)&&wo(s)&&n.hasOwnProperty(t)&&!m.isRef(s)&&!m.isReactive(s)?n[t]=Eh(o,s):n[t]=s}return n}const eE=process.env.NODE_ENV!=="production"?Symbol("pinia:skipHydration"):Symbol();function tE(n){return!wo(n)||!n.hasOwnProperty(eE)}const{assign:Tn}=Object;function $p(n){return!!(m.isRef(n)&&n.effect)}function Fp(n,e,t,s){const{state:o,actions:r,getters:a}=e,l=t.state.value[n];let c;function h(){!l&&(process.env.NODE_ENV==="production"||!s)&&(t.state.value[n]=o?o():{});const u=process.env.NODE_ENV!=="production"&&s?m.toRefs(m.ref(o?o():{}).value):m.toRefs(t.state.value[n]);return Tn(u,r,Object.keys(a||{}).reduce((f,g)=>(process.env.NODE_ENV!=="production"&&g in u&&console.warn(`[ðŸ]: A getter cannot have the same name as another state property. Rename one of them. Found with "${g}" in store "${n}".`),f[g]=m.markRaw(m.computed(()=>{Ha(t);const p=t._s.get(n);return a[g].call(p,p)})),f),{}))}return c=xh(n,h,e,t,s,!0),c}function xh(n,e,t={},s,o,r){let a;const l=Tn({actions:{}},t);if(process.env.NODE_ENV!=="production"&&!s._e.active)throw new Error("Pinia destroyed");const c={deep:!0};process.env.NODE_ENV!=="production"&&!Nt&&(c.onTrigger=F=>{h?p=F:h==!1&&!H._hotUpdating&&(Array.isArray(p)?p.push(F):console.error("ðŸ debuggerEvents should be an array. This is most likely an internal Pinia bug."))});let h,u,f=[],g=[],p;const C=s.state.value[n];!r&&!C&&(process.env.NODE_ENV==="production"||!o)&&(s.state.value[n]={});const y=m.ref({});let b;function T(F){let Y;h=u=!1,process.env.NODE_ENV!=="production"&&(p=[]),typeof F=="function"?(F(s.state.value[n]),Y={type:cr.patchFunction,storeId:n,events:p}):(Eh(s.state.value[n],F),Y={type:cr.patchObject,payload:F,storeId:n,events:p});const te=b=Symbol();m.nextTick().then(()=>{b===te&&(h=!0)}),u=!0,ii(f,Y,s.state.value[n])}const M=r?function(){const{state:Y}=t,te=Y?Y():{};this.$patch(ie=>{Tn(ie,te)})}:process.env.NODE_ENV!=="production"?()=>{throw new Error(`ðŸ: Store "${n}" is built using the setup syntax and does not implement $reset().`)}:Lp;function _(){a.stop(),f=[],g=[],s._s.delete(n)}function I(F,Y){return function(){Ha(s);const te=Array.from(arguments),ie=[],fe=[];function Me(E){ie.push(E)}function Ge(E){fe.push(E)}ii(g,{args:te,name:F,store:H,after:Me,onError:Ge});let Oe;try{Oe=Y.apply(this&&this.$id===n?this:H,te)}catch(E){throw ii(fe,E),E}return Oe instanceof Promise?Oe.then(E=>(ii(ie,E),E)).catch(E=>(ii(fe,E),Promise.reject(E))):(ii(ie,Oe),Oe)}}const D=m.markRaw({actions:{},getters:{},state:[],hotState:y}),K={_p:s,$id:n,$onAction:Vp.bind(null,g),$patch:T,$reset:M,$subscribe(F,Y={}){const te=Vp(f,F,Y.detached,()=>ie()),ie=a.run(()=>m.watch(()=>s.state.value[n],fe=>{(Y.flush==="sync"?u:h)&&F({storeId:n,type:cr.direct,events:p},fe)},Tn({},c,Y)));return te},$dispose:_},H=m.reactive(process.env.NODE_ENV!=="production"||Rh?Tn({_hmrPayload:D,_customProperties:m.markRaw(new Set)},K):K);s._s.set(n,H);const Q=s._a&&s._a.runWithContext||J0,q=s._e.run(()=>(a=m.effectScope(),Q(()=>a.run(e))));for(const F in q){const Y=q[F];if(m.isRef(Y)&&!$p(Y)||m.isReactive(Y))process.env.NODE_ENV!=="production"&&o?po(y.value,F,m.toRef(q,F)):r||(C&&tE(Y)&&(m.isRef(Y)?Y.value=C[F]:Eh(Y,C[F])),s.state.value[n][F]=Y),process.env.NODE_ENV!=="production"&&D.state.push(F);else if(typeof Y=="function"){const te=process.env.NODE_ENV!=="production"&&o?Y:I(F,Y);q[F]=te,process.env.NODE_ENV!=="production"&&(D.actions[F]=Y),l.actions[F]=Y}else process.env.NODE_ENV!=="production"&&$p(Y)&&(D.getters[F]=r?t.getters[F]:Y,bh&&(q._getters||(q._getters=m.markRaw([]))).push(F))}if(Tn(H,q),Tn(m.toRaw(H),q),Object.defineProperty(H,"$state",{get:()=>process.env.NODE_ENV!=="production"&&o?y.value:s.state.value[n],set:F=>{if(process.env.NODE_ENV!=="production"&&o)throw new Error("cannot set hotState");T(Y=>{Tn(Y,F)})}}),process.env.NODE_ENV!=="production"&&(H._hotUpdate=m.markRaw(F=>{H._hotUpdating=!0,F._hmrPayload.state.forEach(Y=>{if(Y in H.$state){const te=F.$state[Y],ie=H.$state[Y];typeof te=="object"&&wo(te)&&wo(ie)?kp(te,ie):F.$state[Y]=ie}po(H,Y,m.toRef(F.$state,Y))}),Object.keys(H.$state).forEach(Y=>{Y in F.$state||vh(H,Y)}),h=!1,u=!1,s.state.value[n]=m.toRef(F._hmrPayload,"hotState"),u=!0,m.nextTick().then(()=>{h=!0});for(const Y in F._hmrPayload.actions){const te=F[Y];po(H,Y,I(Y,te))}for(const Y in F._hmrPayload.getters){const te=F._hmrPayload.getters[Y],ie=r?m.computed(()=>(Ha(s),te.call(H,H))):te;po(H,Y,ie)}Object.keys(H._hmrPayload.getters).forEach(Y=>{Y in F._hmrPayload.getters||vh(H,Y)}),Object.keys(H._hmrPayload.actions).forEach(Y=>{Y in F._hmrPayload.actions||vh(H,Y)}),H._hmrPayload=F._hmrPayload,H._getters=F._getters,H._hotUpdating=!1})),Rh){const F={writable:!0,configurable:!0,enumerable:!1};["_p","_hmrPayload","_getters","_customProperties"].forEach(Y=>{Object.defineProperty(H,Y,Tn({value:H[Y]},F))})}return s._p.forEach(F=>{if(Rh){const Y=a.run(()=>F({store:H,app:s._a,pinia:s,options:l}));Object.keys(Y||{}).forEach(te=>H._customProperties.add(te)),Tn(H,Y)}else Tn(H,a.run(()=>F({store:H,app:s._a,pinia:s,options:l})))}),process.env.NODE_ENV!=="production"&&H.$state&&typeof H.$state=="object"&&typeof H.$state.constructor=="function"&&!H.$state.constructor.toString().includes("[native code]")&&console.warn(`[ðŸ]: The "state" must be a plain object. It cannot be
	state: () => new MyClass()
Found in store "${H.$id}".`),C&&r&&t.hydrate&&t.hydrate(H.$state,C),h=!0,u=!0,H}function Ys(n,e,t){let s,o;const r=typeof e=="function";if(typeof n=="string")s=n,o=r?t:e;else if(o=n,s=n.id,process.env.NODE_ENV!=="production"&&typeof s!="string")throw new Error('[ðŸ]: "defineStore()" must be passed a store id as its first argument.');function a(l,c){const h=m.hasInjectionContext();if(l=(process.env.NODE_ENV==="test"&&lr&&lr._testing?null:l)||(h?m.inject(Q0,null):null),l&&Ha(l),process.env.NODE_ENV!=="production"&&!lr)throw new Error(`[ðŸ]: "getActivePinia()" was called but there was no active Pinia. Did you forget to install pinia?
	const pinia = createPinia()
	app.use(pinia)
This will fail in production.`);l=lr,l._s.has(s)||(r?xh(s,e,o,l):Fp(s,o,l),process.env.NODE_ENV!=="production"&&(a._pinia=l));const u=l._s.get(s);if(process.env.NODE_ENV!=="production"&&c){const f="__hot:"+s,g=r?xh(f,e,o,l,!0):Fp(f,Tn({},o),l,!0);c._hotUpdate(g),delete l.state.value[f],l._s.delete(f)}if(process.env.NODE_ENV!=="production"&&bh){const f=m.getCurrentInstance();if(f&&f.proxy&&!c){const g=f.proxy,p="_pStores"in g?g._pStores:g._pStores={};p[s]=u}}return u}return a.$id=s,a}function Re(n,e){return Array.isArray(e)?e.reduce((t,s)=>(t[s]=function(){return n(this.$pinia)[s]},t),{}):Object.keys(e).reduce((t,s)=>(t[s]=function(){const o=n(this.$pinia),r=e[s];return typeof r=="function"?r.call(this,o):o[r]},t),{})}function wt(n,e){return Array.isArray(e)?e.reduce((t,s)=>(t[s]=function(...o){return n(this.$pinia)[s](...o)},t),{}):Object.keys(e).reduce((t,s)=>(t[s]=function(...o){return n(this.$pinia)[e[s]](...o)},t),{})}class nE{constructor(){Ie(this,"scale",5);Ie(this,"magnifierSettingError","");Ie(this,"crosshairSizePx",1);Ie(this,"sizePx",200)}setScale(e){this.scale=e}}const ys=Ys("magnifier",{state:()=>({magnifier:new nE}),getters:{},actions:{setScale(n){this.magnifier.setScale(n)}}}),sE=m.defineComponent({computed:{...Re(ys,["magnifier"]),width(){return(this.magnifier.sizePx-this.magnifier.crosshairSizePx)/2}}}),qe=(n,e)=>{const t=n.__vccOpts||n;for(const[s,o]of e)t[s]=o;return t};function oE(n,e,t,s,o,r){return m.openBlock(),m.createElementBlock("div",{style:m.normalizeStyle({position:"absolute",top:"0px",left:"0px",width:`${n.width}px`,height:`${n.magnifier.sizePx}px`,outline:"1px solid grey"})},null,4)}const iE=qe(sE,[["render",oE]]),rE=m.defineComponent({computed:{...Re(ys,["magnifier"]),height(){return(this.magnifier.sizePx-this.magnifier.crosshairSizePx)/2}}});function aE(n,e,t,s,o,r){return m.openBlock(),m.createElementBlock("div",{style:m.normalizeStyle({position:"absolute",top:"0px",left:"0px",width:`${n.magnifier.sizePx}px`,height:`${n.height}px`,outline:"1px solid grey"})},null,4)}const lE=qe(rE,[["render",aE]]);if(!Ss)var Ss={map:function(n,e){var t={};return e?n.map(function(s,o){return t.index=o,e.call(t,s)}):n.slice()},naturalOrder:function(n,e){return n<e?-1:n>e?1:0},sum:function(n,e){var t={};return n.reduce(e?function(s,o,r){return t.index=r,s+e.call(t,o)}:function(s,o){return s+o},0)},max:function(n,e){return Math.max.apply(null,e?Ss.map(n,e):n)}};var cE=function(){var n=5,e=8-n,t=1e3;function s(c,h,u){return(c<<2*n)+(h<<n)+u}function o(c){var h=[],u=!1;function f(){h.sort(c),u=!0}return{push:function(g){h.push(g),u=!1},peek:function(g){return u||f(),g===void 0&&(g=h.length-1),h[g]},pop:function(){return u||f(),h.pop()},size:function(){return h.length},map:function(g){return h.map(g)},debug:function(){return u||f(),h}}}function r(c,h,u,f,g,p,C){var y=this;y.r1=c,y.r2=h,y.g1=u,y.g2=f,y.b1=g,y.b2=p,y.histo=C}function a(){this.vboxes=new o(function(c,h){return Ss.naturalOrder(c.vbox.count()*c.vbox.volume(),h.vbox.count()*h.vbox.volume())})}function l(c,h){if(h.count()){var u=h.r2-h.r1+1,f=h.g2-h.g1+1,g=Ss.max([u,f,h.b2-h.b1+1]);if(h.count()==1)return[h.copy()];var p,C,y,b,T=0,M=[],_=[];if(g==u)for(p=h.r1;p<=h.r2;p++){for(b=0,C=h.g1;C<=h.g2;C++)for(y=h.b1;y<=h.b2;y++)b+=c[s(p,C,y)]||0;M[p]=T+=b}else if(g==f)for(p=h.g1;p<=h.g2;p++){for(b=0,C=h.r1;C<=h.r2;C++)for(y=h.b1;y<=h.b2;y++)b+=c[s(C,p,y)]||0;M[p]=T+=b}else for(p=h.b1;p<=h.b2;p++){for(b=0,C=h.r1;C<=h.r2;C++)for(y=h.g1;y<=h.g2;y++)b+=c[s(C,y,p)]||0;M[p]=T+=b}return M.forEach(function(I,D){_[D]=T-I}),function(I){var D,K,H,Q,q,F=I+"1",Y=I+"2",te=0;for(p=h[F];p<=h[Y];p++)if(M[p]>T/2){for(H=h.copy(),Q=h.copy(),q=(D=p-h[F])<=(K=h[Y]-p)?Math.min(h[Y]-1,~~(p+K/2)):Math.max(h[F],~~(p-1-D/2));!M[q];)q++;for(te=_[q];!te&&M[q-1];)te=_[--q];return H[Y]=q,Q[F]=H[Y]+1,[H,Q]}}(g==u?"r":g==f?"g":"b")}}return r.prototype={volume:function(c){var h=this;return h._volume&&!c||(h._volume=(h.r2-h.r1+1)*(h.g2-h.g1+1)*(h.b2-h.b1+1)),h._volume},count:function(c){var h=this,u=h.histo;if(!h._count_set||c){var f,g,p,C=0;for(f=h.r1;f<=h.r2;f++)for(g=h.g1;g<=h.g2;g++)for(p=h.b1;p<=h.b2;p++)C+=u[s(f,g,p)]||0;h._count=C,h._count_set=!0}return h._count},copy:function(){var c=this;return new r(c.r1,c.r2,c.g1,c.g2,c.b1,c.b2,c.histo)},avg:function(c){var h=this,u=h.histo;if(!h._avg||c){var f,g,p,C,y=0,b=1<<8-n,T=0,M=0,_=0;for(g=h.r1;g<=h.r2;g++)for(p=h.g1;p<=h.g2;p++)for(C=h.b1;C<=h.b2;C++)y+=f=u[s(g,p,C)]||0,T+=f*(g+.5)*b,M+=f*(p+.5)*b,_+=f*(C+.5)*b;h._avg=y?[~~(T/y),~~(M/y),~~(_/y)]:[~~(b*(h.r1+h.r2+1)/2),~~(b*(h.g1+h.g2+1)/2),~~(b*(h.b1+h.b2+1)/2)]}return h._avg},contains:function(c){var h=this,u=c[0]>>e;return gval=c[1]>>e,bval=c[2]>>e,u>=h.r1&&u<=h.r2&&gval>=h.g1&&gval<=h.g2&&bval>=h.b1&&bval<=h.b2}},a.prototype={push:function(c){this.vboxes.push({vbox:c,color:c.avg()})},palette:function(){return this.vboxes.map(function(c){return c.color})},size:function(){return this.vboxes.size()},map:function(c){for(var h=this.vboxes,u=0;u<h.size();u++)if(h.peek(u).vbox.contains(c))return h.peek(u).color;return this.nearest(c)},nearest:function(c){for(var h,u,f,g=this.vboxes,p=0;p<g.size();p++)((u=Math.sqrt(Math.pow(c[0]-g.peek(p).color[0],2)+Math.pow(c[1]-g.peek(p).color[1],2)+Math.pow(c[2]-g.peek(p).color[2],2)))<h||h===void 0)&&(h=u,f=g.peek(p).color);return f},forcebw:function(){var c=this.vboxes;c.sort(function(g,p){return Ss.naturalOrder(Ss.sum(g.color),Ss.sum(p.color))});var h=c[0].color;h[0]<5&&h[1]<5&&h[2]<5&&(c[0].color=[0,0,0]);var u=c.length-1,f=c[u].color;f[0]>251&&f[1]>251&&f[2]>251&&(c[u].color=[255,255,255])}},{quantize:function(c,h){if(!c.length||h<2||h>256)return!1;var u=function(b){var T,M=new Array(1<<3*n);return b.forEach(function(_){T=s(_[0]>>e,_[1]>>e,_[2]>>e),M[T]=(M[T]||0)+1}),M}(c);u.forEach(function(){});var f=function(b,T){var M,_,I,D=1e6,K=0,H=1e6,Q=0,q=1e6,F=0;return b.forEach(function(Y){(M=Y[0]>>e)<D?D=M:M>K&&(K=M),(_=Y[1]>>e)<H?H=_:_>Q&&(Q=_),(I=Y[2]>>e)<q?q=I:I>F&&(F=I)}),new r(D,K,H,Q,q,F,T)}(c,u),g=new o(function(b,T){return Ss.naturalOrder(b.count(),T.count())});function p(b,T){for(var M,_=b.size(),I=0;I<t;){if(_>=T||I++>t)return;if((M=b.pop()).count()){var D=l(u,M),K=D[0],H=D[1];if(!K)return;b.push(K),H&&(b.push(H),_++)}else b.push(M),I++}}g.push(f),p(g,.75*h);for(var C=new o(function(b,T){return Ss.naturalOrder(b.count()*b.volume(),T.count()*T.volume())});g.size();)C.push(g.pop());p(C,h);for(var y=new a;C.size();)y.push(C.pop());return y}}}().quantize,Bp=function(n){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.width=this.canvas.width=n.naturalWidth,this.height=this.canvas.height=n.naturalHeight,this.context.drawImage(n,0,0,this.width,this.height)};Bp.prototype.getImageData=function(){return this.context.getImageData(0,0,this.width,this.height)};var ri=function(){};ri.prototype.getColor=function(n,e){return e===void 0&&(e=10),this.getPalette(n,5,e)[0]},ri.prototype.getPalette=function(n,e,t){var s=function(l){var c=l.colorCount,h=l.quality;if(c!==void 0&&Number.isInteger(c)){if(c===1)throw new Error("colorCount should be between 2 and 20. To get one color, call getColor() instead of getPalette()");c=Math.max(c,2),c=Math.min(c,20)}else c=10;return(h===void 0||!Number.isInteger(h)||h<1)&&(h=10),{colorCount:c,quality:h}}({colorCount:e,quality:t}),o=new Bp(n),r=function(l,c,h){for(var u,f,g,p,C,y=l,b=[],T=0;T<c;T+=h)f=y[0+(u=4*T)],g=y[u+1],p=y[u+2],((C=y[u+3])===void 0||C>=125)&&(f>250&&g>250&&p>250||b.push([f,g,p]));return b}(o.getImageData().data,o.width*o.height,s.quality),a=cE(r,s.colorCount);return a?a.palette():null},ri.prototype.getColorFromUrl=function(n,e,t){var s=this,o=document.createElement("img");o.addEventListener("load",function(){var r=s.getPalette(o,5,t);e(r[0],n)}),o.src=n},ri.prototype.getImageData=function(n,e){var t=new XMLHttpRequest;t.open("GET",n,!0),t.responseType="arraybuffer",t.onload=function(){if(this.status==200){var s=new Uint8Array(this.response);i=s.length;for(var o=new Array(i),r=0;r<s.length;r++)o[r]=String.fromCharCode(s[r]);var a=o.join(""),l=window.btoa(a);e("data:image/png;base64,"+l)}},t.send()},ri.prototype.getColorAsync=function(n,e,t){var s=this;this.getImageData(n,function(o){var r=document.createElement("img");r.addEventListener("load",function(){var a=s.getPalette(r,5,t);e(a[0],this)}),r.src=o})};class ka{constructor(e){ar(this,ph);Ie(this,"element");this.element=X0(this,ph,q0).call(this,e)}get context(){const e=this.element.getContext("2d");if(e instanceof CanvasRenderingContext2D)return e;throw new Error("context is not instance of CanvasRenderingContext2D")}get colors(){return this.context.getImageData(0,0,this.element.width,this.element.height).data}}ph=new WeakSet,q0=function(e){const t=document.getElementById(e);if(t instanceof HTMLCanvasElement)return t;throw new Error(`element ID ${e} is not instance of a HTMLCanvasElement`)};const hE=new ri;class uE{constructor(){Ie(this,"isDrawnMask",!1);Ie(this,"imageElement");Ie(this,"scale",1);Ie(this,"cursor",{xPx:0,yPx:0});Ie(this,"rectangle",{startX:0,startY:0,endX:0,endY:0});Ie(this,"maskMode",-1);Ie(this,"manualMode",-1);Ie(this,"penToolSizePx",50);Ie(this,"eraserSizePx",30);Ie(this,"uploadImageUrl","");this.imageElement=new Image}async initializeImageElement(){return new Promise((e,t)=>{this.imageElement.onload=e,this.imageElement.onerror=s=>{t(s)},this.imageElement.src="/sample_graph_curve.png"})}getDivElementById(e){const t=document.getElementById(e);if(t instanceof HTMLDivElement)return t;throw new Error(`element ID ${e} is not instance of a HTMLDivElement`)}get scaledCursor(){return{xPx:this.cursor.xPx*this.scale,yPx:this.cursor.yPx*this.scale}}get scaledPenToolSizePx(){return this.penToolSizePx*this.scale}get isDrawingMask(){switch(this.maskMode){case 0:case 1:case 2:return!0;default:return!1}}mouseMove(e,t){switch(this.maskMode){case 0:this.mouseMoveForPen(e,t,this.penToolSizePx);break;case 1:this.mouseMoveForBox(e,t);break;case 2:this.mouseMoveForEraser(e,t,this.eraserSizePx);break}}mouseMoveForPen(e,t,s){const o=this.maskCanvas.context;o.strokeStyle="#ffff00ff",o.beginPath(),this.cursor.xPx===0?o.moveTo(e,t):o.moveTo(this.scaledCursor.xPx+1e-4,this.scaledCursor.yPx+1e-4),o.lineTo(e,t),o.lineCap="round",o.lineWidth=s,o.stroke(),this.isDrawnMask=!0,this.magnifierMaskCanvas.context.drawImage(this.maskCanvas.element,0,0)}mouseMoveForEraser(e,t,s){const o=this.maskCanvas.context;o.globalCompositeOperation="destination-out",o.strokeStyle="#000000",o.beginPath(),this.scaledCursor.xPx===0?o.moveTo(e,t):o.moveTo(this.scaledCursor.xPx,this.scaledCursor.yPx),o.lineTo(e,t),o.lineCap="round",o.lineWidth=s,o.stroke(),this.isDrawnMask=!0,o.globalCompositeOperation="source-over",this.magnifierMaskCanvas.context.clearRect(0,0,this.maskCanvas.element.width,this.maskCanvas.element.height),this.magnifierMaskCanvas.context.drawImage(this.maskCanvas.element,0,0)}mouseDownForBox(e,t){this.rectangle.startY=t,this.rectangle.startX=e}mouseMoveForBox(e,t){this.tempMaskCanvas.context.strokeStyle="#000000ff",this.tempMaskCanvas.context.clearRect(0,0,this.maskCanvas.element.width,this.maskCanvas.element.height),this.rectangle.endY=t-this.rectangle.startY,this.rectangle.endX=e-this.rectangle.startX,this.tempMaskCanvas.context.strokeRect(this.rectangle.startX,this.rectangle.startY,this.rectangle.endX,this.rectangle.endY)}mouseUpForBox(){this.maskCanvas.context.fillStyle="#ffff00ff",this.maskCanvas.context.fillRect(this.rectangle.startX,this.rectangle.startY,this.rectangle.endX,this.rectangle.endY),this.magnifierMaskCanvas.context.drawImage(this.maskCanvas.element,0,0),this.isDrawnMask=!0,this.clearRectangle(),this.tempMaskCanvas.context.clearRect(0,0,this.maskCanvas.element.width,this.maskCanvas.element.height)}clearRectangle(){this.rectangle={startX:0,startY:0,endX:0,endY:0}}get originalImageCanvasColors(){const e=document.createElement("canvas");e.setAttribute("width",String(this.originalWidth)),e.setAttribute("height",String(this.originalHeight));const t=e.getContext("2d");return t.drawImage(this.imageElement,0,0,this.originalWidth,this.originalHeight),t.getImageData(0,0,this.originalWidth,this.originalHeight).data}get originalSizeMaskCanvasColors(){const e=document.createElement("canvas");e.setAttribute("width",String(this.originalWidth)),e.setAttribute("height",String(this.originalHeight));const t=e.getContext("2d");return t.drawImage(this.maskCanvas.element,0,0,this.originalWidth,this.originalHeight),t.getImageData(0,0,this.originalWidth,this.originalHeight).data}get colorSwatches(){if(!this.imageElement)throw new Error("imageElement is undefined.");return hE.getPalette(this.imageElement).map(e=>e.reduce((t,s)=>s.toString(16).length===1?t+"0"+s.toString(16):t+s.toString(16),"#"))}changeImage(e){this.imageElement=e,this.drawFitSizeImage()}clearMask(){this.maskCanvas.context.clearRect(0,0,this.maskCanvas.element.width,this.maskCanvas.element.height),this.magnifierMaskCanvas.context.clearRect(0,0,this.maskCanvas.element.width,this.maskCanvas.element.height),this.isDrawnMask=!1}get originalWidth(){return this.imageElement.width}get originalHeight(){return this.imageElement.height}get canvasWrapper(){return this.getDivElementById("canvasWrapper")}get imageCanvas(){return new ka("imageCanvas")}get maskCanvas(){return new ka("maskCanvas")}get tempMaskCanvas(){return new ka("tempMaskCanvas")}get magnifierMaskCanvas(){return new ka("magnifierMaskCanvas")}drawFitSizeImage(){const e=this.canvasWrapper.offsetWidth,t=e/this.originalWidth,s=this.originalHeight*t;this.resize(e,s),this.scale=t}scaleDown(){if(this.scale<=.1)throw new Error("The scale doesn't allow it to be a minus.");this.scale=this.scale-.1;const e=this.originalWidth*this.scale,t=this.originalHeight*this.scale;this.resize(e,t)}scaleUp(){this.scale=this.scale+.1;const e=this.originalWidth*this.scale,t=this.originalHeight*this.scale;this.resize(e,t)}drawOriginalSizeImage(){this.resize(this.originalWidth,this.originalHeight),this.scale=1}resize(e,t){const s=document.createElement("canvas"),o=s.getContext("2d");s.width=this.maskCanvas.element.width,s.height=this.maskCanvas.element.height,o.drawImage(this.maskCanvas.element,0,0),this.maskCanvas.element.width=e,this.maskCanvas.element.height=t,this.maskCanvas.context.drawImage(s,0,0,e,t),this.tempMaskCanvas.element.width=e,this.tempMaskCanvas.element.height=t,this.imageCanvas.element.width=e,this.imageCanvas.element.height=t,this.imageCanvas.context.drawImage(this.imageElement,0,0,e,t),this.magnifierMaskCanvas.element.width=e,this.magnifierMaskCanvas.element.height=t,this.magnifierMaskCanvas.context.drawImage(this.maskCanvas.element,0,0,e,t)}}const St=Ys("canvas",{state:()=>({canvas:new uE}),getters:{},actions:{scaleUp(){this.canvas.scaleUp()},scaleDown(){this.canvas.scaleDown()},resizeCanvasToOriginal(){this.canvas.drawOriginalSizeImage()},drawFitSizeImage(){this.canvas.drawFitSizeImage()},mouseMoveForPen(n){this.canvas.mouseMoveForPen(n.xPx,n.yPx,n.penSize)},setCanvasCursor(n){this.canvas.cursor=n},setPenToolSizePx(n){this.canvas.penToolSizePx=n},setMaskMode(n){this.canvas.maskMode=n,this.canvas.manualMode=-1},setManualMode(n){this.canvas.manualMode=n,this.canvas.maskMode=-1},setEraserSizePx(n){this.canvas.eraserSizePx=n},setUploadImageUrl(n){this.canvas.uploadImageUrl=n},mouseMoveOnCanvas(n){this.canvas.mouseMove(n.xPx,n.yPx)}}}),dE=m.defineComponent({computed:{...Re(ys,["magnifier"]),...Re(St,["canvas"]),halfSize(){return this.magnifier.sizePx/2}}}),fE=["src"];function gE(n,e,t,s,o,r){return m.openBlock(),m.createElementBlock("div",null,[m.createElementVNode("img",{src:n.canvas.uploadImageUrl,alt:"the image you uploaded",style:m.normalizeStyle({position:"absolute",top:0,left:0,transform:`scale(${n.magnifier.scale}) translate(-${n.canvas.cursor.xPx-n.halfSize/n.magnifier.scale}px, -${n.canvas.cursor.yPx-n.halfSize/n.magnifier.scale}px)`,"transform-origin":"top left"})},null,12,fE),m.createElementVNode("canvas",{id:"magnifierMaskCanvas",style:m.normalizeStyle({position:"absolute",top:0,left:0,opacity:.5,transform:`scale(${n.magnifier.scale/n.canvas.scale}) translate(-${(n.canvas.cursor.xPx-n.halfSize/n.magnifier.scale)*n.canvas.scale}px, -${(n.canvas.cursor.yPx-n.halfSize/n.magnifier.scale)*n.canvas.scale}px)`,"transform-origin":"top left"})},null,4)])}const mE=qe(dE,[["render",gE]]),pE=m.defineComponent({props:{label:String}}),wE={style:{position:"absolute",left:"4px",top:"8px"}};function CE(n,e,t,s,o,r){return m.openBlock(),m.createElementBlock("div",wE,m.toDisplayString(n.label),1)}const yE=qe(pE,[["render",CE]]),SE=m.defineComponent({props:{label:String}}),vE={style:{position:"absolute",left:"-18px",top:"-10px"}};function bE(n,e,t,s,o,r){return m.openBlock(),m.createElementBlock("div",vE,m.toDisplayString(n.label),1)}const RE=qe(SE,[["render",bE]]);class EE{constructor(e,t,s,o,r){Ie(this,"x1");Ie(this,"x2");Ie(this,"y1");Ie(this,"y2");Ie(this,"x2y2");Ie(this,"xIsLog",!1);Ie(this,"yIsLog",!1);Ie(this,"activeAxisName","");Ie(this,"pointMode",0);Ie(this,"considerGraphTilt",!1);Ie(this,"isAdjusting",!1);this.x1=e,this.x2=t,this.y1=s,this.y2=o,this.x2y2=r}get hasAtLeastOneAxis(){return!!(this.x1.coordIsFilled||this.x2.coordIsFilled||this.y1.coordIsFilled||this.y2.coordIsFilled)}get hasXAxis(){return this.x1.coordIsFilled||this.x2.coordIsFilled}get hasYAxis(){return this.y1.coordIsFilled||this.y2.coordIsFilled}get hasOnlyX1Y1Axes(){return this.x1.coordIsFilled&&this.y1.coordIsFilled&&!this.x2.coordIsFilled&&!this.y2.coordIsFilled}get activeAxis(){switch(this.activeAxisName){case"x1":return this.x1;case"x2":return this.x2;case"y1":return this.y1;case"y2":return this.y2;case"x2y2":return this.x2y2;default:return null}}get nextAxis(){return this.pointMode===0&&this.hasOnlyX1Y1Axes?this.x2y2:this.x1.coordIsFilled?this.x2.coordIsFilled?this.y1.coordIsFilled?this.y2.coordIsFilled?null:this.y2:this.y1:this.x2:this.x1}moveActiveAxis(e){if(!this.activeAxis||!this.activeAxis.coord)throw new Error("active axis's coord is undefined");switch(this.isAdjusting=!0,e.direction){case"up":this.activeAxis.coord.yPx-=e.distancePx,this.activeAxis.name==="x2y2"&&(this.y2.coord.yPx-=e.distancePx);break;case"right":this.activeAxis.coord.xPx+=e.distancePx,this.activeAxis.name==="x2y2"&&(this.x2.coord.xPx+=e.distancePx);break;case"down":this.activeAxis.coord.yPx+=e.distancePx,this.activeAxis.name==="x2y2"&&(this.y2.coord.yPx+=e.distancePx);break;case"left":this.activeAxis.coord.xPx-=e.distancePx,this.activeAxis.name==="x2y2"&&(this.x2.coord.xPx-=e.distancePx);break;default:throw new Error(`undefined direction: ${e.direction}`)}}clearAxesCoords(){this.x1.clearCoord(),this.x2.clearCoord(),this.y1.clearCoord(),this.y2.clearCoord(),this.x2y2.clearCoord(),this.activeAxisName=""}clearXAxisCoords(){this.x1.clearCoord(),this.x2.clearCoord(),this.x2y2.clearCoord(),this.activeAxisName=""}clearYAxisCoords(){this.y1.clearCoord(),this.y2.clearCoord(),this.x2y2.clearCoord(),this.activeAxisName=""}addAxisCoord(e){if(!this.nextAxis)throw new Error("The axes already filled.");if(this.activeAxisName=this.nextAxis.name,this.activeAxisName==="x1"&&this.pointMode===0){this.x1.coord=Object.assign(e),this.y1.coord=Object.assign(e);return}if(this.activeAxisName==="x2y2"){this.x2y2.coord=Object.assign(e),this.x2.coord={xPx:e.xPx,yPx:this.x1.coord.yPx},this.y2.coord={xPx:this.y1.coord.xPx,yPx:e.yPx};return}this.nextAxis.coord=e}inactivateAxis(){this.activeAxisName=""}}class hr{constructor(e,t,s){Ie(this,"name");Ie(this,"value");Ie(this,"coord");Ie(this,"initialCoord",{xPx:-999,yPx:-999});this.name=e,this.value=t,this.coord=s||this.initialCoord}clearCoord(){this.coord=this.initialCoord}get coordIsFilled(){return this.coord.xPx+this.coord.yPx>0}}const jt=Ys("axes",{state:()=>({axes:new EE(new hr("x1",0),new hr("x2",1),new hr("y1",0),new hr("y2",1),new hr("x2y2",-1))}),actions:{setX1Value(n){this.axes.x1.value=n},setX2Value(n){this.axes.x2.value=n},setY1Value(n){this.axes.y1.value=n},setY2Value(n){this.axes.y2.value=n},setXIsLog(n){this.axes.xIsLog=n},setYIsLog(n){this.axes.yIsLog=n},clearAxesCoords(){this.axes.clearAxesCoords()},clearXAxisCoords(){this.axes.clearXAxisCoords()},clearYAxisCoords(){this.axes.clearYAxisCoords()},addAxisCoord(n){this.axes.addAxisCoord(n)},moveActiveAxis(n){this.axes.moveActiveAxis(n)},inactivateAxis(){this.axes.inactivateAxis()}}}),ur=Ys("style",{state:()=>({plotSizePx:10,axisSizePx:20}),getters:{axisHalfSizePx(){return this.axisSizePx/2},axisCrossBorderPx(){return this.axisSizePx*.1},axisCrossBorderHalfPx(){return this.axisCrossBorderPx*.5},axisCrossTopPx(){return(this.axisSizePx-this.axisCrossBorderPx)/2},axisCrossCursorPx(){return this.axisSizePx*.7}},actions:{updatePlotSizePx(n){this.plotSizePx=n},updateAxisSizePx(n){this.axisSizePx=n},setPlotSizePx(n){this.updatePlotSizePx(n)},setAxisSizePx(n){this.updateAxisSizePx(n)}}}),xE=m.defineComponent({components:{MagnifierAxisLabelX:yE,MagnifierAxisLabelY:RE},data(){return{}},computed:{...Re(jt,["axes"]),...Re(St,["canvas"]),...Re(ur,["axisSizePx","axisHalfSizePx","axisCrossBorderHalfPx","axisCrossBorderPx","axisCrossTopPx","axisCrossCursorPx"]),...Re(ys,["magnifier"]),xPx(){return this.axis.coord.xPx},yPx(){return this.axis.coord.yPx},magnifierHalfSizePx(){return this.magnifier.sizePx/2}},props:{axis:{type:Object,required:!0},isActive:{type:Boolean,required:!0}},methods:{}}),TE={style:{border:"'1px solid red'"}},ME={key:0},_E={key:1};function IE(n,e,t,s,o,r){const a=m.resolveComponent("magnifier-axis-label-x"),l=m.resolveComponent("magnifier-axis-label-y");return m.openBlock(),m.createElementBlock("div",TE,[m.createElementVNode("div",{style:m.normalizeStyle({position:"absolute",top:`${(n.yPx-n.axisHalfSizePx)*n.magnifier.scale}px`,left:`${(n.xPx-n.axisCrossBorderHalfPx)*n.magnifier.scale}px`,"pointer-events":"none",transform:`scale(${n.magnifier.scale}) translate(-${n.canvas.cursor.xPx-n.magnifierHalfSizePx/n.magnifier.scale}px, -${n.canvas.cursor.yPx-n.magnifierHalfSizePx/n.magnifier.scale}px)`,"transform-origin":"top left",width:`${n.axisCrossBorderPx}px`,height:`${n.axisSizePx}px`,background:n.isActive?"red":"dodgerblue"})},[m.createElementVNode("div",{style:m.normalizeStyle({content:"",position:"absolute",top:`${n.axisCrossTopPx}px`,left:`${-n.axisCrossTopPx}px`,width:`${n.axisSizePx}px`,height:`${n.axisCrossBorderPx}px`,background:n.isActive?"red":"dodgerblue"})},[n.axis.name.includes("x")&&n.axis.name!=="x2y2"?(m.openBlock(),m.createElementBlock("div",ME,[m.createVNode(a,{label:n.axis.name},null,8,["label"])])):m.createCommentVNode("",!0),n.axis.name.includes("y")&&n.axis.name!=="x2y2"?(m.openBlock(),m.createElementBlock("div",_E,[m.createVNode(l,{label:n.axis.name},null,8,["label"])])):m.createCommentVNode("",!0)],4)],4)])}const OE=qe(xE,[["render",IE]]),AE=m.defineComponent({components:{MagnifierAxis:OE},computed:{...Re(jt,["axes"]),...Re(St,["canvas"])}});function PE(n,e,t,s,o,r){const a=m.resolveComponent("magnifier-axis");return m.openBlock(),m.createElementBlock("div",null,[m.createVNode(a,{axis:n.axes.x1,isActive:n.axes.activeAxisName==="x1"},null,8,["axis","isActive"]),m.createVNode(a,{axis:n.axes.x2,isActive:n.axes.activeAxisName==="x2"},null,8,["axis","isActive"]),m.createVNode(a,{axis:n.axes.y1,isActive:n.axes.activeAxisName==="y1"},null,8,["axis","isActive"]),m.createVNode(a,{axis:n.axes.y2,isActive:n.axes.activeAxisName==="y2"},null,8,["axis","isActive"]),m.createVNode(a,{axis:n.axes.x2y2,isActive:n.axes.activeAxisName==="x2y2"},null,8,["axis","isActive"])])}const DE=qe(AE,[["render",PE]]),NE=m.defineComponent({computed:{...Re(ys,["magnifier"]),...Re(St,["canvas"]),...Re(ur,["plotSizePx"]),plotHalfSize(){return this.plotSizePx/2},magnifierHalfSize(){return this.magnifierSize/2},xPx(){return this.plot.xPx},yPx(){return this.plot.yPx}},props:{plot:{type:Object,required:!0},magnifierSize:{type:Number,required:!0},isActive:{type:Boolean}}});function HE(n,e,t,s,o,r){return m.openBlock(),m.createElementBlock("div",{class:"magnifier-plots",style:m.normalizeStyle({position:"absolute",top:`${(n.yPx-n.plotHalfSize)*n.magnifier.scale}px`,left:`${(n.xPx-n.plotHalfSize)*n.magnifier.scale}px`,transform:`scale(${n.magnifier.scale}) translate(-${n.canvas.cursor.xPx-n.magnifierHalfSize/n.magnifier.scale}px, -${n.canvas.cursor.yPx-n.magnifierHalfSize/n.magnifier.scale}px)`,"transform-origin":"top left","pointer-events":"none",width:`${n.plotSizePx}px`,height:`${n.plotSizePx}px`,"background-color":n.isActive?"red":"dodgerblue",border:"1px solid white","border-radius":"50%"})},null,4)}const kE=qe(NE,[["render",HE]]),LE=m.defineComponent({data(){return{}},computed:{...Re(ys,["magnifier"])},props:{shouldShowSettingsDialog:{type:Boolean,required:!0},toggleSettingsDialog:{type:Function,required:!0},magnifierSettingError:{type:String,required:!0},setMagnifierScale:{type:Function,required:!0}},methods:{onChangeMagnifierScale(n){this.setMagnifierScale(Number(n.target.value))}}}),VE=m.createElementVNode("span",{class:"text-h5"},"Magnifier Settings",-1);function $E(n,e,t,s,o,r){const a=m.resolveComponent("v-card-title"),l=m.resolveComponent("v-text-field"),c=m.resolveComponent("v-col"),h=m.resolveComponent("v-row"),u=m.resolveComponent("v-container"),f=m.resolveComponent("v-card-text"),g=m.resolveComponent("v-btn"),p=m.resolveComponent("v-card-actions"),C=m.resolveComponent("v-card"),y=m.resolveComponent("v-dialog");return m.openBlock(),m.createBlock(y,{"model-value":n.shouldShowSettingsDialog,"max-width":"300px"},{default:m.withCtx(()=>[m.createVNode(C,null,{default:m.withCtx(()=>[m.createVNode(a,null,{default:m.withCtx(()=>[VE]),_:1}),m.createVNode(f,null,{default:m.withCtx(()=>[m.createVNode(u,null,{default:m.withCtx(()=>[m.createVNode(h,null,{default:m.withCtx(()=>[m.createVNode(c,null,{default:m.withCtx(()=>[m.createVNode(l,{"model-value":n.magnifier.scale,type:"number",label:"Magnifier (times)",onChange:n.onChangeMagnifierScale,error:n.magnifierSettingError.length>0,"error-messages":n.magnifierSettingError},null,8,["model-value","onChange","error","error-messages"])]),_:1})]),_:1})]),_:1})]),_:1}),m.createVNode(p,null,{default:m.withCtx(()=>[m.createVNode(g,{onClick:n.toggleSettingsDialog},{default:m.withCtx(()=>[m.createTextVNode(" Close ")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["model-value"])}const FE=qe(LE,[["render",$E]]),BE=m.defineComponent({computed:{},props:{toggleSettingsDialog:{type:Function,required:!0}}});function WE(n,e,t,s,o,r){const a=m.resolveComponent("v-icon"),l=m.resolveComponent("v-btn");return m.openBlock(),m.createBlock(l,{size:"small",onClick:n.toggleSettingsDialog,style:{position:"absolute",top:"-4px",right:"-4px","z-index":100},icon:"",elevation:"0"},{default:m.withCtx(()=>[m.createVNode(a,{size:"small"},{default:m.withCtx(()=>[m.createTextVNode("mdi-cog")]),_:1})]),_:1},8,["onClick"])}const UE=qe(BE,[["render",WE]]);class Wp{matchColor(e,t,s){return e.reduce((r,a,l)=>r+Math.pow(e[l]-t[l],2),0)/(Math.pow(255,2)*3)*100<s}isOnMask(e,t,s,o){return e===255&&t===255&&s===0&&o>0}}const wh=class wh extends Wp{constructor(){super();Ie(this,"name","Line Extract");Ie(this,"dxPx",10);Ie(this,"dyPx",10)}static get instance(){return Je(this,sr)||Na(this,sr,new wh),Je(this,sr)}execute(t,s,o,r,a,l,c){const h=[],u=[...Array(t)].map(()=>Array(s).fill(!1));if(a)for(let f=0;f<t;f++)for(let g=0;g<s;g++){const[p,C,y,b]=r.slice((f*s+g)*4,(f*s+g+1)*4);this.isOnMask(p,C,y,b)||(u[f][g]=!0)}for(let f=0;f<s;f++)for(let g=0;g<t;g++){if(u[g][f])continue;const[p,C,y]=o.slice((g*s+f)*4,(g*s+f+1)*4),b=this.matchColor([p,C,y],l,c);if(u[g][f]=!0,b){const T=[{id:0,xPx:f,yPx:g}];let M=0;for(;M<T.length;){for(let K=T[M].yPx-1;K<=T[M].yPx+1;K++)for(let H=T[M].xPx-1;H<=T[M].xPx+1;H++){if(K<0||H<0||K>=t||H>=s||Math.abs(H-f)>this.dxPx||Math.abs(K-g)>this.dyPx||u[K][H])continue;const[Q,q,F]=o.slice((K*s+H)*4,(K*s+H+1)*4);this.matchColor([Q,q,F],l,c)&&(T.push({id:T.length,xPx:H,yPx:K}),u[K][H]=!0)}M++}const _=T.reduce((K,H)=>K+H.xPx,0),I=T.reduce((K,H)=>K+H.yPx,0),D=.5;h.push({id:h.length,xPx:parseFloat((_/T.length+D).toFixed(1)),yPx:parseFloat((I/T.length+D).toFixed(1))})}}return h}};sr=new WeakMap,ar(wh,sr,void 0);let ai=wh;const Th=Ys("lineExtract",{state:()=>({lineExtract:ai.instance}),getters:{},actions:{setDyPx(n){this.lineExtract.dyPx=n},setDxPx(n){this.lineExtract.dxPx=n}}});class zE{constructor(e){Ie(this,"strategy");Ie(this,"strategies",["Symbol Extract","Line Extract"]);Ie(this,"colorPicker","#000000ff");Ie(this,"colors",[]);Ie(this,"colorDistancePct",5);Ie(this,"swatches",[...Array(5)].map(()=>[]));this.strategy=e}execute(e){return this.strategy.execute(e.imageElement.height,e.imageElement.width,e.originalImageCanvasColors,e.originalSizeMaskCanvasColors,e.isDrawnMask,[this.targetColor.R,this.targetColor.G,this.targetColor.B],this.colorDistancePct)}get targetColor(){return{R:parseInt(this.colorPicker.slice(1,3),16),G:parseInt(this.colorPicker.slice(3,5),16),B:parseInt(this.colorPicker.slice(5,7),16)}}get targetColorHex(){return"#"+this.targetColor.R.toString(16)+this.targetColor.G.toString(16)+this.targetColor.B.toString(16)}updateSwatches(e){this.swatches=[...Array(5)].map(()=>[]),e.forEach((t,s)=>{this.swatches[s%this.swatches.length].push(t)}),this.colorPicker=e[0]}}const Co=Ys("extractor",{state:()=>({extractor:new zE(ai.instance)}),getters:{},actions:{setColorDistancePct(n){this.extractor.colorDistancePct=n},setStrategy(n){this.extractor.strategy=n},setColorPicker(n){this.extractor.colorPicker=n},setSwatches(n){this.extractor.updateSwatches(n)}}}),Ch=class Ch extends Wp{constructor(){super();Ie(this,"name","Symbol Extract");Ie(this,"minDiameterPx",5);Ie(this,"maxDiameterPx",100)}static get instance(){return Je(this,or)||Na(this,or,new Ch),Je(this,or)}execute(t,s,o,r,a,l,c){const h=[],u=[...Array(t)].map(()=>Array(s).fill(!1));if(a)for(let f=0;f<t;f++)for(let g=0;g<s;g++){const[p,C,y,b]=r.slice((f*s+g)*4,(f*s+g+1)*4);this.isOnMask(p,C,y,b)||(u[f][g]=!0)}for(let f=0;f<t;f++)for(let g=0;g<s;g++){if(u[f][g])continue;const[p,C,y]=o.slice((f*s+g)*4,(f*s+g+1)*4),b=this.matchColor([p,C,y],l,c);if(u[f][g]=!0,b){const T=[{id:0,xPx:g,yPx:f}];let M=0;for(;M<T.length;){for(let H=T[M].yPx-1;H<=T[M].yPx+1;H++)for(let Q=T[M].xPx-1;Q<=T[M].xPx+1;Q++){if(H<0||Q<0||H>=t||Q>=s||u[H][Q])continue;const[q,F,Y]=o.slice((H*s+Q)*4,(H*s+Q+1)*4);this.matchColor([q,F,Y],l,c)&&(T.push({id:T.length,xPx:Q,yPx:H}),u[H][Q]=!0)}M++}const _=T.reduce((H,Q)=>H+Q.xPx,0),I=T.reduce((H,Q)=>H+Q.yPx,0),D=T.length,K=Math.sqrt(D/Math.PI)*2;this.minDiameterPx<=K&&K<=this.maxDiameterPx&&h.push({id:h.length,xPx:parseFloat((_/T.length+.5).toFixed(1)),yPx:parseFloat((I/T.length+.5).toFixed(1))})}}return h}};or=new WeakMap,ar(Ch,or,void 0);let dr=Ch;const Mh=Ys("symbolExtractByArea",{state:()=>({symbolExtractByArea:dr.instance}),getters:{},actions:{setMinDiameterPx(n){this.symbolExtractByArea.minDiameterPx=n},setMaxDiameterPx(n){this.symbolExtractByArea.maxDiameterPx=n}}}),YE=m.defineComponent({computed:{...Re(ys,["magnifier"]),...Re(Th,["lineExtract"]),...Re(Co,["extractor"]),...Re(Mh,["symbolExtractByArea"]),symbolMinDiameter(){return this.symbolExtractByArea.minDiameterPx*this.magnifier.scale},symbolMaxDiameter(){return this.symbolExtractByArea.maxDiameterPx*this.magnifier.scale}}}),GE={key:1};function jE(n,e,t,s,o,r){return m.openBlock(),m.createElementBlock("div",null,[n.extractor.strategy.name==="Line Extract"?(m.openBlock(),m.createElementBlock("div",{key:0,style:m.normalizeStyle({position:"absolute",left:`${(n.magnifier.sizePx-n.lineExtract.dxPx*n.magnifier.scale)/2}px`,top:`${(n.magnifier.sizePx-n.lineExtract.dxPx*n.magnifier.scale)/2}px`,width:`${n.lineExtract.dxPx*n.magnifier.scale}px`,height:`${n.lineExtract.dxPx*n.magnifier.scale}px`,border:"1px dotted grey"})},null,4)):m.createCommentVNode("",!0),n.extractor.strategy.name==="Symbol Extract"?(m.openBlock(),m.createElementBlock("div",GE,[m.createElementVNode("div",{style:m.normalizeStyle({position:"absolute",left:`${(n.magnifier.sizePx-n.symbolMinDiameter)/2}px`,top:`${(n.magnifier.sizePx-n.symbolMinDiameter)/2}px`,width:`${n.symbolMinDiameter}px`,height:`${n.symbolMinDiameter}px`,border:"1px dotted grey"})},null,4),m.createElementVNode("div",{style:m.normalizeStyle({position:"absolute",left:`${(n.magnifier.sizePx-n.symbolMaxDiameter)/2}px`,top:`${(n.magnifier.sizePx-n.symbolMaxDiameter)/2}px`,width:`${n.symbolMaxDiameter}px`,height:`${n.symbolMaxDiameter}px`,border:"1px dotted grey"})},null,4)])):m.createCommentVNode("",!0)])}const KE=qe(YE,[["render",jE]]);class Up{constructor(e,t){Ie(this,"effectiveDigits",4);ar(this,ot,void 0);ar(this,ir,void 0);Na(this,ot,e),Na(this,ir,t)}calculateXYValues(e,t){if(!(Je(this,ot).x1.coord&&Je(this,ot).x2.coord&&Je(this,ot).y1.coord&&Je(this,ot).y2.coord))return{xV:"NaN",yV:"NaN"};if(Je(this,ot).x1.value===Je(this,ot).x2.value||Je(this,ot).y1.value===Je(this,ot).y2.value)return{xV:"NaN",yV:"NaN"};const[s,o,r,a,l,c,h,u,f,g,p,C]=[Je(this,ot).x1.coord.xPx,Je(this,ot).x1.coord.yPx,Je(this,ot).x2.coord.xPx,Je(this,ot).x2.coord.yPx,Je(this,ot).x1.value,Je(this,ot).x2.value,Je(this,ot).y1.coord.xPx,Je(this,ot).y1.coord.yPx,Je(this,ot).y2.coord.xPx,Je(this,ot).y2.coord.yPx,Je(this,ot).y1.value,Je(this,ot).y2.value];let y=e,b=t;if(Je(this,ot).considerGraphTilt){const q=r-s,F=a-o,Y=f-h,te=g-u,ie=((t-o)*Y-(e-s)*te)/(F*Y-q*te),fe=((t-u)*q-(e-h)*F)/(te*q-Y*F);y=s+ie*q,b=u+fe*te}const T=Je(this,ir).x?Math.pow(10,(y-s)/(r-s)*(Math.log10(c)-Math.log10(l))+Math.log10(l)):(y-s)/(r-s)*(c-l)+l,M=Je(this,ir).y?Math.pow(10,(b-u)/(g-u)*(Math.log10(C)-Math.log10(p))+Math.log10(p)):(b-u)/(g-u)*(C-p)+p,_=this.calculateEffectiveDigits(Je(this,ot).x2.value,Je(this,ot).x1.value),I=this.calculateEffectiveDigits(Je(this,ot).y2.value,Je(this,ot).y1.value),D=parseFloat(T.toPrecision(_)),K=parseFloat(M.toPrecision(I)),H=D.toExponential(),Q=K.toExponential();return{xV:H,yV:Q}}numDigit(e){return e===0?0:Math.floor(Math.log10(Math.abs(e)))}calculateEffectiveDigits(e,t){return Math.abs(this.numDigit(e)-this.numDigit(e-t))+this.effectiveDigits}}ot=new WeakMap,ir=new WeakMap;class XE{constructor(e){Ie(this,"datasets");Ie(this,"activeDatasetId",1);this.datasets=[e]}get activeDataset(){const e=this.datasets.find(t=>t.id===this.activeDatasetId);if(!e)throw new Error("There are no active datasets.");return e}get nextPlotId(){return this.activeDataset.nextPlotId}get nextDatasetId(){return this.datasets.length===0?1:this.datasets[this.datasets.length-1].id+1}setPlots(e){this.activeDataset.plots=e}sortPlots(){this.activeDataset.plots.sort((e,t)=>e.xPx-t.xPx)}setActiveDataset(e){this.activeDatasetId=e}editDatasetName(e,t){const s=this.datasets.find(o=>o.id===e);if(!s)throw new Error(e+"doesn't exist.");s.name=t}addDataset(e){this.datasets.push(e)}popDataset(){this.datasets.length!==1&&(this.datasets[this.datasets.length-1].id===this.activeDatasetId&&this.setActiveDataset(this.datasets[this.datasets.length-2].id),this.datasets.pop())}}class zp{constructor(e,t,s){Ie(this,"name");Ie(this,"plots");Ie(this,"id");Ie(this,"activePlotIds",[]);Ie(this,"plotsAreAdjusting",!1);this.name=e,this.plots=t,this.id=s}scaledPlots(e){return this.plots.map(t=>({id:t.id,xPx:t.xPx*e,yPx:t.yPx*e}))}get plotsAreActive(){return this.activePlotIds.length>0}addPlot(e,t){this.activePlotIds.length=0,this.activePlotIds.push(this.nextPlotId),this.plots.push({id:this.nextPlotId,xPx:e,yPx:t})}get nextPlotId(){return this.plots.length===0?1:Math.max(...this.plots.map(t=>t.id))+1}activatePlot(e){this.activePlotIds.length=0,this.activePlotIds.push(e)}toggleActivatedPlot(e){if(this.activePlotIds.includes(e)){const t=this.activePlotIds.filter(s=>s!==e);this.activePlotIds.length=0,this.activePlotIds.push(...t);return}this.activePlotIds.push(e)}clearPlot(e){this.plots=this.plots.filter(t=>e!==t.id),this.activePlotIds.length=0}clearPlots(){this.plots=[],this.activePlotIds.length=0}inactivatePlots(){this.activePlotIds=[]}clearActivePlots(){this.plots=this.plots.filter(e=>!this.activePlotIds.includes(e.id)),this.activePlotIds.length=0}hasActive(){return this.activePlotIds.length>0}moveActivePlot(e){const t=this.activePlotIds;switch(this.plotsAreAdjusting=!0,e.direction){case"up":this.plots.filter(s=>t.includes(s.id)).map(s=>s.yPx-=e.distancePx);break;case"right":this.plots.filter(s=>t.includes(s.id)).map(s=>s.xPx+=e.distancePx);break;case"down":this.plots.filter(s=>t.includes(s.id)).map(s=>s.yPx+=e.distancePx);break;case"left":this.plots.filter(s=>t.includes(s.id)).map(s=>s.xPx-=e.distancePx);break}}plotsSortedByXAscending(){return this.plots.sort((e,t)=>e.xPx-t.xPx)}plotsSortedByXDescending(){return this.plots.sort((e,t)=>t.xPx-e.xPx)}plotsSortedByYAscending(){return this.plots.sort((e,t)=>e.yPx-t.yPx)}plotsSortedByYDescending(){return this.plots.sort((e,t)=>t.yPx-e.yPx)}plotsSortedByIdAscending(){return this.plots.sort((e,t)=>e.id-t.id)}plotsSortedByIdDescending(){return this.plots.sort((e,t)=>t.id-e.id)}}const pn=Ys("datasets",{state:()=>({datasets:new XE(new zp("dataset 1",[],1))}),getters:{},actions:{addPlot(n){this.datasets.activeDataset.addPlot(n.xPx,n.yPx)},addDataset(){const n=this.datasets.nextDatasetId;this.datasets.addDataset(new zp(`dataset ${n}`,[],n))},popDataset(){this.datasets.popDataset()},moveActivePlot(n){this.datasets.activeDataset.moveActivePlot(n)},clearPlot(n){this.datasets.activeDataset.clearPlot(n)},clearPlots(){this.datasets.activeDataset.clearPlots()},inactivatePlots(){this.datasets.activeDataset.inactivatePlots()},clearActivePlots(){this.datasets.activeDataset.clearActivePlots()},setPlots(n){this.datasets.setPlots(n)},toggleActivatedPlot(n){this.datasets.activeDataset.toggleActivatedPlot(n)},activatePlot(n){this.datasets.activeDataset.activatePlot(n)},setActiveDataset(n){this.datasets.setActiveDataset(n)},sortPlots(){this.datasets.sortPlots()}}}),qE=m.defineComponent({components:{MagnifierVerticalLine:iE,MagnifierHorizontalLine:lE,MagnifierImage:mE,MagnifierAxes:DE,MagnifierPlots:kE,MagnifierSettings:FE,MagnifierSettingsBtn:UE,MagnifierExtractSize:KE},data(){return{magnifierSettingError:"",shouldShowSettingsDialog:!1}},computed:{...Re(pn,["datasets"]),...Re(ys,["magnifier"]),...Re(jt,["axes"]),...Re(St,["canvas"]),xyValue(){return new Up(this.axes,{x:this.axes.xIsLog,y:this.axes.yIsLog}).calculateXYValues(this.canvas.cursor.xPx,this.canvas.cursor.yPx)}},methods:{...wt(ys,["setScale"]),toggleSettingsDialog(){this.shouldShowSettingsDialog=!this.shouldShowSettingsDialog},setMagnifierScale(n){const e=parseInt(n);if(this.magnifierSettingError="",e<2){this.magnifierSettingError="The Magnifier scale is supposed to be larger than 2 times.",this.setScale(2);return}this.setScale(parseInt(n))}}}),ZE={class:"mb-5"};function QE(n,e,t,s,o,r){const a=m.resolveComponent("magnifier-settings-btn"),l=m.resolveComponent("magnifier-image"),c=m.resolveComponent("magnifier-plots"),h=m.resolveComponent("magnifier-extract-size"),u=m.resolveComponent("magnifier-axes"),f=m.resolveComponent("magnifier-vertical-line"),g=m.resolveComponent("magnifier-horizontal-line"),p=m.resolveComponent("magnifier-settings");return m.openBlock(),m.createElementBlock("div",ZE,[m.createElementVNode("div",{style:m.normalizeStyle({overflow:"hidden",width:`${n.magnifier.sizePx}px`,height:`${n.magnifier.sizePx}px`,position:"relative",outline:"1px solid grey"})},[m.createVNode(a,{toggleSettingsDialog:n.toggleSettingsDialog},null,8,["toggleSettingsDialog"]),m.createVNode(l),(m.openBlock(!0),m.createElementBlock(m.Fragment,null,m.renderList(n.datasets.activeDataset.plots,C=>(m.openBlock(),m.createElementBlock("div",{key:C.id},[m.createVNode(c,{plot:C,magnifierSize:n.magnifier.sizePx,isActive:n.datasets.activeDataset.activePlotIds.includes(C.id)},null,8,["plot","magnifierSize","isActive"])]))),128)),m.createVNode(h),m.createVNode(u),m.createVNode(f),m.createVNode(g)],4),m.createElementVNode("span",null,"x: "+m.toDisplayString(n.xyValue.xV)+", y: "+m.toDisplayString(n.xyValue.yV),1),m.createVNode(p,{shouldShowSettingsDialog:n.shouldShowSettingsDialog,toggleSettingsDialog:n.toggleSettingsDialog,magnifierSettingError:n.magnifierSettingError,setMagnifierScale:n.setMagnifierScale},null,8,["shouldShowSettingsDialog","toggleSettingsDialog","magnifierSettingError","setMagnifierScale"])])}const JE=qe(qE,[["render",QE]]),ex=m.defineComponent({computed:{...Re(St,["canvas"]),plotHalfSize(){return this.plotSizePx/2},xPx(){return this.plot.xPx},yPx(){return this.plot.yPx},cursor(){const n=this.canvas.manualMode;if(n===1||n===2)return"pointer"}},props:{plot:{type:Object,required:!0},plotSizePx:{type:Number,required:!0},isActive:{type:Boolean}},methods:{...wt(pn,["toggleActivatedPlot","activatePlot","clearPlot"]),click(n){switch(this.canvas.manualMode){case 0:return;case 1:if(n.ctrlKey||n.metaKey){this.toggleActivatedPlot(this.plot.id);return}this.activatePlot(this.plot.id);return;case 2:this.clearPlot(this.plot.id);return}}}});function tx(n,e,t,s,o,r){return m.openBlock(),m.createElementBlock("div",{class:"canvas-plot",style:m.normalizeStyle({position:"absolute",top:`${n.yPx-n.plotHalfSize}px`,left:`${n.xPx-n.plotHalfSize}px`,cursor:n.cursor,width:`${n.plotSizePx}px`,height:`${n.plotSizePx}px`,"background-color":n.isActive?"red":"dodgerblue",border:"1px solid white","border-radius":"50%"}),onClick:e[0]||(e[0]=(...a)=>n.click&&n.click(...a))},null,4)}const nx=qe(ex,[["render",tx]]),sx=m.defineComponent({components:{CanvasPlot:nx},computed:{...Re(pn,["datasets"]),...Re(St,["canvas"]),...Re(ur,["plotSizePx"]),plotHalfSize(){return this.plotSizePx/2}},data(){return{}},methods:{}});function ox(n,e,t,s,o,r){const a=m.resolveComponent("canvas-plot");return m.openBlock(),m.createElementBlock("div",null,[(m.openBlock(!0),m.createElementBlock(m.Fragment,null,m.renderList(n.datasets.activeDataset.scaledPlots(n.canvas.scale),l=>(m.openBlock(),m.createBlock(a,{key:l.id,plotSizePx:n.plotSizePx,plot:l,isActive:n.datasets.activeDataset.activePlotIds.includes(l.id)},null,8,["plotSizePx","plot","isActive"]))),128))])}const ix=qe(sx,[["render",ox]]),rx=m.defineComponent({props:{axis:{type:Object,required:!0}},data(){return{fontSize:14}},computed:{...Re(ur,["axisSizePx","axisHalfSizePx","axisCrossBorderHalfPx","axisCrossBorderPx","axisCrossTopPx","axisCrossCursorPx"]),...Re(St,["canvas"]),...Re(jt,["axes"]),xPx(){return this.axis.coord?this.axis.coord.xPx*this.canvas.scale:-999},yPx(){return this.axis.coord?this.axis.coord.yPx*this.canvas.scale:-999},labelLeft(){return this.axis.name.includes("x")?this.xPx-this.axisCrossCursorPx/2:this.axis.name.includes("y")?this.xPx-this.axisCrossCursorPx*2:0},labelTop(){return this.axis.name.includes("x")?this.yPx+this.axisCrossCursorPx/2:this.axis.name.includes("y")?this.yPx-this.axisCrossCursorPx:0},isActive(){return this.axes.pointMode===0&&this.axes.activeAxisName==="x1"&&this.axis.name==="y1"?!0:this.axes.activeAxisName===this.axis.name}},methods:{}}),ax={key:0};function lx(n,e,t,s,o,r){return n.axis.coordIsFilled?(m.openBlock(),m.createElementBlock("div",ax,[m.createElementVNode("div",{style:m.normalizeStyle({position:"absolute",top:`${n.yPx-n.axisHalfSizePx}px`,left:`${n.xPx-n.axisCrossBorderHalfPx}px`,"pointer-events":"none",width:`${n.axisCrossBorderPx}px`,height:`${n.axisSizePx}px`,background:n.isActive?"red":"dodgerblue"})},[m.createElementVNode("div",{style:m.normalizeStyle({content:"",position:"absolute",top:`${n.axisCrossTopPx}px`,left:`${-n.axisCrossTopPx}px`,width:`${n.axisSizePx}px`,height:`${n.axisCrossBorderPx}px`,background:n.isActive?"red":"dodgerblue"})},null,4)],4),n.axis.name!=="x2y2"?(m.openBlock(),m.createElementBlock("span",{key:0,style:m.normalizeStyle({position:"absolute",top:`${n.labelTop}px`,left:`${n.labelLeft}px`,"pointer-events":"none","user-select":"none"})},m.toDisplayString(n.axis.name),5)):m.createCommentVNode("",!0)])):m.createCommentVNode("",!0)}const cx=qe(rx,[["render",lx]]),hx=m.defineComponent({components:{CanvasAxis:cx},computed:{...Re(jt,["axes"])},methods:{}});function ux(n,e,t,s,o,r){const a=m.resolveComponent("canvas-axis");return m.openBlock(),m.createElementBlock("div",null,[m.createVNode(a,{axis:n.axes.x1},null,8,["axis"]),m.createVNode(a,{axis:n.axes.x2},null,8,["axis"]),m.createVNode(a,{axis:n.axes.y1},null,8,["axis"]),m.createVNode(a,{axis:n.axes.y2},null,8,["axis"]),m.createVNode(a,{axis:n.axes.x2y2},null,8,["axis"])])}const dx=qe(hx,[["render",ux]]),La={position:"absolute",backgroundColor:"#00ff00",opacity:"0.8","pointer-events":"none"},fx=m.defineComponent({components:{},methods:{getImageCanvasSize(){const n=document.getElementById("imageCanvas");return n?{w:n.clientWidth,h:n.clientHeight}:{w:0,h:0}}},computed:{...Re(jt,["axes"]),...Re(St,["canvas"]),isActive(){return this.axes.pointMode===0},isX1Y1LineVisible(){return this.axes.x1.coordIsFilled||this.canvas.scaledCursor.xPx!==0},isX2Y2LineVisible(){return this.axes.x2y2.coordIsFilled},X1Y1HorizontalLineStyle(){const n=this.axes.x1.coordIsFilled?this.axes.x1.coord.yPx*this.canvas.scale:this.canvas.scaledCursor.yPx;return{...La,right:"0",left:"0",width:`${this.getImageCanvasSize().w}px`,height:"1px",top:n+"px"}},X1Y1VerticalLineStyle(){const n=this.axes.x1.coordIsFilled?this.axes.x1.coord.xPx*this.canvas.scale:this.canvas.scaledCursor.xPx;return{...La,width:"1px",height:`${this.getImageCanvasSize().h}px`,top:"0",bottom:"0",left:n+"px"}},X2Y2HorizontalLineStyle(){const n=this.axes.x2y2.coordIsFilled?this.axes.x2y2.coord.yPx*this.canvas.scale:this.canvas.scaledCursor.yPx;return{...La,right:"0",left:"0",width:`${this.getImageCanvasSize().w}px`,height:"1px",top:n+"px"}},X2Y2VerticalLineStyle(){const n=this.axes.x2y2.coordIsFilled?this.axes.x2y2.coord.xPx*this.canvas.scale:this.canvas.scaledCursor.xPx;return{...La,width:"1px",height:`${this.getImageCanvasSize().h}px`,top:"0",bottom:"0",left:n+"px"}}}}),gx={key:0,class:"axes-guide"};function mx(n,e,t,s,o,r){return n.isActive?(m.openBlock(),m.createElementBlock("div",gx,[n.isX1Y1LineVisible?(m.openBlock(),m.createElementBlock("div",{key:0,style:m.normalizeStyle(n.X1Y1HorizontalLineStyle)},null,4)):m.createCommentVNode("",!0),n.isX1Y1LineVisible?(m.openBlock(),m.createElementBlock("div",{key:1,style:m.normalizeStyle(n.X1Y1VerticalLineStyle)},null,4)):m.createCommentVNode("",!0),n.isX2Y2LineVisible?(m.openBlock(),m.createElementBlock("div",{key:2,style:m.normalizeStyle(n.X2Y2HorizontalLineStyle)},null,4)):m.createCommentVNode("",!0),n.isX2Y2LineVisible?(m.openBlock(),m.createElementBlock("div",{key:3,style:m.normalizeStyle(n.X2Y2VerticalLineStyle)},null,4)):m.createCommentVNode("",!0)])):m.createCommentVNode("",!0)}const px=qe(fx,[["render",mx]]),Yp={position:"absolute",pointerEvents:"none",opacity:"0.8"},wx=m.defineComponent({computed:{...Re(ur,["axisCrossCursorPx","axisHalfSizePx"]),...Re(St,["canvas"]),...Re(jt,["axes"]),...Re(pn,["datasets"]),rightLabel(){switch(this.canvas.maskMode){case 0:return"Pen";case 1:return"Box";case 2:return"Eraser"}switch(this.canvas.manualMode){case 0:return"Add";case 1:return"Edit";case 2:return"Delete"}return""},bottomLabel(){var n,e;return((n=this.axes.nextAxis)==null?void 0:n.name)==="x2y2"?"x2'":(e=this.axes.nextAxis)!=null&&e.name.includes("x")?this.axes.nextAxis.name:""},leftLabel(){var n,e,t;return((n=this.axes.nextAxis)==null?void 0:n.name)==="x2y2"?"y2'":(e=this.axes.nextAxis)!=null&&e.name.includes("y")?this.axes.nextAxis.name:((t=this.axes.nextAxis)==null?void 0:t.name)==="x1"&&this.axes.pointMode===0?"y1":""},isCursorGuideLinesActive(){return!(this.canvas.manualMode===-1&&this.axes.y2.coordIsFilled||this.canvas.maskMode!==-1||this.canvas.manualMode!==-1&&this.canvas.manualMode!==0)},guideLineColor(){return this.canvas.manualMode===-1?"#00ff00":this.canvas.manualMode===0?"#ffcc00":"#00ff00"},horizontalGuideLineStyle(){return{...Yp,width:`${this.getImageCanvasSize().w}px`,height:"1px",top:`${this.canvas.scaledCursor.yPx}px`,backgroundColor:this.guideLineColor}},verticalGuideLineStyle(){return{...Yp,width:"1px",top:"0",height:`${this.getImageCanvasSize().h}px`,left:`${this.canvas.scaledCursor.xPx}px`,backgroundColor:this.guideLineColor}}},methods:{getImageCanvasSize(){const n=document.getElementById("imageCanvas");return n?{w:n.clientWidth,h:n.clientHeight}:{w:0,h:0}}}}),Cx={key:3};function yx(n,e,t,s,o,r){return m.openBlock(),m.createElementBlock("div",null,[n.axes.isAdjusting||n.datasets.activeDataset.plotsAreAdjusting?m.createCommentVNode("",!0):(m.openBlock(),m.createElementBlock("div",{key:0,style:m.normalizeStyle({position:"absolute",top:`${n.canvas.scaledCursor.yPx-n.axisCrossCursorPx}px`,left:`${n.canvas.scaledCursor.xPx+n.axisCrossCursorPx}px`,"pointer-events":"none"})},m.toDisplayString(n.rightLabel),5)),n.axes.isAdjusting?m.createCommentVNode("",!0):(m.openBlock(),m.createElementBlock("div",{key:1,style:m.normalizeStyle({position:"absolute",top:`${n.canvas.scaledCursor.yPx+n.axisCrossCursorPx/2}px`,left:`${n.canvas.scaledCursor.xPx-n.axisCrossCursorPx/2}px`,"pointer-events":"none"})},m.toDisplayString(n.bottomLabel),5)),n.axes.isAdjusting?m.createCommentVNode("",!0):(m.openBlock(),m.createElementBlock("div",{key:2,style:m.normalizeStyle({position:"absolute",top:`${n.canvas.scaledCursor.yPx-n.axisCrossCursorPx}px`,left:`${n.canvas.scaledCursor.xPx-n.axisCrossCursorPx*2}px`,"pointer-events":"none"})},m.toDisplayString(n.leftLabel),5)),n.isCursorGuideLinesActive?(m.openBlock(),m.createElementBlock("div",Cx,[m.createElementVNode("div",{style:m.normalizeStyle(n.horizontalGuideLineStyle)},null,4),m.createElementVNode("div",{style:m.normalizeStyle(n.verticalGuideLineStyle)},null,4)])):m.createCommentVNode("",!0)])}const Sx=qe(wx,[["render",yx]]),vx=m.defineComponent({computed:{...Re(jt,["axes"]),...Re(pn,["datasets"])},methods:{...wt(pn,["clearPlots","clearActivePlots"]),...wt(jt,["clearAxesCoords","clearXAxisCoords","clearYAxisCoords"]),...wt(St,["setManualMode"]),clearAxes(){this.clearAxesCoords(),this.setManualMode(-1)},clearXAxis(){this.clearXAxisCoords(),this.setManualMode(-1)},clearYAxis(){this.clearAxesCoords(),this.setManualMode(-1)}}}),bx={class:"mt-2"};function Rx(n,e,t,s,o,r){const a=m.resolveComponent("v-btn");return m.openBlock(),m.createElementBlock("div",bx,[m.createVNode(a,{class:"ml-2",size:"small",disabled:!n.axes.hasAtLeastOneAxis,onClick:n.clearAxes},{default:m.withCtx(()=>[m.createTextVNode(" Clear Axes")]),_:1},8,["disabled","onClick"]),m.createVNode(a,{size:"small",class:"ml-2",disabled:n.datasets.activeDataset.plots.length===0,onClick:n.clearPlots},{default:m.withCtx(()=>[m.createTextVNode("Clear Points")]),_:1},8,["disabled","onClick"]),m.createVNode(a,{size:"small",class:"ml-2",disabled:n.datasets.activeDataset.plots.length===0||!n.datasets.activeDataset.nextPlotId,onClick:n.clearActivePlots},{default:m.withCtx(()=>[m.createTextVNode("Clear Active Point")]),_:1},8,["disabled","onClick"])])}const Ex=qe(vx,[["render",Rx]]),xx=m.defineComponent({computed:{...Re(St,["canvas"]),showCanvasScale(){return Math.trunc(this.canvas.scale*100)+"%"}},methods:{...wt(St,["scaleUp","scaleDown","resizeCanvasToOriginal","drawFitSizeImage"])}}),Tx={class:"d-flex justify-end"},Mx=m.createElementVNode("div",null,null,-1),_x={class:"ml-2"},Ix={class:"ma-1"};function Ox(n,e,t,s,o,r){const a=m.resolveComponent("v-icon"),l=m.resolveComponent("v-btn");return m.openBlock(),m.createElementBlock("div",Tx,[Mx,m.createElementVNode("div",_x,[m.createVNode(l,{size:"small",onClick:n.scaleDown},{default:m.withCtx(()=>[m.createVNode(a,null,{default:m.withCtx(()=>[m.createTextVNode("mdi-minus")]),_:1})]),_:1},8,["onClick"]),m.createVNode(l,{size:"small",class:"ml-2",onClick:n.scaleUp},{default:m.withCtx(()=>[m.createVNode(a,null,{default:m.withCtx(()=>[m.createTextVNode("mdi-plus")]),_:1})]),_:1},8,["onClick"]),m.createVNode(l,{size:"small",class:"ml-2",onClick:n.resizeCanvasToOriginal},{default:m.withCtx(()=>[m.createTextVNode("100%")]),_:1},8,["onClick"]),m.createVNode(l,{size:"small",class:"ml-2",onClick:n.drawFitSizeImage},{default:m.withCtx(()=>[m.createTextVNode("Fit")]),_:1},8,["onClick"])]),m.createElementVNode("span",Ix,m.toDisplayString(n.showCanvasScale),1)])}const Ax=qe(xx,[["render",Ox]]),fr=1,Px=m.defineComponent({components:{CanvasAxes:dx,CanvasPlots:ix,CanvasCursor:Sx,CanvasAxesGuide:px},props:{imagePath:String},beforeDestroy(){document.removeEventListener("keydown",this.keyDownHandler)},computed:{...Re(St,["canvas"]),...Re(jt,["axes"]),...Re(pn,["datasets"])},async mounted(){if(document.addEventListener("keydown",this.keyDownHandler.bind(this)),!!this.imagePath)try{await this.canvas.initializeImageElement(),this.drawFitSizeImage(),this.setUploadImageUrl(this.imagePath),this.setSwatches(this.canvas.colorSwatches)}finally{}},methods:{...wt(pn,["addPlot","moveActivePlot","clearActivePlots","inactivatePlots"]),...wt(St,["mouseMoveOnCanvas","setCanvasCursor","drawFitSizeImage","setUploadImageUrl","setManualMode"]),...wt(jt,["addAxisCoord","inactivateAxis","moveActiveAxis"]),...wt(Co,["setSwatches"]),plot(n){if(this.canvas.isDrawingMask)return;const e=n.target,t=e.className==="canvas-plot";switch(this.canvas.manualMode){case 0:this.addPlot({xPx:t?(n.offsetX+parseFloat(e.style.left)-fr)/this.canvas.scale:(n.offsetX-fr)/this.canvas.scale,yPx:t?(n.offsetY+parseFloat(e.style.top))/this.canvas.scale:n.offsetY/this.canvas.scale}),this.inactivateAxis();return;case 1:return;case 2:return}if(!t&&this.axes.nextAxis){this.addAxisCoord({xPx:(n.offsetX-fr)/this.canvas.scale,yPx:n.offsetY/this.canvas.scale}),this.inactivatePlots(),this.axes.nextAxis||(this.canvas.manualMode=0);return}},mouseDrag(n){this.mouseMoveOnCanvas(n)},mouseMove(n){const e=n.target,t=n.offsetX-fr+parseFloat(e.style.left),s=n.offsetY+parseFloat(e.style.top);this.axes.isAdjusting=!1,this.datasets.activeDataset.plotsAreAdjusting=!1,this.setCanvasCursor({xPx:t/this.canvas.scale,yPx:s/this.canvas.scale}),n.buttons===1&&this.mouseDrag({xPx:t,yPx:s})},mouseDown(n){const e=n.target,t=n.offsetX-fr+parseFloat(e.style.left),s=n.offsetY+parseFloat(e.style.top);this.canvas.maskMode===1&&this.canvas.mouseDownForBox(t,s)},mouseUp(){this.canvas.maskMode===1&&this.canvas.mouseUpForBox()},keyDownHandler(n){const e=n.target;if(e.hasAttribute("contentEditable"))return;const t=e.nodeName;if(t==="INPUT"||t==="TEXTAREA")return;const s=["ArrowUp","ArrowRight","ArrowDown","ArrowLeft","Backspace","Delete","a","e","d"],o=n.key;if(!s.includes(o))return;switch(n.preventDefault(),o){case"a":this.setManualMode(0);return;case"e":this.setManualMode(1);return;case"d":this.setManualMode(2);return}this.datasets.activeDataset.hasActive()&&(o==="Backspace"||o==="Delete")&&this.clearActivePlots();const r=n.shiftKey,a={direction:this.getDirectionFromKey(o),distancePx:r?10:1};this.axes.activeAxis&&this.axes.activeAxis.coord&&(this.moveActiveAxis(a),this.setCanvasCursor(this.axes.activeAxis.coord)),this.datasets.activeDataset.plotsAreActive&&(this.moveActivePlot(a),this.setCanvasCursor(this.datasets.activeDataset.plots.filter(l=>this.datasets.activeDataset.activePlotIds.includes(l.id))[0]))},getDirectionFromKey(n){switch(n){case"ArrowUp":return"up";case"ArrowDown":return"down";case"ArrowRight":return"right";case"ArrowLeft":return"left";default:throw new Error(`undefined direction: ${n}`)}}}}),_3="",_h=n=>(m.pushScopeId("data-v-9ce439db"),n=n(),m.popScopeId(),n),Dx=_h(()=>m.createElementVNode("canvas",{id:"imageCanvas"},null,-1)),Nx=_h(()=>m.createElementVNode("canvas",{id:"tempMaskCanvas",style:{position:"absolute",top:0,left:0,opacity:.5}},null,-1)),Hx=_h(()=>m.createElementVNode("canvas",{style:{position:"absolute",top:0,left:0,opacity:.5},id:"maskCanvas"},null,-1));function kx(n,e,t,s,o,r){const a=m.resolveComponent("canvas-axes-guide"),l=m.resolveComponent("canvas-axes"),c=m.resolveComponent("canvas-plots"),h=m.resolveComponent("canvas-cursor");return m.openBlock(),m.createElementBlock("div",{id:"canvasWrapper",class:"c__canvas-wrapper",onClick:e[0]||(e[0]=(...u)=>n.plot&&n.plot(...u)),onMousemove:e[1]||(e[1]=(...u)=>n.mouseMove&&n.mouseMove(...u)),onMousedown:e[2]||(e[2]=(...u)=>n.mouseDown&&n.mouseDown(...u)),onMouseup:e[3]||(e[3]=(...u)=>n.mouseUp&&n.mouseUp(...u))},[Dx,Nx,Hx,m.createVNode(a),m.createVNode(l),m.createVNode(c),m.createVNode(h)],32)}const Lx=qe(Px,[["render",kx],["__scopeId","data-v-9ce439db"]]),Vx=m.defineComponent({computed:{...Re(jt,["axes"]),errorMessage(){if(this.axes.xIsLog){if(this.x1==="0"||this.x2==="0")return"x1 or x2 should not be 0"}else if(this.x1===this.x2)return"x1 and x2 should not be same value";if(this.axes.yIsLog){if(this.y1==="0"||this.y2==="0")return"y1 or y2 should not be 0"}else if(this.y1===this.y2)return"y1 and y2 should not be same value";return""}},data(){return{x1:"0",x2:"1",y1:"0",y2:"1",xIsLog:!1,yIsLog:!1}},methods:{...wt(jt,["setX1Value","setX2Value","setY1Value","setY2Value","setXIsLog","setYIsLog"]),multiplyByTenX1(){this.x1=String(this.multiplyByTen(parseFloat(this.x1)))},divideByTenX1(){this.x1=String(this.divideByTen(parseFloat(this.x1)))},multiplyByTenX2(){this.x2=String(this.multiplyByTen(parseFloat(this.x2)))},divideByTenX2(){this.x2=String(this.divideByTen(parseFloat(this.x2)))},multiplyByTenY1(){this.y1=String(this.multiplyByTen(parseFloat(this.y1)))},divideByTenY1(){this.y1=String(this.divideByTen(parseFloat(this.y1)))},multiplyByTenY2(){this.y2=String(this.multiplyByTen(parseFloat(this.y2)))},divideByTenY2(){this.y2=String(this.divideByTen(parseFloat(this.y2)))},multiplyByTen(n){return n===0?1:(n*10).toPrecision(1)},divideByTen(n){return n===0?.1:(n*.1).toPrecision(1)}},mounted(){this.x1=String(this.axes.x1.value),this.x2=String(this.axes.x2.value),this.y1=String(this.axes.y1.value),this.y2=String(this.axes.y2.value),this.xIsLog=this.axes.xIsLog,this.yIsLog=this.axes.yIsLog},watch:{xIsLog(n){this.setXIsLog(n)},yIsLog(n){this.setYIsLog(n)},x1(n){this.setX1Value(parseFloat(n))},x2(n){this.setX2Value(parseFloat(n))},y1(n){this.setY1Value(parseFloat(n))},y2(n){this.setY2Value(parseFloat(n))}}}),I3="",li=n=>(m.pushScopeId("data-v-d02d45ba"),n=n(),m.popScopeId(),n),$x=li(()=>m.createElementVNode("h4",null,"XY Axes",-1)),Fx={class:"c__axes-settings__table"},Bx=li(()=>m.createElementVNode("td",{class:"pl-0 pr-1"},"X",-1)),Wx={class:"pl-0 pr-1"},Ux={key:0,class:"c__axes-settings__log-adjuster"},zx={class:"pl-0 pr-1"},Yx={key:0,class:"c__axes-settings__log-adjuster"},Gx=li(()=>m.createElementVNode("span",{class:"c__axes-settings__hint"},"Log",-1)),jx=li(()=>m.createElementVNode("td",{class:"pl-0 pr-1"},"Y",-1)),Kx={class:"pl-0 pr-1"},Xx={key:0,class:"c__axes-settings__log-adjuster"},qx={class:"pl-0 pr-1"},Zx={key:0,class:"c__axes-settings__log-adjuster"},Qx=li(()=>m.createElementVNode("span",{class:"c__axes-settings__hint"},"Log",-1)),Jx={class:"mb-5"},eT=li(()=>m.createElementVNode("h5",{class:"c__axes-settings__point-mode__label"}," Define the axes by the coordinates of: ",-1)),tT={class:"text-red"};function nT(n,e,t,s,o,r){const a=m.resolveComponent("v-text-field"),l=m.resolveComponent("v-checkbox"),c=m.resolveComponent("v-radio"),h=m.resolveComponent("v-radio-group");return m.openBlock(),m.createElementBlock("div",null,[$x,m.createElementVNode("table",Fx,[m.createElementVNode("tbody",null,[m.createElementVNode("tr",null,[Bx,m.createElementVNode("td",Wx,[m.createVNode(a,{modelValue:n.x1,"onUpdate:modelValue":e[2]||(e[2]=u=>n.x1=u),id:"x1-value",type:"number","hide-details":"",label:"x1",density:"compact"},{default:m.withCtx(()=>[n.xIsLog?(m.openBlock(),m.createElementBlock("div",Ux,[m.createElementVNode("button",{size:"x-small",onClick:e[0]||(e[0]=(...u)=>n.multiplyByTenX1&&n.multiplyByTenX1(...u)),id:"multiply-by-ten-x1",icon:""}," x10 "),m.createElementVNode("button",{id:"divide-by-ten-x1",size:"x-small",onClick:e[1]||(e[1]=(...u)=>n.divideByTenX1&&n.divideByTenX1(...u)),icon:""}," /10 ")])):m.createCommentVNode("",!0)]),_:1},8,["modelValue"])]),m.createElementVNode("td",zx,[m.createVNode(a,{modelValue:n.x2,"onUpdate:modelValue":e[5]||(e[5]=u=>n.x2=u),id:"x2-value",type:"number","hide-details":"",label:"x2",density:"compact"},{default:m.withCtx(()=>[n.xIsLog?(m.openBlock(),m.createElementBlock("div",Yx,[m.createElementVNode("button",{id:"multiply-by-ten-x2",size:"x-small",onClick:e[3]||(e[3]=(...u)=>n.multiplyByTenX2&&n.multiplyByTenX2(...u)),icon:""}," x10 "),m.createElementVNode("button",{id:"divide-by-ten-x2",size:"x-small",onClick:e[4]||(e[4]=(...u)=>n.divideByTenX2&&n.divideByTenX2(...u)),icon:""}," /10 ")])):m.createCommentVNode("",!0)]),_:1},8,["modelValue"])]),m.createElementVNode("td",null,[m.createVNode(l,{color:"primary",modelValue:n.xIsLog,"onUpdate:modelValue":e[6]||(e[6]=u=>n.xIsLog=u),id:"x-is-log","hide-details":"",density:"compact"},null,8,["modelValue"]),Gx])]),m.createElementVNode("tr",null,[jx,m.createElementVNode("td",Kx,[m.createVNode(a,{modelValue:n.y1,"onUpdate:modelValue":e[9]||(e[9]=u=>n.y1=u),id:"y1-value",type:"number","hide-details":"",label:"y1",density:"compact"},{default:m.withCtx(()=>[n.yIsLog?(m.openBlock(),m.createElementBlock("div",Xx,[m.createElementVNode("button",{id:"multiply-by-ten-y1",size:"x-small",onClick:e[7]||(e[7]=(...u)=>n.multiplyByTenY1&&n.multiplyByTenY1(...u)),icon:""}," x10 "),m.createElementVNode("button",{id:"divide-by-ten-y1",size:"x-small",onClick:e[8]||(e[8]=(...u)=>n.divideByTenY1&&n.divideByTenY1(...u)),icon:""}," /10 ")])):m.createCommentVNode("",!0)]),_:1},8,["modelValue"])]),m.createElementVNode("td",qx,[m.createVNode(a,{modelValue:n.y2,"onUpdate:modelValue":e[12]||(e[12]=u=>n.y2=u),id:"y2-value",type:"number","hide-details":"",label:"y2",density:"compact"},{default:m.withCtx(()=>[n.yIsLog?(m.openBlock(),m.createElementBlock("div",Zx,[m.createElementVNode("button",{id:"multiply-by-ten-y2",size:"x-small",onClick:e[10]||(e[10]=(...u)=>n.multiplyByTenY2&&n.multiplyByTenY2(...u)),icon:""}," x10 "),m.createElementVNode("button",{id:"divide-by-ten-y2",size:"x-small",onClick:e[11]||(e[11]=(...u)=>n.divideByTenY2&&n.divideByTenY2(...u)),icon:""}," /10 ")])):m.createCommentVNode("",!0)]),_:1},8,["modelValue"])]),m.createElementVNode("td",null,[m.createVNode(l,{color:"primary",modelValue:n.yIsLog,"onUpdate:modelValue":e[13]||(e[13]=u=>n.yIsLog=u),id:"y-is-log",density:"compact","hide-details":""},null,8,["modelValue"]),Qx])])])]),m.createElementVNode("div",Jx,[eT,m.createVNode(h,{row:"",modelValue:n.axes.pointMode,"onUpdate:modelValue":e[14]||(e[14]=u=>n.axes.pointMode=u),modelModifiers:{number:!0},inline:"",color:"primary","hide-details":""},{default:m.withCtx(()=>[m.createVNode(c,{label:"2 Points",value:0}),m.createVNode(c,{label:"4 Points",value:1})]),_:1},8,["modelValue"]),n.axes.pointMode===1?(m.openBlock(),m.createBlock(l,{key:0,modelValue:n.axes.considerGraphTilt,"onUpdate:modelValue":e[15]||(e[15]=u=>n.axes.considerGraphTilt=u),label:"Consider graph tilt",density:"compact",color:"primary"},null,8,["modelValue"])):m.createCommentVNode("",!0)]),m.createElementVNode("p",tT,m.toDisplayString(n.errorMessage),1)])}const sT=qe(Vx,[["render",nT],["__scopeId","data-v-d02d45ba"]]),oT=m.defineComponent({computed:{...Re(Mh,["symbolExtractByArea"])},methods:{...wt(Mh,["setMinDiameterPx","setMaxDiameterPx"]),inputMin(n){this.setMinDiameterPx(parseInt(n))},inputMax(n){this.setMaxDiameterPx(parseInt(n))}}});function iT(n,e,t,s,o,r){const a=m.resolveComponent("v-text-field"),l=m.resolveComponent("v-col"),c=m.resolveComponent("v-row");return m.openBlock(),m.createBlock(c,{class:"ma-0"},{default:m.withCtx(()=>[m.createVNode(l,{class:"pa-0"},{default:m.withCtx(()=>[m.createVNode(a,{"model-value":n.symbolExtractByArea.minDiameterPx,"onUpdate:modelValue":n.inputMin,label:"Min. Diameter (px)",type:"number",class:"ma-0",density:"compact"},null,8,["model-value","onUpdate:modelValue"])]),_:1}),m.createVNode(l,{class:"pa-0"},{default:m.withCtx(()=>[m.createVNode(a,{"model-value":n.symbolExtractByArea.maxDiameterPx,"onUpdate:modelValue":n.inputMax,label:"Max. Diameter (px)",type:"number",class:"ma-0",density:"compact"},null,8,["model-value","onUpdate:modelValue"])]),_:1})]),_:1})}const rT=qe(oT,[["render",iT]]),aT=m.defineComponent({computed:{...Re(Th,["lineExtract"])},methods:{...wt(Th,["setDyPx","setDxPx"]),inputDxDyPx(n){this.setDxPx(parseInt(n)),this.setDyPx(parseInt(n))}}});function lT(n,e,t,s,o,r){const a=m.resolveComponent("v-text-field"),l=m.resolveComponent("v-col"),c=m.resolveComponent("v-row");return m.openBlock(),m.createBlock(c,{class:"ma-0"},{default:m.withCtx(()=>[m.createVNode(l,{class:"pa-0"},{default:m.withCtx(()=>[m.createVNode(a,{"model-value":n.lineExtract.dxPx,"onUpdate:modelValue":n.inputDxDyPx,label:"Î”X (px)",type:"number",class:"ma-0",id:"line-extract-dx",density:"compact"},null,8,["model-value","onUpdate:modelValue"])]),_:1}),m.createVNode(l,{class:"pa-0"},{default:m.withCtx(()=>[m.createVNode(a,{"model-value":n.lineExtract.dyPx,"onUpdate:modelValue":n.inputDxDyPx,label:"Î”Y (px)",type:"number",class:"ma-0",id:"line-extract-dy",density:"compact"},null,8,["model-value","onUpdate:modelValue"])]),_:1})]),_:1})}const cT=qe(aT,[["render",lT]]),hT=m.defineComponent({computed:{...Re(St,["canvas"])},methods:{...wt(St,["setPenToolSizePx","setMaskMode","setEraserSizePx"]),onChangePenToolSizePx(n){this.setPenToolSizePx(Number(n.target.value))},onChangeEraserSizePx(n){this.setEraserSizePx(Number(n.target.value))},change(n){if(n===void 0){this.setMaskMode(-1);return}this.setMaskMode(n)},clearMask(){this.canvas.clearMask(),this.canvas.maskMode===2&&(this.canvas.maskMode=-1)}}}),uT={class:"mt-3 mb-5"},dT=m.createElementVNode("h5",{class:"mb-2"},"Selection Area",-1);function fT(n,e,t,s,o,r){const a=m.resolveComponent("v-btn"),l=m.resolveComponent("v-btn-toggle"),c=m.resolveComponent("v-text-field");return m.openBlock(),m.createElementBlock("div",uT,[dT,m.createVNode(l,{"model-value":n.canvas.maskMode,"onUpdate:modelValue":n.change,density:"compact",class:"mb-2",divided:"",border:!0},{default:m.withCtx(()=>[m.createVNode(a,{size:"small",color:"primary"},{default:m.withCtx(()=>[m.createTextVNode(" Pen ")]),_:1}),m.createVNode(a,{size:"small",color:"primary"},{default:m.withCtx(()=>[m.createTextVNode(" Box ")]),_:1}),m.createVNode(a,{size:"small",color:"primary"},{default:m.withCtx(()=>[m.createTextVNode(" Eraser ")]),_:1})]),_:1},8,["model-value","onUpdate:modelValue"]),m.createVNode(a,{size:"small",class:"ml-1",disabled:!n.canvas.isDrawnMask,onClick:n.clearMask},{default:m.withCtx(()=>[m.createTextVNode(" Clear ")]),_:1},8,["disabled","onClick"]),n.canvas.maskMode===0?(m.openBlock(),m.createBlock(c,{key:0,"model-value":n.canvas.penToolSizePx,onChange:n.onChangePenToolSizePx,type:"number","hide-details":"",label:"Pen Size",density:"compact"},null,8,["model-value","onChange"])):m.createCommentVNode("",!0),n.canvas.maskMode===2?(m.openBlock(),m.createBlock(c,{key:1,"model-value":n.canvas.eraserSizePx,onChange:n.onChangeEraserSizePx,type:"number","hide-details":"",label:"Eraser Size (px)",density:"compact"},null,8,["model-value","onChange"])):m.createCommentVNode("",!0)])}const gT=qe(hT,[["render",fT]]),mT=m.defineComponent({data(){return{colorDistancePctErrorMsg:""}},computed:{...Re(Co,["extractor"])},methods:{...wt(Co,["setColorPicker","setColorDistancePct"]),inputColorPicker(n){console.log(n),this.setColorPicker(n.target.value)},inputColorDistancePct(n){const e=parseInt(n);this.colorDistancePctErrorMsg="",e<1&&(this.colorDistancePctErrorMsg="The Color Difference(%) is supposed to be larger than 1%."),100<=e&&(this.colorDistancePctErrorMsg='The Color Difference(%) is supposed to be size="small"er than 100%'),this.setColorDistancePct(e)}}}),pT={class:"mt-3 mb-5"},wT=m.createElementVNode("h5",{class:"mb-2"},"Extracted Color",-1),CT={class:"d-flex"},yT=["value"];function ST(n,e,t,s,o,r){const a=m.resolveComponent("v-icon"),l=m.resolveComponent("v-col"),c=m.resolveComponent("v-text-field"),h=m.resolveComponent("v-row"),u=m.resolveComponent("v-color-picker");return m.openBlock(),m.createElementBlock("div",pT,[wT,m.createVNode(h,{class:"mt-1"},{default:m.withCtx(()=>[m.createVNode(l,{cols:"4"},{default:m.withCtx(()=>[m.createElementVNode("label",CT,[m.createElementVNode("input",{type:"color",value:n.extractor.colorPicker,onInput:e[0]||(e[0]=(...f)=>n.inputColorPicker&&n.inputColorPicker(...f))},null,40,yT),m.createVNode(a,{size:"small"},{default:m.withCtx(()=>[m.createTextVNode("mdi-palette")]),_:1})])]),_:1}),m.createVNode(l,{cols:"8"},{default:m.withCtx(()=>[m.createVNode(c,{"model-value":n.extractor.colorDistancePct,"onUpdate:modelValue":n.inputColorDistancePct,label:"Color Diff. (%)",type:"number",error:n.colorDistancePctErrorMsg.length>0,"error-messages":n.colorDistancePctErrorMsg,density:"compact"},null,8,["model-value","onUpdate:modelValue","error","error-messages"])]),_:1})]),_:1}),m.createVNode(u,{"model-value":n.extractor.colorPicker,"onUpdate:modelValue":n.setColorPicker,"hide-canvas":"","hide-inputs":"","show-swatches":"","hide-sliders":"",swatches:n.extractor.swatches,elevation:0},null,8,["model-value","onUpdate:modelValue","swatches"])])}const vT=qe(mT,[["render",ST]]),bT=m.defineComponent({components:{SymbolExtractSettings:rT,LineExtractSettings:cT,MaskSettings:gT,ColorSettings:vT},data(){return{isExtracting:!1}},computed:{...Re(Co,["extractor"]),...Re(St,["canvas"])},props:{initialExtractorStrategy:{type:String,required:!1}},mounted(){switch(this.initialExtractorStrategy){case"Symbol Extract":this.setStrategy(dr.instance);break;case"Line Extract":this.setStrategy(ai.instance)}},methods:{...wt(Co,["setStrategy"]),...wt(jt,["inactivateAxis"]),...wt(pn,["clearPlots","setPlots","sortPlots","inactivatePlots"]),...wt(St,["setManualMode"]),changeManualMode(n){if(this.inactivatePlots(),n===void 0){this.setManualMode(-1);return}this.setManualMode(n)},setExtractStrategy(n){switch(n){case"Symbol Extract":this.setStrategy(dr.instance);break;case"Line Extract":this.setStrategy(ai.instance)}},async extractPlots(){this.isExtracting=!0,this.inactivateAxis(),this.clearPlots();try{this.setPlots(this.extractor.execute(this.canvas)),this.sortPlots()}catch(n){console.error("failed to extractPlots",{cause:n})}finally{this.isExtracting=!1}}}}),RT=m.createElementVNode("h4",{class:"mb-2"},"Manual Extraction",-1),ET=m.createElementVNode("h4",{class:"mb-2"},"Automatic Extraction",-1),xT={key:0},TT={key:1};function MT(n,e,t,s,o,r){const a=m.resolveComponent("v-btn"),l=m.resolveComponent("v-btn-toggle"),c=m.resolveComponent("v-select"),h=m.resolveComponent("symbol-extract-settings"),u=m.resolveComponent("line-extract-settings"),f=m.resolveComponent("mask-settings"),g=m.resolveComponent("color-settings");return m.openBlock(),m.createElementBlock("div",null,[RT,m.createVNode(l,{"model-value":n.canvas.manualMode,"onUpdate:modelValue":n.changeManualMode,density:"compact",class:"mb-4",divided:"",border:!0},{default:m.withCtx(()=>[m.createVNode(a,{size:"small",color:"primary"},{default:m.withCtx(()=>[m.createTextVNode(" Add (A) ")]),_:1}),m.createVNode(a,{size:"small",color:"primary"},{default:m.withCtx(()=>[m.createTextVNode(" Edit (E) ")]),_:1}),m.createVNode(a,{size:"small",color:"primary"},{default:m.withCtx(()=>[m.createTextVNode(" Delete (D) ")]),_:1})]),_:1},8,["model-value","onUpdate:modelValue"]),ET,m.createVNode(c,{"onUpdate:modelValue":n.setExtractStrategy,"model-value":n.extractor.strategy.name,items:n.extractor.strategies,label:"Select Algorithm"},null,8,["onUpdate:modelValue","model-value","items"]),n.extractor.strategy.name==="Symbol Extract"?(m.openBlock(),m.createElementBlock("div",xT,[m.createVNode(h)])):n.extractor.strategy.name==="Line Extract"?(m.openBlock(),m.createElementBlock("div",TT,[m.createVNode(u)])):m.createCommentVNode("",!0),m.createVNode(f),m.createVNode(g),m.createVNode(a,{loading:n.isExtracting,onClick:n.extractPlots,color:"primary",size:"small"},{default:m.withCtx(()=>[m.createTextVNode("Run")]),_:1},8,["loading","onClick"])])}const _T=qe(bT,[["render",MT]]),IT=m.defineComponent({computed:{...Re(St,["canvas"])},data(){return{}},mounted(){document.addEventListener("paste",this.pasteHandler.bind(this))},beforeDestroy(){document.removeEventListener("paste",this.pasteHandler)},methods:{...wt(St,["drawFitSizeImage","setUploadImageUrl"]),...wt(jt,["clearAxesCoords"]),...wt(pn,["clearPlots"]),...wt(Co,["setSwatches"]),async uploadImage(n){try{const e=await this.readFile(n);if(typeof e.result!="string")throw new Error("file is not string type");const t=await this.loadImage(e.result);this.canvas.changeImage(t),this.drawFitSizeImage(),this.setSwatches(this.canvas.colorSwatches),this.setUploadImageUrl(e.result),this.clearAxesCoords(),this.clearPlots()}finally{}},readFile(n){return new Promise((e,t)=>{const s=new FileReader;s.readAsDataURL(n),s.addEventListener("load",()=>e(s)),s.addEventListener("error",o=>t(o))})},loadImage(n){return new Promise((e,t)=>{const s=new Image;s.onload=()=>e(s),s.onerror=o=>t(o),s.src=n})},pasteHandler(n){const e=n.target.nodeName;if(e==="INPUT"||e==="TEXTAREA"||!n.clipboardData||!n.clipboardData.items)return;const t=n.clipboardData.items;if(t[0].type.indexOf("image")===-1)return;const s=t[0].getAsFile();s&&this.uploadImage(s)}}});function OT(n,e,t,s,o,r){const a=m.resolveComponent("v-file-input");return m.openBlock(),m.createBlock(a,{accept:"image/*",onChange:n.uploadImage,clearable:!1,label:"choose an image file","hide-details":"",class:"mb-5"},null,8,["onChange"])}const AT=qe(IT,[["render",OT]]),PT=m.defineComponent({components:{},data(){return{sortKey:"as added",sortKeys:["as added","x","y"],sortOrder:"ascending",sortOrders:["ascending","descending"]}},computed:{...Re(pn,["datasets"]),...Re(St,["canvas"])},props:{exportBtnText:{type:String,required:!1},exportBtnClick:{type:Function,required:!1}},methods:{...wt(pn,["addDataset","setActiveDataset","popDataset"]),activateDataset(n){this.setActiveDataset(n),this.canvas.clearMask(),this.canvas.maskMode=-1}}}),DT={class:"align-self-center"};function NT(n,e,t,s,o,r){const a=m.resolveComponent("v-icon"),l=m.resolveComponent("v-btn"),c=m.resolveComponent("v-text-field"),h=m.resolveComponent("v-col"),u=m.resolveComponent("v-row"),f=m.resolveComponent("v-list-item"),g=m.resolveComponent("v-list");return m.openBlock(),m.createElementBlock("div",null,[m.createElementVNode("h4",null,[m.createTextVNode(" Datasets "),m.createVNode(l,{onClick:n.addDataset,size:"x-small",class:"ml-2"},{default:m.withCtx(()=>[m.createVNode(a,null,{default:m.withCtx(()=>[m.createTextVNode("mdi-plus")]),_:1})]),_:1},8,["onClick"]),m.createVNode(l,{size:"x-small",onClick:n.popDataset,disabled:n.datasets.datasets.length===1,class:"ml-2"},{default:m.withCtx(()=>[m.createVNode(a,null,{default:m.withCtx(()=>[m.createTextVNode("mdi-minus")]),_:1})]),_:1},8,["onClick","disabled"])]),m.createVNode(g,{density:"compact",height:"20vh",class:"overflow-y-auto mb-5 mt-1 pa-0",style:{outline:"solid 1px gray"}},{default:m.withCtx(()=>[(m.openBlock(!0),m.createElementBlock(m.Fragment,null,m.renderList(n.datasets.datasets,p=>(m.openBlock(),m.createBlock(f,{key:p.id,class:m.normalizeClass(["pl-2",p.id===n.datasets.activeDataset.id&&"blue lighten-4"]),link:"",onClick:C=>n.activateDataset(p.id)},{default:m.withCtx(()=>[m.createVNode(u,null,{default:m.withCtx(()=>[m.createVNode(h,{cols:"10"},{default:m.withCtx(()=>[m.createVNode(c,{modelValue:p.name,"onUpdate:modelValue":C=>p.name=C,placeholder:"dataset "+p.id,"hide-details":"",density:"compact",class:"mt-0 pt-0"},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1024),m.createVNode(h,{cols:"2",class:m.normalizeClass(["pa-0 d-flex align-items-center",`dataset-count-${p.id}`])},{default:m.withCtx(()=>[m.createElementVNode("span",DT,m.toDisplayString(p.plots.length),1)]),_:2},1032,["class"])]),_:2},1024)]),_:2},1032,["onClick","class"]))),128))]),_:1})])}const HT=qe(PT,[["render",NT]]),Gp="0.16.1",kT=Object.freeze({base:"#f44336",lighten5:"#ffebee",lighten4:"#ffcdd2",lighten3:"#ef9a9a",lighten2:"#e57373",lighten1:"#ef5350",darken1:"#e53935",darken2:"#d32f2f",darken3:"#c62828",darken4:"#b71c1c",accent1:"#ff8a80",accent2:"#ff5252",accent3:"#ff1744",accent4:"#d50000"}),LT=Object.freeze({base:"#e91e63",lighten5:"#fce4ec",lighten4:"#f8bbd0",lighten3:"#f48fb1",lighten2:"#f06292",lighten1:"#ec407a",darken1:"#d81b60",darken2:"#c2185b",darken3:"#ad1457",darken4:"#880e4f",accent1:"#ff80ab",accent2:"#ff4081",accent3:"#f50057",accent4:"#c51162"}),VT=Object.freeze({base:"#9c27b0",lighten5:"#f3e5f5",lighten4:"#e1bee7",lighten3:"#ce93d8",lighten2:"#ba68c8",lighten1:"#ab47bc",darken1:"#8e24aa",darken2:"#7b1fa2",darken3:"#6a1b9a",darken4:"#4a148c",accent1:"#ea80fc",accent2:"#e040fb",accent3:"#d500f9",accent4:"#aa00ff"}),$T=Object.freeze({base:"#673ab7",lighten5:"#ede7f6",lighten4:"#d1c4e9",lighten3:"#b39ddb",lighten2:"#9575cd",lighten1:"#7e57c2",darken1:"#5e35b1",darken2:"#512da8",darken3:"#4527a0",darken4:"#311b92",accent1:"#b388ff",accent2:"#7c4dff",accent3:"#651fff",accent4:"#6200ea"}),FT=Object.freeze({base:"#3f51b5",lighten5:"#e8eaf6",lighten4:"#c5cae9",lighten3:"#9fa8da",lighten2:"#7986cb",lighten1:"#5c6bc0",darken1:"#3949ab",darken2:"#303f9f",darken3:"#283593",darken4:"#1a237e",accent1:"#8c9eff",accent2:"#536dfe",accent3:"#3d5afe",accent4:"#304ffe"}),BT=Object.freeze({base:"#2196f3",lighten5:"#e3f2fd",lighten4:"#bbdefb",lighten3:"#90caf9",lighten2:"#64b5f6",lighten1:"#42a5f5",darken1:"#1e88e5",darken2:"#1976d2",darken3:"#1565c0",darken4:"#0d47a1",accent1:"#82b1ff",accent2:"#448aff",accent3:"#2979ff",accent4:"#2962ff"}),WT=Object.freeze({base:"#03a9f4",lighten5:"#e1f5fe",lighten4:"#b3e5fc",lighten3:"#81d4fa",lighten2:"#4fc3f7",lighten1:"#29b6f6",darken1:"#039be5",darken2:"#0288d1",darken3:"#0277bd",darken4:"#01579b",accent1:"#80d8ff",accent2:"#40c4ff",accent3:"#00b0ff",accent4:"#0091ea"}),UT=Object.freeze({base:"#00bcd4",lighten5:"#e0f7fa",lighten4:"#b2ebf2",lighten3:"#80deea",lighten2:"#4dd0e1",lighten1:"#26c6da",darken1:"#00acc1",darken2:"#0097a7",darken3:"#00838f",darken4:"#006064",accent1:"#84ffff",accent2:"#18ffff",accent3:"#00e5ff",accent4:"#00b8d4"}),zT=Object.freeze({base:"#009688",lighten5:"#e0f2f1",lighten4:"#b2dfdb",lighten3:"#80cbc4",lighten2:"#4db6ac",lighten1:"#26a69a",darken1:"#00897b",darken2:"#00796b",darken3:"#00695c",darken4:"#004d40",accent1:"#a7ffeb",accent2:"#64ffda",accent3:"#1de9b6",accent4:"#00bfa5"}),YT=Object.freeze({base:"#4caf50",lighten5:"#e8f5e9",lighten4:"#c8e6c9",lighten3:"#a5d6a7",lighten2:"#81c784",lighten1:"#66bb6a",darken1:"#43a047",darken2:"#388e3c",darken3:"#2e7d32",darken4:"#1b5e20",accent1:"#b9f6ca",accent2:"#69f0ae",accent3:"#00e676",accent4:"#00c853"}),GT=Object.freeze({base:"#8bc34a",lighten5:"#f1f8e9",lighten4:"#dcedc8",lighten3:"#c5e1a5",lighten2:"#aed581",lighten1:"#9ccc65",darken1:"#7cb342",darken2:"#689f38",darken3:"#558b2f",darken4:"#33691e",accent1:"#ccff90",accent2:"#b2ff59",accent3:"#76ff03",accent4:"#64dd17"}),jT=Object.freeze({base:"#cddc39",lighten5:"#f9fbe7",lighten4:"#f0f4c3",lighten3:"#e6ee9c",lighten2:"#dce775",lighten1:"#d4e157",darken1:"#c0ca33",darken2:"#afb42b",darken3:"#9e9d24",darken4:"#827717",accent1:"#f4ff81",accent2:"#eeff41",accent3:"#c6ff00",accent4:"#aeea00"}),KT=Object.freeze({base:"#ffeb3b",lighten5:"#fffde7",lighten4:"#fff9c4",lighten3:"#fff59d",lighten2:"#fff176",lighten1:"#ffee58",darken1:"#fdd835",darken2:"#fbc02d",darken3:"#f9a825",darken4:"#f57f17",accent1:"#ffff8d",accent2:"#ffff00",accent3:"#ffea00",accent4:"#ffd600"}),XT=Object.freeze({base:"#ffc107",lighten5:"#fff8e1",lighten4:"#ffecb3",lighten3:"#ffe082",lighten2:"#ffd54f",lighten1:"#ffca28",darken1:"#ffb300",darken2:"#ffa000",darken3:"#ff8f00",darken4:"#ff6f00",accent1:"#ffe57f",accent2:"#ffd740",accent3:"#ffc400",accent4:"#ffab00"}),qT=Object.freeze({base:"#ff9800",lighten5:"#fff3e0",lighten4:"#ffe0b2",lighten3:"#ffcc80",lighten2:"#ffb74d",lighten1:"#ffa726",darken1:"#fb8c00",darken2:"#f57c00",darken3:"#ef6c00",darken4:"#e65100",accent1:"#ffd180",accent2:"#ffab40",accent3:"#ff9100",accent4:"#ff6d00"}),ZT=Object.freeze({base:"#ff5722",lighten5:"#fbe9e7",lighten4:"#ffccbc",lighten3:"#ffab91",lighten2:"#ff8a65",lighten1:"#ff7043",darken1:"#f4511e",darken2:"#e64a19",darken3:"#d84315",darken4:"#bf360c",accent1:"#ff9e80",accent2:"#ff6e40",accent3:"#ff3d00",accent4:"#dd2c00"}),QT=Object.freeze({base:"#795548",lighten5:"#efebe9",lighten4:"#d7ccc8",lighten3:"#bcaaa4",lighten2:"#a1887f",lighten1:"#8d6e63",darken1:"#6d4c41",darken2:"#5d4037",darken3:"#4e342e",darken4:"#3e2723"}),JT=Object.freeze({base:"#607d8b",lighten5:"#eceff1",lighten4:"#cfd8dc",lighten3:"#b0bec5",lighten2:"#90a4ae",lighten1:"#78909c",darken1:"#546e7a",darken2:"#455a64",darken3:"#37474f",darken4:"#263238"}),eM=Object.freeze({base:"#9e9e9e",lighten5:"#fafafa",lighten4:"#f5f5f5",lighten3:"#eeeeee",lighten2:"#e0e0e0",lighten1:"#bdbdbd",darken1:"#757575",darken2:"#616161",darken3:"#424242",darken4:"#212121"}),tM=Object.freeze({black:"#000000",white:"#ffffff",transparent:"#ffffff00"}),nM=Object.freeze({red:kT,pink:LT,purple:VT,deepPurple:$T,indigo:FT,blue:BT,lightBlue:WT,cyan:UT,teal:zT,green:YT,lightGreen:GT,lime:jT,yellow:KT,amber:XT,orange:qT,deepOrange:ZT,brown:QT,blueGrey:JT,grey:eM,shades:tM});var Va=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function jp(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function sM(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var t=function s(){return this instanceof s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(s){var o=Object.getOwnPropertyDescriptor(n,s);Object.defineProperty(t,s,o.get?o:{enumerable:!0,get:function(){return n[s]}})}),t}var $a=function(n){return n&&n.Math===Math&&n},Kt=$a(typeof globalThis=="object"&&globalThis)||$a(typeof window=="object"&&window)||$a(typeof self=="object"&&self)||$a(typeof Va=="object"&&Va)||function(){return this}()||Va||Function("return this")(),Ih={},Mn=function(n){try{return!!n()}catch{return!0}},oM=Mn,qn=!oM(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),iM=Mn,Fa=!iM(function(){var n=(function(){}).bind();return typeof n!="function"||n.hasOwnProperty("prototype")}),rM=Fa,Ba=Function.prototype.call,Wa=rM?Ba.bind(Ba):function(){return Ba.apply(Ba,arguments)},Kp={},Xp={}.propertyIsEnumerable,qp=Object.getOwnPropertyDescriptor,aM=qp&&!Xp.call({1:2},1);Kp.f=aM?function(e){var t=qp(this,e);return!!t&&t.enumerable}:Xp;var Oh=function(n,e){return{enumerable:!(n&1),configurable:!(n&2),writable:!(n&4),value:e}},Zp=Fa,Qp=Function.prototype,Ah=Qp.call,lM=Zp&&Qp.bind.bind(Ah,Ah),nn=Zp?lM:function(n){return function(){return Ah.apply(n,arguments)}},Jp=nn,cM=Jp({}.toString),hM=Jp("".slice),ci=function(n){return hM(cM(n),8,-1)},uM=nn,dM=Mn,fM=ci,Ph=Object,gM=uM("".split),mM=dM(function(){return!Ph("z").propertyIsEnumerable(0)})?function(n){return fM(n)==="String"?gM(n,""):Ph(n)}:Ph,ew=function(n){return n==null},pM=ew,wM=TypeError,tw=function(n){if(pM(n))throw wM("Can't call method on "+n);return n},CM=mM,yM=tw,Ua=function(n){return CM(yM(n))},Dh=typeof document=="object"&&document.all,SM=typeof Dh>"u"&&Dh!==void 0,nw={all:Dh,IS_HTMLDDA:SM},sw=nw,vM=sw.all,zt=sw.IS_HTMLDDA?function(n){return typeof n=="function"||n===vM}:function(n){return typeof n=="function"},ow=zt,iw=nw,bM=iw.all,yo=iw.IS_HTMLDDA?function(n){return typeof n=="object"?n!==null:ow(n)||n===bM}:function(n){return typeof n=="object"?n!==null:ow(n)},Nh=Kt,RM=zt,EM=function(n){return RM(n)?n:void 0},gr=function(n,e){return arguments.length<2?EM(Nh[n]):Nh[n]&&Nh[n][e]},xM=nn,rw=xM({}.isPrototypeOf),Hh=typeof navigator<"u"&&String(navigator.userAgent)||"",aw=Kt,kh=Hh,lw=aw.process,cw=aw.Deno,hw=lw&&lw.versions||cw&&cw.version,uw=hw&&hw.v8,$n,za;uw&&($n=uw.split("."),za=$n[0]>0&&$n[0]<4?1:+($n[0]+$n[1])),!za&&kh&&($n=kh.match(/Edge\/(\d+)/),(!$n||$n[1]>=74)&&($n=kh.match(/Chrome\/(\d+)/),$n&&(za=+$n[1])));var TM=za,dw=TM,MM=Mn,_M=Kt,IM=_M.String,Lh=!!Object.getOwnPropertySymbols&&!MM(function(){var n=Symbol("symbol detection");return!IM(n)||!(Object(n)instanceof Symbol)||!Symbol.sham&&dw&&dw<41}),OM=Lh,fw=OM&&!Symbol.sham&&typeof Symbol.iterator=="symbol",AM=gr,PM=zt,DM=rw,NM=fw,HM=Object,Vh=NM?function(n){return typeof n=="symbol"}:function(n){var e=AM("Symbol");return PM(e)&&DM(e.prototype,HM(n))},kM=String,gw=function(n){try{return kM(n)}catch{return"Object"}},LM=zt,VM=gw,$M=TypeError,$h=function(n){if(LM(n))return n;throw $M(VM(n)+" is not a function")},FM=$h,BM=ew,WM=function(n,e){var t=n[e];return BM(t)?void 0:FM(t)},Fh=Wa,Bh=zt,Wh=yo,UM=TypeError,zM=function(n,e){var t,s;if(e==="string"&&Bh(t=n.toString)&&!Wh(s=Fh(t,n))||Bh(t=n.valueOf)&&!Wh(s=Fh(t,n))||e!=="string"&&Bh(t=n.toString)&&!Wh(s=Fh(t,n)))return s;throw UM("Can't convert object to primitive value")},mw={exports:{}},pw=Kt,YM=Object.defineProperty,Uh=function(n,e){try{YM(pw,n,{value:e,configurable:!0,writable:!0})}catch{pw[n]=e}return e},GM=Kt,jM=Uh,ww="__core-js_shared__",KM=GM[ww]||jM(ww,{}),zh=KM,Cw=zh;(mw.exports=function(n,e){return Cw[n]||(Cw[n]=e!==void 0?e:{})})("versions",[]).push({version:"3.32.2",mode:"global",copyright:"Â© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.32.2/LICENSE",source:"https://github.com/zloirock/core-js"});var yw=mw.exports,XM=tw,qM=Object,Ya=function(n){return qM(XM(n))},ZM=nn,QM=Ya,JM=ZM({}.hasOwnProperty),vs=Object.hasOwn||function(e,t){return JM(QM(e),t)},e_=nn,t_=0,n_=Math.random(),s_=e_(1 .toString),Sw=function(n){return"Symbol("+(n===void 0?"":n)+")_"+s_(++t_+n_,36)},o_=Kt,i_=yw,vw=vs,r_=Sw,a_=Lh,l_=fw,hi=o_.Symbol,Yh=i_("wks"),c_=l_?hi.for||hi:hi&&hi.withoutSetter||r_,Ga=function(n){return vw(Yh,n)||(Yh[n]=a_&&vw(hi,n)?hi[n]:c_("Symbol."+n)),Yh[n]},h_=Wa,bw=yo,Rw=Vh,u_=WM,d_=zM,f_=Ga,g_=TypeError,m_=f_("toPrimitive"),p_=function(n,e){if(!bw(n)||Rw(n))return n;var t=u_(n,m_),s;if(t){if(e===void 0&&(e="default"),s=h_(t,n,e),!bw(s)||Rw(s))return s;throw g_("Can't convert object to primitive value")}return e===void 0&&(e="number"),d_(n,e)},w_=p_,C_=Vh,Ew=function(n){var e=w_(n,"string");return C_(e)?e:e+""},y_=Kt,xw=yo,Gh=y_.document,S_=xw(Gh)&&xw(Gh.createElement),jh=function(n){return S_?Gh.createElement(n):{}},v_=qn,b_=Mn,R_=jh,Tw=!v_&&!b_(function(){return Object.defineProperty(R_("div"),"a",{get:function(){return 7}}).a!==7}),E_=qn,x_=Wa,T_=Kp,M_=Oh,__=Ua,I_=Ew,O_=vs,A_=Tw,Mw=Object.getOwnPropertyDescriptor;Ih.f=E_?Mw:function(e,t){if(e=__(e),t=I_(t),A_)try{return Mw(e,t)}catch{}if(O_(e,t))return M_(!x_(T_.f,e,t),e[t])};var So={},P_=qn,D_=Mn,_w=P_&&D_(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),N_=yo,H_=String,k_=TypeError,mr=function(n){if(N_(n))return n;throw k_(H_(n)+" is not an object")},L_=qn,V_=Tw,$_=_w,ja=mr,Iw=Ew,F_=TypeError,Kh=Object.defineProperty,B_=Object.getOwnPropertyDescriptor,Xh="enumerable",qh="configurable",Zh="writable";So.f=L_?$_?function(e,t,s){if(ja(e),t=Iw(t),ja(s),typeof e=="function"&&t==="prototype"&&"value"in s&&Zh in s&&!s[Zh]){var o=B_(e,t);o&&o[Zh]&&(e[t]=s.value,s={configurable:qh in s?s[qh]:o[qh],enumerable:Xh in s?s[Xh]:o[Xh],writable:!1})}return Kh(e,t,s)}:Kh:function(e,t,s){if(ja(e),t=Iw(t),ja(s),V_)try{return Kh(e,t,s)}catch{}if("get"in s||"set"in s)throw F_("Accessors not supported");return"value"in s&&(e[t]=s.value),e};var W_=qn,U_=So,z_=Oh,pr=W_?function(n,e,t){return U_.f(n,e,z_(1,t))}:function(n,e,t){return n[e]=t,n},Ow={exports:{}},Qh=qn,Y_=vs,Aw=Function.prototype,G_=Qh&&Object.getOwnPropertyDescriptor,Jh=Y_(Aw,"name"),j_=Jh&&(function(){}).name==="something",K_=Jh&&(!Qh||Qh&&G_(Aw,"name").configurable),X_={EXISTS:Jh,PROPER:j_,CONFIGURABLE:K_},q_=nn,Z_=zt,eu=zh,Q_=q_(Function.toString);Z_(eu.inspectSource)||(eu.inspectSource=function(n){return Q_(n)});var J_=eu.inspectSource,e1=Kt,t1=zt,Pw=e1.WeakMap,n1=t1(Pw)&&/native code/.test(String(Pw)),s1=yw,o1=Sw,Dw=s1("keys"),Nw=function(n){return Dw[n]||(Dw[n]=o1(n))},tu={},i1=n1,Hw=Kt,r1=yo,a1=pr,nu=vs,su=zh,l1=Nw,c1=tu,kw="Object already initialized",ou=Hw.TypeError,h1=Hw.WeakMap,Ka,wr,Xa,u1=function(n){return Xa(n)?wr(n):Ka(n,{})},d1=function(n){return function(e){var t;if(!r1(e)||(t=wr(e)).type!==n)throw ou("Incompatible receiver, "+n+" required");return t}};if(i1||su.state){var Zn=su.state||(su.state=new h1);Zn.get=Zn.get,Zn.has=Zn.has,Zn.set=Zn.set,Ka=function(n,e){if(Zn.has(n))throw ou(kw);return e.facade=n,Zn.set(n,e),e},wr=function(n){return Zn.get(n)||{}},Xa=function(n){return Zn.has(n)}}else{var ui=l1("state");c1[ui]=!0,Ka=function(n,e){if(nu(n,ui))throw ou(kw);return e.facade=n,a1(n,ui,e),e},wr=function(n){return nu(n,ui)?n[ui]:{}},Xa=function(n){return nu(n,ui)}}var f1={set:Ka,get:wr,has:Xa,enforce:u1,getterFor:d1},iu=nn,g1=Mn,m1=zt,qa=vs,ru=qn,p1=X_.CONFIGURABLE,w1=J_,Lw=f1,C1=Lw.enforce,y1=Lw.get,Vw=String,Za=Object.defineProperty,S1=iu("".slice),v1=iu("".replace),b1=iu([].join),R1=ru&&!g1(function(){return Za(function(){},"length",{value:8}).length!==8}),E1=String(String).split("String"),x1=Ow.exports=function(n,e,t){S1(Vw(e),0,7)==="Symbol("&&(e="["+v1(Vw(e),/^Symbol\(([^)]*)\)/,"$1")+"]"),t&&t.getter&&(e="get "+e),t&&t.setter&&(e="set "+e),(!qa(n,"name")||p1&&n.name!==e)&&(ru?Za(n,"name",{value:e,configurable:!0}):n.name=e),R1&&t&&qa(t,"arity")&&n.length!==t.arity&&Za(n,"length",{value:t.arity});try{t&&qa(t,"constructor")&&t.constructor?ru&&Za(n,"prototype",{writable:!1}):n.prototype&&(n.prototype=void 0)}catch{}var s=C1(n);return qa(s,"source")||(s.source=b1(E1,typeof e=="string"?e:"")),n};Function.prototype.toString=x1(function(){return m1(this)&&y1(this).source||w1(this)},"toString");var T1=Ow.exports,M1=zt,_1=So,I1=T1,O1=Uh,A1=function(n,e,t,s){s||(s={});var o=s.enumerable,r=s.name!==void 0?s.name:e;if(M1(t)&&I1(t,r,s),s.global)o?n[e]=t:O1(e,t);else{try{s.unsafe?n[e]&&(o=!0):delete n[e]}catch{}o?n[e]=t:_1.f(n,e,{value:t,enumerable:!1,configurable:!s.nonConfigurable,writable:!s.nonWritable})}return n},$w={},P1=Math.ceil,D1=Math.floor,N1=Math.trunc||function(e){var t=+e;return(t>0?D1:P1)(t)},H1=N1,au=function(n){var e=+n;return e!==e||e===0?0:H1(e)},k1=au,L1=Math.max,V1=Math.min,$1=function(n,e){var t=k1(n);return t<0?L1(t+e,0):V1(t,e)},F1=au,B1=Math.min,W1=function(n){return n>0?B1(F1(n),9007199254740991):0},U1=W1,Qa=function(n){return U1(n.length)},z1=Ua,Y1=$1,G1=Qa,Fw=function(n){return function(e,t,s){var o=z1(e),r=G1(o),a=Y1(s,r),l;if(n&&t!==t){for(;r>a;)if(l=o[a++],l!==l)return!0}else for(;r>a;a++)if((n||a in o)&&o[a]===t)return n||a||0;return!n&&-1}},j1={includes:Fw(!0),indexOf:Fw(!1)},K1=nn,lu=vs,X1=Ua,q1=j1.indexOf,Z1=tu,Bw=K1([].push),Ww=function(n,e){var t=X1(n),s=0,o=[],r;for(r in t)!lu(Z1,r)&&lu(t,r)&&Bw(o,r);for(;e.length>s;)lu(t,r=e[s++])&&(~q1(o,r)||Bw(o,r));return o},cu=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Q1=Ww,J1=cu,eI=J1.concat("length","prototype");$w.f=Object.getOwnPropertyNames||function(e){return Q1(e,eI)};var Uw={};Uw.f=Object.getOwnPropertySymbols;var tI=gr,nI=nn,sI=$w,oI=Uw,iI=mr,rI=nI([].concat),aI=tI("Reflect","ownKeys")||function(e){var t=sI.f(iI(e)),s=oI.f;return s?rI(t,s(e)):t},zw=vs,lI=aI,cI=Ih,hI=So,Yw=function(n,e,t){for(var s=lI(e),o=hI.f,r=cI.f,a=0;a<s.length;a++){var l=s[a];!zw(n,l)&&!(t&&zw(t,l))&&o(n,l,r(e,l))}},uI=Mn,dI=zt,fI=/#|\.prototype\./,Cr=function(n,e){var t=mI[gI(n)];return t===wI?!0:t===pI?!1:dI(e)?uI(e):!!e},gI=Cr.normalize=function(n){return String(n).replace(fI,".").toLowerCase()},mI=Cr.data={},pI=Cr.NATIVE="N",wI=Cr.POLYFILL="P",CI=Cr,hu=Kt,yI=Ih.f,SI=pr,vI=A1,bI=Uh,RI=Yw,EI=CI,vo=function(n,e){var t=n.target,s=n.global,o=n.stat,r,a,l,c,h,u;if(s?a=hu:o?a=hu[t]||bI(t,{}):a=(hu[t]||{}).prototype,a)for(l in e){if(h=e[l],n.dontCallGetSet?(u=yI(a,l),c=u&&u.value):c=a[l],r=EI(s?l:t+(o?".":"#")+l,n.forced),!r&&c!==void 0){if(typeof h==typeof c)continue;RI(h,c)}(n.sham||c&&c.sham)&&SI(h,"sham",!0),vI(a,l,h,n)}},xI=ci,Gw=Array.isArray||function(e){return xI(e)==="Array"},TI=qn,MI=Gw,_I=TypeError,II=Object.getOwnPropertyDescriptor,OI=TI&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(n){return n instanceof TypeError}}(),jw=OI?function(n,e){if(MI(n)&&!II(n,"length").writable)throw _I("Cannot set read only .length");return n.length=e}:function(n,e){return n.length=e},AI=TypeError,PI=9007199254740991,Kw=function(n){if(n>PI)throw AI("Maximum allowed index exceeded");return n},DI=vo,NI=Ya,HI=Qa,kI=jw,LI=Kw,VI=Mn,$I=VI(function(){return[].push.call({length:4294967296},1)!==4294967297}),FI=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(n){return n instanceof TypeError}},BI=$I||!FI();DI({target:"Array",proto:!0,arity:1,forced:BI},{push:function(e){var t=NI(this),s=HI(t),o=arguments.length;LI(s+o);for(var r=0;r<o;r++)t[s]=arguments[r],s++;return kI(t,s),s}});var WI=Fa,Xw=Function.prototype,qw=Xw.apply,Zw=Xw.call,Ja=typeof Reflect=="object"&&Reflect.apply||(WI?Zw.bind(qw):function(){return Zw.apply(qw,arguments)}),UI=nn,zI=$h,YI=function(n,e,t){try{return UI(zI(Object.getOwnPropertyDescriptor(n,e)[t]))}catch{}},GI=zt,jI=String,KI=TypeError,XI=function(n){if(typeof n=="object"||GI(n))return n;throw KI("Can't set "+jI(n)+" as a prototype")},qI=YI,ZI=mr,QI=XI,Qw=Object.setPrototypeOf||("__proto__"in{}?function(){var n=!1,e={},t;try{t=qI(Object.prototype,"__proto__","set"),t(e,[]),n=e instanceof Array}catch{}return function(o,r){return ZI(o),QI(r),n?t(o,r):o.__proto__=r,o}}():void 0),JI=So.f,eO=function(n,e,t){t in n||JI(n,t,{configurable:!0,get:function(){return e[t]},set:function(s){e[t]=s}})},tO=zt,nO=yo,Jw=Qw,sO=function(n,e,t){var s,o;return Jw&&tO(s=e.constructor)&&s!==t&&nO(o=s.prototype)&&o!==t.prototype&&Jw(n,o),n},oO=Ga,iO=oO("toStringTag"),eC={};eC[iO]="z";var rO=String(eC)==="[object z]",aO=rO,lO=zt,el=ci,cO=Ga,hO=cO("toStringTag"),uO=Object,dO=el(function(){return arguments}())==="Arguments",fO=function(n,e){try{return n[e]}catch{}},gO=aO?el:function(n){var e,t,s;return n===void 0?"Undefined":n===null?"Null":typeof(t=fO(e=uO(n),hO))=="string"?t:dO?el(e):(s=el(e))==="Object"&&lO(e.callee)?"Arguments":s},mO=gO,pO=String,tC=function(n){if(mO(n)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return pO(n)},wO=tC,CO=function(n,e){return n===void 0?arguments.length<2?"":e:wO(n)},yO=yo,SO=pr,vO=function(n,e){yO(e)&&"cause"in e&&SO(n,"cause",e.cause)},bO=nn,nC=Error,RO=bO("".replace),EO=function(n){return String(nC(n).stack)}("zxcasd"),sC=/\n\s*at [^:]*:[^\n]*/,xO=sC.test(EO),TO=function(n,e){if(xO&&typeof n=="string"&&!nC.prepareStackTrace)for(;e--;)n=RO(n,sC,"");return n},MO=Mn,_O=Oh,IO=!MO(function(){var n=Error("a");return"stack"in n?(Object.defineProperty(n,"stack",_O(1,7)),n.stack!==7):!0}),OO=pr,AO=TO,PO=IO,oC=Error.captureStackTrace,DO=function(n,e,t,s){PO&&(oC?oC(n,e):OO(n,"stack",AO(t,s)))},iC=gr,NO=vs,rC=pr,HO=rw,aC=Qw,lC=Yw,cC=eO,kO=sO,LO=CO,VO=vO,$O=DO,FO=qn,BO=function(n,e,t,s){var o="stackTraceLimit",r=s?2:1,a=n.split("."),l=a[a.length-1],c=iC.apply(null,a);if(c){var h=c.prototype;if(NO(h,"cause")&&delete h.cause,!t)return c;var u=iC("Error"),f=e(function(g,p){var C=LO(s?p:g,void 0),y=s?new c(g):new c;return C!==void 0&&rC(y,"message",C),$O(y,f,y.stack,2),this&&HO(h,this)&&kO(y,this,f),arguments.length>r&&VO(y,arguments[r]),y});f.prototype=h,l!=="Error"?aC?aC(f,u):lC(f,u,{name:!0}):FO&&o in c&&(cC(f,c,o),cC(f,c,"prepareStackTrace")),lC(f,c);try{h.name!==l&&rC(h,"name",l),h.constructor=f}catch{}return f}},hC=vo,WO=Kt,Qn=Ja,uC=BO,uu="WebAssembly",dC=WO[uu],tl=Error("e",{cause:7}).cause!==7,bo=function(n,e){var t={};t[n]=uC(n,e,tl),hC({global:!0,constructor:!0,arity:1,forced:tl},t)},du=function(n,e){if(dC&&dC[n]){var t={};t[n]=uC(uu+"."+n,e,tl),hC({target:uu,stat:!0,constructor:!0,arity:1,forced:tl},t)}};bo("Error",function(n){return function(t){return Qn(n,this,arguments)}}),bo("EvalError",function(n){return function(t){return Qn(n,this,arguments)}}),bo("RangeError",function(n){return function(t){return Qn(n,this,arguments)}}),bo("ReferenceError",function(n){return function(t){return Qn(n,this,arguments)}}),bo("SyntaxError",function(n){return function(t){return Qn(n,this,arguments)}}),bo("TypeError",function(n){return function(t){return Qn(n,this,arguments)}}),bo("URIError",function(n){return function(t){return Qn(n,this,arguments)}}),du("CompileError",function(n){return function(t){return Qn(n,this,arguments)}}),du("LinkError",function(n){return function(t){return Qn(n,this,arguments)}}),du("RuntimeError",function(n){return function(t){return Qn(n,this,arguments)}});var UO=ci,zO=nn,YO=function(n){if(UO(n)==="Function")return zO(n)},fC=YO,GO=$h,jO=Fa,KO=fC(fC.bind),XO=function(n,e){return GO(n),e===void 0?n:jO?KO(n,e):function(){return n.apply(e,arguments)}},qO=gr,gC=qO("document","documentElement"),ZO=nn,fu=ZO([].slice),QO=TypeError,mC=function(n,e){if(n<e)throw QO("Not enough arguments");return n},JO=Hh,eA=/(?:ipad|iphone|ipod).*applewebkit/i.test(JO),tA=Kt,nA=ci,sA=nA(tA.process)==="process",wn=Kt,oA=Ja,iA=XO,pC=zt,rA=vs,wC=Mn,CC=gC,aA=fu,yC=jh,lA=mC,cA=eA,hA=sA,gu=wn.setImmediate,mu=wn.clearImmediate,uA=wn.process,pu=wn.Dispatch,dA=wn.Function,SC=wn.MessageChannel,fA=wn.String,wu=0,yr={},vC="onreadystatechange",Sr,Ro,Cu,yu;wC(function(){Sr=wn.location});var Su=function(n){if(rA(yr,n)){var e=yr[n];delete yr[n],e()}},vu=function(n){return function(){Su(n)}},bC=function(n){Su(n.data)},RC=function(n){wn.postMessage(fA(n),Sr.protocol+"//"+Sr.host)};(!gu||!mu)&&(gu=function(e){lA(arguments.length,1);var t=pC(e)?e:dA(e),s=aA(arguments,1);return yr[++wu]=function(){oA(t,void 0,s)},Ro(wu),wu},mu=function(e){delete yr[e]},hA?Ro=function(n){uA.nextTick(vu(n))}:pu&&pu.now?Ro=function(n){pu.now(vu(n))}:SC&&!cA?(Cu=new SC,yu=Cu.port2,Cu.port1.onmessage=bC,Ro=iA(yu.postMessage,yu)):wn.addEventListener&&pC(wn.postMessage)&&!wn.importScripts&&Sr&&Sr.protocol!=="file:"&&!wC(RC)?(Ro=RC,wn.addEventListener("message",bC,!1)):vC in yC("script")?Ro=function(n){CC.appendChild(yC("script"))[vC]=function(){CC.removeChild(this),Su(n)}}:Ro=function(n){setTimeout(vu(n),0)});var EC={set:gu,clear:mu},gA=vo,mA=Kt,xC=EC.clear;gA({global:!0,bind:!0,enumerable:!0,forced:mA.clearImmediate!==xC},{clearImmediate:xC});var pA=typeof Bun=="function"&&Bun&&typeof Bun.version=="string",TC=Kt,wA=Ja,CA=zt,yA=pA,SA=Hh,vA=fu,bA=mC,RA=TC.Function,EA=/MSIE .\./.test(SA)||yA&&function(){var n=TC.Bun.version.split(".");return n.length<3||n[0]==="0"&&(n[1]<3||n[1]==="3"&&n[2]==="0")}(),xA=function(n,e){var t=e?2:1;return EA?function(s,o){var r=bA(arguments.length,1)>t,a=CA(s)?s:RA(s),l=r?vA(arguments,t):[],c=r?function(){wA(a,this,l)}:a;return e?n(c,o):n(c)}:n},TA=vo,MC=Kt,_C=EC.set,MA=xA,IC=MC.setImmediate?MA(_C,!1):_C;TA({global:!0,bind:!0,enumerable:!0,forced:MC.setImmediate!==IC},{setImmediate:IC});/*! @license DOMPurify 2.4.7 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.7/LICENSE */function Gs(n){"@babel/helpers - typeof";return Gs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gs(n)}function bu(n,e){return bu=Object.setPrototypeOf||function(s,o){return s.__proto__=o,s},bu(n,e)}function _A(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function nl(n,e,t){return _A()?nl=Reflect.construct:nl=function(o,r,a){var l=[null];l.push.apply(l,r);var c=Function.bind.apply(o,l),h=new c;return a&&bu(h,a.prototype),h},nl.apply(null,arguments)}function Fn(n){return IA(n)||OA(n)||AA(n)||PA()}function IA(n){if(Array.isArray(n))return Ru(n)}function OA(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function AA(n,e){if(n){if(typeof n=="string")return Ru(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Ru(n,e)}}function Ru(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,s=new Array(e);t<e;t++)s[t]=n[t];return s}function PA(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var DA=Object.hasOwnProperty,OC=Object.setPrototypeOf,NA=Object.isFrozen,HA=Object.getPrototypeOf,kA=Object.getOwnPropertyDescriptor,sn=Object.freeze,Bn=Object.seal,LA=Object.create,AC=typeof Reflect<"u"&&Reflect,sl=AC.apply,Eu=AC.construct;sl||(sl=function(e,t,s){return e.apply(t,s)}),sn||(sn=function(e){return e}),Bn||(Bn=function(e){return e}),Eu||(Eu=function(e,t){return nl(e,Fn(t))});var VA=_n(Array.prototype.forEach),PC=_n(Array.prototype.pop),vr=_n(Array.prototype.push),ol=_n(String.prototype.toLowerCase),xu=_n(String.prototype.toString),$A=_n(String.prototype.match),Wn=_n(String.prototype.replace),FA=_n(String.prototype.indexOf),BA=_n(String.prototype.trim),on=_n(RegExp.prototype.test),Tu=WA(TypeError);function _n(n){return function(e){for(var t=arguments.length,s=new Array(t>1?t-1:0),o=1;o<t;o++)s[o-1]=arguments[o];return sl(n,e,s)}}function WA(n){return function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return Eu(n,t)}}function Ue(n,e,t){var s;t=(s=t)!==null&&s!==void 0?s:ol,OC&&OC(n,null);for(var o=e.length;o--;){var r=e[o];if(typeof r=="string"){var a=t(r);a!==r&&(NA(e)||(e[o]=a),r=a)}n[r]=!0}return n}function Eo(n){var e=LA(null),t;for(t in n)sl(DA,n,[t])===!0&&(e[t]=n[t]);return e}function il(n,e){for(;n!==null;){var t=kA(n,e);if(t){if(t.get)return _n(t.get);if(typeof t.value=="function")return _n(t.value)}n=HA(n)}function s(o){return console.warn("fallback value for",o),null}return s}var DC=sn(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Mu=sn(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),_u=sn(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),UA=sn(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Iu=sn(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),zA=sn(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),NC=sn(["#text"]),HC=sn(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),Ou=sn(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),kC=sn(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),rl=sn(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),YA=Bn(/\{\{[\w\W]*|[\w\W]*\}\}/gm),GA=Bn(/<%[\w\W]*|[\w\W]*%>/gm),jA=Bn(/\${[\w\W]*}/gm),KA=Bn(/^data-[\-\w.\u00B7-\uFFFF]/),XA=Bn(/^aria-[\-\w]+$/),qA=Bn(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),ZA=Bn(/^(?:\w+script|data):/i),QA=Bn(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),JA=Bn(/^html$/i),eP=function(){return typeof window>"u"?null:window},tP=function(e,t){if(Gs(e)!=="object"||typeof e.createPolicy!="function")return null;var s=null,o="data-tt-policy-suffix";t.currentScript&&t.currentScript.hasAttribute(o)&&(s=t.currentScript.getAttribute(o));var r="dompurify"+(s?"#"+s:"");try{return e.createPolicy(r,{createHTML:function(l){return l},createScriptURL:function(l){return l}})}catch{return console.warn("TrustedTypes policy "+r+" could not be created."),null}};function LC(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:eP(),e=function($){return LC($)};if(e.version="2.4.7",e.removed=[],!n||!n.document||n.document.nodeType!==9)return e.isSupported=!1,e;var t=n.document,s=n.document,o=n.DocumentFragment,r=n.HTMLTemplateElement,a=n.Node,l=n.Element,c=n.NodeFilter,h=n.NamedNodeMap,u=h===void 0?n.NamedNodeMap||n.MozNamedAttrMap:h,f=n.HTMLFormElement,g=n.DOMParser,p=n.trustedTypes,C=l.prototype,y=il(C,"cloneNode"),b=il(C,"nextSibling"),T=il(C,"childNodes"),M=il(C,"parentNode");if(typeof r=="function"){var _=s.createElement("template");_.content&&_.content.ownerDocument&&(s=_.content.ownerDocument)}var I=tP(p,t),D=I?I.createHTML(""):"",K=s,H=K.implementation,Q=K.createNodeIterator,q=K.createDocumentFragment,F=K.getElementsByTagName,Y=t.importNode,te={};try{te=Eo(s).documentMode?s.documentMode:{}}catch{}var ie={};e.isSupported=typeof M=="function"&&H&&H.createHTMLDocument!==void 0&&te!==9;var fe=YA,Me=GA,Ge=jA,Oe=KA,E=XA,d=ZA,w=QA,S=qA,x=null,O=Ue({},[].concat(Fn(DC),Fn(Mu),Fn(_u),Fn(Iu),Fn(NC))),P=null,X=Ue({},[].concat(Fn(HC),Fn(Ou),Fn(kC),Fn(rl))),z=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),ee=null,se=null,J=!0,pe=!0,He=!1,xe=!0,Te=!1,Z=!1,je=!1,Le=!1,ve=!1,Pe=!1,Se=!1,v=!0,R=!1,A="user-content-",U=!0,k=!1,W={},L=null,V=Ue({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),G=null,B=Ue({},["audio","video","img","source","image","track"]),j=null,le=Ue({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),ge="http://www.w3.org/1998/Math/MathML",ye="http://www.w3.org/2000/svg",_e="http://www.w3.org/1999/xhtml",ke=_e,dt=!1,ze=null,nt=Ue({},[ge,ye,_e],xu),yt,rr=["application/xhtml+xml","text/html"],Pa="text/html",It,Yt=null,oi=s.createElement("form"),hn=function($){return $ instanceof RegExp||$ instanceof Function},$t=function($){Yt&&Yt===$||((!$||Gs($)!=="object")&&($={}),$=Eo($),yt=rr.indexOf($.PARSER_MEDIA_TYPE)===-1?yt=Pa:yt=$.PARSER_MEDIA_TYPE,It=yt==="application/xhtml+xml"?xu:ol,x="ALLOWED_TAGS"in $?Ue({},$.ALLOWED_TAGS,It):O,P="ALLOWED_ATTR"in $?Ue({},$.ALLOWED_ATTR,It):X,ze="ALLOWED_NAMESPACES"in $?Ue({},$.ALLOWED_NAMESPACES,xu):nt,j="ADD_URI_SAFE_ATTR"in $?Ue(Eo(le),$.ADD_URI_SAFE_ATTR,It):le,G="ADD_DATA_URI_TAGS"in $?Ue(Eo(B),$.ADD_DATA_URI_TAGS,It):B,L="FORBID_CONTENTS"in $?Ue({},$.FORBID_CONTENTS,It):V,ee="FORBID_TAGS"in $?Ue({},$.FORBID_TAGS,It):{},se="FORBID_ATTR"in $?Ue({},$.FORBID_ATTR,It):{},W="USE_PROFILES"in $?$.USE_PROFILES:!1,J=$.ALLOW_ARIA_ATTR!==!1,pe=$.ALLOW_DATA_ATTR!==!1,He=$.ALLOW_UNKNOWN_PROTOCOLS||!1,xe=$.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Te=$.SAFE_FOR_TEMPLATES||!1,Z=$.WHOLE_DOCUMENT||!1,ve=$.RETURN_DOM||!1,Pe=$.RETURN_DOM_FRAGMENT||!1,Se=$.RETURN_TRUSTED_TYPE||!1,Le=$.FORCE_BODY||!1,v=$.SANITIZE_DOM!==!1,R=$.SANITIZE_NAMED_PROPS||!1,U=$.KEEP_CONTENT!==!1,k=$.IN_PLACE||!1,S=$.ALLOWED_URI_REGEXP||S,ke=$.NAMESPACE||_e,z=$.CUSTOM_ELEMENT_HANDLING||{},$.CUSTOM_ELEMENT_HANDLING&&hn($.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(z.tagNameCheck=$.CUSTOM_ELEMENT_HANDLING.tagNameCheck),$.CUSTOM_ELEMENT_HANDLING&&hn($.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(z.attributeNameCheck=$.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),$.CUSTOM_ELEMENT_HANDLING&&typeof $.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(z.allowCustomizedBuiltInElements=$.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Te&&(pe=!1),Pe&&(ve=!0),W&&(x=Ue({},Fn(NC)),P=[],W.html===!0&&(Ue(x,DC),Ue(P,HC)),W.svg===!0&&(Ue(x,Mu),Ue(P,Ou),Ue(P,rl)),W.svgFilters===!0&&(Ue(x,_u),Ue(P,Ou),Ue(P,rl)),W.mathMl===!0&&(Ue(x,Iu),Ue(P,kC),Ue(P,rl))),$.ADD_TAGS&&(x===O&&(x=Eo(x)),Ue(x,$.ADD_TAGS,It)),$.ADD_ATTR&&(P===X&&(P=Eo(P)),Ue(P,$.ADD_ATTR,It)),$.ADD_URI_SAFE_ATTR&&Ue(j,$.ADD_URI_SAFE_ATTR,It),$.FORBID_CONTENTS&&(L===V&&(L=Eo(L)),Ue(L,$.FORBID_CONTENTS,It)),U&&(x["#text"]=!0),Z&&Ue(x,["html","head","body"]),x.table&&(Ue(x,["tbody"]),delete ee.tbody),sn&&sn($),Yt=$)},pt=Ue({},["mi","mo","mn","ms","mtext"]),B0=Ue({},["foreignobject","desc","title","annotation-xml"]),b3=Ue({},["title","style","font","a","script"]),yh=Ue({},Mu);Ue(yh,_u),Ue(yh,UA);var Pp=Ue({},Iu);Ue(Pp,zA);var R3=function($){var ae=M($);(!ae||!ae.tagName)&&(ae={namespaceURI:ke,tagName:"template"});var ce=ol($.tagName),tt=ol(ae.tagName);return ze[$.namespaceURI]?$.namespaceURI===ye?ae.namespaceURI===_e?ce==="svg":ae.namespaceURI===ge?ce==="svg"&&(tt==="annotation-xml"||pt[tt]):!!yh[ce]:$.namespaceURI===ge?ae.namespaceURI===_e?ce==="math":ae.namespaceURI===ye?ce==="math"&&B0[tt]:!!Pp[ce]:$.namespaceURI===_e?ae.namespaceURI===ye&&!B0[tt]||ae.namespaceURI===ge&&!pt[tt]?!1:!Pp[ce]&&(b3[ce]||!yh[ce]):!!(yt==="application/xhtml+xml"&&ze[$.namespaceURI]):!1},Us=function($){vr(e.removed,{element:$});try{$.parentNode.removeChild($)}catch{try{$.outerHTML=D}catch{$.remove()}}},Dp=function($,ae){try{vr(e.removed,{attribute:ae.getAttributeNode($),from:ae})}catch{vr(e.removed,{attribute:null,from:ae})}if(ae.removeAttribute($),$==="is"&&!P[$])if(ve||Pe)try{Us(ae)}catch{}else try{ae.setAttribute($,"")}catch{}},W0=function($){var ae,ce;if(Le)$="<remove></remove>"+$;else{var tt=$A($,/^[\r\n\t ]+/);ce=tt&&tt[0]}yt==="application/xhtml+xml"&&ke===_e&&($='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+$+"</body></html>");var mn=I?I.createHTML($):$;if(ke===_e)try{ae=new g().parseFromString(mn,yt)}catch{}if(!ae||!ae.documentElement){ae=H.createDocument(ke,"template",null);try{ae.documentElement.innerHTML=dt?D:mn}catch{}}var tn=ae.body||ae.documentElement;return $&&ce&&tn.insertBefore(s.createTextNode(ce),tn.childNodes[0]||null),ke===_e?F.call(ae,Z?"html":"body")[0]:Z?ae.documentElement:tn},U0=function($){return Q.call($.ownerDocument||$,$,c.SHOW_ELEMENT|c.SHOW_COMMENT|c.SHOW_TEXT,null,!1)},E3=function($){return $ instanceof f&&(typeof $.nodeName!="string"||typeof $.textContent!="string"||typeof $.removeChild!="function"||!($.attributes instanceof u)||typeof $.removeAttribute!="function"||typeof $.setAttribute!="function"||typeof $.namespaceURI!="string"||typeof $.insertBefore!="function"||typeof $.hasChildNodes!="function")},Da=function($){return Gs(a)==="object"?$ instanceof a:$&&Gs($)==="object"&&typeof $.nodeType=="number"&&typeof $.nodeName=="string"},zs=function($,ae,ce){ie[$]&&VA(ie[$],function(tt){tt.call(e,ae,ce,Yt)})},z0=function($){var ae;if(zs("beforeSanitizeElements",$,null),E3($)||on(/[\u0080-\uFFFF]/,$.nodeName))return Us($),!0;var ce=It($.nodeName);if(zs("uponSanitizeElement",$,{tagName:ce,allowedTags:x}),$.hasChildNodes()&&!Da($.firstElementChild)&&(!Da($.content)||!Da($.content.firstElementChild))&&on(/<[/\w]/g,$.innerHTML)&&on(/<[/\w]/g,$.textContent)||ce==="select"&&on(/<template/i,$.innerHTML))return Us($),!0;if(!x[ce]||ee[ce]){if(!ee[ce]&&G0(ce)&&(z.tagNameCheck instanceof RegExp&&on(z.tagNameCheck,ce)||z.tagNameCheck instanceof Function&&z.tagNameCheck(ce)))return!1;if(U&&!L[ce]){var tt=M($)||$.parentNode,mn=T($)||$.childNodes;if(mn&&tt)for(var tn=mn.length,Gt=tn-1;Gt>=0;--Gt)tt.insertBefore(y(mn[Gt],!0),b($))}return Us($),!0}return $ instanceof l&&!R3($)||(ce==="noscript"||ce==="noembed"||ce==="noframes")&&on(/<\/no(script|embed|frames)/i,$.innerHTML)?(Us($),!0):(Te&&$.nodeType===3&&(ae=$.textContent,ae=Wn(ae,fe," "),ae=Wn(ae,Me," "),ae=Wn(ae,Ge," "),$.textContent!==ae&&(vr(e.removed,{element:$.cloneNode()}),$.textContent=ae)),zs("afterSanitizeElements",$,null),!1)},Y0=function($,ae,ce){if(v&&(ae==="id"||ae==="name")&&(ce in s||ce in oi))return!1;if(!(pe&&!se[ae]&&on(Oe,ae))){if(!(J&&on(E,ae))){if(!P[ae]||se[ae]){if(!(G0($)&&(z.tagNameCheck instanceof RegExp&&on(z.tagNameCheck,$)||z.tagNameCheck instanceof Function&&z.tagNameCheck($))&&(z.attributeNameCheck instanceof RegExp&&on(z.attributeNameCheck,ae)||z.attributeNameCheck instanceof Function&&z.attributeNameCheck(ae))||ae==="is"&&z.allowCustomizedBuiltInElements&&(z.tagNameCheck instanceof RegExp&&on(z.tagNameCheck,ce)||z.tagNameCheck instanceof Function&&z.tagNameCheck(ce))))return!1}else if(!j[ae]){if(!on(S,Wn(ce,w,""))){if(!((ae==="src"||ae==="xlink:href"||ae==="href")&&$!=="script"&&FA(ce,"data:")===0&&G[$])){if(!(He&&!on(d,Wn(ce,w,"")))){if(ce)return!1}}}}}}return!0},G0=function($){return $.indexOf("-")>0},j0=function($){var ae,ce,tt,mn;zs("beforeSanitizeAttributes",$,null);var tn=$.attributes;if(tn){var Gt={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:P};for(mn=tn.length;mn--;){ae=tn[mn];var Sh=ae,Ut=Sh.name,Np=Sh.namespaceURI;if(ce=Ut==="value"?ae.value:BA(ae.value),tt=It(Ut),Gt.attrName=tt,Gt.attrValue=ce,Gt.keepAttr=!0,Gt.forceKeepAttr=void 0,zs("uponSanitizeAttribute",$,Gt),ce=Gt.attrValue,!Gt.forceKeepAttr&&(Dp(Ut,$),!!Gt.keepAttr)){if(!xe&&on(/\/>/i,ce)){Dp(Ut,$);continue}Te&&(ce=Wn(ce,fe," "),ce=Wn(ce,Me," "),ce=Wn(ce,Ge," "));var K0=It($.nodeName);if(Y0(K0,tt,ce)){if(R&&(tt==="id"||tt==="name")&&(Dp(Ut,$),ce=A+ce),I&&Gs(p)==="object"&&typeof p.getAttributeType=="function"&&!Np)switch(p.getAttributeType(K0,tt)){case"TrustedHTML":{ce=I.createHTML(ce);break}case"TrustedScriptURL":{ce=I.createScriptURL(ce);break}}try{Np?$.setAttributeNS(Np,Ut,ce):$.setAttribute(Ut,ce),PC(e.removed)}catch{}}}}zs("afterSanitizeAttributes",$,null)}},x3=function be($){var ae,ce=U0($);for(zs("beforeSanitizeShadowDOM",$,null);ae=ce.nextNode();)zs("uponSanitizeShadowNode",ae,null),!z0(ae)&&(ae.content instanceof o&&be(ae.content),j0(ae));zs("afterSanitizeShadowDOM",$,null)};return e.sanitize=function(be){var $=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ae,ce,tt,mn,tn;if(dt=!be,dt&&(be="<!-->"),typeof be!="string"&&!Da(be))if(typeof be.toString=="function"){if(be=be.toString(),typeof be!="string")throw Tu("dirty is not a string, aborting")}else throw Tu("toString is not a function");if(!e.isSupported){if(Gs(n.toStaticHTML)==="object"||typeof n.toStaticHTML=="function"){if(typeof be=="string")return n.toStaticHTML(be);if(Da(be))return n.toStaticHTML(be.outerHTML)}return be}if(je||$t($),e.removed=[],typeof be=="string"&&(k=!1),k){if(be.nodeName){var Gt=It(be.nodeName);if(!x[Gt]||ee[Gt])throw Tu("root node is forbidden and cannot be sanitized in-place")}}else if(be instanceof a)ae=W0("<!---->"),ce=ae.ownerDocument.importNode(be,!0),ce.nodeType===1&&ce.nodeName==="BODY"||ce.nodeName==="HTML"?ae=ce:ae.appendChild(ce);else{if(!ve&&!Te&&!Z&&be.indexOf("<")===-1)return I&&Se?I.createHTML(be):be;if(ae=W0(be),!ae)return ve?null:Se?D:""}ae&&Le&&Us(ae.firstChild);for(var Sh=U0(k?be:ae);tt=Sh.nextNode();)tt.nodeType===3&&tt===mn||z0(tt)||(tt.content instanceof o&&x3(tt.content),j0(tt),mn=tt);if(mn=null,k)return be;if(ve){if(Pe)for(tn=q.call(ae.ownerDocument);ae.firstChild;)tn.appendChild(ae.firstChild);else tn=ae;return(P.shadowroot||P.shadowrootmod)&&(tn=Y.call(t,tn,!0)),tn}var Ut=Z?ae.outerHTML:ae.innerHTML;return Z&&x["!doctype"]&&ae.ownerDocument&&ae.ownerDocument.doctype&&ae.ownerDocument.doctype.name&&on(JA,ae.ownerDocument.doctype.name)&&(Ut="<!DOCTYPE "+ae.ownerDocument.doctype.name+`>
`+Ut),Te&&(Ut=Wn(Ut,fe," "),Ut=Wn(Ut,Me," "),Ut=Wn(Ut,Ge," ")),I&&Se?I.createHTML(Ut):Ut},e.setConfig=function(be){$t(be),je=!0},e.clearConfig=function(){Yt=null,je=!1},e.isValidAttribute=function(be,$,ae){Yt||$t({});var ce=It(be),tt=It($);return Y0(ce,tt,ae)},e.addHook=function(be,$){typeof $=="function"&&(ie[be]=ie[be]||[],vr(ie[be],$))},e.removeHook=function(be){if(ie[be])return PC(ie[be])},e.removeHooks=function(be){ie[be]&&(ie[be]=[])},e.removeAllHooks=function(){ie={}},e}var nP=LC();//! moment.js
//! version : 2.29.4
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var VC;function ne(){return VC.apply(null,arguments)}function sP(n){VC=n}function Un(n){return n instanceof Array||Object.prototype.toString.call(n)==="[object Array]"}function xo(n){return n!=null&&Object.prototype.toString.call(n)==="[object Object]"}function Ze(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function Au(n){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(n).length===0;var e;for(e in n)if(Ze(n,e))return!1;return!0}function un(n){return n===void 0}function bs(n){return typeof n=="number"||Object.prototype.toString.call(n)==="[object Number]"}function br(n){return n instanceof Date||Object.prototype.toString.call(n)==="[object Date]"}function $C(n,e){var t=[],s,o=n.length;for(s=0;s<o;++s)t.push(e(n[s],s));return t}function js(n,e){for(var t in e)Ze(e,t)&&(n[t]=e[t]);return Ze(e,"toString")&&(n.toString=e.toString),Ze(e,"valueOf")&&(n.valueOf=e.valueOf),n}function Jn(n,e,t,s){return dy(n,e,t,s,!0).utc()}function oP(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function Ve(n){return n._pf==null&&(n._pf=oP()),n._pf}var Pu;Array.prototype.some?Pu=Array.prototype.some:Pu=function(n){var e=Object(this),t=e.length>>>0,s;for(s=0;s<t;s++)if(s in e&&n.call(this,e[s],s,e))return!0;return!1};function Du(n){if(n._isValid==null){var e=Ve(n),t=Pu.call(e.parsedDateParts,function(o){return o!=null}),s=!isNaN(n._d.getTime())&&e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&t);if(n._strict&&(s=s&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0),Object.isFrozen==null||!Object.isFrozen(n))n._isValid=s;else return s}return n._isValid}function al(n){var e=Jn(NaN);return n!=null?js(Ve(e),n):Ve(e).userInvalidated=!0,e}var FC=ne.momentProperties=[],Nu=!1;function Hu(n,e){var t,s,o,r=FC.length;if(un(e._isAMomentObject)||(n._isAMomentObject=e._isAMomentObject),un(e._i)||(n._i=e._i),un(e._f)||(n._f=e._f),un(e._l)||(n._l=e._l),un(e._strict)||(n._strict=e._strict),un(e._tzm)||(n._tzm=e._tzm),un(e._isUTC)||(n._isUTC=e._isUTC),un(e._offset)||(n._offset=e._offset),un(e._pf)||(n._pf=Ve(e)),un(e._locale)||(n._locale=e._locale),r>0)for(t=0;t<r;t++)s=FC[t],o=e[s],un(o)||(n[s]=o);return n}function Rr(n){Hu(this,n),this._d=new Date(n._d!=null?n._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),Nu===!1&&(Nu=!0,ne.updateOffset(this),Nu=!1)}function zn(n){return n instanceof Rr||n!=null&&n._isAMomentObject!=null}function BC(n){ne.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+n)}function In(n,e){var t=!0;return js(function(){if(ne.deprecationHandler!=null&&ne.deprecationHandler(null,n),t){var s=[],o,r,a,l=arguments.length;for(r=0;r<l;r++){if(o="",typeof arguments[r]=="object"){o+=`
[`+r+"] ";for(a in arguments[0])Ze(arguments[0],a)&&(o+=a+": "+arguments[0][a]+", ");o=o.slice(0,-2)}else o=arguments[r];s.push(o)}BC(n+`
Arguments: `+Array.prototype.slice.call(s).join("")+`
`+new Error().stack),t=!1}return e.apply(this,arguments)},e)}var WC={};function UC(n,e){ne.deprecationHandler!=null&&ne.deprecationHandler(n,e),WC[n]||(BC(e),WC[n]=!0)}ne.suppressDeprecationWarnings=!1,ne.deprecationHandler=null;function es(n){return typeof Function<"u"&&n instanceof Function||Object.prototype.toString.call(n)==="[object Function]"}function iP(n){var e,t;for(t in n)Ze(n,t)&&(e=n[t],es(e)?this[t]=e:this["_"+t]=e);this._config=n,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function ku(n,e){var t=js({},n),s;for(s in e)Ze(e,s)&&(xo(n[s])&&xo(e[s])?(t[s]={},js(t[s],n[s]),js(t[s],e[s])):e[s]!=null?t[s]=e[s]:delete t[s]);for(s in n)Ze(n,s)&&!Ze(e,s)&&xo(n[s])&&(t[s]=js({},t[s]));return t}function Lu(n){n!=null&&this.set(n)}var Vu;Object.keys?Vu=Object.keys:Vu=function(n){var e,t=[];for(e in n)Ze(n,e)&&t.push(e);return t};var rP={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function aP(n,e,t){var s=this._calendar[n]||this._calendar.sameElse;return es(s)?s.call(e,t):s}function ts(n,e,t){var s=""+Math.abs(n),o=e-s.length,r=n>=0;return(r?t?"+":"":"-")+Math.pow(10,Math.max(0,o)).toString().substr(1)+s}var $u=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,ll=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Fu={},di={};function Ee(n,e,t,s){var o=s;typeof s=="string"&&(o=function(){return this[s]()}),n&&(di[n]=o),e&&(di[e[0]]=function(){return ts(o.apply(this,arguments),e[1],e[2])}),t&&(di[t]=function(){return this.localeData().ordinal(o.apply(this,arguments),n)})}function lP(n){return n.match(/\[[\s\S]/)?n.replace(/^\[|\]$/g,""):n.replace(/\\/g,"")}function cP(n){var e=n.match($u),t,s;for(t=0,s=e.length;t<s;t++)di[e[t]]?e[t]=di[e[t]]:e[t]=lP(e[t]);return function(o){var r="",a;for(a=0;a<s;a++)r+=es(e[a])?e[a].call(o,n):e[a];return r}}function cl(n,e){return n.isValid()?(e=zC(e,n.localeData()),Fu[e]=Fu[e]||cP(e),Fu[e](n)):n.localeData().invalidDate()}function zC(n,e){var t=5;function s(o){return e.longDateFormat(o)||o}for(ll.lastIndex=0;t>=0&&ll.test(n);)n=n.replace(ll,s),ll.lastIndex=0,t-=1;return n}var hP={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function uP(n){var e=this._longDateFormat[n],t=this._longDateFormat[n.toUpperCase()];return e||!t?e:(this._longDateFormat[n]=t.match($u).map(function(s){return s==="MMMM"||s==="MM"||s==="DD"||s==="dddd"?s.slice(1):s}).join(""),this._longDateFormat[n])}var dP="Invalid date";function fP(){return this._invalidDate}var gP="%d",mP=/\d{1,2}/;function pP(n){return this._ordinal.replace("%d",n)}var wP={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function CP(n,e,t,s){var o=this._relativeTime[t];return es(o)?o(n,e,t,s):o.replace(/%d/i,n)}function yP(n,e){var t=this._relativeTime[n>0?"future":"past"];return es(t)?t(e):t.replace(/%s/i,e)}var Er={};function Xt(n,e){var t=n.toLowerCase();Er[t]=Er[t+"s"]=Er[e]=n}function On(n){return typeof n=="string"?Er[n]||Er[n.toLowerCase()]:void 0}function Bu(n){var e={},t,s;for(s in n)Ze(n,s)&&(t=On(s),t&&(e[t]=n[s]));return e}var YC={};function qt(n,e){YC[n]=e}function SP(n){var e=[],t;for(t in n)Ze(n,t)&&e.push({unit:t,priority:YC[t]});return e.sort(function(s,o){return s.priority-o.priority}),e}function hl(n){return n%4===0&&n%100!==0||n%400===0}function An(n){return n<0?Math.ceil(n)||0:Math.floor(n)}function Ye(n){var e=+n,t=0;return e!==0&&isFinite(e)&&(t=An(e)),t}function fi(n,e){return function(t){return t!=null?(GC(this,n,t),ne.updateOffset(this,e),this):ul(this,n)}}function ul(n,e){return n.isValid()?n._d["get"+(n._isUTC?"UTC":"")+e]():NaN}function GC(n,e,t){n.isValid()&&!isNaN(t)&&(e==="FullYear"&&hl(n.year())&&n.month()===1&&n.date()===29?(t=Ye(t),n._d["set"+(n._isUTC?"UTC":"")+e](t,n.month(),Cl(t,n.month()))):n._d["set"+(n._isUTC?"UTC":"")+e](t))}function vP(n){return n=On(n),es(this[n])?this[n]():this}function bP(n,e){if(typeof n=="object"){n=Bu(n);var t=SP(n),s,o=t.length;for(s=0;s<o;s++)this[t[s].unit](n[t[s].unit])}else if(n=On(n),es(this[n]))return this[n](e);return this}var jC=/\d/,Cn=/\d\d/,KC=/\d{3}/,Wu=/\d{4}/,dl=/[+-]?\d{6}/,ft=/\d\d?/,XC=/\d\d\d\d?/,qC=/\d\d\d\d\d\d?/,fl=/\d{1,3}/,Uu=/\d{1,4}/,gl=/[+-]?\d{1,6}/,gi=/\d+/,ml=/[+-]?\d+/,RP=/Z|[+-]\d\d:?\d\d/gi,pl=/Z|[+-]\d\d(?::?\d\d)?/gi,EP=/[+-]?\d+(\.\d{1,3})?/,xr=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,wl;wl={};function me(n,e,t){wl[n]=es(e)?e:function(s,o){return s&&t?t:e}}function xP(n,e){return Ze(wl,n)?wl[n](e._strict,e._locale):new RegExp(TP(n))}function TP(n){return yn(n.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,s,o,r){return t||s||o||r}))}function yn(n){return n.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var zu={};function it(n,e){var t,s=e,o;for(typeof n=="string"&&(n=[n]),bs(e)&&(s=function(r,a){a[e]=Ye(r)}),o=n.length,t=0;t<o;t++)zu[n[t]]=s}function Tr(n,e){it(n,function(t,s,o,r){o._w=o._w||{},e(t,o._w,o,r)})}function MP(n,e,t){e!=null&&Ze(zu,n)&&zu[n](e,t._a,t,n)}var Zt=0,Rs=1,ns=2,Lt=3,Yn=4,Es=5,To=6,_P=7,IP=8;function OP(n,e){return(n%e+e)%e}var Ot;Array.prototype.indexOf?Ot=Array.prototype.indexOf:Ot=function(n){var e;for(e=0;e<this.length;++e)if(this[e]===n)return e;return-1};function Cl(n,e){if(isNaN(n)||isNaN(e))return NaN;var t=OP(e,12);return n+=(e-t)/12,t===1?hl(n)?29:28:31-t%7%2}Ee("M",["MM",2],"Mo",function(){return this.month()+1}),Ee("MMM",0,0,function(n){return this.localeData().monthsShort(this,n)}),Ee("MMMM",0,0,function(n){return this.localeData().months(this,n)}),Xt("month","M"),qt("month",8),me("M",ft),me("MM",ft,Cn),me("MMM",function(n,e){return e.monthsShortRegex(n)}),me("MMMM",function(n,e){return e.monthsRegex(n)}),it(["M","MM"],function(n,e){e[Rs]=Ye(n)-1}),it(["MMM","MMMM"],function(n,e,t,s){var o=t._locale.monthsParse(n,s,t._strict);o!=null?e[Rs]=o:Ve(t).invalidMonth=n});var AP="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ZC="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),QC=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,PP=xr,DP=xr;function NP(n,e){return n?Un(this._months)?this._months[n.month()]:this._months[(this._months.isFormat||QC).test(e)?"format":"standalone"][n.month()]:Un(this._months)?this._months:this._months.standalone}function HP(n,e){return n?Un(this._monthsShort)?this._monthsShort[n.month()]:this._monthsShort[QC.test(e)?"format":"standalone"][n.month()]:Un(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function kP(n,e,t){var s,o,r,a=n.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],s=0;s<12;++s)r=Jn([2e3,s]),this._shortMonthsParse[s]=this.monthsShort(r,"").toLocaleLowerCase(),this._longMonthsParse[s]=this.months(r,"").toLocaleLowerCase();return t?e==="MMM"?(o=Ot.call(this._shortMonthsParse,a),o!==-1?o:null):(o=Ot.call(this._longMonthsParse,a),o!==-1?o:null):e==="MMM"?(o=Ot.call(this._shortMonthsParse,a),o!==-1?o:(o=Ot.call(this._longMonthsParse,a),o!==-1?o:null)):(o=Ot.call(this._longMonthsParse,a),o!==-1?o:(o=Ot.call(this._shortMonthsParse,a),o!==-1?o:null))}function LP(n,e,t){var s,o,r;if(this._monthsParseExact)return kP.call(this,n,e,t);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),s=0;s<12;s++){if(o=Jn([2e3,s]),t&&!this._longMonthsParse[s]&&(this._longMonthsParse[s]=new RegExp("^"+this.months(o,"").replace(".","")+"$","i"),this._shortMonthsParse[s]=new RegExp("^"+this.monthsShort(o,"").replace(".","")+"$","i")),!t&&!this._monthsParse[s]&&(r="^"+this.months(o,"")+"|^"+this.monthsShort(o,""),this._monthsParse[s]=new RegExp(r.replace(".",""),"i")),t&&e==="MMMM"&&this._longMonthsParse[s].test(n))return s;if(t&&e==="MMM"&&this._shortMonthsParse[s].test(n))return s;if(!t&&this._monthsParse[s].test(n))return s}}function JC(n,e){var t;if(!n.isValid())return n;if(typeof e=="string"){if(/^\d+$/.test(e))e=Ye(e);else if(e=n.localeData().monthsParse(e),!bs(e))return n}return t=Math.min(n.date(),Cl(n.year(),e)),n._d["set"+(n._isUTC?"UTC":"")+"Month"](e,t),n}function ey(n){return n!=null?(JC(this,n),ne.updateOffset(this,!0),this):ul(this,"Month")}function VP(){return Cl(this.year(),this.month())}function $P(n){return this._monthsParseExact?(Ze(this,"_monthsRegex")||ty.call(this),n?this._monthsShortStrictRegex:this._monthsShortRegex):(Ze(this,"_monthsShortRegex")||(this._monthsShortRegex=PP),this._monthsShortStrictRegex&&n?this._monthsShortStrictRegex:this._monthsShortRegex)}function FP(n){return this._monthsParseExact?(Ze(this,"_monthsRegex")||ty.call(this),n?this._monthsStrictRegex:this._monthsRegex):(Ze(this,"_monthsRegex")||(this._monthsRegex=DP),this._monthsStrictRegex&&n?this._monthsStrictRegex:this._monthsRegex)}function ty(){function n(a,l){return l.length-a.length}var e=[],t=[],s=[],o,r;for(o=0;o<12;o++)r=Jn([2e3,o]),e.push(this.monthsShort(r,"")),t.push(this.months(r,"")),s.push(this.months(r,"")),s.push(this.monthsShort(r,""));for(e.sort(n),t.sort(n),s.sort(n),o=0;o<12;o++)e[o]=yn(e[o]),t[o]=yn(t[o]);for(o=0;o<24;o++)s[o]=yn(s[o]);this._monthsRegex=new RegExp("^("+s.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+t.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}Ee("Y",0,0,function(){var n=this.year();return n<=9999?ts(n,4):"+"+n}),Ee(0,["YY",2],0,function(){return this.year()%100}),Ee(0,["YYYY",4],0,"year"),Ee(0,["YYYYY",5],0,"year"),Ee(0,["YYYYYY",6,!0],0,"year"),Xt("year","y"),qt("year",1),me("Y",ml),me("YY",ft,Cn),me("YYYY",Uu,Wu),me("YYYYY",gl,dl),me("YYYYYY",gl,dl),it(["YYYYY","YYYYYY"],Zt),it("YYYY",function(n,e){e[Zt]=n.length===2?ne.parseTwoDigitYear(n):Ye(n)}),it("YY",function(n,e){e[Zt]=ne.parseTwoDigitYear(n)}),it("Y",function(n,e){e[Zt]=parseInt(n,10)});function Mr(n){return hl(n)?366:365}ne.parseTwoDigitYear=function(n){return Ye(n)+(Ye(n)>68?1900:2e3)};var ny=fi("FullYear",!0);function BP(){return hl(this.year())}function WP(n,e,t,s,o,r,a){var l;return n<100&&n>=0?(l=new Date(n+400,e,t,s,o,r,a),isFinite(l.getFullYear())&&l.setFullYear(n)):l=new Date(n,e,t,s,o,r,a),l}function _r(n){var e,t;return n<100&&n>=0?(t=Array.prototype.slice.call(arguments),t[0]=n+400,e=new Date(Date.UTC.apply(null,t)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(n)):e=new Date(Date.UTC.apply(null,arguments)),e}function yl(n,e,t){var s=7+e-t,o=(7+_r(n,0,s).getUTCDay()-e)%7;return-o+s-1}function sy(n,e,t,s,o){var r=(7+t-s)%7,a=yl(n,s,o),l=1+7*(e-1)+r+a,c,h;return l<=0?(c=n-1,h=Mr(c)+l):l>Mr(n)?(c=n+1,h=l-Mr(n)):(c=n,h=l),{year:c,dayOfYear:h}}function Ir(n,e,t){var s=yl(n.year(),e,t),o=Math.floor((n.dayOfYear()-s-1)/7)+1,r,a;return o<1?(a=n.year()-1,r=o+xs(a,e,t)):o>xs(n.year(),e,t)?(r=o-xs(n.year(),e,t),a=n.year()+1):(a=n.year(),r=o),{week:r,year:a}}function xs(n,e,t){var s=yl(n,e,t),o=yl(n+1,e,t);return(Mr(n)-s+o)/7}Ee("w",["ww",2],"wo","week"),Ee("W",["WW",2],"Wo","isoWeek"),Xt("week","w"),Xt("isoWeek","W"),qt("week",5),qt("isoWeek",5),me("w",ft),me("ww",ft,Cn),me("W",ft),me("WW",ft,Cn),Tr(["w","ww","W","WW"],function(n,e,t,s){e[s.substr(0,1)]=Ye(n)});function UP(n){return Ir(n,this._week.dow,this._week.doy).week}var zP={dow:0,doy:6};function YP(){return this._week.dow}function GP(){return this._week.doy}function jP(n){var e=this.localeData().week(this);return n==null?e:this.add((n-e)*7,"d")}function KP(n){var e=Ir(this,1,4).week;return n==null?e:this.add((n-e)*7,"d")}Ee("d",0,"do","day"),Ee("dd",0,0,function(n){return this.localeData().weekdaysMin(this,n)}),Ee("ddd",0,0,function(n){return this.localeData().weekdaysShort(this,n)}),Ee("dddd",0,0,function(n){return this.localeData().weekdays(this,n)}),Ee("e",0,0,"weekday"),Ee("E",0,0,"isoWeekday"),Xt("day","d"),Xt("weekday","e"),Xt("isoWeekday","E"),qt("day",11),qt("weekday",11),qt("isoWeekday",11),me("d",ft),me("e",ft),me("E",ft),me("dd",function(n,e){return e.weekdaysMinRegex(n)}),me("ddd",function(n,e){return e.weekdaysShortRegex(n)}),me("dddd",function(n,e){return e.weekdaysRegex(n)}),Tr(["dd","ddd","dddd"],function(n,e,t,s){var o=t._locale.weekdaysParse(n,s,t._strict);o!=null?e.d=o:Ve(t).invalidWeekday=n}),Tr(["d","e","E"],function(n,e,t,s){e[s]=Ye(n)});function XP(n,e){return typeof n!="string"?n:isNaN(n)?(n=e.weekdaysParse(n),typeof n=="number"?n:null):parseInt(n,10)}function qP(n,e){return typeof n=="string"?e.weekdaysParse(n)%7||7:isNaN(n)?null:n}function Yu(n,e){return n.slice(e,7).concat(n.slice(0,e))}var ZP="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),oy="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),QP="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),JP=xr,eD=xr,tD=xr;function nD(n,e){var t=Un(this._weekdays)?this._weekdays:this._weekdays[n&&n!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return n===!0?Yu(t,this._week.dow):n?t[n.day()]:t}function sD(n){return n===!0?Yu(this._weekdaysShort,this._week.dow):n?this._weekdaysShort[n.day()]:this._weekdaysShort}function oD(n){return n===!0?Yu(this._weekdaysMin,this._week.dow):n?this._weekdaysMin[n.day()]:this._weekdaysMin}function iD(n,e,t){var s,o,r,a=n.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],s=0;s<7;++s)r=Jn([2e3,1]).day(s),this._minWeekdaysParse[s]=this.weekdaysMin(r,"").toLocaleLowerCase(),this._shortWeekdaysParse[s]=this.weekdaysShort(r,"").toLocaleLowerCase(),this._weekdaysParse[s]=this.weekdays(r,"").toLocaleLowerCase();return t?e==="dddd"?(o=Ot.call(this._weekdaysParse,a),o!==-1?o:null):e==="ddd"?(o=Ot.call(this._shortWeekdaysParse,a),o!==-1?o:null):(o=Ot.call(this._minWeekdaysParse,a),o!==-1?o:null):e==="dddd"?(o=Ot.call(this._weekdaysParse,a),o!==-1||(o=Ot.call(this._shortWeekdaysParse,a),o!==-1)?o:(o=Ot.call(this._minWeekdaysParse,a),o!==-1?o:null)):e==="ddd"?(o=Ot.call(this._shortWeekdaysParse,a),o!==-1||(o=Ot.call(this._weekdaysParse,a),o!==-1)?o:(o=Ot.call(this._minWeekdaysParse,a),o!==-1?o:null)):(o=Ot.call(this._minWeekdaysParse,a),o!==-1||(o=Ot.call(this._weekdaysParse,a),o!==-1)?o:(o=Ot.call(this._shortWeekdaysParse,a),o!==-1?o:null))}function rD(n,e,t){var s,o,r;if(this._weekdaysParseExact)return iD.call(this,n,e,t);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),s=0;s<7;s++){if(o=Jn([2e3,1]).day(s),t&&!this._fullWeekdaysParse[s]&&(this._fullWeekdaysParse[s]=new RegExp("^"+this.weekdays(o,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[s]=new RegExp("^"+this.weekdaysShort(o,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[s]=new RegExp("^"+this.weekdaysMin(o,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[s]||(r="^"+this.weekdays(o,"")+"|^"+this.weekdaysShort(o,"")+"|^"+this.weekdaysMin(o,""),this._weekdaysParse[s]=new RegExp(r.replace(".",""),"i")),t&&e==="dddd"&&this._fullWeekdaysParse[s].test(n))return s;if(t&&e==="ddd"&&this._shortWeekdaysParse[s].test(n))return s;if(t&&e==="dd"&&this._minWeekdaysParse[s].test(n))return s;if(!t&&this._weekdaysParse[s].test(n))return s}}function aD(n){if(!this.isValid())return n!=null?this:NaN;var e=this._isUTC?this._d.getUTCDay():this._d.getDay();return n!=null?(n=XP(n,this.localeData()),this.add(n-e,"d")):e}function lD(n){if(!this.isValid())return n!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return n==null?e:this.add(n-e,"d")}function cD(n){if(!this.isValid())return n!=null?this:NaN;if(n!=null){var e=qP(n,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function hD(n){return this._weekdaysParseExact?(Ze(this,"_weekdaysRegex")||Gu.call(this),n?this._weekdaysStrictRegex:this._weekdaysRegex):(Ze(this,"_weekdaysRegex")||(this._weekdaysRegex=JP),this._weekdaysStrictRegex&&n?this._weekdaysStrictRegex:this._weekdaysRegex)}function uD(n){return this._weekdaysParseExact?(Ze(this,"_weekdaysRegex")||Gu.call(this),n?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(Ze(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=eD),this._weekdaysShortStrictRegex&&n?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function dD(n){return this._weekdaysParseExact?(Ze(this,"_weekdaysRegex")||Gu.call(this),n?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(Ze(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=tD),this._weekdaysMinStrictRegex&&n?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function Gu(){function n(u,f){return f.length-u.length}var e=[],t=[],s=[],o=[],r,a,l,c,h;for(r=0;r<7;r++)a=Jn([2e3,1]).day(r),l=yn(this.weekdaysMin(a,"")),c=yn(this.weekdaysShort(a,"")),h=yn(this.weekdays(a,"")),e.push(l),t.push(c),s.push(h),o.push(l),o.push(c),o.push(h);e.sort(n),t.sort(n),s.sort(n),o.sort(n),this._weekdaysRegex=new RegExp("^("+o.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+s.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+t.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function ju(){return this.hours()%12||12}function fD(){return this.hours()||24}Ee("H",["HH",2],0,"hour"),Ee("h",["hh",2],0,ju),Ee("k",["kk",2],0,fD),Ee("hmm",0,0,function(){return""+ju.apply(this)+ts(this.minutes(),2)}),Ee("hmmss",0,0,function(){return""+ju.apply(this)+ts(this.minutes(),2)+ts(this.seconds(),2)}),Ee("Hmm",0,0,function(){return""+this.hours()+ts(this.minutes(),2)}),Ee("Hmmss",0,0,function(){return""+this.hours()+ts(this.minutes(),2)+ts(this.seconds(),2)});function iy(n,e){Ee(n,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}iy("a",!0),iy("A",!1),Xt("hour","h"),qt("hour",13);function ry(n,e){return e._meridiemParse}me("a",ry),me("A",ry),me("H",ft),me("h",ft),me("k",ft),me("HH",ft,Cn),me("hh",ft,Cn),me("kk",ft,Cn),me("hmm",XC),me("hmmss",qC),me("Hmm",XC),me("Hmmss",qC),it(["H","HH"],Lt),it(["k","kk"],function(n,e,t){var s=Ye(n);e[Lt]=s===24?0:s}),it(["a","A"],function(n,e,t){t._isPm=t._locale.isPM(n),t._meridiem=n}),it(["h","hh"],function(n,e,t){e[Lt]=Ye(n),Ve(t).bigHour=!0}),it("hmm",function(n,e,t){var s=n.length-2;e[Lt]=Ye(n.substr(0,s)),e[Yn]=Ye(n.substr(s)),Ve(t).bigHour=!0}),it("hmmss",function(n,e,t){var s=n.length-4,o=n.length-2;e[Lt]=Ye(n.substr(0,s)),e[Yn]=Ye(n.substr(s,2)),e[Es]=Ye(n.substr(o)),Ve(t).bigHour=!0}),it("Hmm",function(n,e,t){var s=n.length-2;e[Lt]=Ye(n.substr(0,s)),e[Yn]=Ye(n.substr(s))}),it("Hmmss",function(n,e,t){var s=n.length-4,o=n.length-2;e[Lt]=Ye(n.substr(0,s)),e[Yn]=Ye(n.substr(s,2)),e[Es]=Ye(n.substr(o))});function gD(n){return(n+"").toLowerCase().charAt(0)==="p"}var mD=/[ap]\.?m?\.?/i,pD=fi("Hours",!0);function wD(n,e,t){return n>11?t?"pm":"PM":t?"am":"AM"}var ay={calendar:rP,longDateFormat:hP,invalidDate:dP,ordinal:gP,dayOfMonthOrdinalParse:mP,relativeTime:wP,months:AP,monthsShort:ZC,week:zP,weekdays:ZP,weekdaysMin:QP,weekdaysShort:oy,meridiemParse:mD},Ct={},Or={},Ar;function CD(n,e){var t,s=Math.min(n.length,e.length);for(t=0;t<s;t+=1)if(n[t]!==e[t])return t;return s}function ly(n){return n&&n.toLowerCase().replace("_","-")}function yD(n){for(var e=0,t,s,o,r;e<n.length;){for(r=ly(n[e]).split("-"),t=r.length,s=ly(n[e+1]),s=s?s.split("-"):null;t>0;){if(o=Sl(r.slice(0,t).join("-")),o)return o;if(s&&s.length>=t&&CD(r,s)>=t-1)break;t--}e++}return Ar}function SD(n){return n.match("^[^/\\\\]*$")!=null}function Sl(n){var e=null,t;if(Ct[n]===void 0&&typeof module<"u"&&module&&module.exports&&SD(n))try{e=Ar._abbr,t=require,t("./locale/"+n),Ks(e)}catch{Ct[n]=null}return Ct[n]}function Ks(n,e){var t;return n&&(un(e)?t=Ts(n):t=Ku(n,e),t?Ar=t:typeof console<"u"&&console.warn&&console.warn("Locale "+n+" not found. Did you forget to load it?")),Ar._abbr}function Ku(n,e){if(e!==null){var t,s=ay;if(e.abbr=n,Ct[n]!=null)UC("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),s=Ct[n]._config;else if(e.parentLocale!=null)if(Ct[e.parentLocale]!=null)s=Ct[e.parentLocale]._config;else if(t=Sl(e.parentLocale),t!=null)s=t._config;else return Or[e.parentLocale]||(Or[e.parentLocale]=[]),Or[e.parentLocale].push({name:n,config:e}),null;return Ct[n]=new Lu(ku(s,e)),Or[n]&&Or[n].forEach(function(o){Ku(o.name,o.config)}),Ks(n),Ct[n]}else return delete Ct[n],null}function vD(n,e){if(e!=null){var t,s,o=ay;Ct[n]!=null&&Ct[n].parentLocale!=null?Ct[n].set(ku(Ct[n]._config,e)):(s=Sl(n),s!=null&&(o=s._config),e=ku(o,e),s==null&&(e.abbr=n),t=new Lu(e),t.parentLocale=Ct[n],Ct[n]=t),Ks(n)}else Ct[n]!=null&&(Ct[n].parentLocale!=null?(Ct[n]=Ct[n].parentLocale,n===Ks()&&Ks(n)):Ct[n]!=null&&delete Ct[n]);return Ct[n]}function Ts(n){var e;if(n&&n._locale&&n._locale._abbr&&(n=n._locale._abbr),!n)return Ar;if(!Un(n)){if(e=Sl(n),e)return e;n=[n]}return yD(n)}function bD(){return Vu(Ct)}function Xu(n){var e,t=n._a;return t&&Ve(n).overflow===-2&&(e=t[Rs]<0||t[Rs]>11?Rs:t[ns]<1||t[ns]>Cl(t[Zt],t[Rs])?ns:t[Lt]<0||t[Lt]>24||t[Lt]===24&&(t[Yn]!==0||t[Es]!==0||t[To]!==0)?Lt:t[Yn]<0||t[Yn]>59?Yn:t[Es]<0||t[Es]>59?Es:t[To]<0||t[To]>999?To:-1,Ve(n)._overflowDayOfYear&&(e<Zt||e>ns)&&(e=ns),Ve(n)._overflowWeeks&&e===-1&&(e=_P),Ve(n)._overflowWeekday&&e===-1&&(e=IP),Ve(n).overflow=e),n}var RD=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,ED=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,xD=/Z|[+-]\d\d(?::?\d\d)?/,vl=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],qu=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],TD=/^\/?Date\((-?\d+)/i,MD=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,_D={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function cy(n){var e,t,s=n._i,o=RD.exec(s)||ED.exec(s),r,a,l,c,h=vl.length,u=qu.length;if(o){for(Ve(n).iso=!0,e=0,t=h;e<t;e++)if(vl[e][1].exec(o[1])){a=vl[e][0],r=vl[e][2]!==!1;break}if(a==null){n._isValid=!1;return}if(o[3]){for(e=0,t=u;e<t;e++)if(qu[e][1].exec(o[3])){l=(o[2]||" ")+qu[e][0];break}if(l==null){n._isValid=!1;return}}if(!r&&l!=null){n._isValid=!1;return}if(o[4])if(xD.exec(o[4]))c="Z";else{n._isValid=!1;return}n._f=a+(l||"")+(c||""),Qu(n)}else n._isValid=!1}function ID(n,e,t,s,o,r){var a=[OD(n),ZC.indexOf(e),parseInt(t,10),parseInt(s,10),parseInt(o,10)];return r&&a.push(parseInt(r,10)),a}function OD(n){var e=parseInt(n,10);return e<=49?2e3+e:e<=999?1900+e:e}function AD(n){return n.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function PD(n,e,t){if(n){var s=oy.indexOf(n),o=new Date(e[0],e[1],e[2]).getDay();if(s!==o)return Ve(t).weekdayMismatch=!0,t._isValid=!1,!1}return!0}function DD(n,e,t){if(n)return _D[n];if(e)return 0;var s=parseInt(t,10),o=s%100,r=(s-o)/100;return r*60+o}function hy(n){var e=MD.exec(AD(n._i)),t;if(e){if(t=ID(e[4],e[3],e[2],e[5],e[6],e[7]),!PD(e[1],t,n))return;n._a=t,n._tzm=DD(e[8],e[9],e[10]),n._d=_r.apply(null,n._a),n._d.setUTCMinutes(n._d.getUTCMinutes()-n._tzm),Ve(n).rfc2822=!0}else n._isValid=!1}function ND(n){var e=TD.exec(n._i);if(e!==null){n._d=new Date(+e[1]);return}if(cy(n),n._isValid===!1)delete n._isValid;else return;if(hy(n),n._isValid===!1)delete n._isValid;else return;n._strict?n._isValid=!1:ne.createFromInputFallback(n)}ne.createFromInputFallback=In("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(n){n._d=new Date(n._i+(n._useUTC?" UTC":""))});function mi(n,e,t){return n??e??t}function HD(n){var e=new Date(ne.now());return n._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function Zu(n){var e,t,s=[],o,r,a;if(!n._d){for(o=HD(n),n._w&&n._a[ns]==null&&n._a[Rs]==null&&kD(n),n._dayOfYear!=null&&(a=mi(n._a[Zt],o[Zt]),(n._dayOfYear>Mr(a)||n._dayOfYear===0)&&(Ve(n)._overflowDayOfYear=!0),t=_r(a,0,n._dayOfYear),n._a[Rs]=t.getUTCMonth(),n._a[ns]=t.getUTCDate()),e=0;e<3&&n._a[e]==null;++e)n._a[e]=s[e]=o[e];for(;e<7;e++)n._a[e]=s[e]=n._a[e]==null?e===2?1:0:n._a[e];n._a[Lt]===24&&n._a[Yn]===0&&n._a[Es]===0&&n._a[To]===0&&(n._nextDay=!0,n._a[Lt]=0),n._d=(n._useUTC?_r:WP).apply(null,s),r=n._useUTC?n._d.getUTCDay():n._d.getDay(),n._tzm!=null&&n._d.setUTCMinutes(n._d.getUTCMinutes()-n._tzm),n._nextDay&&(n._a[Lt]=24),n._w&&typeof n._w.d<"u"&&n._w.d!==r&&(Ve(n).weekdayMismatch=!0)}}function kD(n){var e,t,s,o,r,a,l,c,h;e=n._w,e.GG!=null||e.W!=null||e.E!=null?(r=1,a=4,t=mi(e.GG,n._a[Zt],Ir(gt(),1,4).year),s=mi(e.W,1),o=mi(e.E,1),(o<1||o>7)&&(c=!0)):(r=n._locale._week.dow,a=n._locale._week.doy,h=Ir(gt(),r,a),t=mi(e.gg,n._a[Zt],h.year),s=mi(e.w,h.week),e.d!=null?(o=e.d,(o<0||o>6)&&(c=!0)):e.e!=null?(o=e.e+r,(e.e<0||e.e>6)&&(c=!0)):o=r),s<1||s>xs(t,r,a)?Ve(n)._overflowWeeks=!0:c!=null?Ve(n)._overflowWeekday=!0:(l=sy(t,s,o,r,a),n._a[Zt]=l.year,n._dayOfYear=l.dayOfYear)}ne.ISO_8601=function(){},ne.RFC_2822=function(){};function Qu(n){if(n._f===ne.ISO_8601){cy(n);return}if(n._f===ne.RFC_2822){hy(n);return}n._a=[],Ve(n).empty=!0;var e=""+n._i,t,s,o,r,a,l=e.length,c=0,h,u;for(o=zC(n._f,n._locale).match($u)||[],u=o.length,t=0;t<u;t++)r=o[t],s=(e.match(xP(r,n))||[])[0],s&&(a=e.substr(0,e.indexOf(s)),a.length>0&&Ve(n).unusedInput.push(a),e=e.slice(e.indexOf(s)+s.length),c+=s.length),di[r]?(s?Ve(n).empty=!1:Ve(n).unusedTokens.push(r),MP(r,s,n)):n._strict&&!s&&Ve(n).unusedTokens.push(r);Ve(n).charsLeftOver=l-c,e.length>0&&Ve(n).unusedInput.push(e),n._a[Lt]<=12&&Ve(n).bigHour===!0&&n._a[Lt]>0&&(Ve(n).bigHour=void 0),Ve(n).parsedDateParts=n._a.slice(0),Ve(n).meridiem=n._meridiem,n._a[Lt]=LD(n._locale,n._a[Lt],n._meridiem),h=Ve(n).era,h!==null&&(n._a[Zt]=n._locale.erasConvertYear(h,n._a[Zt])),Zu(n),Xu(n)}function LD(n,e,t){var s;return t==null?e:n.meridiemHour!=null?n.meridiemHour(e,t):(n.isPM!=null&&(s=n.isPM(t),s&&e<12&&(e+=12),!s&&e===12&&(e=0)),e)}function VD(n){var e,t,s,o,r,a,l=!1,c=n._f.length;if(c===0){Ve(n).invalidFormat=!0,n._d=new Date(NaN);return}for(o=0;o<c;o++)r=0,a=!1,e=Hu({},n),n._useUTC!=null&&(e._useUTC=n._useUTC),e._f=n._f[o],Qu(e),Du(e)&&(a=!0),r+=Ve(e).charsLeftOver,r+=Ve(e).unusedTokens.length*10,Ve(e).score=r,l?r<s&&(s=r,t=e):(s==null||r<s||a)&&(s=r,t=e,a&&(l=!0));js(n,t||e)}function $D(n){if(!n._d){var e=Bu(n._i),t=e.day===void 0?e.date:e.day;n._a=$C([e.year,e.month,t,e.hour,e.minute,e.second,e.millisecond],function(s){return s&&parseInt(s,10)}),Zu(n)}}function FD(n){var e=new Rr(Xu(uy(n)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function uy(n){var e=n._i,t=n._f;return n._locale=n._locale||Ts(n._l),e===null||t===void 0&&e===""?al({nullInput:!0}):(typeof e=="string"&&(n._i=e=n._locale.preparse(e)),zn(e)?new Rr(Xu(e)):(br(e)?n._d=e:Un(t)?VD(n):t?Qu(n):BD(n),Du(n)||(n._d=null),n))}function BD(n){var e=n._i;un(e)?n._d=new Date(ne.now()):br(e)?n._d=new Date(e.valueOf()):typeof e=="string"?ND(n):Un(e)?(n._a=$C(e.slice(0),function(t){return parseInt(t,10)}),Zu(n)):xo(e)?$D(n):bs(e)?n._d=new Date(e):ne.createFromInputFallback(n)}function dy(n,e,t,s,o){var r={};return(e===!0||e===!1)&&(s=e,e=void 0),(t===!0||t===!1)&&(s=t,t=void 0),(xo(n)&&Au(n)||Un(n)&&n.length===0)&&(n=void 0),r._isAMomentObject=!0,r._useUTC=r._isUTC=o,r._l=t,r._i=n,r._f=e,r._strict=s,FD(r)}function gt(n,e,t,s){return dy(n,e,t,s,!1)}var WD=In("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var n=gt.apply(null,arguments);return this.isValid()&&n.isValid()?n<this?this:n:al()}),UD=In("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var n=gt.apply(null,arguments);return this.isValid()&&n.isValid()?n>this?this:n:al()});function fy(n,e){var t,s;if(e.length===1&&Un(e[0])&&(e=e[0]),!e.length)return gt();for(t=e[0],s=1;s<e.length;++s)(!e[s].isValid()||e[s][n](t))&&(t=e[s]);return t}function zD(){var n=[].slice.call(arguments,0);return fy("isBefore",n)}function YD(){var n=[].slice.call(arguments,0);return fy("isAfter",n)}var GD=function(){return Date.now?Date.now():+new Date},Pr=["year","quarter","month","week","day","hour","minute","second","millisecond"];function jD(n){var e,t=!1,s,o=Pr.length;for(e in n)if(Ze(n,e)&&!(Ot.call(Pr,e)!==-1&&(n[e]==null||!isNaN(n[e]))))return!1;for(s=0;s<o;++s)if(n[Pr[s]]){if(t)return!1;parseFloat(n[Pr[s]])!==Ye(n[Pr[s]])&&(t=!0)}return!0}function KD(){return this._isValid}function XD(){return Gn(NaN)}function bl(n){var e=Bu(n),t=e.year||0,s=e.quarter||0,o=e.month||0,r=e.week||e.isoWeek||0,a=e.day||0,l=e.hour||0,c=e.minute||0,h=e.second||0,u=e.millisecond||0;this._isValid=jD(e),this._milliseconds=+u+h*1e3+c*6e4+l*1e3*60*60,this._days=+a+r*7,this._months=+o+s*3+t*12,this._data={},this._locale=Ts(),this._bubble()}function Rl(n){return n instanceof bl}function Ju(n){return n<0?Math.round(-1*n)*-1:Math.round(n)}function qD(n,e,t){var s=Math.min(n.length,e.length),o=Math.abs(n.length-e.length),r=0,a;for(a=0;a<s;a++)(t&&n[a]!==e[a]||!t&&Ye(n[a])!==Ye(e[a]))&&r++;return r+o}function gy(n,e){Ee(n,0,0,function(){var t=this.utcOffset(),s="+";return t<0&&(t=-t,s="-"),s+ts(~~(t/60),2)+e+ts(~~t%60,2)})}gy("Z",":"),gy("ZZ",""),me("Z",pl),me("ZZ",pl),it(["Z","ZZ"],function(n,e,t){t._useUTC=!0,t._tzm=ed(pl,n)});var ZD=/([\+\-]|\d\d)/gi;function ed(n,e){var t=(e||"").match(n),s,o,r;return t===null?null:(s=t[t.length-1]||[],o=(s+"").match(ZD)||["-",0,0],r=+(o[1]*60)+Ye(o[2]),r===0?0:o[0]==="+"?r:-r)}function td(n,e){var t,s;return e._isUTC?(t=e.clone(),s=(zn(n)||br(n)?n.valueOf():gt(n).valueOf())-t.valueOf(),t._d.setTime(t._d.valueOf()+s),ne.updateOffset(t,!1),t):gt(n).local()}function nd(n){return-Math.round(n._d.getTimezoneOffset())}ne.updateOffset=function(){};function QD(n,e,t){var s=this._offset||0,o;if(!this.isValid())return n!=null?this:NaN;if(n!=null){if(typeof n=="string"){if(n=ed(pl,n),n===null)return this}else Math.abs(n)<16&&!t&&(n=n*60);return!this._isUTC&&e&&(o=nd(this)),this._offset=n,this._isUTC=!0,o!=null&&this.add(o,"m"),s!==n&&(!e||this._changeInProgress?Cy(this,Gn(n-s,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,ne.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?s:nd(this)}function JD(n,e){return n!=null?(typeof n!="string"&&(n=-n),this.utcOffset(n,e),this):-this.utcOffset()}function eN(n){return this.utcOffset(0,n)}function tN(n){return this._isUTC&&(this.utcOffset(0,n),this._isUTC=!1,n&&this.subtract(nd(this),"m")),this}function nN(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var n=ed(RP,this._i);n!=null?this.utcOffset(n):this.utcOffset(0,!0)}return this}function sN(n){return this.isValid()?(n=n?gt(n).utcOffset():0,(this.utcOffset()-n)%60===0):!1}function oN(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function iN(){if(!un(this._isDSTShifted))return this._isDSTShifted;var n={},e;return Hu(n,this),n=uy(n),n._a?(e=n._isUTC?Jn(n._a):gt(n._a),this._isDSTShifted=this.isValid()&&qD(n._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function rN(){return this.isValid()?!this._isUTC:!1}function aN(){return this.isValid()?this._isUTC:!1}function my(){return this.isValid()?this._isUTC&&this._offset===0:!1}var lN=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,cN=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Gn(n,e){var t=n,s=null,o,r,a;return Rl(n)?t={ms:n._milliseconds,d:n._days,M:n._months}:bs(n)||!isNaN(+n)?(t={},e?t[e]=+n:t.milliseconds=+n):(s=lN.exec(n))?(o=s[1]==="-"?-1:1,t={y:0,d:Ye(s[ns])*o,h:Ye(s[Lt])*o,m:Ye(s[Yn])*o,s:Ye(s[Es])*o,ms:Ye(Ju(s[To]*1e3))*o}):(s=cN.exec(n))?(o=s[1]==="-"?-1:1,t={y:Mo(s[2],o),M:Mo(s[3],o),w:Mo(s[4],o),d:Mo(s[5],o),h:Mo(s[6],o),m:Mo(s[7],o),s:Mo(s[8],o)}):t==null?t={}:typeof t=="object"&&("from"in t||"to"in t)&&(a=hN(gt(t.from),gt(t.to)),t={},t.ms=a.milliseconds,t.M=a.months),r=new bl(t),Rl(n)&&Ze(n,"_locale")&&(r._locale=n._locale),Rl(n)&&Ze(n,"_isValid")&&(r._isValid=n._isValid),r}Gn.fn=bl.prototype,Gn.invalid=XD;function Mo(n,e){var t=n&&parseFloat(n.replace(",","."));return(isNaN(t)?0:t)*e}function py(n,e){var t={};return t.months=e.month()-n.month()+(e.year()-n.year())*12,n.clone().add(t.months,"M").isAfter(e)&&--t.months,t.milliseconds=+e-+n.clone().add(t.months,"M"),t}function hN(n,e){var t;return n.isValid()&&e.isValid()?(e=td(e,n),n.isBefore(e)?t=py(n,e):(t=py(e,n),t.milliseconds=-t.milliseconds,t.months=-t.months),t):{milliseconds:0,months:0}}function wy(n,e){return function(t,s){var o,r;return s!==null&&!isNaN(+s)&&(UC(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),r=t,t=s,s=r),o=Gn(t,s),Cy(this,o,n),this}}function Cy(n,e,t,s){var o=e._milliseconds,r=Ju(e._days),a=Ju(e._months);n.isValid()&&(s=s??!0,a&&JC(n,ul(n,"Month")+a*t),r&&GC(n,"Date",ul(n,"Date")+r*t),o&&n._d.setTime(n._d.valueOf()+o*t),s&&ne.updateOffset(n,r||a))}var uN=wy(1,"add"),dN=wy(-1,"subtract");function yy(n){return typeof n=="string"||n instanceof String}function fN(n){return zn(n)||br(n)||yy(n)||bs(n)||mN(n)||gN(n)||n===null||n===void 0}function gN(n){var e=xo(n)&&!Au(n),t=!1,s=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],o,r,a=s.length;for(o=0;o<a;o+=1)r=s[o],t=t||Ze(n,r);return e&&t}function mN(n){var e=Un(n),t=!1;return e&&(t=n.filter(function(s){return!bs(s)&&yy(n)}).length===0),e&&t}function pN(n){var e=xo(n)&&!Au(n),t=!1,s=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],o,r;for(o=0;o<s.length;o+=1)r=s[o],t=t||Ze(n,r);return e&&t}function wN(n,e){var t=n.diff(e,"days",!0);return t<-6?"sameElse":t<-1?"lastWeek":t<0?"lastDay":t<1?"sameDay":t<2?"nextDay":t<7?"nextWeek":"sameElse"}function CN(n,e){arguments.length===1&&(arguments[0]?fN(arguments[0])?(n=arguments[0],e=void 0):pN(arguments[0])&&(e=arguments[0],n=void 0):(n=void 0,e=void 0));var t=n||gt(),s=td(t,this).startOf("day"),o=ne.calendarFormat(this,s)||"sameElse",r=e&&(es(e[o])?e[o].call(this,t):e[o]);return this.format(r||this.localeData().calendar(o,this,gt(t)))}function yN(){return new Rr(this)}function SN(n,e){var t=zn(n)?n:gt(n);return this.isValid()&&t.isValid()?(e=On(e)||"millisecond",e==="millisecond"?this.valueOf()>t.valueOf():t.valueOf()<this.clone().startOf(e).valueOf()):!1}function vN(n,e){var t=zn(n)?n:gt(n);return this.isValid()&&t.isValid()?(e=On(e)||"millisecond",e==="millisecond"?this.valueOf()<t.valueOf():this.clone().endOf(e).valueOf()<t.valueOf()):!1}function bN(n,e,t,s){var o=zn(n)?n:gt(n),r=zn(e)?e:gt(e);return this.isValid()&&o.isValid()&&r.isValid()?(s=s||"()",(s[0]==="("?this.isAfter(o,t):!this.isBefore(o,t))&&(s[1]===")"?this.isBefore(r,t):!this.isAfter(r,t))):!1}function RN(n,e){var t=zn(n)?n:gt(n),s;return this.isValid()&&t.isValid()?(e=On(e)||"millisecond",e==="millisecond"?this.valueOf()===t.valueOf():(s=t.valueOf(),this.clone().startOf(e).valueOf()<=s&&s<=this.clone().endOf(e).valueOf())):!1}function EN(n,e){return this.isSame(n,e)||this.isAfter(n,e)}function xN(n,e){return this.isSame(n,e)||this.isBefore(n,e)}function TN(n,e,t){var s,o,r;if(!this.isValid())return NaN;if(s=td(n,this),!s.isValid())return NaN;switch(o=(s.utcOffset()-this.utcOffset())*6e4,e=On(e),e){case"year":r=El(this,s)/12;break;case"month":r=El(this,s);break;case"quarter":r=El(this,s)/3;break;case"second":r=(this-s)/1e3;break;case"minute":r=(this-s)/6e4;break;case"hour":r=(this-s)/36e5;break;case"day":r=(this-s-o)/864e5;break;case"week":r=(this-s-o)/6048e5;break;default:r=this-s}return t?r:An(r)}function El(n,e){if(n.date()<e.date())return-El(e,n);var t=(e.year()-n.year())*12+(e.month()-n.month()),s=n.clone().add(t,"months"),o,r;return e-s<0?(o=n.clone().add(t-1,"months"),r=(e-s)/(s-o)):(o=n.clone().add(t+1,"months"),r=(e-s)/(o-s)),-(t+r)||0}ne.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",ne.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function MN(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function _N(n){if(!this.isValid())return null;var e=n!==!0,t=e?this.clone().utc():this;return t.year()<0||t.year()>9999?cl(t,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):es(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",cl(t,"Z")):cl(t,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function IN(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var n="moment",e="",t,s,o,r;return this.isLocal()||(n=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),t="["+n+'("]',s=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",o="-MM-DD[T]HH:mm:ss.SSS",r=e+'[")]',this.format(t+s+o+r)}function ON(n){n||(n=this.isUtc()?ne.defaultFormatUtc:ne.defaultFormat);var e=cl(this,n);return this.localeData().postformat(e)}function AN(n,e){return this.isValid()&&(zn(n)&&n.isValid()||gt(n).isValid())?Gn({to:this,from:n}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function PN(n){return this.from(gt(),n)}function DN(n,e){return this.isValid()&&(zn(n)&&n.isValid()||gt(n).isValid())?Gn({from:this,to:n}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function NN(n){return this.to(gt(),n)}function Sy(n){var e;return n===void 0?this._locale._abbr:(e=Ts(n),e!=null&&(this._locale=e),this)}var vy=In("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(n){return n===void 0?this.localeData():this.locale(n)});function by(){return this._locale}var xl=1e3,pi=60*xl,Tl=60*pi,Ry=(365*400+97)*24*Tl;function wi(n,e){return(n%e+e)%e}function Ey(n,e,t){return n<100&&n>=0?new Date(n+400,e,t)-Ry:new Date(n,e,t).valueOf()}function xy(n,e,t){return n<100&&n>=0?Date.UTC(n+400,e,t)-Ry:Date.UTC(n,e,t)}function HN(n){var e,t;if(n=On(n),n===void 0||n==="millisecond"||!this.isValid())return this;switch(t=this._isUTC?xy:Ey,n){case"year":e=t(this.year(),0,1);break;case"quarter":e=t(this.year(),this.month()-this.month()%3,1);break;case"month":e=t(this.year(),this.month(),1);break;case"week":e=t(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=t(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=t(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=wi(e+(this._isUTC?0:this.utcOffset()*pi),Tl);break;case"minute":e=this._d.valueOf(),e-=wi(e,pi);break;case"second":e=this._d.valueOf(),e-=wi(e,xl);break}return this._d.setTime(e),ne.updateOffset(this,!0),this}function kN(n){var e,t;if(n=On(n),n===void 0||n==="millisecond"||!this.isValid())return this;switch(t=this._isUTC?xy:Ey,n){case"year":e=t(this.year()+1,0,1)-1;break;case"quarter":e=t(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=t(this.year(),this.month()+1,1)-1;break;case"week":e=t(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=t(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=t(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=Tl-wi(e+(this._isUTC?0:this.utcOffset()*pi),Tl)-1;break;case"minute":e=this._d.valueOf(),e+=pi-wi(e,pi)-1;break;case"second":e=this._d.valueOf(),e+=xl-wi(e,xl)-1;break}return this._d.setTime(e),ne.updateOffset(this,!0),this}function LN(){return this._d.valueOf()-(this._offset||0)*6e4}function VN(){return Math.floor(this.valueOf()/1e3)}function $N(){return new Date(this.valueOf())}function FN(){var n=this;return[n.year(),n.month(),n.date(),n.hour(),n.minute(),n.second(),n.millisecond()]}function BN(){var n=this;return{years:n.year(),months:n.month(),date:n.date(),hours:n.hours(),minutes:n.minutes(),seconds:n.seconds(),milliseconds:n.milliseconds()}}function WN(){return this.isValid()?this.toISOString():null}function UN(){return Du(this)}function zN(){return js({},Ve(this))}function YN(){return Ve(this).overflow}function GN(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Ee("N",0,0,"eraAbbr"),Ee("NN",0,0,"eraAbbr"),Ee("NNN",0,0,"eraAbbr"),Ee("NNNN",0,0,"eraName"),Ee("NNNNN",0,0,"eraNarrow"),Ee("y",["y",1],"yo","eraYear"),Ee("y",["yy",2],0,"eraYear"),Ee("y",["yyy",3],0,"eraYear"),Ee("y",["yyyy",4],0,"eraYear"),me("N",sd),me("NN",sd),me("NNN",sd),me("NNNN",sH),me("NNNNN",oH),it(["N","NN","NNN","NNNN","NNNNN"],function(n,e,t,s){var o=t._locale.erasParse(n,s,t._strict);o?Ve(t).era=o:Ve(t).invalidEra=n}),me("y",gi),me("yy",gi),me("yyy",gi),me("yyyy",gi),me("yo",iH),it(["y","yy","yyy","yyyy"],Zt),it(["yo"],function(n,e,t,s){var o;t._locale._eraYearOrdinalRegex&&(o=n.match(t._locale._eraYearOrdinalRegex)),t._locale.eraYearOrdinalParse?e[Zt]=t._locale.eraYearOrdinalParse(n,o):e[Zt]=parseInt(n,10)});function jN(n,e){var t,s,o,r=this._eras||Ts("en")._eras;for(t=0,s=r.length;t<s;++t){switch(typeof r[t].since){case"string":o=ne(r[t].since).startOf("day"),r[t].since=o.valueOf();break}switch(typeof r[t].until){case"undefined":r[t].until=1/0;break;case"string":o=ne(r[t].until).startOf("day").valueOf(),r[t].until=o.valueOf();break}}return r}function KN(n,e,t){var s,o,r=this.eras(),a,l,c;for(n=n.toUpperCase(),s=0,o=r.length;s<o;++s)if(a=r[s].name.toUpperCase(),l=r[s].abbr.toUpperCase(),c=r[s].narrow.toUpperCase(),t)switch(e){case"N":case"NN":case"NNN":if(l===n)return r[s];break;case"NNNN":if(a===n)return r[s];break;case"NNNNN":if(c===n)return r[s];break}else if([a,l,c].indexOf(n)>=0)return r[s]}function XN(n,e){var t=n.since<=n.until?1:-1;return e===void 0?ne(n.since).year():ne(n.since).year()+(e-n.offset)*t}function qN(){var n,e,t,s=this.localeData().eras();for(n=0,e=s.length;n<e;++n)if(t=this.clone().startOf("day").valueOf(),s[n].since<=t&&t<=s[n].until||s[n].until<=t&&t<=s[n].since)return s[n].name;return""}function ZN(){var n,e,t,s=this.localeData().eras();for(n=0,e=s.length;n<e;++n)if(t=this.clone().startOf("day").valueOf(),s[n].since<=t&&t<=s[n].until||s[n].until<=t&&t<=s[n].since)return s[n].narrow;return""}function QN(){var n,e,t,s=this.localeData().eras();for(n=0,e=s.length;n<e;++n)if(t=this.clone().startOf("day").valueOf(),s[n].since<=t&&t<=s[n].until||s[n].until<=t&&t<=s[n].since)return s[n].abbr;return""}function JN(){var n,e,t,s,o=this.localeData().eras();for(n=0,e=o.length;n<e;++n)if(t=o[n].since<=o[n].until?1:-1,s=this.clone().startOf("day").valueOf(),o[n].since<=s&&s<=o[n].until||o[n].until<=s&&s<=o[n].since)return(this.year()-ne(o[n].since).year())*t+o[n].offset;return this.year()}function eH(n){return Ze(this,"_erasNameRegex")||od.call(this),n?this._erasNameRegex:this._erasRegex}function tH(n){return Ze(this,"_erasAbbrRegex")||od.call(this),n?this._erasAbbrRegex:this._erasRegex}function nH(n){return Ze(this,"_erasNarrowRegex")||od.call(this),n?this._erasNarrowRegex:this._erasRegex}function sd(n,e){return e.erasAbbrRegex(n)}function sH(n,e){return e.erasNameRegex(n)}function oH(n,e){return e.erasNarrowRegex(n)}function iH(n,e){return e._eraYearOrdinalRegex||gi}function od(){var n=[],e=[],t=[],s=[],o,r,a=this.eras();for(o=0,r=a.length;o<r;++o)e.push(yn(a[o].name)),n.push(yn(a[o].abbr)),t.push(yn(a[o].narrow)),s.push(yn(a[o].name)),s.push(yn(a[o].abbr)),s.push(yn(a[o].narrow));this._erasRegex=new RegExp("^("+s.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+t.join("|")+")","i")}Ee(0,["gg",2],0,function(){return this.weekYear()%100}),Ee(0,["GG",2],0,function(){return this.isoWeekYear()%100});function Ml(n,e){Ee(0,[n,n.length],0,e)}Ml("gggg","weekYear"),Ml("ggggg","weekYear"),Ml("GGGG","isoWeekYear"),Ml("GGGGG","isoWeekYear"),Xt("weekYear","gg"),Xt("isoWeekYear","GG"),qt("weekYear",1),qt("isoWeekYear",1),me("G",ml),me("g",ml),me("GG",ft,Cn),me("gg",ft,Cn),me("GGGG",Uu,Wu),me("gggg",Uu,Wu),me("GGGGG",gl,dl),me("ggggg",gl,dl),Tr(["gggg","ggggg","GGGG","GGGGG"],function(n,e,t,s){e[s.substr(0,2)]=Ye(n)}),Tr(["gg","GG"],function(n,e,t,s){e[s]=ne.parseTwoDigitYear(n)});function rH(n){return Ty.call(this,n,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function aH(n){return Ty.call(this,n,this.isoWeek(),this.isoWeekday(),1,4)}function lH(){return xs(this.year(),1,4)}function cH(){return xs(this.isoWeekYear(),1,4)}function hH(){var n=this.localeData()._week;return xs(this.year(),n.dow,n.doy)}function uH(){var n=this.localeData()._week;return xs(this.weekYear(),n.dow,n.doy)}function Ty(n,e,t,s,o){var r;return n==null?Ir(this,s,o).year:(r=xs(n,s,o),e>r&&(e=r),dH.call(this,n,e,t,s,o))}function dH(n,e,t,s,o){var r=sy(n,e,t,s,o),a=_r(r.year,0,r.dayOfYear);return this.year(a.getUTCFullYear()),this.month(a.getUTCMonth()),this.date(a.getUTCDate()),this}Ee("Q",0,"Qo","quarter"),Xt("quarter","Q"),qt("quarter",7),me("Q",jC),it("Q",function(n,e){e[Rs]=(Ye(n)-1)*3});function fH(n){return n==null?Math.ceil((this.month()+1)/3):this.month((n-1)*3+this.month()%3)}Ee("D",["DD",2],"Do","date"),Xt("date","D"),qt("date",9),me("D",ft),me("DD",ft,Cn),me("Do",function(n,e){return n?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient}),it(["D","DD"],ns),it("Do",function(n,e){e[ns]=Ye(n.match(ft)[0])});var My=fi("Date",!0);Ee("DDD",["DDDD",3],"DDDo","dayOfYear"),Xt("dayOfYear","DDD"),qt("dayOfYear",4),me("DDD",fl),me("DDDD",KC),it(["DDD","DDDD"],function(n,e,t){t._dayOfYear=Ye(n)});function gH(n){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return n==null?e:this.add(n-e,"d")}Ee("m",["mm",2],0,"minute"),Xt("minute","m"),qt("minute",14),me("m",ft),me("mm",ft,Cn),it(["m","mm"],Yn);var mH=fi("Minutes",!1);Ee("s",["ss",2],0,"second"),Xt("second","s"),qt("second",15),me("s",ft),me("ss",ft,Cn),it(["s","ss"],Es);var pH=fi("Seconds",!1);Ee("S",0,0,function(){return~~(this.millisecond()/100)}),Ee(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),Ee(0,["SSS",3],0,"millisecond"),Ee(0,["SSSS",4],0,function(){return this.millisecond()*10}),Ee(0,["SSSSS",5],0,function(){return this.millisecond()*100}),Ee(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3}),Ee(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4}),Ee(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5}),Ee(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6}),Xt("millisecond","ms"),qt("millisecond",16),me("S",fl,jC),me("SS",fl,Cn),me("SSS",fl,KC);var Xs,_y;for(Xs="SSSS";Xs.length<=9;Xs+="S")me(Xs,gi);function wH(n,e){e[To]=Ye(("0."+n)*1e3)}for(Xs="S";Xs.length<=9;Xs+="S")it(Xs,wH);_y=fi("Milliseconds",!1),Ee("z",0,0,"zoneAbbr"),Ee("zz",0,0,"zoneName");function CH(){return this._isUTC?"UTC":""}function yH(){return this._isUTC?"Coordinated Universal Time":""}var re=Rr.prototype;re.add=uN,re.calendar=CN,re.clone=yN,re.diff=TN,re.endOf=kN,re.format=ON,re.from=AN,re.fromNow=PN,re.to=DN,re.toNow=NN,re.get=vP,re.invalidAt=YN,re.isAfter=SN,re.isBefore=vN,re.isBetween=bN,re.isSame=RN,re.isSameOrAfter=EN,re.isSameOrBefore=xN,re.isValid=UN,re.lang=vy,re.locale=Sy,re.localeData=by,re.max=UD,re.min=WD,re.parsingFlags=zN,re.set=bP,re.startOf=HN,re.subtract=dN,re.toArray=FN,re.toObject=BN,re.toDate=$N,re.toISOString=_N,re.inspect=IN,typeof Symbol<"u"&&Symbol.for!=null&&(re[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"}),re.toJSON=WN,re.toString=MN,re.unix=VN,re.valueOf=LN,re.creationData=GN,re.eraName=qN,re.eraNarrow=ZN,re.eraAbbr=QN,re.eraYear=JN,re.year=ny,re.isLeapYear=BP,re.weekYear=rH,re.isoWeekYear=aH,re.quarter=re.quarters=fH,re.month=ey,re.daysInMonth=VP,re.week=re.weeks=jP,re.isoWeek=re.isoWeeks=KP,re.weeksInYear=hH,re.weeksInWeekYear=uH,re.isoWeeksInYear=lH,re.isoWeeksInISOWeekYear=cH,re.date=My,re.day=re.days=aD,re.weekday=lD,re.isoWeekday=cD,re.dayOfYear=gH,re.hour=re.hours=pD,re.minute=re.minutes=mH,re.second=re.seconds=pH,re.millisecond=re.milliseconds=_y,re.utcOffset=QD,re.utc=eN,re.local=tN,re.parseZone=nN,re.hasAlignedHourOffset=sN,re.isDST=oN,re.isLocal=rN,re.isUtcOffset=aN,re.isUtc=my,re.isUTC=my,re.zoneAbbr=CH,re.zoneName=yH,re.dates=In("dates accessor is deprecated. Use date instead.",My),re.months=In("months accessor is deprecated. Use month instead",ey),re.years=In("years accessor is deprecated. Use year instead",ny),re.zone=In("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",JD),re.isDSTShifted=In("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",iN);function SH(n){return gt(n*1e3)}function vH(){return gt.apply(null,arguments).parseZone()}function Iy(n){return n}var Qe=Lu.prototype;Qe.calendar=aP,Qe.longDateFormat=uP,Qe.invalidDate=fP,Qe.ordinal=pP,Qe.preparse=Iy,Qe.postformat=Iy,Qe.relativeTime=CP,Qe.pastFuture=yP,Qe.set=iP,Qe.eras=jN,Qe.erasParse=KN,Qe.erasConvertYear=XN,Qe.erasAbbrRegex=tH,Qe.erasNameRegex=eH,Qe.erasNarrowRegex=nH,Qe.months=NP,Qe.monthsShort=HP,Qe.monthsParse=LP,Qe.monthsRegex=FP,Qe.monthsShortRegex=$P,Qe.week=UP,Qe.firstDayOfYear=GP,Qe.firstDayOfWeek=YP,Qe.weekdays=nD,Qe.weekdaysMin=oD,Qe.weekdaysShort=sD,Qe.weekdaysParse=rD,Qe.weekdaysRegex=hD,Qe.weekdaysShortRegex=uD,Qe.weekdaysMinRegex=dD,Qe.isPM=gD,Qe.meridiem=wD;function _l(n,e,t,s){var o=Ts(),r=Jn().set(s,e);return o[t](r,n)}function Oy(n,e,t){if(bs(n)&&(e=n,n=void 0),n=n||"",e!=null)return _l(n,e,t,"month");var s,o=[];for(s=0;s<12;s++)o[s]=_l(n,s,t,"month");return o}function id(n,e,t,s){typeof n=="boolean"?(bs(e)&&(t=e,e=void 0),e=e||""):(e=n,t=e,n=!1,bs(e)&&(t=e,e=void 0),e=e||"");var o=Ts(),r=n?o._week.dow:0,a,l=[];if(t!=null)return _l(e,(t+r)%7,s,"day");for(a=0;a<7;a++)l[a]=_l(e,(a+r)%7,s,"day");return l}function bH(n,e){return Oy(n,e,"months")}function RH(n,e){return Oy(n,e,"monthsShort")}function EH(n,e,t){return id(n,e,t,"weekdays")}function xH(n,e,t){return id(n,e,t,"weekdaysShort")}function TH(n,e,t){return id(n,e,t,"weekdaysMin")}Ks("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(n){var e=n%10,t=Ye(n%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return n+t}}),ne.lang=In("moment.lang is deprecated. Use moment.locale instead.",Ks),ne.langData=In("moment.langData is deprecated. Use moment.localeData instead.",Ts);var Ms=Math.abs;function MH(){var n=this._data;return this._milliseconds=Ms(this._milliseconds),this._days=Ms(this._days),this._months=Ms(this._months),n.milliseconds=Ms(n.milliseconds),n.seconds=Ms(n.seconds),n.minutes=Ms(n.minutes),n.hours=Ms(n.hours),n.months=Ms(n.months),n.years=Ms(n.years),this}function Ay(n,e,t,s){var o=Gn(e,t);return n._milliseconds+=s*o._milliseconds,n._days+=s*o._days,n._months+=s*o._months,n._bubble()}function _H(n,e){return Ay(this,n,e,1)}function IH(n,e){return Ay(this,n,e,-1)}function Py(n){return n<0?Math.floor(n):Math.ceil(n)}function OH(){var n=this._milliseconds,e=this._days,t=this._months,s=this._data,o,r,a,l,c;return n>=0&&e>=0&&t>=0||n<=0&&e<=0&&t<=0||(n+=Py(rd(t)+e)*864e5,e=0,t=0),s.milliseconds=n%1e3,o=An(n/1e3),s.seconds=o%60,r=An(o/60),s.minutes=r%60,a=An(r/60),s.hours=a%24,e+=An(a/24),c=An(Dy(e)),t+=c,e-=Py(rd(c)),l=An(t/12),t%=12,s.days=e,s.months=t,s.years=l,this}function Dy(n){return n*4800/146097}function rd(n){return n*146097/4800}function AH(n){if(!this.isValid())return NaN;var e,t,s=this._milliseconds;if(n=On(n),n==="month"||n==="quarter"||n==="year")switch(e=this._days+s/864e5,t=this._months+Dy(e),n){case"month":return t;case"quarter":return t/3;case"year":return t/12}else switch(e=this._days+Math.round(rd(this._months)),n){case"week":return e/7+s/6048e5;case"day":return e+s/864e5;case"hour":return e*24+s/36e5;case"minute":return e*1440+s/6e4;case"second":return e*86400+s/1e3;case"millisecond":return Math.floor(e*864e5)+s;default:throw new Error("Unknown unit "+n)}}function PH(){return this.isValid()?this._milliseconds+this._days*864e5+this._months%12*2592e6+Ye(this._months/12)*31536e6:NaN}function _s(n){return function(){return this.as(n)}}var DH=_s("ms"),NH=_s("s"),HH=_s("m"),kH=_s("h"),LH=_s("d"),VH=_s("w"),$H=_s("M"),FH=_s("Q"),BH=_s("y");function WH(){return Gn(this)}function UH(n){return n=On(n),this.isValid()?this[n+"s"]():NaN}function _o(n){return function(){return this.isValid()?this._data[n]:NaN}}var zH=_o("milliseconds"),YH=_o("seconds"),GH=_o("minutes"),jH=_o("hours"),KH=_o("days"),XH=_o("months"),qH=_o("years");function ZH(){return An(this.days()/7)}var Is=Math.round,Ci={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function QH(n,e,t,s,o){return o.relativeTime(e||1,!!t,n,s)}function JH(n,e,t,s){var o=Gn(n).abs(),r=Is(o.as("s")),a=Is(o.as("m")),l=Is(o.as("h")),c=Is(o.as("d")),h=Is(o.as("M")),u=Is(o.as("w")),f=Is(o.as("y")),g=r<=t.ss&&["s",r]||r<t.s&&["ss",r]||a<=1&&["m"]||a<t.m&&["mm",a]||l<=1&&["h"]||l<t.h&&["hh",l]||c<=1&&["d"]||c<t.d&&["dd",c];return t.w!=null&&(g=g||u<=1&&["w"]||u<t.w&&["ww",u]),g=g||h<=1&&["M"]||h<t.M&&["MM",h]||f<=1&&["y"]||["yy",f],g[2]=e,g[3]=+n>0,g[4]=s,QH.apply(null,g)}function ek(n){return n===void 0?Is:typeof n=="function"?(Is=n,!0):!1}function tk(n,e){return Ci[n]===void 0?!1:e===void 0?Ci[n]:(Ci[n]=e,n==="s"&&(Ci.ss=e-1),!0)}function nk(n,e){if(!this.isValid())return this.localeData().invalidDate();var t=!1,s=Ci,o,r;return typeof n=="object"&&(e=n,n=!1),typeof n=="boolean"&&(t=n),typeof e=="object"&&(s=Object.assign({},Ci,e),e.s!=null&&e.ss==null&&(s.ss=e.s-1)),o=this.localeData(),r=JH(this,!t,s,o),t&&(r=o.pastFuture(+this,r)),o.postformat(r)}var ad=Math.abs;function yi(n){return(n>0)-(n<0)||+n}function Il(){if(!this.isValid())return this.localeData().invalidDate();var n=ad(this._milliseconds)/1e3,e=ad(this._days),t=ad(this._months),s,o,r,a,l=this.asSeconds(),c,h,u,f;return l?(s=An(n/60),o=An(s/60),n%=60,s%=60,r=An(t/12),t%=12,a=n?n.toFixed(3).replace(/\.?0+$/,""):"",c=l<0?"-":"",h=yi(this._months)!==yi(l)?"-":"",u=yi(this._days)!==yi(l)?"-":"",f=yi(this._milliseconds)!==yi(l)?"-":"",c+"P"+(r?h+r+"Y":"")+(t?h+t+"M":"")+(e?u+e+"D":"")+(o||s||n?"T":"")+(o?f+o+"H":"")+(s?f+s+"M":"")+(n?f+a+"S":"")):"P0D"}var Ke=bl.prototype;Ke.isValid=KD,Ke.abs=MH,Ke.add=_H,Ke.subtract=IH,Ke.as=AH,Ke.asMilliseconds=DH,Ke.asSeconds=NH,Ke.asMinutes=HH,Ke.asHours=kH,Ke.asDays=LH,Ke.asWeeks=VH,Ke.asMonths=$H,Ke.asQuarters=FH,Ke.asYears=BH,Ke.valueOf=PH,Ke._bubble=OH,Ke.clone=WH,Ke.get=UH,Ke.milliseconds=zH,Ke.seconds=YH,Ke.minutes=GH,Ke.hours=jH,Ke.days=KH,Ke.weeks=ZH,Ke.months=XH,Ke.years=qH,Ke.humanize=nk,Ke.toISOString=Il,Ke.toString=Il,Ke.toJSON=Il,Ke.locale=Sy,Ke.localeData=by,Ke.toIsoString=In("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Il),Ke.lang=vy,Ee("X",0,0,"unix"),Ee("x",0,0,"valueOf"),me("x",ml),me("X",EP),it("X",function(n,e,t){t._d=new Date(parseFloat(n)*1e3)}),it("x",function(n,e,t){t._d=new Date(Ye(n))});//! moment.js
ne.version="2.29.4",sP(gt),ne.fn=re,ne.min=zD,ne.max=YD,ne.now=GD,ne.utc=Jn,ne.unix=SH,ne.months=bH,ne.isDate=br,ne.locale=Ks,ne.invalid=al,ne.duration=Gn,ne.isMoment=zn,ne.weekdays=EH,ne.parseZone=vH,ne.localeData=Ts,ne.isDuration=Rl,ne.monthsShort=RH,ne.weekdaysMin=TH,ne.defineLocale=Ku,ne.updateLocale=vD,ne.locales=bD,ne.weekdaysShort=xH,ne.normalizeUnits=On,ne.relativeTimeRounding=ek,ne.relativeTimeThreshold=tk,ne.calendarFormat=wN,ne.prototype=re,ne.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};const sk=Object.freeze(Object.defineProperty({__proto__:null,default:ne},Symbol.toStringTag,{value:"Module"}));function ok(n){const e=n.length;let t=0;for(;t<e;)n[t]=[n[t]],t+=1}function Ny(n,e){const t=e.length;let s=0;for(;s<t;)n.push(e[s]),s+=1}function Ol(n){const e=[];if(!n||n.length===0||!n[0]||n[0].length===0)return e;const t=n.length,s=n[0].length;for(let o=0;o<t;o++)for(let r=0;r<s;r++)e[r]||(e[r]=[]),e[r][o]=n[o][r];return e}function Qt(n,e,t,s){let o=-1,r=n,a=t;Array.isArray(n)||(r=Array.from(n));const l=r.length;for(s&&l&&(o+=1,a=r[o]),o+=1;o<l;)a=e(a,r[o],o,r),o+=1;return a}function Pn(n,e){let t=0,s=n;Array.isArray(n)||(s=Array.from(n));const o=s.length,r=[];let a=-1;for(;t<o;){const l=s[t];e(l,t,s)&&(a+=1,r[a]=l),t+=1}return r}function $e(n,e){let t=0,s=n;Array.isArray(n)||(s=Array.from(n));const o=s.length,r=[];let a=-1;for(;t<o;){const l=s[t];a+=1,r[a]=e(l,t,s),t+=1}return r}function N(n,e){let t=0,s=n;Array.isArray(n)||(s=Array.from(n));const o=s.length;for(;t<o&&e(s[t],t,s)!==!1;)t+=1;return n}function Hy(n){const e=[];return N(n,t=>{e.indexOf(t)===-1&&e.push(t)}),e}function ky(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];const[s,...o]=[...e];let r=s;return N(o,a=>{r=r.filter(l=>!a.includes(l))}),r}function Ly(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return n.split(e)}function rt(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),s=1;s<e;s++)t[s-1]=arguments[s];return Qt(n,(r,a,l)=>{const c=a.replace(/\r?\n\s*/g,""),h=t[l]?t[l]:"";return r+c+h},"").trim()}function At(n){let e;switch(typeof n){case"string":case"number":e=`${n}`;break;case"object":e=n===null?"":n.toString();break;case"undefined":e="";break;default:e=n.toString();break}return e}function he(n){return typeof n<"u"}function ct(n){return typeof n>"u"}function Vt(n){return n===null||n===""||ct(n)}function ik(n){return Object.prototype.toString.call(n)==="[object RegExp]"}const Dr="length",Nr=n=>parseInt(n,16),Vy=n=>parseInt(n,10),Al=(n,e,t)=>n.substr(e,t),Hr=n=>n.codePointAt(0)-65,ld=n=>`${n}`.replace(/\-/g,""),rk=n=>Nr(Al(ld(n),Nr("12"),Hr("F")))/(Nr(Al(ld(n),Hr("B"),~~![][Dr]))||9),ak=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let $y=!1;const Fy={invalid:()=>rt`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:n=>{let{keyValidityDate:e,hotVersion:t}=n;return rt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${t}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>rt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},By={invalid:()=>rt`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:n=>{let{keyValidityDate:e,hotVersion:t}=n;return rt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${t}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>rt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function lk(n,e){const t=!Vt(n),s=typeof n=="string"&&n.toLowerCase()==="non-commercial-and-evaluation",o="13.1.0";let r,a="invalid",l="invalid";n=ld(n||"");const c=ck(n);if(t||s||c)if(c){const h=ne("31/08/2023","DD/MM/YYYY"),u=Math.floor(h.toDate().getTime()/864e5),f=rk(n);r=ne((f+1)*864e5,"x").format("MMMM DD, YYYY"),u>f?(a="expired",l="expired"):(a="valid",l="valid")}else s?(a="non_commercial",l="valid"):(a="invalid",l="invalid");else a="missing",l="missing";if(ak()&&(a="valid",l="valid"),!$y&&a!=="valid"&&(Fy[a]({keyValidityDate:r,hotVersion:o})&&console[a==="non_commercial"?"info":"warn"](Fy[a]({keyValidityDate:r,hotVersion:o})),$y=!0),l!=="valid"&&e.parentNode&&By[l]({keyValidityDate:r,hotVersion:o})){const u=document.createElement("div");u.className="hot-display-license-info",u.innerHTML=By[l]({keyValidityDate:r,hotVersion:o}),e.parentNode.insertBefore(u,e.nextSibling)}}function ck(n){let e=[][Dr],t=e;if(n[Dr]!==Hr("Z"))return!1;for(let s="",o="B<H4P+".split(""),r=Hr(o.shift());r;r=Hr(o.shift()||"A"))--r<""[Dr]?t=t|(Vy(`${Vy(Nr(s)+(Nr(Al(n,Math.abs(r),2))+[]).padStart(2,"0"))}`)%97||2)>>1:s=Al(n,r,r?o[Dr]===1?9:8:6);return t===e}function jn(n){return n[0].toUpperCase()+n.substr(1)}function Wy(){function n(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return n()+n()+n()+n()}function Uy(n){return/^([0-9][0-9]?%$)|(^100%$)/.test(n)}function zy(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${n}`.replace(/(?:\\)?\[([^[\]]+)]/g,(t,s)=>t.charAt(0)==="\\"?t.substr(1,t.length-1):e[s]===void 0?"":e[s])}function Yy(n){return cd(`${n}`,{ALLOWED_TAGS:[]})}function cd(n,e){return nP.sanitize(n,e)}function hk(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=-1,s=null,o=n;for(;o!==null;){if(t===e){s=o;break}o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o=o.host:(t+=1,o=o.parentNode)}return s}function uk(n){return Object.getPrototypeOf(n.parent)&&n.frameElement}function Pl(n){return uk(n)&&n.parent}function Io(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],t=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:s,DOCUMENT_FRAGMENT_NODE:o}=Node;let r=n;for(;r!=null&&r!==t;){const{nodeType:a,nodeName:l}=r;if(a===s&&(e.includes(l)||e.includes(r)))return r;const{host:c}=r;c&&a===o?r=c:r=r.parentNode}return null}function Dl(n,e,t){const s=[];let o=n;for(;o&&(o=Io(o,e,t),!(!o||t&&!t.contains(o)));)s.push(o),o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o=o.host:o=o.parentNode;const r=s.length;return r?s[r-1]:null}function Oo(n,e){let t=n.parentNode,s=[];for(typeof e=="string"?n.defaultView?s=Array.prototype.slice.call(n.querySelectorAll(e),0):s=Array.prototype.slice.call(n.ownerDocument.querySelectorAll(e),0):s.push(e);t!==null;){if(s.indexOf(t)>-1)return!0;t=t.parentNode}return!1}function dk(n){let e=0,t=n;if(t.previousSibling)for(;t=t.previousSibling;)e+=1;return e}function Ao(n,e,t){const s=t.parentElement.querySelector(`.ht_clone_${n}`);return s?s.contains(e):null}function Gy(n){return!n||!n.length?[]:n.filter(e=>!!e)}function Ae(n,e){return n.classList===void 0||typeof e!="string"||e===""?!1:n.classList.contains(e)}function oe(n,e){typeof e=="string"&&(e=e.split(" ")),e=Gy(e),e.length>0&&n.classList.add(...e)}function De(n,e){typeof e=="string"&&(e=e.split(" ")),e=Gy(e),e.length>0&&n.classList.remove(...e)}function jy(n){if(n.nodeType===3)n.parentNode.removeChild(n);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(n.nodeName)>-1){const e=n.childNodes;for(let t=e.length-1;t>=0;t--)jy(e[t])}}function ss(n){let e;for(;e=n.lastChild;)n.removeChild(e)}const fk=/(<(.*)>|&(.*);)/;function Si(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;fk.test(e)?n.innerHTML=t?cd(e):e:Po(n,e)}function Po(n,e){const t=n.firstChild;t&&t.nodeType===3&&t.nextSibling===null?t.textContent=e:(ss(n),n.appendChild(n.ownerDocument.createTextNode(e)))}function kr(n){const e=n.ownerDocument.documentElement;let t=n;for(;t!==e;){if(t===null)return!1;if(t.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(t.host){if(t.host.impl)return kr(t.host.impl);if(t.host)return kr(t.host);throw new Error("Lost in Web Components world")}else return!1;else if(t.style&&t.style.display==="none")return!1;t=t.parentNode}return!0}function Ht(n){const e=n.ownerDocument,t=e.defaultView,s=e.documentElement;let o=n,r,a,l;for(r=o.offsetLeft,a=o.offsetTop,l=o;(o=o.offsetParent)&&o!==e.body;)r+=o.offsetLeft,a+=o.offsetTop,l=o;return l&&l.style.position==="fixed"&&(r+=t.pageXOffset||s.scrollLeft,a+=t.pageYOffset||s.scrollTop),{left:r,top:a}}function Lr(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function vi(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function Nl(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return n===e?Lr(e):n.scrollTop}function hd(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return n===e?vi(e):n.scrollLeft}function Hl(n){let e=n.ownerDocument,t=e?e.defaultView:void 0;e||(e=n.document?n.document:n,t=e.defaultView);const s=["auto","scroll"];let o=n.parentNode;for(;o&&o.style&&e.body!==o;){let{overflow:r,overflowX:a,overflowY:l}=o.style;if([r,a,l].includes("scroll"))return o;if({overflow:r,overflowX:a,overflowY:l}=t.getComputedStyle(o),s.includes(r)||s.includes(a)||s.includes(l)||o.clientHeight<=o.scrollHeight+1&&(s.includes(l)||s.includes(r))||o.clientWidth<=o.scrollWidth+1&&(s.includes(a)||s.includes(r)))return o;o=o.parentNode}return t}function bi(n){const e=n.ownerDocument,t=e.defaultView;let s=n.parentNode;for(;s&&s.style&&e.body!==s;){if(s.style.overflow!=="visible"&&s.style.overflow!=="")return s;const o=Do(s,t),r=["scroll","hidden","auto"],a=o.getPropertyValue("overflow"),l=o.getPropertyValue("overflow-y"),c=o.getPropertyValue("overflow-x");if(r.includes(a)||r.includes(l)||r.includes(c))return s;s=s.parentNode}return t}function Vr(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(n){if(n===t)return e==="width"?`${t.innerWidth}px`:e==="height"?`${t.innerHeight}px`:void 0}else return;const s=n.style[e];if(s!==""&&s!==void 0)return s;const o=Do(n,t);if(o[e]!==""&&o[e]!==void 0)return o[e]}function Do(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return n.currentStyle||e.getComputedStyle(n)}function at(n){return n.offsetWidth}function vt(n){return n.offsetHeight}function qs(n){return n.clientHeight||n.innerHeight}function kl(n){return n.clientWidth||n.innerWidth}function Ky(n){return n.selectionStart?n.selectionStart:0}function gk(n){return n.selectionEnd?n.selectionEnd:0}function mk(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;const e=n.document;let t="";return n.getSelection?t=n.getSelection().toString():e.selection&&e.selection.type!=="Control"&&(t=e.selection.createRange().text),t}function Xy(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;n.getSelection&&(n.getSelection().empty?n.getSelection().empty():n.getSelection().removeAllRanges&&n.getSelection().removeAllRanges())}function Ll(n,e,t){if(t===void 0&&(t=e),n.setSelectionRange){n.focus();try{n.setSelectionRange(e,t)}catch{const o=n.parentNode,r=o.style.display;o.style.display="block",n.setSelectionRange(e,t),o.style.display=r}}}let ud;function pk(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=n.createElement("div");e.style.height="200px",e.style.width="100%";const t=n.createElement("div");t.style.boxSizing="content-box",t.style.height="150px",t.style.left="0px",t.style.overflow="hidden",t.style.position="absolute",t.style.top="0px",t.style.width="200px",t.style.visibility="hidden",t.appendChild(e),(n.body||n.documentElement).appendChild(t);const s=e.offsetWidth;t.style.overflow="scroll";let o=e.offsetWidth;return s===o&&(o=t.clientWidth),(n.body||n.documentElement).removeChild(t),s-o}function Ft(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return ud===void 0&&(ud=pk(n)),ud}function wk(n){return n.offsetWidth!==n.clientWidth}function Ck(n){return n.offsetHeight!==n.clientHeight}function dd(n,e,t){n.style.transform=`translate3d(${e},${t},0)`}function Vl(n){n.style.transform&&n.style.transform!==""&&(n.style.transform="")}function $l(n){return n&&(["INPUT","SELECT","TEXTAREA"].indexOf(n.nodeName)>-1||n.contentEditable==="true")}function fd(n){return $l(n)&&n.hasAttribute("data-hot-input")===!1}function yk(n){const e=n.ownerDocument.activeElement;fd(e)||n.select()}function qy(n){return!n.parentNode}function Sk(n,e){new IntersectionObserver((s,o)=>{s.forEach(r=>{r.isIntersecting&&n.offsetParent!==null&&(e(),o.unobserve(n))})},{root:n.ownerDocument.body}).observe(n)}function ht(n){return typeof n=="function"}function Zy(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,t=null,s;function o(){for(var r=arguments.length,a=new Array(r),l=0;l<r;l++)a[l]=arguments[l];return t&&clearTimeout(t),t=setTimeout(()=>{s=n.apply(this,a)},e),s}return o}function Qy(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),s=1;s<e;s++)t[s-1]=arguments[s];return function(){for(var r=arguments.length,a=new Array(r),l=0;l<r;l++)a[l]=arguments[l];return n.apply(this,t.concat(a))}}function vk(n){const e=n.length;function t(s){return function(){for(var r=arguments.length,a=new Array(r),l=0;l<r;l++)a[l]=arguments[l];const c=s.concat(a);let h;return c.length>=e?h=n.apply(this,c):h=t(c),h}}return t([])}function gd(n,e,t,s,o,r,a,l){return he(l)?n.call(e,t,s,o,r,a,l):he(a)?n.call(e,t,s,o,r,a):he(r)?n.call(e,t,s,o,r):he(o)?n.call(e,t,s,o):he(s)?n.call(e,t,s):he(t)?n.call(e,t):n.call(e)}var bk=nn,Jy=Gw,Rk=zt,eS=ci,Ek=tC,tS=bk([].push),xk=function(n){if(Rk(n))return n;if(Jy(n)){for(var e=n.length,t=[],s=0;s<e;s++){var o=n[s];typeof o=="string"?tS(t,o):(typeof o=="number"||eS(o)==="Number"||eS(o)==="String")&&tS(t,Ek(o))}var r=t.length,a=!0;return function(l,c){if(a)return a=!1,c;if(Jy(this))return c;for(var h=0;h<r;h++)if(t[h]===l)return c}}},Tk=vo,nS=gr,sS=Ja,Mk=Wa,$r=nn,oS=Mn,iS=zt,rS=Vh,aS=fu,_k=xk,Ik=Lh,Ok=String,Zs=nS("JSON","stringify"),Fl=$r(/./.exec),lS=$r("".charAt),Ak=$r("".charCodeAt),Pk=$r("".replace),Dk=$r(1 .toString),Nk=/[\uD800-\uDFFF]/g,cS=/^[\uD800-\uDBFF]$/,hS=/^[\uDC00-\uDFFF]$/,uS=!Ik||oS(function(){var n=nS("Symbol")("stringify detection");return Zs([n])!=="[null]"||Zs({a:n})!=="{}"||Zs(Object(n))!=="{}"}),dS=oS(function(){return Zs("\uDF06\uD834")!=='"\\udf06\\ud834"'||Zs("\uDEAD")!=='"\\udead"'}),Hk=function(n,e){var t=aS(arguments),s=_k(e);if(!(!iS(s)&&(n===void 0||rS(n))))return t[1]=function(o,r){if(iS(s)&&(r=Mk(s,this,Ok(o),r)),!rS(r))return r},sS(Zs,null,t)},kk=function(n,e,t){var s=lS(t,e-1),o=lS(t,e+1);return Fl(cS,n)&&!Fl(hS,o)||Fl(hS,n)&&!Fl(cS,s)?"\\u"+Dk(Ak(n,0),16):n};Zs&&Tk({target:"JSON",stat:!0,arity:3,forced:uS||dS},{stringify:function(e,t,s){var o=aS(arguments),r=sS(uS?Hk:Zs,null,o);return dS&&typeof r=="string"?Pk(r,Nk,kk):r}});function Fr(n){let e;return Array.isArray(n)?e=n.length?new Array(n.length).fill(null):[]:(e={},Be(n,(t,s)=>{s!=="__children"&&(t&&typeof t=="object"&&!Array.isArray(t)?e[s]=Fr(t):Array.isArray(t)?t.length&&typeof t[0]=="object"&&!Array.isArray(t[0])?e[s]=[Fr(t[0])]:e[s]=[]:e[s]=null)})),e}function Qs(n,e){return e.prototype.constructor=e,n.prototype=new e,n.prototype.constructor=n,n}function kt(n,e,t){const s=Array.isArray(t);return Be(e,(o,r)=>{(s===!1||t.includes(r))&&(n[r]=o)}),n}function Bl(n,e){Be(e,(t,s)=>{e[s]&&typeof e[s]=="object"?(n[s]||(Array.isArray(e[s])?n[s]=[]:Object.prototype.toString.call(e[s])==="[object Date]"?n[s]=e[s]:n[s]={}),Bl(n[s],e[s])):n[s]=e[s]})}function rn(n){return typeof n=="object"?JSON.parse(JSON.stringify(n)):n}function dn(n){const e={};return Be(n,(t,s)=>{e[s]=t}),e}function lt(n){n.MIXINS||(n.MIXINS=[]);for(var e=arguments.length,t=new Array(e>1?e-1:0),s=1;s<e;s++)t[s-1]=arguments[s];return N(t,o=>{n.MIXINS.push(o.MIXIN_NAME),Be(o,(r,a)=>{if(n.prototype[a]!==void 0)throw new Error(`Mixin conflict. Property '${a}' already exist and cannot be overwritten.`);if(typeof r=="function")n.prototype[a]=r;else{const l=function(u,f){const g=`_${u}`,p=C=>{let y=C;return(Array.isArray(y)||Fe(y))&&(y=rn(y)),y};return function(){return this[g]===void 0&&(this[g]=p(f)),this[g]}},c=function(u){const f=`_${u}`;return function(g){this[f]=g}};Object.defineProperty(n.prototype,a,{get:l(a,r),set:c(a),configurable:!0})}})}),n}function md(n,e){return JSON.stringify(n)===JSON.stringify(e)}function Fe(n){return Object.prototype.toString.call(n)==="[object Object]"}function Os(n,e,t,s){s.value=t,s.writable=s.writable!==!1,s.enumerable=s.enumerable!==!1,s.configurable=s.configurable!==!1,Object.defineProperty(n,e,s)}function Be(n,e){for(const t in n)if((!n.hasOwnProperty||n.hasOwnProperty&&Object.prototype.hasOwnProperty.call(n,t))&&e(n[t],t,n)===!1)break;return n}function Lk(n,e){const t=e.split(".");let s=n;return Be(t,o=>{if(s=s[o],s===void 0)return s=void 0,!1}),s}function pd(n,e,t){const s=e.split(".");let o=n;s.forEach((r,a)=>{a!==s.length-1?(Mt(o,r)||(o[r]={}),o=o[r]):o[r]=t})}function wd(n){if(!Fe(n))return 0;const e=function(t){let s=0;return Fe(t)?Be(t,(o,r)=>{r!=="__children"&&(s+=e(o))}):s+=1,s};return e(n)}function Ri(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const t=`_${e}`,s={_touched:!1,[t]:n,isTouched(){return this._touched}};return Object.defineProperty(s,e,{get(){return this[t]},set(o){this._touched=!0,this[t]=o},enumerable:!0,configurable:!0}),s}function Mt(n,e){return Object.prototype.hasOwnProperty.call(n,e)}const Dn=n=>{const e={value:!1};return e.test=(t,s)=>{e.value=n(t,s)},e},No={chrome:Dn((n,e)=>/Chrome/.test(n)&&/Google/.test(e)),chromeWebKit:Dn(n=>/CriOS/.test(n)),edge:Dn(n=>/Edge/.test(n)),edgeWebKit:Dn(n=>/EdgiOS/.test(n)),firefox:Dn(n=>/Firefox/.test(n)),firefoxWebKit:Dn(n=>/FxiOS/.test(n)),mobile:Dn(n=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(n)),safari:Dn((n,e)=>/Safari/.test(n)&&/Apple Computer/.test(e))},Br={mac:Dn(n=>/^Mac/.test(n)),win:Dn(n=>/^Win/.test(n)),linux:Dn(n=>/^Linux/.test(n)),ios:Dn(n=>/iPhone|iPad|iPod/i.test(n))};function Vk(){let{userAgent:n=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Be(No,t=>{let{test:s}=t;return void s(n,e)})}function $k(){let{platform:n=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Be(Br,e=>{let{test:t}=e;return void t(n)})}Vk(),$k();function fS(){return No.chrome.value}function Fk(){return No.chromeWebKit.value}function Cd(){return No.firefox.value}function Bk(){return No.firefoxWebKit.value}function Wk(){return No.edge.value}function os(){return No.mobile.value}function gS(){return Br.ios.value}function mS(){let{maxTouchPoints:n}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return n>2&&Br.mac.value}function pS(){return Br.win.value}function wS(){return Br.mac.value}const we={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:Cd()?182:174,AUDIO_MUTE:Cd()?181:173,AUDIO_UP:Cd()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},Uk=[we.ALT,we.ARROW_DOWN,we.ARROW_LEFT,we.ARROW_RIGHT,we.ARROW_UP,we.AUDIO_DOWN,we.AUDIO_MUTE,we.AUDIO_UP,we.BACKSPACE,we.CAPS_LOCK,we.DELETE,we.END,we.ENTER,we.ESCAPE,we.F1,we.F2,we.F3,we.F4,we.F5,we.F6,we.F7,we.F8,we.F9,we.F10,we.F11,we.F12,we.F13,we.F14,we.F15,we.F16,we.F17,we.F18,we.F19,we.HOME,we.INSERT,we.MEDIA_NEXT,we.MEDIA_PLAY_PAUSE,we.MEDIA_PREV,we.MEDIA_STOP,we.NULL,we.NUM_LOCK,we.PAGE_DOWN,we.PAGE_UP,we.PAUSE,we.SCROLL_LOCK,we.SHIFT,we.TAB];function zk(n){return n===32||n>=48&&n<=57||n>=96&&n<=111||n>=186&&n<=192||n>=219&&n<=222||n>=226||n>=65&&n<=90}function CS(n){return Uk.includes(n)}function Yk(n){return[we.CONTROL,we.COMMAND_LEFT,we.COMMAND_RIGHT,we.COMMAND_FIREFOX].includes(n)}function Wr(n,e){const t=e.split("|");let s=!1;return N(t,o=>{if(n===we[o])return s=!0,!1}),s}function is(n){n.isImmediatePropagationEnabled=!1,n.cancelBubble=!0}function Ei(n){return n.isImmediatePropagationEnabled===!1}function Ho(n){return n.button===2}function yd(n){return n.button===0}function ut(){he(console)&&console.warn(...arguments)}function Sd(){he(console)&&console.error(...arguments)}const xi=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],Gk=rt`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`,vd=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),bd=new Map([]);class yS{static getSingleton(){return Kk()}constructor(){this.globalBucket=this.createEmptyBucket()}createEmptyBucket(){const e=Object.create(null);return N(xi,t=>e[t]=[]),e}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=this.createEmptyBucket()),e.pluginHookBucket):this.globalBucket}add(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(Array.isArray(t))N(t,o=>this.add(e,o,s));else{vd.has(e)&&ut(zy(Gk,{hookName:e,removedInVersion:vd.get(e)})),bd.has(e)&&ut(bd.get(e));const o=this.getBucket(s);if(typeof o[e]>"u"&&(this.register(e),o[e]=[]),t.skip=!1,o[e].indexOf(t)===-1){let r=!1;t.initialHook&&N(o[e],(a,l)=>{if(a.initialHook)return o[e][l]=t,r=!0,!1}),r||o[e].push(t)}}return this}once(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;Array.isArray(t)?N(t,o=>this.once(e,o,s)):(t.runOnce=!0,this.add(e,t,s))}remove(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;const o=this.getBucket(s);return typeof o[e]<"u"&&o[e].indexOf(t)>=0?(t.skip=!0,!0):!1}has(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const s=this.getBucket(t);return!!(s[e]!==void 0&&s[e].length)}run(e,t,s,o,r,a,l,c){{const h=this.globalBucket[t],u=h?h.length:0;let f=0;if(u)for(;f<u;){if(!h[f]||h[f].skip){f+=1;continue}const g=gd(h[f],e,s,o,r,a,l,c);g!==void 0&&(s=g),h[f]&&h[f].runOnce&&this.remove(t,h[f]),f+=1}}{const h=this.getBucket(e)[t],u=h?h.length:0;let f=0;if(u)for(;f<u;){if(!h[f]||h[f].skip){f+=1;continue}const g=gd(h[f],e,s,o,r,a,l,c);g!==void 0&&(s=g),h[f]&&h[f].runOnce&&this.remove(t,h[f],e),f+=1}}return s}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Be(this.getBucket(e),(t,s,o)=>o[s].length=0)}register(e){this.isRegistered(e)||xi.push(e)}deregister(e){this.isRegistered(e)&&xi.splice(xi.indexOf(e),1)}isDeprecated(e){return bd.has(e)||vd.has(e)}isRegistered(e){return xi.indexOf(e)>=0}getRegistered(){return xi}}const jk=new yS;function Kk(){return jk}const de=yS,Rd=new Map;function Nn(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";Rd.has(n)||Rd.set(n,new Map);const e=Rd.get(n);function t(l,c){e.set(l,c)}function s(l){return e.get(l)}function o(l){return e.has(l)}function r(){return[...e.keys()]}function a(){return[...e.values()]}return{register:t,getItem:s,hasItem:o,getNames:r,getValues:a}}const Ed=new WeakMap,{register:Xk,getItem:SS,hasItem:vS,getNames:O3,getValues:A3}=Nn("editors");function qk(n){const e={},t=n;this.getConstructor=function(){return n},this.getInstance=function(s){return s.guid in e||(e[s.guid]=new t(s)),e[s.guid]},de.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function bS(n,e){let t;if(typeof n=="function")Ed.get(n)||Sn(null,n),t=Ed.get(n);else if(typeof n=="string")t=SS(n);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!t)throw Error(`No editor registered under name "${n}"`);return t.getInstance(e)}function RS(n){if(typeof n=="function")return n;if(!vS(n))throw Error(`No registered editor found under "${n}" name`);return SS(n).getConstructor()}function Sn(n,e){n&&typeof n!="string"&&(e=n,n=e.EDITOR_TYPE);const t=new qk(e);typeof n=="string"&&Xk(n,t),Ed.set(e,t)}class Zk{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,t,s){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function r(a){s.call(this,Qk(a))}return this.context.eventListeners.push({element:e,event:t,callback:s,callbackProxy:r,options:o,eventManager:this}),e.addEventListener(t,r,o),()=>{this.removeEventListener(e,t,s)}}removeEventListener(e,t,s){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,r=this.context.eventListeners.length,a;for(;r;)if(r-=1,a=this.context.eventListeners[r],a.event===t&&a.element===e){if(s&&s!==a.callback||o&&a.eventManager!==this)continue;this.context.eventListeners.splice(r,1),a.element.removeEventListener(a.event,a.callbackProxy,a.options)}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let t=this.context.eventListeners.length;for(;t;){t-=1;const s=this.context.eventListeners[t];e&&s.eventManager!==this||(this.context.eventListeners.splice(t,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options))}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,t){let s=e.document,o=e;s||(s=e.ownerDocument?e.ownerDocument:e,o=s.defaultView);const r={bubbles:!0,cancelable:t!=="mousemove",view:o,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};let a;s.createEvent?(a=s.createEvent("MouseEvents"),a.initMouseEvent(t,r.bubbles,r.cancelable,r.view,r.detail,r.screenX,r.screenY,r.clientX,r.clientY,r.ctrlKey,r.altKey,r.shiftKey,r.metaKey,r.button,s.body.parentNode)):a=s.createEventObject(),e.dispatchEvent?e.dispatchEvent(a):e.fireEvent(`on${t}`,a)}}function Qk(n){const e=n.stopImmediatePropagation;return n.stopImmediatePropagation=function(){e.apply(this),is(this)},n}const bt=Zk,Wl="editorManager.navigation",Ur="editorManager.handlingEditor";class xd{constructor(e,t,s){this.instance=e,this.tableMeta=t,this.selection=s,this.eventManager=new bt(e),this.destroyed=!1,this.lock=!1,this.activeEditor=void 0,this.cellProperties=void 0,this.instance.getShortcutManager().addContext("editor"),this.registerShortcuts(),this.instance.addHook("afterDocumentKeyDown",r=>this.onAfterDocumentKeyDown(r)),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"compositionstart",r=>{!this.destroyed&&this.instance.isListening()&&this.openEditor("",r)}),this.instance.view._wt.update("onCellDblClick",(r,a,l)=>this.onCellDblClick(r,a,l))}registerShortcuts(){const e=this.instance.getShortcutManager(),t=e.getContext("grid"),s=e.getContext("editor"),o={group:Ur};s.addShortcuts([{keys:[["Enter"],["Enter","Shift"],["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],callback:(r,a)=>{this.closeEditorAndSaveChanges(e.isCtrlPressed()),this.moveSelectionAfterEnter(a.includes("shift"))}},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>{this.closeEditorAndRestoreOriginalValue(e.isCtrlPressed()),this.activeEditor.focus()}}],o),t.addShortcuts([{keys:[["F2"]],callback:r=>{this.openEditor(null,r,!0)}},{keys:[["Backspace"],["Delete"]],callback:()=>{this.instance.emptySelectedCells(),this.prepareEditor()}},{keys:[["Enter"],["Enter","Shift"]],callback:(r,a)=>{this.instance.getSettings().enterBeginsEditing?this.cellProperties.readOnly?this.moveSelectionAfterEnter():this.openEditor(null,r,!0):this.moveSelectionAfterEnter(a.includes("shift")),is(r)}}],{...o,runOnlyIf:()=>he(this.instance.getSelected())})}lockEditor(){this.lock=!0}unlockEditor(){this.lock=!1}destroyEditor(e){this.lock||this.closeEditor(e)}getActiveEditor(){return this.activeEditor}prepareEditor(){if(this.lock)return;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,c=>{c&&this.prepareEditor()});return}const{row:e,col:t}=this.instance.getSelectedRangeLast().highlight,s=this.instance.runHooks("modifyGetCellCoords",e,t);let o=e,r=t;Array.isArray(s)&&([o,r]=s),this.cellProperties=this.instance.getCellMeta(o,r);const{activeElement:a}=this.instance.rootDocument;if(a&&fd(a)&&a.blur(),!this.isCellEditable()){this.clearActiveEditor();return}const l=this.instance.getCell(e,t,!0);if(l){const c=this.instance.getCellEditor(this.cellProperties),h=this.instance.colToProp(r),u=this.instance.getSourceDataAtCell(this.instance.toPhysicalRow(o),r);this.activeEditor=bS(c,this.instance),this.activeEditor.prepare(e,t,h,l,u,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}if(!this.activeEditor){const{row:o,col:r}=this.instance.getSelectedRangeLast().highlight,a=this.instance.rowIndexMapper.getRenderableFromVisualIndex(o),l=this.instance.columnIndexMapper.getRenderableFromVisualIndex(r);this.instance.view.scrollViewport(this.instance._createCellCoords(a,l)),this.instance.view.render(),this.prepareEditor()}this.activeEditor&&(s&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,t))}closeEditor(e,t,s){this.activeEditor?this.activeEditor.finishEditing(e,t,s):s&&s(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.instance.getCellEditor(this.cellProperties),{row:t,col:s}=this.instance.getSelectedRangeLast().highlight,{rowIndexMapper:o,columnIndexMapper:r}=this.instance,a=o.isHidden(this.instance.toPhysicalRow(t))||r.isHidden(this.instance.toPhysicalColumn(s));return!(this.cellProperties.readOnly||!e||a)}moveSelectionAfterEnter(e){const t=typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;e?this.selection.transformStart(-t.row,-t.col):this.selection.transformStart(t.row,t.col,!0)}onAfterDocumentKeyDown(e){if(!this.instance.isListening())return;const{keyCode:t}=e;if(!this.selection.isSelected())return;const s=(e.ctrlKey||e.metaKey)&&!e.altKey;if((!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!CS(t)&&!Yk(t)&&!s&&!this.isEditorOpened()){const r=this.instance.getShortcutManager().getContext("editor"),a={runOnlyIf:()=>he(this.instance.getSelected()),group:Wl};r.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.instance.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.instance.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.instance.selection.transformStart(0,-1*this.instance.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.instance.selection.transformStart(0,this.instance.getDirectionFactor())}}],a),this.openEditor("",e)}}onCellDblClick(e,t,s){s.nodeName==="TD"&&this.openEditor(null,e,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}const ES=new WeakMap;xd.getInstance=function(n,e,t){let s=ES.get(n);return s||(s=new xd(n,e,t),ES.set(n,s)),s};const Jk=xd,xS={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},eL=new RegExp(Object.keys(xS).map(n=>`(${n})`).join("|"),"gi");function tL(n){return(n&&n.nodeName||"")==="TABLE"}function TS(n){const e=n.hasColHeaders(),t=n.hasRowHeaders(),s=[e?-1:0,t?-1:0,n.countRows()-1,n.countCols()-1],o=n.getData(...s),r=o.length,a=r>0?o[0].length:0,l=["<table>","</table>"],c=e?["<thead>","</thead>"]:[],h=["<tbody>","</tbody>"],u=t?1:0,f=e?1:0;for(let g=0;g<r;g+=1){const p=e&&g===0,C=[];for(let b=0;b<a;b+=1){const T=!p&&t&&b===0;let M="";if(p)M=`<th>${n.getColHeader(b-u)}</th>`;else if(T)M=`<th>${n.getRowHeader(g-f)}</th>`;else{const _=o[g][b],{hidden:I,rowspan:D,colspan:K}=n.getCellMeta(g-f,b-u);if(!I){const H=[];if(D&&H.push(`rowspan="${D}"`),K&&H.push(`colspan="${K}"`),Vt(_))M=`<td ${H.join(" ")}></td>`;else{const Q=_.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");M=`<td ${H.join(" ")}>${Q}</td>`}}}C.push(M)}const y=["<tr>",...C,"</tr>"].join("");p?c.splice(1,0,y):h.splice(-1,0,y)}return l.splice(1,0,c.join(""),h.join("")),l.join("")}function MS(n){const e=n.length,t=["<table>"];for(let s=0;s<e;s+=1){const o=n[s],r=o.length,a=[];s===0&&t.push("<tbody>");for(let l=0;l<r;l+=1){const c=o[l],h=Vt(c)?"":c.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,u=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(u.length-1)} </span>`).replace(/\t/gi,"&#9;");a.push(`<td>${h}</td>`)}t.push("<tr>",...a,"</tr>"),s+1===e&&t.push("</tbody>")}return t.push("</table>"),t.join("")}function nL(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const t={},s=e.createDocumentFragment(),o=e.createElement("div");s.appendChild(o);let r=n;if(typeof r=="string"){const _=r.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,I=>{const D=I.match(/<td\b[^>]*?>/g)[0],K=I.substring(D.length,I.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,"");return`${D}${K}</td>`});o.insertAdjacentHTML("afterbegin",`${_}`),r=o.querySelector("table")}if(!r||!tL(r))return;const a=o.querySelector('meta[name$="enerator"]'),l=r.querySelector("tbody th")!==null,c=r.querySelector("tr"),h=c?Array.from(c.cells).reduce((_,I)=>_+I.colSpan,0)-(l?1:0):0,u=r.tFoot&&Array.from(r.tFoot.rows)||[],f=[];let g=!1,p=0,C=0;if(r.tHead){const _=Array.from(r.tHead.rows).filter(I=>{const D=I.querySelector("td")!==null;return D&&f.push(I),!D});p=_.length,g=p>0,p>1?t.nestedHeaders=Array.from(_).reduce((I,D)=>{const K=Array.from(D.cells).reduce((H,Q,q)=>{if(l&&q===0)return H;const{colSpan:F,innerHTML:Y}=Q,te=F>1?{label:Y,colspan:F}:Y;return H.push(te),H},[]);return I.push(K),I},[]):g&&(t.colHeaders=Array.from(_[0].children).reduce((I,D,K)=>(l&&K===0||I.push(D.innerHTML),I),[]))}f.length&&(t.fixedRowsTop=f.length),u.length&&(t.fixedRowsBottom=u.length);const y=[...f,...Array.from(r.tBodies).reduce((_,I)=>(_.push(...Array.from(I.rows)),_),[]),...u];C=y.length;const b=new Array(C);for(let _=0;_<C;_++)b[_]=new Array(h);const T=[],M=[];for(let _=0;_<C;_++){const I=y[_],D=Array.from(I.cells),K=D.length;for(let H=0;H<K;H++){const Q=D[H],{nodeName:q,innerHTML:F,rowSpan:Y,colSpan:te}=Q,ie=b[_].findIndex(fe=>fe===void 0);if(q==="TD"){if(Y>1||te>1){for(let Oe=_;Oe<_+Y;Oe++)if(Oe<C)for(let E=ie;E<ie+te;E++)b[Oe][E]=null;const Me=Q.getAttribute("style");Me&&Me.includes("mso-ignore:colspan")||T.push({col:ie,row:_,rowspan:Y,colspan:te})}let fe="";a&&/excel/gi.test(a.content)?fe=F.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):fe=F.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),b[_][ie]=fe.replace(eL,Me=>xS[Me])}else M.push(F)}}return T.length&&(t.mergeCells=T),M.length&&(t.rowHeaders=M),b.length&&(t.data=b),t}function fn(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const t=typeof n;if(t==="number")return!isNaN(n)&&isFinite(n);if(t==="string"){if(n.length===0)return!1;if(n.length===1)return/\d/.test(n);const s=Array.from(new Set([".",...e])).map(o=>`\\${o}`).join("|");return new RegExp(`^[+-]?\\s*(((${s})?\\d+((${s})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(n.trim())}else if(t==="object")return!!n&&typeof n.valueOf()=="number"&&!(n instanceof Date);return!1}function sL(n){return fn(n,[","])}function Ce(n,e,t){let s=-1;for(typeof e=="function"?(t=e,e=n):s=n-1;++s<=e&&t(s)!==!1;);}function Td(n,e,t){let s=n+1;for(typeof e=="function"&&(t=e,e=0);--s>=e&&t(s)!==!1;);}function _S(n,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(n*e/100,10)}const Md="asc",oL="desc",IS=new Map([[Md,[-1,1]],[oL,[1,-1]]]),iL=n=>`The priority '${n}' is already declared in a map.`,rL=n=>`The priority '${n}' is not a number.`;function aL(){let{errorPriorityExists:n,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=new Map;n=ht(n)?n:iL,e=ht(e)?e:rL;function s(r,a){if(!fn(r))throw new Error(e(r));if(t.has(r))throw new Error(n(r));t.set(r,a)}function o(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Md;const[a,l]=IS.get(r)||IS.get(Md);return[...t].sort((c,h)=>c[0]<h[0]?a:l).map(c=>c[1])}return{addItem:s,getItems:o}}const lL=n=>`The id '${n}' is already declared in a map.`;function Ul(){let{errorIdExists:n}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;n=ht(n)?n:lL;function t(h,u){if(c(h))throw new Error(n(h));e.set(h,u)}function s(h){return e.delete(h)}function o(){e.clear()}function r(h){const[u]=l().find(f=>{let[g,p]=f;return h===p?g:!1})||[null];return u}function a(h){return e.get(h)}function l(){return[...e]}function c(h){return e.has(h)}return{addItem:t,clear:o,getId:r,getItem:a,getItems:l,hasItem:c,removeItem:s}}const cL=n=>`'${n}' value is already declared in a unique set.`;function hL(){let{errorItemExists:n}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;n=ht(n)?n:cL;function t(r){if(e.has(r))throw new Error(n(r));e.add(r)}function s(){return[...e]}function o(){e.clear()}return{addItem:t,clear:o,getItems:s}}const _d=n=>`There is already registered "${n}" plugin.`,OS=aL({errorPriorityExists:n=>`There is already registered plugin on priority "${n}".`,errorPriorityNaN:n=>`The priority "${n}" is not a number.`}),AS=hL({errorItemExists:_d}),Id=Ul({errorIdExists:_d});function PS(){return[...OS.getItems(),...AS.getItems()]}function Od(n){const e=jn(n);return Id.getItem(e)}function uL(n){return!!Od(n)}function Xe(n,e,t){[n,e,t]=fL(n,e,t),Od(n)===void 0&&dL(n,e,t)}function dL(n,e,t){const s=jn(n);if(Id.hasItem(s))throw new Error(_d(s));t===void 0?AS.addItem(s):OS.addItem(t,s),Id.addItem(s,e)}function fL(n,e,t){return typeof n=="function"&&(e=n,n=e.PLUGIN_KEY,t=e.PLUGIN_PRIORITY),[n,e,t]}const{register:gL,getItem:mL,hasItem:DS,getNames:N3,getValues:H3}=Nn("renderers");function NS(n){if(typeof n=="function")return n;if(!DS(n))throw Error(`No registered renderer found under "${n}" name`);return mL(n)}function As(n,e){typeof n!="string"&&(e=n,n=e.RENDERER_TYPE),gL(n,e)}const{register:pL,getItem:wL,hasItem:HS,getNames:k3,getValues:L3}=Nn("validators");function CL(n){if(typeof n=="function")return n;if(!HS(n))throw Error(`No registered validator found under "${n}" name`);return wL(n)}function zr(n,e){typeof n!="string"&&(e=n,n=e.VALIDATOR_TYPE),pL(n,e)}var kS={},yL=Ww,SL=cu,vL=Object.keys||function(e){return yL(e,SL)},bL=qn,RL=_w,EL=So,xL=mr,TL=Ua,ML=vL;kS.f=bL&&!RL?Object.defineProperties:function(e,t){xL(e);for(var s=TL(t),o=ML(t),r=o.length,a=0,l;r>a;)EL.f(e,l=o[a++],s[l]);return e};var _L=mr,IL=kS,LS=cu,OL=tu,AL=gC,PL=jh,DL=Nw,VS=">",$S="<",Ad="prototype",Pd="script",FS=DL("IE_PROTO"),Dd=function(){},BS=function(n){return $S+Pd+VS+n+$S+"/"+Pd+VS},WS=function(n){n.write(BS("")),n.close();var e=n.parentWindow.Object;return n=null,e},NL=function(){var n=PL("iframe"),e="java"+Pd+":",t;return n.style.display="none",AL.appendChild(n),n.src=String(e),t=n.contentWindow.document,t.open(),t.write(BS("document.F=Object")),t.close(),t.F},zl,Yl=function(){try{zl=new ActiveXObject("htmlfile")}catch{}Yl=typeof document<"u"?document.domain&&zl?WS(zl):NL():WS(zl);for(var n=LS.length;n--;)delete Yl[Ad][LS[n]];return Yl()};OL[FS]=!0;var HL=Object.create||function(e,t){var s;return e!==null?(Dd[Ad]=_L(e),s=new Dd,Dd[Ad]=null,s[FS]=e):s=Yl(),t===void 0?s:IL.f(s,t)},kL=Ga,LL=HL,VL=So.f,Nd=kL("unscopables"),Hd=Array.prototype;Hd[Nd]===void 0&&VL(Hd,Nd,{configurable:!0,value:LL(null)});var $L=function(n){Hd[Nd][n]=!0},FL=vo,BL=Ya,WL=Qa,UL=au,zL=$L;FL({target:"Array",proto:!0},{at:function(e){var t=BL(this),s=WL(t),o=UL(e),r=o>=0?o:s+o;return r<0||r>=s?void 0:t[r]}}),zL("at");const ko=1,Jt=2,Ti=new WeakMap;class kd{static get DEFAULT_WIDTH(){return 50}constructor(){let{viewportSize:e,scrollOffset:t,totalItems:s,itemSizeFn:o,overrideFn:r,calculationType:a,stretchMode:l,stretchingItemWidthFn:c=u=>u,inlineStartOffset:h}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ti.set(this,{viewportWidth:e,scrollOffset:t,totalColumns:s,columnWidthFn:o,overrideFn:r,calculationType:a,stretchingColumnWidthFn:c,inlineStartOffset:h}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=l,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()}calculate(){let e=0,t=!0;const s=[];let o,r=0,a=0;const l=Ti.get(this),c=l.calculationType,h=l.overrideFn,u=l.scrollOffset,f=Math.max(l.scrollOffset,0),g=l.totalColumns,p=l.viewportWidth,C=f>0?p+1:p;for(let M=0;M<g;M++)if(o=this._getColumnWidth(M),e<=f&&c!==Jt&&(this.startColumn=M,r=o),e>=f&&e+(c===Jt?o:0)<=f+C&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=M,r=o),this.endColumn=M),s.push(e),e+=o,a=o,c!==Jt&&(this.endColumn=M),e>=f+p){t=!1;break}const y=u+p-C,b=c===Jt?0:a,T=c===Jt?r:0;if(y<-1*l.inlineStartOffset||u>s.at(-1)+b||-1*l.scrollOffset-l.viewportWidth>-1*T?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endColumn===g-1&&t)for(this.startColumn=this.endColumn;this.startColumn>0;){const M=s[this.endColumn]+o-s[this.startColumn-1];if((M<=p||c!==Jt)&&(this.startColumn-=1),M>p)break}c===ko&&this.startColumn!==null&&h&&h(this),this.startPosition=s[this.startColumn],this.startPosition===void 0&&(this.startPosition=null),g<this.endColumn&&(this.endColumn=g-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}refreshStretching(e){if(this.stretch==="none")return;let t=e;this.totalTargetWidth=t;const s=Ti.get(this),o=s.totalColumns;let r=0;for(let l=0;l<o;l++){const c=this._getColumnWidth(l),h=s.stretchingColumnWidthFn(void 0,l);typeof h=="number"?t-=h:r+=c}const a=t-r;if(this.stretch==="all"&&a>0)this.stretchAllRatio=t/r,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(this.stretch==="last"&&t!==1/0){const l=this._getColumnWidth(o-1),c=a+l;this.stretchLastWidth=c>=0?c:l}}getStretchedColumnWidth(e,t){let s=null;return this.stretch==="all"&&this.stretchAllRatio!==0?s=this._getStretchedAllColumnWidth(e,t):this.stretch==="last"&&this.stretchLastWidth!==0&&(s=this._getStretchedLastColumnWidth(e)),s}_getStretchedAllColumnWidth(e,t){let s=0;const o=Ti.get(this),r=o.totalColumns;if(!this.stretchAllColumnsWidth[e]){const a=Math.round(t*this.stretchAllRatio),l=o.stretchingColumnWidthFn(a,e);l===void 0?this.stretchAllColumnsWidth[e]=a:this.stretchAllColumnsWidth[e]=isNaN(l)?this._getColumnWidth(e):l}if(this.stretchAllColumnsWidth.length===r&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(let a=0;a<this.stretchAllColumnsWidth.length;a++)s+=this.stretchAllColumnsWidth[a];s!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-s)}return this.stretchAllColumnsWidth[e]}_getStretchedLastColumnWidth(e){const s=Ti.get(this).totalColumns;return e===s-1?this.stretchLastWidth:null}_getColumnWidth(e){let t=Ti.get(this).columnWidthFn(e);return isNaN(t)&&(t=kd.DEFAULT_WIDTH),t}}const Ld=kd,US=new WeakMap;class Vd{static get DEFAULT_HEIGHT(){return 23}constructor(){let{viewportSize:e,scrollOffset:t,totalItems:s,itemSizeFn:o,overrideFn:r,calculationType:a,scrollbarHeight:l}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};US.set(this,{viewportHeight:e,scrollOffset:t,totalRows:s,rowHeightFn:o,overrideFn:r,calculationType:a,horizontalScrollbarHeight:l}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.calculate()}calculate(){const e=US.get(this),t=e.calculationType,s=e.overrideFn,o=e.rowHeightFn,r=e.scrollOffset,a=Math.max(e.scrollOffset,0),l=e.totalRows,c=e.viewportHeight,h=e.horizontalScrollbarHeight||0;let u=0,f=!0;const g=[];let p,C=0,y=0;for(let _=0;_<l;_++)if(p=o(_),isNaN(p)&&(p=Vd.DEFAULT_HEIGHT),u<=a&&t!==Jt&&(this.startRow=_,C=p),u>=a&&u+(t===Jt?p:0)<=a+c-h&&(this.startRow===null&&(this.startRow=_,C=p),this.endRow=_),g.push(u),u+=p,y=p,t!==Jt&&(this.endRow=_),u>=a+c-h){f=!1;break}const b=r+c-h,T=t===Jt?C:0,M=t===Jt?0:y;if(b<T||r>g.at(-1)+M?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endRow===l-1&&f)for(this.startRow=this.endRow;this.startRow>0;){const _=g[this.endRow]+p-g[this.startRow-1];if((_<=c-h||t!==Jt)&&(this.startRow-=1),_>=c-h)break}t===ko&&this.startRow!==null&&s&&s(this),this.startPosition=g[this.startRow],this.startPosition===void 0&&(this.startPosition=null),l<this.endRow&&(this.endRow=l-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}const zS=Vd;function YL(n,e,t){GL(n,e),e.set(n,t)}function GL(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function YS(n,e,t){return e=jL(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function jL(n){var e=KL(n,"string");return typeof e=="symbol"?e:String(e)}function KL(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Yr(n,e){var t=GS(n,e,"get");return XL(n,t)}function XL(n,e){return e.get?e.get.call(n):e.value}function qL(n,e,t){var s=GS(n,e,"set");return ZL(n,s,t),t}function GS(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function ZL(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}var Lo=new WeakMap;class $d{constructor(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;YS(this,"row",null),YS(this,"col",null),YL(this,Lo,{writable:!0,value:!1}),qL(this,Lo,s),typeof e<"u"&&typeof t<"u"&&(this.row=e,this.col=t)}isValid(e){return!(this.row<0||this.col<0||this.row>=e.getSetting("totalRows")||this.col>=e.getSetting("totalColumns"))}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isSouthEastOf(e){return this.row>=e.row&&(Yr(this,Lo)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(Yr(this,Lo)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(Yr(this,Lo)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(Yr(this,Lo)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}clone(){return new $d(this.row,this.col,Yr(this,Lo))}toObject(){return{row:this.row,col:this.col}}}const Gl=$d;function QL(n,e,t){JL(n,e),e.set(n,t)}function JL(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fd(n,e,t){return e=eV(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function eV(n){var e=tV(n,"string");return typeof e=="symbol"?e:String(e)}function tV(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function rs(n,e){var t=jS(n,e,"get");return nV(n,t)}function nV(n,e){return e.get?e.get.call(n):e.value}function sV(n,e,t){var s=jS(n,e,"set");return oV(n,s,t),t}function jS(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function oV(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}var Hn=new WeakMap;class Bd{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;Fd(this,"highlight",null),Fd(this,"from",null),Fd(this,"to",null),QL(this,Hn,{writable:!0,value:!1}),this.highlight=e.clone().normalize(),this.from=t.clone(),this.to=s.clone(),sV(this,Hn,o)}setHighlight(e){return this.highlight=e.clone().normalize(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),t=Math.max(this.to.row,0);return Math.max(e,t)-Math.min(e,t)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),t=Math.max(this.to.col,0);return Math.max(e,t)-Math.min(e,t)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:t,col:s}=e,o=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();return o.row<=t&&r.row>=t&&o.col<=s&&r.col>=s}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopRightCorner().col>=e.getOuterTopLeftCorner().col&&this.getOuterTopRightCorner().col<=e.getOuterTopRightCorner().col||this.getOuterTopLeftCorner().col<=e.getOuterTopRightCorner().col&&this.getOuterTopLeftCorner().col>=e.getOuterTopLeftCorner().col}isOverlappingVertically(e){return this.getOuterBottomRightCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomRightCorner().row<=e.getOuterBottomRightCorner().row||this.getOuterTopRightCorner().row<=e.getOuterBottomRightCorner().row&&this.getOuterTopRightCorner().row>=e.getOuterTopRightCorner().row}expand(e){const t=this.getOuterTopStartCorner(),s=this.getOuterBottomEndCorner();return e.row<t.row||e.col<t.col||e.row>s.row||e.col>s.col?(this.from=this._createCellCoords(Math.min(t.row,e.row),Math.min(t.col,e.col)),this.to=this._createCellCoords(Math.max(s.row,e.row),Math.max(s.col,e.col)),!0):!1}expandByRange(e){if(this.includesRange(e)||!this.overlaps(e))return!1;const t=this.getOuterTopStartCorner(),s=this.getOuterBottomEndCorner(),o=this.getDirection(),r=e.getOuterTopStartCorner(),a=e.getOuterBottomEndCorner(),l=Math.min(t.row,r.row),c=Math.min(t.col,r.col),h=Math.max(s.row,a.row),u=Math.max(s.col,a.col),f=this._createCellCoords(l,c),g=this._createCellCoords(h,u);return this.from=f,this.to=g,this.setDirection(o),this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally(),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return rs(this,Hn)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return rs(this,Hn)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return rs(this,Hn)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return rs(this,Hn)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return rs(this,Hn)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return rs(this,Hn)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return rs(this,Hn)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return rs(this,Hn)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e,t){return t&&t.includes(e)&&(this.getOuterTopLeftCorner().isEqual(this._createCellCoords(t.from.row,t.from.col))||this.getOuterTopRightCorner().isEqual(this._createCellCoords(t.from.row,t.to.col))||this.getOuterBottomLeftCorner().isEqual(this._createCellCoords(t.to.row,t.from.col))||this.getOuterBottomRightCorner().isEqual(this._createCellCoords(t.to.row,t.to.col)))?!0:e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e,t){if(!(e instanceof Gl))return!1;if(t){const{from:s,to:o}=t;if(t.includes(e)){if(this.getOuterTopStartCorner().isEqual(this._createCellCoords(s.row,s.col)))return this.getOuterBottomEndCorner();if(this.getOuterTopEndCorner().isEqual(this._createCellCoords(s.row,o.col)))return this.getOuterBottomStartCorner();if(this.getOuterBottomStartCorner().isEqual(this._createCellCoords(o.row,s.col)))return this.getOuterTopEndCorner();if(this.getOuterBottomEndCorner().isEqual(this._createCellCoords(o.row,o.col)))return this.getOuterTopStartCorner()}}if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const t={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},s={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},o=[];return t.top===s.top&&o.push("top"),t.right===s.right&&o.push("right"),t.bottom===s.bottom&&o.push("bottom"),t.left===s.left&&o.push("left"),o}getInner(){const e=this.getOuterTopStartCorner(),t=this.getOuterBottomEndCorner(),s=[];for(let o=e.row;o<=t.row;o++)for(let r=e.col;r<=t.col;r++)!(this.from.row===o&&this.from.col===r)&&!(this.to.row===o&&this.to.col===r)&&s.push(this._createCellCoords(o,r));return s}getAll(){const e=this.getOuterTopStartCorner(),t=this.getOuterBottomEndCorner(),s=[];for(let o=e.row;o<=t.row;o++)for(let r=e.col;r<=t.col;r++)e.row===o&&e.col===r?s.push(e):t.row===o&&t.col===r?s.push(t):s.push(this._createCellCoords(o,r));return s}forAll(e){const t=this.getOuterTopStartCorner(),s=this.getOuterBottomEndCorner();for(let o=t.row;o<=s.row;o++)for(let r=t.col;r<=s.col;r++)if(e(o,r)===!1)return}clone(){return new Bd(this.highlight,this.from,this.to,rs(this,Hn))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,t){return new Gl(e,t,rs(this,Hn))}}const Wd=Bd;function Ud(n){return window.requestAnimationFrame(n)}function jl(n){window.cancelAnimationFrame(n)}function KS(){return"ontouchstart"in window}let Mi;function iV(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Mi||(typeof Intl=="object"?Mi=new Intl.Collator(n,e).compare:typeof String.prototype.localeCompare=="function"?Mi=(t,s)=>`${t}`.localeCompare(s):Mi=(t,s)=>t===s?0:t>s?-1:1,Mi)}const _i=new WeakMap,XS=class{constructor(e,t,s,o,r,a){let l=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;this.wtSettings=s,this.domBindings=t,this.wtTable=r,this.selections=a,this.parent=l,this.eventManager=o,this.facadeGetter=e,_i.set(this,{selectedCellBeforeTouchEnd:void 0,dblClickTimeout:[null,null],dblClickOrigin:[null,null]}),this.registerEvents()}registerEvents(){this.eventManager.addEventListener(this.wtTable.holder,"contextmenu",s=>this.onContextMenu(s)),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseover",s=>this.onMouseOver(s)),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseout",s=>this.onMouseOut(s));const e=()=>{this.eventManager.addEventListener(this.wtTable.holder,"touchstart",s=>this.onTouchStart(s)),this.eventManager.addEventListener(this.wtTable.holder,"touchend",s=>this.onTouchEnd(s)),this.momentumScrolling||(this.momentumScrolling={}),this.eventManager.addEventListener(this.wtTable.holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||this.wtSettings.getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,this.wtSettings.getSetting("onAfterMomentumScroll"))},200)})},t=()=>{this.eventManager.addEventListener(this.wtTable.holder,"mouseup",s=>this.onMouseUp(s)),this.eventManager.addEventListener(this.wtTable.holder,"mousedown",s=>this.onMouseDown(s))};os()?e():(KS()&&e(),t())}selectedCellWasTouched(e){const t=_i.get(this),o=this.parentCell(e).coords;if(t.selectedCellBeforeTouchEnd&&o){const[r,a]=[o.row,t.selectedCellBeforeTouchEnd.from.row],[l,c]=[o.col,t.selectedCellBeforeTouchEnd.from.col];return r===a&&l===c}return!1}parentCell(e){const t={},s=this.wtTable.TABLE,o=Dl(e,["TD","TH"],s);return o?(t.coords=this.wtTable.getCoords(o),t.TD=o):Ae(e,"wtBorder")&&Ae(e,"current")?(t.coords=this.selections.getCell().cellRange.highlight,t.TD=this.wtTable.getCell(t.coords)):Ae(e,"wtBorder")&&Ae(e,"area")&&this.selections.createOrGetArea().cellRange&&(t.coords=this.selections.createOrGetArea().cellRange.to,t.TD=this.wtTable.getCell(t.coords)),t}onMouseDown(e){const t=_i.get(this),s=this.domBindings.rootDocument.activeElement,o=Qy(hk,e.target),r=e.target;if(r===s||o(0)===s||o(1)===s)return;const a=this.parentCell(r);Ae(r,"corner")?this.wtSettings.getSetting("onCellCornerMouseDown",e,r):a.TD&&this.wtSettings.has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,a.coords,a.TD),(e.button===0||this.touchApplied)&&a.TD&&(t.dblClickOrigin[0]=a.TD,clearTimeout(t.dblClickTimeout[0]),t.dblClickTimeout[0]=setTimeout(()=>{t.dblClickOrigin[0]=null},1e3))}onContextMenu(e){if(this.wtSettings.has("onCellContextMenu")){const t=this.parentCell(e.target);t.TD&&this.callListener("onCellContextMenu",e,t.coords,t.TD)}}onMouseOver(e){if(!this.wtSettings.has("onCellMouseOver"))return;const t=this.wtTable.TABLE,s=Dl(e.target,["TD","TH"],t),o=this.parent||this;s&&s!==o.lastMouseOver&&Oo(s,t)&&(o.lastMouseOver=s,this.callListener("onCellMouseOver",e,this.wtTable.getCoords(s),s))}onMouseOut(e){if(!this.wtSettings.has("onCellMouseOut"))return;const t=this.wtTable.TABLE,s=Dl(e.target,["TD","TH"],t),o=Dl(e.relatedTarget,["TD","TH"],t),r=this.parent||this;s&&s!==o&&Oo(s,t)&&(this.callListener("onCellMouseOut",e,this.wtTable.getCoords(s),s),o===null&&(r.lastMouseOver=null))}onMouseUp(e){const t=_i.get(this),s=this.parentCell(e.target);s.TD&&this.wtSettings.has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,s.coords,s.TD),!(e.button!==0&&!this.touchApplied)&&(s.TD===t.dblClickOrigin[0]&&s.TD===t.dblClickOrigin[1]?(Ae(e.target,"corner")?this.callListener("onCellCornerDblClick",e,s.coords,s.TD):this.callListener("onCellDblClick",e,s.coords,s.TD),t.dblClickOrigin[0]=null,t.dblClickOrigin[1]=null):s.TD===t.dblClickOrigin[0]&&(t.dblClickOrigin[1]=s.TD,clearTimeout(t.dblClickTimeout[1]),t.dblClickTimeout[1]=setTimeout(()=>{t.dblClickOrigin[1]=null},500)))}onTouchStart(e){const t=_i.get(this);t.selectedCellBeforeTouchEnd=this.selections.getCell().cellRange,this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var t;const s=e.target,o=(t=this.parentCell(s))===null||t===void 0?void 0:t.coords,r=he(o)&&o.row>=0&&o.col>=0;if(e.cancelable&&r&&this.wtSettings.getSetting("isDataViewInstance")){const l=["A","BUTTON","INPUT"];gS()&&(Fk()||Bk())&&this.selectedCellWasTouched(s)&&!l.includes(s.tagName)?e.preventDefault():this.selectedCellWasTouched(s)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,t,s,o){const r=this.wtSettings.getSettingPure(e);r&&r(t,s,o,this.facadeGetter())}destroy(){const e=_i.get(this);clearTimeout(e.dblClickTimeout[0]),clearTimeout(e.dblClickTimeout[1]),this.eventManager.destroy()}};class rV{constructor(e,t,s){this.offset=e,this.total=t,this.countTH=s}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}const aV=rV;class lV{constructor(e,t,s){this.offset=e,this.total=t,this.countTH=s}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}const cV=lV,hV=0,Kl=1,Xl=2;class qS{constructor(){this.currentSize=0,this.nextSize=0,this.currentOffset=0,this.nextOffset=0}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}class uV{constructor(){this.size=new qS,this.workingSpace=hV,this.sharedSize=null}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof qS}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=Kl,e.workingSpace=Xl,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=Xl,e.workingSpace=Kl,this.sharedSize=e.getViewSize()}}class ZS{constructor(e,t,s){this.rootNode=e,this.nodesPool=t,this.sizeSet=new uV,this.childNodeType=s.toUpperCase(),this.visualIndex=0,this.collectedNodes=[]}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}getRenderedChildCount(){const{rootNode:e,sizeSet:t}=this;let s=0;if(this.isSharedViewSet()){let o=e.firstElementChild;for(;o;){if(o.tagName===this.childNodeType)s+=1;else if(t.isPlaceOn(Kl))break;o=o.nextElementSibling}}else s=e.childElementCount;return s}start(){this.collectedNodes.length=0,this.visualIndex=0;const{rootNode:e,sizeSet:t}=this,s=this.isSharedViewSet(),{nextSize:o}=t.getViewSize();let r=this.getRenderedChildCount();for(;r<o;){const l=this.nodesPool();!s||s&&t.isPlaceOn(Xl)?e.appendChild(l):e.insertBefore(l,e.firstChild),r+=1}const a=s&&t.isPlaceOn(Kl);for(;r>o;)e.removeChild(a?e.firstChild:e.lastChild),r-=1}render(){const{rootNode:e,sizeSet:t}=this;let s=this.visualIndex;this.isSharedViewSet()&&t.isPlaceOn(Xl)&&(s+=t.sharedSize.nextSize);let o=e.childNodes[s];if(o.tagName!==this.childNodeType){const r=this.nodesPool();e.replaceChild(r,o),o=r}this.collectedNodes.push(o),this.visualIndex+=1}end(){}}class QS extends ZS{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}class dV{constructor(e){this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(){return this.rootDocument.createElement(this.nodeType)}}class Gr{constructor(e,t){this.nodesPool=typeof e=="string"?new dV(e):null,this.nodeType=e,this.rootNode=t,this.table=null,this.renderedNodes=0}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}class fV extends Gr{constructor(){super("TH"),this.orderViews=new WeakMap,this.sourceRowIndex=0}obtainOrderView(e){let t;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new QS(e,s=>this.nodesPool.obtain(this.sourceRowIndex,s),this.nodeType),this.orderViews.set(e,t)),t}render(){const{rowsToRender:e,rowHeaderFunctions:t,rowHeadersCount:s,rows:o,cells:r}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),c=o.getRenderedNode(a);this.sourceRowIndex=l;const h=this.obtainOrderView(c),u=r.obtainOrderView(c);h.appendView(u).setSize(s).setOffset(this.table.renderedColumnToSource(0)).start();for(let f=0;f<s;f++){h.render();const g=h.getCurrentNode();g.className="",g.removeAttribute("style"),t[f](l,g,f)}h.end()}}}class gV extends Gr{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:t}=this.table;let s=this.rootNode.firstChild;if(e){const{columnsToRender:o}=this.table,r=o+t;for(let l=0,c=e;l<c;l++){for(s=this.rootNode.childNodes[l],s||(s=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(s)),this.renderedNodes=s.childNodes.length;this.renderedNodes<r;)s.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>r;)s.removeChild(s.lastChild),this.renderedNodes-=1}const a=this.rootNode.childNodes.length;if(a>e)for(let l=e;l<a;l++)this.rootNode.removeChild(this.rootNode.lastChild)}else s&&ss(s)}render(){const{columnHeadersCount:e}=this.table;for(let t=0;t<e;t+=1){const{columnHeaderFunctions:s,columnsToRender:o,rowHeadersCount:r}=this.table,a=this.rootNode.childNodes[t];for(let l=-1*r;l<o;l+=1){const c=this.table.renderedColumnToSource(l),h=a.childNodes[l+r];h.className="",h.removeAttribute("style"),s[t](c,h,t)}}}}class mV extends Gr{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:t}=this.table,s=e+t;for(;this.renderedNodes<s;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>s;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:t}=this.table;for(let o=0;o<t;o++){const r=this.table.renderedColumnToSource(o),a=this.table.columnUtils.getHeaderWidth(r);this.rootNode.childNodes[o].style.width=`${a}px`}for(let o=0;o<e;o++){const r=this.table.renderedColumnToSource(o),a=this.table.columnUtils.getStretchedColumnWidth(r);this.rootNode.childNodes[o+t].style.width=`${a}px`}const s=this.rootNode.firstChild;s&&oe(s,"rowHeader")}}let JS=!1;class pV extends Gr{constructor(e){super("TR",e),this.orderView=new ZS(e,t=>this.nodesPool.obtain(t),this.nodeType)}getRenderedNode(e){return this.orderView.getNode(e)}render(){const{rowsToRender:e}=this.table;!JS&&e>1e3&&(JS=!0,ut(rt`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\x20
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`)),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let t=0;t<e;t++)this.orderView.render();this.orderView.end()}}class wV extends Gr{constructor(){super("TD"),this.orderViews=new WeakMap,this.sourceRowIndex=0}obtainOrderView(e){let t;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new QS(e,s=>this.nodesPool.obtain(this.sourceRowIndex,s),this.nodeType),this.orderViews.set(e,t)),t}render(){const{rowsToRender:e,columnsToRender:t,rows:s,rowHeaders:o}=this.table;for(let r=0;r<e;r++){const a=this.table.renderedRowToSource(r),l=s.getRenderedNode(r);this.sourceRowIndex=a;const c=this.obtainOrderView(l),h=o.obtainOrderView(l);c.prependView(h).setSize(t).setOffset(this.table.renderedColumnToSource(0)).start();for(let u=0;u<t;u++){c.render();const f=c.getCurrentNode(),g=this.table.renderedColumnToSource(u);Ae(f,"hide")||(f.className=""),f.removeAttribute("style"),f.removeAttribute("dir"),this.table.cellRenderer(a,g,f)}c.end()}}}class CV{constructor(e){let{cellRenderer:t}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.rowHeaders=null,this.columnHeaders=null,this.colGroup=null,this.rows=null,this.cells=null,this.rowFilter=null,this.columnFilter=null,this.rowUtils=null,this.columnUtils=null,this.rowsToRender=0,this.columnsToRender=0,this.rowHeaderFunctions=[],this.rowHeadersCount=0,this.columnHeaderFunctions=[],this.columnHeadersCount=0,this.cellRenderer=t}setAxisUtils(e,t){this.rowUtils=e,this.columnUtils=t}setViewportSize(e,t){this.rowsToRender=e,this.columnsToRender=t}setFilters(e,t){this.rowFilter=e,this.columnFilter=t}setHeaderContentRenderers(e,t){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=t,this.columnHeadersCount=t.length}setRenderers(){let{rowHeaders:e,columnHeaders:t,colGroup:s,rows:o,cells:r}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),t.setTable(this),s.setTable(this),o.setTable(this),r.setTable(this),this.rowHeaders=e,this.columnHeaders=t,this.colGroup=s,this.rows=o,this.cells=r}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:t}=this;for(let s=0;s<e;s++){const o=t.getRenderedNode(s);if(o.firstChild){const r=this.renderedRowToSource(s),a=this.rowUtils.getHeight(r);a?o.firstChild.style.height=`${a-1}px`:o.firstChild.style.height=""}}}}class yV{constructor(){let{TABLE:e,THEAD:t,COLGROUP:s,TBODY:o,rowUtils:r,columnUtils:a,cellRenderer:l}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new CV(e,{cellRenderer:l}),this.renderer.setRenderers({rowHeaders:new fV,columnHeaders:new gV(t),colGroup:new mV(s),rows:new pV(o),cells:new wV}),this.renderer.setAxisUtils(r,a)}setFilters(e,t){return this.renderer.setFilters(e,t),this}setViewportSize(e,t){return this.renderer.setViewportSize(e,t),this}setHeaderContentRenderers(e,t){return this.renderer.setHeaderContentRenderers(e,t),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}class SV{constructor(e,t){this.dataAccessObject=e,this.wtSettings=t,this.headerWidths=new Map}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getStretchedColumnWidth(e){const t=this.dataAccessObject.wtViewport.columnsRenderCalculator;let s=this.getWidth(e);if(t){const o=t.getStretchedColumnWidth(e,s);o&&(s=o)}return s}getHeaderHeight(e){let t=this.wtSettings.getSetting("defaultRowHeight");const s=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return s!==void 0&&(t=t?Math.max(t,s):s),t}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this,{wtTable:t,wtViewport:s,cloneSource:o}=this.dataAccessObject,r=o?o.wtTable.holder:t.holder,a=r.offsetHeight<r.scrollHeight?Ft():0;let l=e.getSetting("rowHeaderWidth");if(s.columnsRenderCalculator.refreshStretching(s.getViewportWidth()-a),l=e.getSetting("onModifyRowHeaderWidth",l),l!=null){const c=e.getSetting("rowHeaders").length,h=e.getSetting("defaultColumnWidth");for(let u=0;u<c;u++){let f=Array.isArray(l)?l[u]:l;f=f??h,this.headerWidths.set(u,f)}}}}class vV{constructor(e,t){this.dataAccessObject=e,this.wtSettings=t}getHeight(e){let t=this.wtSettings.getSetting("rowHeight",e);const s=this.dataAccessObject.wtViewport.oversizedRows[e];return s!==void 0&&(t=t===void 0?s:Math.max(t,s)),t}}function as(n,e,t){return e=bV(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function bV(n){var e=RV(n,"string");return typeof e=="symbol"?e:String(e)}function RV(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class EV{constructor(e,t,s,o,r){as(this,"wtSettings",null),as(this,"domBindings",void 0),as(this,"TBODY",null),as(this,"THEAD",null),as(this,"COLGROUP",null),as(this,"hasTableHeight",!0),as(this,"hasTableWidth",!0),as(this,"isTableVisible",!1),as(this,"tableOffset",0),as(this,"holderOffset",0),this.domBindings=s,this.isMaster=r==="master",this.name=r,this.dataAccessObject=e,this.facadeGetter=t,this.wtSettings=o,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=s.rootTable,jy(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const a=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(a)),this.rowUtils=new vV(this.dataAccessObject,this.wtSettings),this.columnUtils=new SV(this.dataAccessObject,this.wtSettings),this.tableRenderer=new yV({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const t=e.parentNode;let s;return(!t||t.nodeType!==Node.ELEMENT_NODE||!Ae(t,"wtHolder"))&&(s=this.domBindings.rootDocument.createElement("div"),s.className="wtSpreader",t&&t.insertBefore(s,e),s.appendChild(e)),s.style.position="relative",s}createHider(e){const t=e.parentNode;let s;return(!t||t.nodeType!==Node.ELEMENT_NODE||!Ae(t,"wtHolder"))&&(s=this.domBindings.rootDocument.createElement("div"),s.className="wtHider",t&&t.insertBefore(s,e),s.appendChild(e)),s}createHolder(e){const t=e.parentNode;let s;return(!t||t.nodeType!==Node.ELEMENT_NODE||!Ae(t,"wtHolder"))&&(s=this.domBindings.rootDocument.createElement("div"),s.style.position="relative",s.className="wtHolder",t&&t.insertBefore(s,e),this.isMaster&&(s.parentNode.className+="ht_master handsontable",s.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr")),s.appendChild(e)),s}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:t}=this,{wtOverlays:s,wtViewport:o}=this.dataAccessObject,r=t.getSetting("totalRows"),a=t.getSetting("totalColumns"),l=t.getSetting("rowHeaders"),c=l.length,h=t.getSetting("columnHeaders"),u=h.length;let f=!1,g=e;if(this.isMaster&&(this.holderOffset=Ht(this.holder),g=o.createRenderCalculators(g),c&&!t.getSetting("fixedColumnsStart"))){const C=s.inlineStartOverlay.getScrollPosition(),y=this.correctHeaderWidth;this.correctHeaderWidth=C!==0,y!==this.correctHeaderWidth&&(g=!1)}if(this.isMaster&&(f=s.updateStateOfRendering()),g)this.isMaster&&o.createVisibleCalculators(),s&&s.refresh(!0);else{this.isMaster?this.tableOffset=Ht(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const C=r>0?this.getFirstRenderedRow():0,y=a>0?this.getFirstRenderedColumn():0;this.rowFilter=new cV(C,r,u),this.columnFilter=new aV(y,a,c);let b=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const T={};this.wtSettings.getSetting("beforeDraw",!0,T),b=T.skipRender!==!0}if(b){this.tableRenderer.setHeaderContentRenderers(l,h),(this.is(ls)||this.is(Js))&&this.tableRenderer.setHeaderContentRenderers(l,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();let T;if(this.isMaster&&(T=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(ls))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();const M=at(this.hider),_=at(this.TABLE);M!==0&&_!==M&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),T!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(ls)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}let p=!1;return this.isMaster&&(p=s.topOverlay.resetFixedPosition(),s.bottomOverlay.clone&&(p=s.bottomOverlay.resetFixedPosition()||p),p=s.inlineStartOverlay.resetFixedPosition()||p,s.topInlineStartCornerOverlay&&s.topInlineStartCornerOverlay.resetFixedPosition(),s.bottomInlineStartCornerOverlay&&s.bottomInlineStartCornerOverlay.clone&&s.bottomInlineStartCornerOverlay.resetFixedPosition()),p?(s.refreshAll(),s.adjustElementsSize()):this.refreshSelections(g),f&&s.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const t=this.columnFilter.renderedToSource(e);let s=this.wtSettings.getSetting("columnHeaders").length;const o=this.wtSettings.getSetting("defaultRowHeight");let r,a,l;const c=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;s;)s-=1,r=this.getColumnHeaderHeight(s),a=this.getColumnHeader(t,s),a&&(l=qs(a),(!r&&o<l||r<l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[s]=l),Array.isArray(c)?c[s]!==null&&c[s]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[s]=c[s]):isNaN(c)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[s]=c),this.dataAccessObject.wtViewport.oversizedColumnHeaders[s]<(c[s]||c)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[s]=c[s]||c))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,t=this.THEAD.childNodes,s=this.dataAccessObject.wtViewport.oversizedColumnHeaders,o=e.getSetting("columnHeaders");for(let r=0,a=o.length;r<a;r++)if(s[r]){if(!t[r]||t[r].childNodes.length===0)return;t[r].childNodes[0].style.height=`${s[r]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:t}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(ls))&&!e.getSetting("externalRowCalculator")){const s=this.getRenderedRowsCount();for(let o=0;o<s;o++){const r=this.rowFilter.renderedToSource(o);t.oversizedRows&&t.oversizedRows[r]&&(t.oversizedRows[r]=void 0)}}}removeClassFromCells(e){const t=this.TABLE.querySelectorAll(`.${e}`);for(let s=0,o=t.length;s<o;s++)De(t[s],e)}refreshSelections(e){const{wtSettings:t}=this,{selections:s}=this.dataAccessObject;if(!s)return;const o=Array.from(s),r=o.length;if(e){const a=[];for(let h=0;h<r;h++){const{highlightHeaderClassName:u,highlightRowClassName:f,highlightColumnClassName:g}=o[h].settings,p=o[h].classNames,C=p.length;for(let y=0;y<C;y++)a.includes(p[y])||a.push(p[y]);u&&!a.includes(u)&&a.push(u),f&&!a.includes(f)&&a.push(f),g&&!a.includes(g)&&a.push(g)}const l=t.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(l))for(let h=0;h<l.length;h++)a.push(l[h]);const c=a.length;for(let h=0;h<c;h++)this.removeClassFromCells(a[h])}for(let a=0;a<r;a++)o[a].draw(this.facadeGetter(),e)}getCell(e){let t=e.row,s=e.col;const o=this.wtSettings.getSetting("onModifyGetCellCoords",t,s);if(o&&Array.isArray(o)&&([t,s]=o),this.isRowBeforeRenderedRows(t))return-1;if(this.isRowAfterRenderedRows(t))return-2;if(this.isColumnBeforeRenderedColumns(s))return-3;if(this.isColumnAfterRenderedColumns(s))return-4;const r=this.getRow(t);if(!r&&t>=0)throw new Error("TR was expected to be rendered but is not");const a=r.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(s)];if(!a&&s>=0)throw new Error("TD or TH was expected to be rendered but is not");return a}getRow(e){let t=null,s=null;if(e<0){var o;t=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceRowToVisibleColHeadedRow(e),s=this.THEAD}else{var r;t=(r=this.rowFilter)===null||r===void 0?void 0:r.sourceToRendered(e),s=this.TBODY}return t!==void 0&&s!==void 0?s.childNodes.length<t+1?!1:s.childNodes[t]:!1}getColumnHeader(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const s=this.THEAD.childNodes[t];return s==null?void 0:s.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const t=[],s=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(o=>{const r=o.childNodes[s];r&&t.push(r)}),t}getRowHeader(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)===0)return;const s=this.wtSettings.getSetting("rowHeaders").length;if(t>=s)return;const o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)];return o==null?void 0:o.childNodes[t]}getRowHeaders(e){if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)===0)return[];const t=[],s=this.wtSettings.getSetting("rowHeaders").length;for(let o=0;o<s;o++){const r=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],a=r==null?void 0:r.childNodes[o];a&&t.push(a)}return t}getCoords(e){let t=e;if(t.nodeName!=="TD"&&t.nodeName!=="TH"&&(t=Io(t,["TD","TH"])),t===null)return null;const s=t.parentNode,o=s.parentNode;let r=dk(s),a=t.cellIndex;return Ao(Fo,t,this.wtRootElement)||Ao(Vo,t,this.wtRootElement)?o.nodeName==="THEAD"&&(r-=o.childNodes.length):Ao(Js,t,this.wtRootElement)||Ao(ls,t,this.wtRootElement)?r=this.wtSettings.getSetting("totalRows")-o.childNodes.length+r:o===this.THEAD?r=this.rowFilter.visibleColHeadedRowToSourceRow(r):r=this.rowFilter.renderedToSource(r),Ao(Fo,t,this.wtRootElement)||Ao($o,t,this.wtRootElement)||Ao(Js,t,this.wtRootElement)?a=this.columnFilter.offsettedTH(a):a=this.columnFilter.visibleRowHeadedColumnToSourceColumn(a),this.wot.createCellCoords(r,a)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const t=e*this.wtSettings.getSetting("defaultRowHeight"),s=qs(this.TBODY)-1;let o,r,a,l,c;if(!(t===s&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;)e-=1,a=this.rowFilter.renderedToSource(e),o=this.getRowHeight(a),l=this.getTrForRow(a),c=l.querySelector("th"),c?r=qs(c):r=qs(l)-1,(!o&&this.wtSettings.getSetting("defaultRowHeight")<r||o<r)&&(r+=1,this.dataAccessObject.wtViewport.oversizedRows[a]=r)}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const s=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=s}isRowHeaderRendered(e){if(e>=0)return!1;const s=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=s}isRowBeforeRenderedRows(e){const t=this.getFirstRenderedRow();return e<0&&t<=0?!this.isRowHeaderRendered(e):e<t}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const t=this.getFirstRenderedColumn();return e<0&&t<=0?!this.isColumnHeaderRendered(e):e<t}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}getStretchedColumnWidth(e){return this.columnUtils.getStretchedColumnWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return at(this.TABLE)}getHeight(){return vt(this.TABLE)}getTotalWidth(){const e=at(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=vt(this.hider);return e!==0?e:this.getHeight()}isVisible(){return kr(this.TABLE)}_modifyRowHeaderWidth(e){let t=ht(e)?e():null;return Array.isArray(t)?(t=[...t],t[t.length-1]=this._correctRowHeaderWidth(t[t.length-1])):t=this._correctRowHeaderWidth(t),t}_correctRowHeaderWidth(e){let t=e;return typeof e!="number"&&(t=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(t+=1),t}}const Ii=EV,xV="stickyRowsBottom",ev={getFirstRenderedRow(){const n=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),t=n-e;return n===0||e===0?-1:t<0?0:t},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const n=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),n)},getVisibleRowsCount(){return this.getRenderedRowsCount()}};Os(ev,"MIXIN_NAME",xV,{writable:!1,enumerable:!1});const tv=ev,TV="stickyColumnsStart",nv={getFirstRenderedColumn(){return this.wtSettings.getSetting("totalColumns")===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){const n=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),n)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()}};Os(nv,"MIXIN_NAME",TV,{writable:!1,enumerable:!1});const zd=nv;class Yd extends Ii{constructor(e,t,s,o){super(e,t,s,o,Js)}}lt(Yd,tv),lt(Yd,zd);const MV=Yd,Vo="top",ls="bottom",$o="inline_start",Fo="top_inline_start_corner",Js="bottom_inline_start_corner",_V=[Vo,ls,$o,Fo,Js],IV=new Map([[Vo,`ht_clone_${Vo}`],[ls,`ht_clone_${ls}`],[$o,`ht_clone_${$o} ht_clone_left`],[Fo,`ht_clone_${Fo} ht_clone_top_left_corner`],[Js,`ht_clone_${Js} ht_clone_bottom_left_corner`]]);function Gd(n,e,t){return e=OV(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function OV(n){var e=AV(n,"string");return typeof e=="symbol"?e:String(e)}function AV(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class PV{constructor(e){Gd(this,"dataAccessObject",void 0),Gd(this,"lastScrolledColumnPos",-1),Gd(this,"lastScrolledRowPos",-1),this.dataAccessObject=e}scrollViewport(e,t,s,o,r){const a=this.scrollViewportHorizontally(e.col,s,r),l=this.scrollViewportVertically(e.row,t,o);return a||l}scrollViewportHorizontally(e,t,s){const{drawn:o,totalColumns:r}=this.dataAccessObject;if(!o||!Number.isInteger(e)||e<0||e>r)return!1;const a=this.getFirstVisibleColumn(),l=this.getLastVisibleColumn(),c=t===void 0&&s===void 0,{fixedColumnsStart:h,inlineStartOverlay:u}=this.dataAccessObject;if(c&&e<h)return!1;let f=!1;return a===-1?f=u.scrollTo(e,c?e>this.lastScrolledColumnPos:t):(c&&(e<a||e>l)||!c)&&(f=u.scrollTo(e,c?e>l:t)),f&&(this.lastScrolledColumnPos=e),f}scrollViewportVertically(e,t,s){const{drawn:o,totalRows:r}=this.dataAccessObject;if(!o||!Number.isInteger(e)||e<0||e>r)return!1;const a=this.getFirstVisibleRow(),l=this.getLastVisibleRow(),c=t===void 0&&s===void 0,{fixedRowsBottom:h,fixedRowsTop:u,topOverlay:f}=this.dataAccessObject;if(c&&(e<u||e>r-h-1))return!1;let g=!1;return a===-1?g=f.scrollTo(e,c?e>this.lastScrolledRowPos:s):(c&&(e<a||e>l)||!c)&&(g=f.scrollTo(e,c?e>l:s)),g&&(this.lastScrolledRowPos=e),g}getFirstVisibleRow(){const{topOverlay:e,wtTable:t,wtViewport:s,totalRows:o,fixedRowsTop:r,rootWindow:a}=this.dataAccessObject;let l=t.getFirstVisibleRow();if(e.mainTableScrollableElement===a){const c=Ht(t.wtRootElement),h=qs(t.hider),u=qs(a),f=Nl(a,a);if(c.top+h-u<=f){let g=s.getColumnHeaderHeight();g+=e.sumCellSizes(0,r);for(let p=o;p>0;p--)if(g+=e.sumCellSizes(p-1,p),c.top+h-g<=f){l=p;break}}}return l}getLastVisibleRow(){const{topOverlay:e,wtTable:t,wtViewport:s,totalRows:o,rootWindow:r}=this.dataAccessObject;let a=t.getLastVisibleRow();if(e.mainTableScrollableElement===r){const l=Ht(t.wtRootElement),c=Nl(r,r);if(l.top>c){const h=qs(r);let u=s.getColumnHeaderHeight();for(let f=1;f<=o;f++)if(u+=e.sumCellSizes(f-1,f),l.top+u-c>=h){a=f-2;break}}}return a}getFirstVisibleColumn(){const{inlineStartOverlay:e,wtTable:t,wtViewport:s,totalColumns:o,rootWindow:r}=this.dataAccessObject;let a=t.getFirstVisibleColumn();if(e.mainTableScrollableElement===r){const l=Ht(t.wtRootElement),c=kl(t.hider),h=kl(r),u=Math.abs(hd(r,r));if(l.left+c-h<=u){let f=s.getRowHeaderWidth();for(let g=o;g>0;g--)if(f+=e.sumCellSizes(g-1,g),l.left+c-f<=u){a=g;break}}}return a}getLastVisibleColumn(){const{wtSettings:e,inlineStartOverlay:t,wtTable:s,wtViewport:o,totalColumns:r,rootWindow:a}=this.dataAccessObject;let l=s.getLastVisibleColumn();if(t.mainTableScrollableElement===a){const c=e.getSetting("rtlMode");let h=null;if(c){const f=s.TABLE.getBoundingClientRect(),p=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;h=Math.abs(f.right-p)}else h=Ht(s.wtRootElement).left;const u=Math.abs(hd(a,a));if(h>u){const f=kl(a);let g=o.getRowHeaderWidth();for(let p=1;p<=r;p++)if(g+=t.sumCellSizes(p-1,p),h+g-u>=f){l=p-2;break}}}return l}}const DV=PV;function Kn(n,e,t){return e=NV(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function NV(n){var e=HV(n,"string");return typeof e=="symbol"?e:String(e)}function HV(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class jd{get eventManager(){return new bt(this)}constructor(e,t){Kn(this,"wtTable",void 0),Kn(this,"wtScroll",void 0),Kn(this,"wtViewport",void 0),Kn(this,"wtOverlays",void 0),Kn(this,"selections",void 0),Kn(this,"wtEvent",void 0),Kn(this,"guid",`wt_${Wy()}`),Kn(this,"drawInterrupted",!1),Kn(this,"drawn",!1),Kn(this,"domBindings",void 0),Kn(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=t,this.wtScroll=new DV(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let t=0,s=this.wtTable.THEAD.childNodes[0].childNodes.length;t<s;t++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[t].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(t,s){Po(s,e[t])}])}}createCellCoords(e,t){return new Gl(e,t,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,t,s){return new Wd(e,t,s,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!e&&!this.wtTable.isVisible()?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const s=this.wtSettings.getSetting("totalRows"),o=this.wtSettings.getSetting("fixedRowsTop"),r=this.wtSettings.getSetting("fixedRowsBottom"),a=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<o&&e.col<a)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<o)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<a&&e.row>=s-r){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<a)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<s&&e.row>=s-r&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,t,s,o,r){return e.col<0||e.row<0?!1:this.wtScroll.scrollViewport(e,t,s,o,r)}scrollViewportHorizontally(e,t,s){return e<0?!1:this.wtScroll.scrollViewportHorizontally(e,t,s)}scrollViewportVertically(e,t,s){return e<0?!1:this.wtScroll.scrollViewportVertically(e,t,s)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selections(){return e.selections},get drawn(){return e.drawn},set drawn(t){e.drawn=t},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count}}}}function sv(n,e,t){return e=kV(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function kV(n){var e=LV(n,"string");return typeof e=="symbol"?e:String(e)}function LV(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class VV extends jd{constructor(e,t,s){super(e,t),sv(this,"cloneSource",void 0),sv(this,"cloneOverlay",void 0);const o=this.wtSettings.getSetting("facade",this);this.cloneSource=s.source,this.cloneOverlay=s.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),o,this.domBindings,this.wtSettings),this.wtViewport=s.viewport,this.selections=s.selections,this.wtEvent=new XS(o,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selections,s.event),this.findOriginalHeaders()}}function $V(n,e,t){return e=FV(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function FV(n){var e=BV(n,"string");return typeof e=="symbol"?e:String(e)}function BV(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class jr{constructor(e,t,s,o,r){$V(this,"wtSettings",null),Os(this,"wot",e,{writable:!1}),this.domBindings=r,this.facadeGetter=t,this.wtSettings=o;const{TABLE:a,hider:l,spreader:c,holder:h,wtRootElement:u}=this.wot.wtTable;this.instance=this.wot,this.type=s,this.mainTableScrollableElement=null,this.TABLE=a,this.hider=l,this.spreader=c,this.holder=h,this.wtRootElement=u,this.trimmingContainer=bi(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}updateStateOfRendering(){const e=this.needFullRender;this.needFullRender=this.shouldBeRendered();const t=e!==this.needFullRender;return t&&!this.needFullRender&&this.reset(),t}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=bi(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:t}=this.domBindings;t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=Hl(e.TABLE)}getRelativeCellPosition(e,t,s){if(this.clone.wtTable.holder.contains(e)===!1){ut(`The provided element is not a child of the ${this.type} overlay`);return}const o=this.mainTableScrollableElement===this.domBindings.rootWindow,r=s<this.wtSettings.getSetting("fixedColumnsStart"),a=t<this.wtSettings.getSetting("fixedRowsTop"),l=t>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),c=this.clone.wtTable.spreader,h={start:this.getRelativeStartPosition(c),top:c.offsetTop},u={start:this.getRelativeStartPosition(e),top:e.offsetTop};let f=null;return o?f=this.getRelativeCellPositionWithinWindow(a,r,u,h):f=this.getRelativeCellPositionWithinHolder(a,l,r,u,h),f}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,t,s,o){const r=this.wot.wtTable.wtRootElement.getBoundingClientRect();let a=0,l=0;if(!t)a=o.start;else{let c=r.left;this.isRtl()&&(c=this.domBindings.rootWindow.innerWidth-(r.left+r.width+Ft())),a=c<=0?-1*c:0}return e?l=this.clone.wtTable.TABLE.getBoundingClientRect().top-r.top:l=o.top,{start:s.start+a,top:s.top+l}}getRelativeCellPositionWithinHolder(e,t,s,o,r){const a={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let l=0,c=0;if(s||(l=a.horizontal-r.start),t){const h=this.wot.wtTable.wtRootElement.getBoundingClientRect();c=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+h.top}else e||(c=a.vertical-r.top);return{start:o.start-l,top:o.top-c}}makeClone(){if(_V.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e}=this.wot,{rootDocument:t,rootWindow:s}=this.domBindings,o=t.createElement("DIV"),r=t.createElement("TABLE"),a=e.wtRootElement.parentNode;o.className=`${IV.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,r.className=e.TABLE.className,o.appendChild(r),a.appendChild(o);const l=this.wtSettings.getSetting("preventOverflow");return l===!0||l==="horizontal"&&this.type===Vo||l==="vertical"&&this.type===$o?this.mainTableScrollableElement=s:s.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=Hl(e.TABLE),new VV(r,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selections:this.wot.selections})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const t=this.shouldBeRendered();this.clone&&(this.needFullRender||t)&&this.clone.draw(e),this.needFullRender=t}reset(){if(!this.clone)return;const e=this.clone.wtTable.holder,t=this.clone.wtTable.hider,s=e.style,o=t.style,r=e.parentNode.style;N([s,o,r],a=>{a.width="",a.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class WV extends jr{constructor(e,t,s,o,r,a){super(e,t,Js,s,o),this.bottomOverlay=r,this.inlineStartOverlay=a}createTable(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return new MV(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const t=this.clone.wtTable.holder.parentNode;if(t.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const r=this.inlineStartOverlay.getOverlayOffset(),a=this.bottomOverlay.getOverlayOffset();t.style[this.isRtl()?"right":"left"]=`${r}px`,t.style.bottom=`${a}px`}else Vl(t),this.repositionOverlay();let s=vt(this.clone.wtTable.TABLE);const o=at(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(s=0),t.style.height=`${s}px`,t.style.width=`${o}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:s}=this.domBindings,o=this.clone.wtTable.holder.parentNode;let r=0;t.hasVerticalScroll()||(r+=t.getWorkspaceHeight()-e.getTotalHeight()),t.hasVerticalScroll()&&t.hasHorizontalScroll()&&(r+=Ft(s)),o.style.bottom=`${r}px`}}const UV="calculatedColumns",ov={getFirstRenderedColumn(){const n=this.dataAccessObject.startColumnRendered;return n===null?-1:n},getFirstVisibleColumn(){const n=this.dataAccessObject.startColumnVisible;return n===null?-1:n},getLastRenderedColumn(){const n=this.dataAccessObject.endColumnRendered;return n===null?-1:n},getLastVisibleColumn(){const n=this.dataAccessObject.endColumnVisible;return n===null?-1:n},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible}};Os(ov,"MIXIN_NAME",UV,{writable:!1,enumerable:!1});const Kd=ov;class Xd extends Ii{constructor(e,t,s,o){super(e,t,s,o,ls)}}lt(Xd,tv),lt(Xd,Kd);const zV=Xd;function YV(n,e,t){return e=GV(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function GV(n){var e=jV(n,"string");return typeof e=="symbol"?e:String(e)}function jV(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class KV extends jr{constructor(e,t,s,o){super(e,t,ls,s,o),YV(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return new zV(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,t=this.clone.wtTable.holder.parentNode;t.style.top="";let s=0;const o=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!o||o!=="vertical")?(s=this.getOverlayOffset(),t.style.bottom=`${s}px`):(s=this.getScrollPosition(),this.repositionOverlay());const r=this.adjustHeaderBordersPosition(s);return this.adjustElementsSize(),r}repositionOverlay(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:s}=this.domBindings,o=this.clone.wtTable.holder.parentNode;let r=0;t.hasVerticalScroll()||(r+=t.getWorkspaceHeight()-e.getTotalHeight()),t.hasVerticalScroll()&&t.hasHorizontalScroll()&&(r+=Ft(s)),o.style.bottom=`${r}px`}setScrollPosition(e){const{rootWindow:t}=this.domBindings;let s=!1;return this.mainTableScrollableElement===t?(t.scrollTo(vi(t),e),s=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,s=!0),s}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,t){const{wtTable:s,wtSettings:o}=this.wot,r=o.getSetting("defaultRowHeight");let a=e,l=0;for(;a<t;){const c=s.getRowHeight(a);l+=c===void 0?r:c,a+=1}return l}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:s,rootWindow:o}=this.domBindings,r=Ft(s),l=this.clone.wtTable.holder.parentNode.style,c=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==o||c==="horizontal"){let u=t.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(u-=r),u=Math.min(u,e.wtRootElement.scrollWidth),l.width=`${u}px`}else l.width="";this.clone.wtTable.holder.style.width=l.width;let h=vt(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(h=0),l.height=`${h}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:t}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?t.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:t.style[e]=""}scrollTo(e,t){let s=this.getTableParentOffset();const r=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let a=0;t&&r.offsetHeight!==r.clientHeight&&(a=Ft(this.domBindings.rootDocument)),t?(s+=this.sumCellSizes(0,e+1),s-=this.wot.wtViewport.getViewportHeight(),s+=1):s+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),s+=a,this.setScrollPosition(s)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Nl(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let s=0;if(this.trimmingContainer===e&&(!t||t!=="vertical")){const o=this.wot.wtTable.getTotalHeight(),r=this.clone.wtTable.getTotalHeight(),a=o-r,l=this.domBindings.rootDocument.documentElement.clientHeight;s=Math.max(this.getTableParentOffset()-this.getScrollPosition()-l+o,0),s>a&&(s=0)}return s}adjustHeaderBordersPosition(e){const t=this.wtSettings.getSetting("fixedRowsBottom"),s=this.cachedFixedRowsBottom!==t,o=this.wtSettings.getSetting("columnHeaders");let r=!1;if((s||t===0)&&o.length>0){const a=this.wot.wtTable.holder.parentNode,l=Ae(a,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(oe(a,"innerBorderBottom"),r=!l):(De(a,"innerBorderBottom"),r=l)}return r}}const XV="calculatedRows",iv={getFirstRenderedRow(){const n=this.dataAccessObject.startRowRendered;return n===null?-1:n},getFirstVisibleRow(){const n=this.dataAccessObject.startRowVisible;return n===null?-1:n},getLastRenderedRow(){const n=this.dataAccessObject.endRowRendered;return n===null?-1:n},getLastVisibleRow(){const n=this.dataAccessObject.endRowVisible;return n===null?-1:n},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible}};Os(iv,"MIXIN_NAME",XV,{writable:!1,enumerable:!1});const rv=iv;class qd extends Ii{constructor(e,t,s,o){super(e,t,s,o,$o)}}lt(qd,rv),lt(qd,zd);const qV=qd;class ZV extends jr{constructor(e,t,s,o){super(e,t,$o,s,o)}createTable(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return new qV(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!e.holder.parentNode)return!1;const{rootWindow:t}=this.domBindings,s=this.clone.wtTable.holder.parentNode,o=this.wtSettings.getSetting("preventOverflow");let r=0;this.trimmingContainer===t&&(!o||o!=="horizontal")?(r=this.getOverlayOffset()*(this.isRtl()?-1:1),dd(s,`${r}px`,"0px")):(r=this.getScrollPosition(),Vl(s));const a=this.adjustHeaderBordersPosition(r);return this.adjustElementsSize(),a}setScrollPosition(e){const{rootWindow:t}=this.domBindings;let s=!1;return this.isRtl()&&(e=-e),this.mainTableScrollableElement===t&&t.scrollX!==e?(t.scrollTo(e,Lr(t)),s=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,s=!0),s}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,t){const s=this.wtSettings.getSetting("defaultColumnWidth");let o=e,r=0;for(;o<t;)r+=this.wot.wtTable.getStretchedColumnWidth(o)||s,o+=1;return r}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:t,rootWindow:s}=this.domBindings,o=Ft(t),a=this.clone.wtTable.holder.parentNode.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==s||l==="vertical"){let h=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(h-=o),h=Math.min(h,e.wtRootElement.scrollHeight),a.height=`${h}px`}else a.height="";this.clone.wtTable.holder.style.height=a.height;const c=at(this.clone.wtTable.TABLE);a.width=`${c}px`}adjustRootChildrenSize(){var e;const{holder:t}=this.clone.wtTable,{selections:s}=this.wot,o=this.facadeGetter(),r=Math.abs((e=s==null?void 0:s.getCell().getBorder(o).cornerCenterPointOffset)!==null&&e!==void 0?e:0);this.clone.wtTable.hider.style.height=this.hider.style.height,t.style.height=t.parentNode.style.height,t.style.width=`${parseInt(t.parentNode.style.width,10)+r}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),t=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[t]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[t]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,t){let s=this.getTableParentOffset();const r=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let a=0;if(t){const l=this.wot.wtTable.getColumnWidth(e),c=this.wot.wtViewport.getViewportWidth();l>c&&(t=!1)}return t&&r.offsetWidth!==r.clientWidth&&(a=Ft(this.domBindings.rootDocument)),t?(s+=this.sumCellSizes(0,e+1),s-=this.wot.wtViewport.getViewportWidth()):s+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),s+=a,this.setScrollPosition(s)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let t=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(t=this.wot.wtTable.holderOffset.left),t}getScrollPosition(){return Math.abs(hd(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let s=0;if(this.trimmingContainer===e&&(!t||t!=="horizontal")){this.isRtl()?s=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):s=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const o=this.wot.wtTable.getTotalWidth(),r=this.clone.wtTable.getTotalWidth(),a=o-r;s>a&&(s=0)}return s}adjustHeaderBordersPosition(e){const t=this.wot.wtTable.holder.parentNode,s=this.wtSettings.getSetting("rowHeaders"),o=this.wtSettings.getSetting("fixedColumnsStart");this.wtSettings.getSetting("totalRows")?De(t,"emptyRows"):oe(t,"emptyRows");let a=!1;if(o&&!s.length)oe(t,"innerBorderLeft innerBorderInlineStart");else if(!o&&s.length){const l=Ae(t,"innerBorderInlineStart");e?(oe(t,"innerBorderLeft innerBorderInlineStart"),a=!l):(De(t,"innerBorderLeft innerBorderInlineStart"),a=l)}return a}}const QV="stickyRowsTop",av={getFirstRenderedRow(){return this.wtSettings.getSetting("totalRows")===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const n=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),n)},getVisibleRowsCount(){return this.getRenderedRowsCount()}};Os(av,"MIXIN_NAME",QV,{writable:!1,enumerable:!1});const lv=av;class Zd extends Ii{constructor(e,t,s,o){super(e,t,s,o,Fo)}}lt(Zd,lv),lt(Zd,zd);const JV=Zd;function cv(n,e,t){return e=e$(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function e$(n){var e=t$(n,"string");return typeof e=="symbol"?e:String(e)}function t$(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class n$ extends jr{constructor(e,t,s,o,r,a){super(e,t,Fo,s,o),cv(this,"topOverlay",void 0),cv(this,"inlineStartOverlay",void 0),this.topOverlay=r,this.inlineStartOverlay=a}createTable(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return new JV(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const o=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),r=this.topOverlay.getOverlayOffset();dd(e,`${o}px`,`${r}px`)}else Vl(e);let t=vt(this.clone.wtTable.TABLE);const s=at(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(t=0),e.style.height=`${t}px`,e.style.width=`${s}px`,!1}}class Qd extends Ii{constructor(e,t,s,o){super(e,t,s,o,Vo)}}lt(Qd,lv),lt(Qd,Kd);const s$=Qd;function o$(n,e,t){return e=i$(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function i$(n){var e=r$(n,"string");return typeof e=="symbol"?e:String(e)}function r$(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class a$ extends jr{constructor(e,t,s,o){super(e,t,Vo,s,o),o$(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return new s$(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:t}=this.domBindings,s=this.wtSettings.getSetting("preventOverflow");let o=0,r=!1;if(this.trimmingContainer===t&&(!s||s!=="vertical")){const{wtTable:l}=this.wot,c=l.hider.getBoundingClientRect(),h=Math.ceil(c.bottom),u=e.offsetHeight;r=h===u,o=this.getOverlayOffset(),dd(e,"0px",`${o}px`)}else o=this.getScrollPosition(),Vl(e);const a=this.adjustHeaderBordersPosition(o,r);return this.adjustElementsSize(),a}setScrollPosition(e){const t=this.domBindings.rootWindow;let s=!1;return this.mainTableScrollableElement===t&&t.scrollY!==e?(t.scrollTo(vi(t),e),s=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,s=!0),s}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,t){const s=this.wtSettings.getSetting("defaultRowHeight");let o=e,r=0;for(;o<t;){const a=this.wot.wtTable.getRowHeight(o);r+=a===void 0?s:a,o+=1}return r}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:t,rootWindow:s}=this.domBindings,o=Ft(t),a=this.clone.wtTable.holder.parentNode.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==s||l==="horizontal"){let h=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(h-=o),h=Math.min(h,e.wtRootElement.scrollWidth),a.width=`${h}px`}else a.width="";this.clone.wtTable.holder.style.width=a.width;let c=vt(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(c=0),a.height=`${c}px`}adjustRootChildrenSize(){var e;const{holder:t}=this.clone.wtTable,{selections:s}=this.wot,o=this.facadeGetter(),r=Math.abs((e=s==null?void 0:s.getCell().getBorder(o).cornerCenterPointOffset)!==null&&e!==void 0?e:0);this.clone.wtTable.hider.style.width=this.hider.style.width,t.style.width=t.parentNode.style.width,t.style.height=`${parseInt(t.parentNode.style.height,10)+r}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:t}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?t.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:t.style[e]=""}scrollTo(e,t){const{wot:s,wtSettings:o}=this,a=(s.cloneSource?s.cloneSource:s).wtTable.holder;let l=this.getTableParentOffset(),c=0;if(t){const h=this.wot.wtTable.getRowHeight(e),u=this.wot.wtViewport.getViewportHeight();h>u&&(t=!1)}if(t&&a.offsetHeight!==a.clientHeight&&(c=Ft(this.domBindings.rootDocument)),t){const h=o.getSetting("fixedRowsBottom"),u=o.getSetting("totalRows");l+=this.sumCellSizes(0,e+1),l-=s.wtViewport.getViewportHeight()-this.sumCellSizes(u-h,u),l+=1}else l+=this.sumCellSizes(o.getSetting("fixedRowsTop"),e);return l+=c,this.setScrollPosition(l)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Nl(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let s=0;if(this.trimmingContainer===e&&(!t||t!=="vertical")){const o=this.wot.wtTable.getTotalHeight(),r=this.clone.wtTable.getTotalHeight(),a=o-r;s=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),s>a&&(s=0)}return s}adjustHeaderBordersPosition(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const s=this.wot.wtTable.holder.parentNode;this.wtSettings.getSetting("totalColumns")?De(s,"emptyColumns"):oe(s,"emptyColumns");let r=!1;if(!t){const a=this.wtSettings.getSetting("fixedRowsTop"),l=this.cachedFixedRowsTop!==a,c=this.wtSettings.getSetting("columnHeaders");if((l||a===0)&&c.length>0){const h=Ae(s,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),e||this.wtSettings.getSetting("totalRows")===0?(oe(s,"innerBorderTop"),r=!h):(De(s,"innerBorderTop"),r=h)}}return r}}function Ps(n,e,t){return e=l$(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function l$(n){var e=c$(n,"string");return typeof e=="symbol"?e:String(e)}function c$(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class h${constructor(e,t,s,o,r,a){Ps(this,"wot",null),Ps(this,"topOverlay",null),Ps(this,"bottomOverlay",null),Ps(this,"inlineStartOverlay",null),Ps(this,"topInlineStartCornerOverlay",null),Ps(this,"bottomInlineStartCornerOverlay",null),Ps(this,"browserLineHeight",void 0),Ps(this,"wtSettings",null),Ps(this,"resizeObserver",new ResizeObserver(u=>{Ud(()=>{!Array.isArray(u)||!u.length||this.wtSettings.getSetting("onContainerElementResize")})})),this.wot=e,this.wtSettings=o,this.domBindings=s,this.facadeGetter=t,this.wtTable=a;const{rootDocument:l,rootWindow:c}=this.domBindings;this.instance=this.wot,this.eventManager=r,this.scrollbarSize=Ft(l);const h=c.getComputedStyle(a.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=h?a.holder:Hl(a.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=c.scrollX,this.lastScrollY=c.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const t=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return e&&t.push(this.wtTable),t}initBrowserLineHeight(){const{rootWindow:e,rootDocument:t}=this.domBindings,s=e.getComputedStyle(t.body),o=parseInt(s.lineHeight,10),r=parseInt(s.fontSize,10)*1.2;this.browserLineHeight=o||r}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new a$(...e),this.bottomOverlay=new KV(...e),this.inlineStartOverlay=new ZV(...e),this.topInlineStartCornerOverlay=new n$(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new WV(...e,this.bottomOverlay,this.inlineStartOverlay)}updateStateOfRendering(){let e=this.topOverlay.updateStateOfRendering();return e=this.bottomOverlay.updateStateOfRendering()||e,e=this.inlineStartOverlay.updateStateOfRendering()||e,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(e=this.topInlineStartCornerOverlay.updateStateOfRendering()||e),this.bottomOverlay.needFullRender&&(e=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||e)),e}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:t}=this.domBindings,{mainTableScrollableElement:s}=this.topOverlay,{mainTableScrollableElement:o}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",f=>this.onKeyDown(f)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(s,"scroll",f=>this.onTableScroll(f),{passive:!0}),s!==o&&this.eventManager.addEventListener(o,"scroll",f=>this.onTableScroll(f),{passive:!0});const r=t.devicePixelRatio&&t.devicePixelRatio>1,a=this.scrollableElement===t,l=this.wtSettings.getSetting("preventWheel"),c={passive:a};(l||r||!fS())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",f=>this.onCloneWheel(f,l),c),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(f=>{if(f&&f.needFullRender){const{holder:g}=f.clone.wtTable;this.eventManager.addEventListener(g,"wheel",p=>this.onCloneWheel(p,l),c)}});let u;this.eventManager.addEventListener(t,"resize",()=>{clearTimeout(u),u=setTimeout(()=>{this.wtSettings.getSetting("onWindowResize")},200)}),a||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(e){const t=this.domBindings.rootWindow,s=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,r=e.target;this.keyPressed&&(o!==t&&r!==t&&!e.target.contains(o)||s!==t&&r!==t&&!e.target.contains(s))||this.syncScrollPositions(e)}onCloneWheel(e,t){const{rootWindow:s}=this.domBindings,o=this.inlineStartOverlay.mainTableScrollableElement,r=this.topOverlay.mainTableScrollableElement,a=e.target,l=r!==s&&a!==s&&!a.contains(r),c=o!==s&&a!==s&&!a.contains(o);if(this.keyPressed&&(l||c))return;const h=this.translateMouseWheelToScroll(e);(t||this.scrollableElement!==s&&h)&&e.preventDefault()}onKeyDown(e){this.keyPressed=Wr(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let t=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,s=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(s+=s*this.browserLineHeight,t+=t*this.browserLineHeight);const o=this.scrollVertically(t),r=this.scrollHorizontally(s);return o||r}scrollVertically(e){const t=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,t!==this.scrollableElement.scrollTop}scrollHorizontally(e){const t=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,t!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const{rootWindow:e}=this.domBindings,t=this.topOverlay.clone.wtTable.holder,s=this.inlineStartOverlay.clone.wtTable.holder,[o,r]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=t.scrollLeft!==o||this.lastScrollX!==e.scrollX,this.verticalScrolling=s.scrollTop!==r||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){t.scrollLeft=o;const a=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;a&&(a.scrollLeft=o)}this.verticalScrolling&&(s.scrollTop=r),this.refreshAll()}syncScrollWithMaster(){const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:t,scrollTop:s}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=t),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=t),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=s)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:t}=this.domBindings;t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=Hl(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,t=e.clientWidth,s=e.clientHeight,o=t!==this.spreaderLastSize.width||s!==this.spreaderLastSize.height;return o&&(this.spreaderLastSize.width=t,this.spreaderLastSize.height=s),o}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtViewport:t}=this.wot,{wtTable:s}=this,o=this.wtSettings.getSetting("totalColumns"),r=this.wtSettings.getSetting("totalRows"),a=t.getRowHeaderWidth(),l=t.getColumnHeaderHeight(),c=s.hider.style;if(c.width=`${a+this.inlineStartOverlay.sumCellSizes(0,o)}px`,c.height=`${l+this.topOverlay.sumCellSizes(0,r)+1}px`,this.scrollbarSize>0){const{scrollHeight:h,scrollWidth:u}=s.wtRootElement,{scrollHeight:f,scrollWidth:g}=s.holder;this.hasScrollbarRight=h<f,this.hasScrollbarBottom=u<g,this.hasScrollbarRight&&s.hider.scrollWidth+this.scrollbarSize>u?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&s.hider.scrollHeight+this.scrollbarSize>h&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(e),this.inlineStartOverlay.adjustElementsSize(e),this.bottomOverlay.adjustElementsSize(e)}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const t=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let s=null;return N(t,o=>{o&&o.clone&&o.clone.wtTable.TABLE.contains(e)&&(s=o.clone)}),s}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,t=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];N(t,s=>{s&&(s.clone.wtTable.TABLE.className=e.className)})}}const u$=h$;function hv(n,e,t){return e=d$(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function d$(n){var e=f$(n,"string");return typeof e=="symbol"?e:String(e)}function f$(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class g${constructor(e){hv(this,"settings",{}),hv(this,"defaults",Object.freeze(this.getDefaults())),Be(this.defaults,(t,s)=>{if(e[s]!==void 0)this.settings[s]=e[s];else{if(t===void 0)throw new Error(`A required setting "${s}" was not provided`);this.settings[s]=t}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,t,s)=>{const o=this.getSetting("data",e,t);Po(s,o??"")},columnWidth(){},rowHeight(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:e=>e,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1}}update(e,t){return t===void 0?Be(e,(s,o)=>{this.settings[o]=s}):this.settings[e]=t,this}getSetting(e,t,s,o,r){return typeof this.settings[e]=="function"?this.settings[e](t,s,o,r):t!==void 0&&Array.isArray(this.settings[e])?this.settings[e][t]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class Jd extends Ii{constructor(e,t,s,o){super(e,t,s,o,"master")}alignOverlaysWithTrimmingContainer(){const e=bi(this.wtRootElement),{rootWindow:t}=this.domBindings;if(e===t)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const s=e.parentElement,o=Vr(e,"height",t),r=Vr(e,"overflow",t),a=this.holder.style,{scrollWidth:l,scrollHeight:c}=e;let{width:h,height:u}=e.getBoundingClientRect();if(s&&["auto","hidden","scroll"].includes(r)){const g=e.cloneNode(!1);g.style.overflow="auto",g.style.position="absolute",e.nextElementSibling?s.insertBefore(g,e.nextElementSibling):s.appendChild(g);const p=parseInt(Do(g,t).height,10);s.removeChild(g),p===0&&(u=0)}u=Math.min(u,c),a.height=o==="auto"?"auto":`${u}px`,h=Math.min(h,l),a.width=`${h}px`,a.overflow="",this.hasTableHeight=a.height==="auto"?!0:u>0,this.hasTableWidth=h>0}this.isTableVisible=kr(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:t}=this.dataAccessObject,s="master",r=e.getSetting("columnHeaders").length;if(r&&!t.hasOversizedColumnHeadersMarked[s]){const l=e.getSetting("rowHeaders").length,c=this.getRenderedColumnsCount();for(let h=0;h<r;h++)for(let u=-1*l;u<c;u++)this.markIfOversizedColumnHeader(u);t.hasOversizedColumnHeadersMarked[s]=!0}}}lt(Jd,rv),lt(Jd,Kd);const m$=Jd;class p${constructor(e,t,s,o,r){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=t,this.wtSettings=s,this.wtTable=r,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=o,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,t=this.dataAccessObject.topOverlayTrimmingContainer;let s=0;return t===this.domBindings.rootWindow?s=e.documentElement.clientHeight:s=vt(t)>0&&t.clientHeight>0?t.clientHeight:1/0,s}getWorkspaceWidth(){const{wtSettings:e}=this,{rootDocument:t,rootWindow:s}=this.domBindings,o=this.dataAccessObject.inlineStartOverlayTrimmingContainer,r=t.documentElement.offsetWidth,a=e.getSetting("totalColumns"),l=e.getSetting("preventOverflow"),c=e.getSetting("rtlMode"),h=this.wtTable.TABLE.getBoundingClientRect(),u=c?h.right-r:h.left,f=r-u;let g,p;if(l)return at(this.wtTable.wtRootElement);if(e.getSetting("freezeOverlays")?g=Math.min(f,r):g=Math.min(this.getContainerFillWidth(),f,r),o===s&&a>0&&this.sumColumnWidths(0,a-1)>g)return t.documentElement.clientWidth;if(o!==s&&(p=Vr(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",s),p==="scroll"||p==="hidden"||p==="auto"))return Math.max(g,o.clientWidth);const C=e.getSetting("stretchH");return C==="none"||!C?Math.max(g,at(this.wtTable.TABLE)):g}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}sumColumnWidths(e,t){let s=0,o=e;for(;o<t;)s+=this.wtTable.getColumnWidth(o),o+=1;return s}getContainerFillWidth(){if(this.containerWidth)return this.containerWidth;const e=this.wtTable.holder,t=this.domBindings.rootDocument.createElement("div");t.style.width="100%",t.style.height="1px",e.appendChild(t);const s=t.offsetWidth;return this.containerWidth=s,e.removeChild(t),s}getWorkspaceOffset(){return Ht(this.wtTable.TABLE)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=vt(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const t=this.getColumnHeaderHeight();return t>0&&(e-=t),e}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),t=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let s=0,o=t.length;s<o;s++)this.rowHeaderWidth+=e[s]||e}if(isNaN(this.rowHeaderWidth))if(t.length){let s=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let o=0,r=t.length;o<r;o++)s?(this.rowHeaderWidth+=at(s),s=s.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const t=this.getRowHeaderWidth();return t>0?e-t:e}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ko;const{wtSettings:t,wtTable:s}=this;let o,r,a;this.rowHeaderWidth=NaN,t.getSetting("renderAllRows")&&e===ko?o=1/0:o=this.getViewportHeight();let l=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const c=t.getSetting("fixedRowsTop"),h=t.getSetting("fixedRowsBottom"),u=t.getSetting("totalRows");return c&&l>=0&&(a=this.dataAccessObject.topOverlay.sumCellSizes(0,c),l+=a,o-=a),h&&this.dataAccessObject.bottomOverlay.clone&&(a=this.dataAccessObject.bottomOverlay.sumCellSizes(u-h,u),o-=a),s.holder.clientHeight===s.holder.offsetHeight?r=0:r=Ft(this.domBindings.rootDocument),new zS({viewportSize:o,scrollOffset:l,totalItems:t.getSetting("totalRows"),itemSizeFn:f=>s.getRowHeight(f),overrideFn:t.getSettingPure("viewportRowCalculatorOverride"),calculationType:e,scrollbarHeight:r})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ko;const{wtSettings:t,wtTable:s}=this;let o=this.getViewportWidth(),r=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const a=t.getSetting("fixedColumnsStart");if(a&&r>=0){const l=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,a);r+=l,o-=l}return s.holder.clientWidth!==s.holder.offsetWidth&&(o-=Ft(this.domBindings.rootDocument)),new Ld({viewportSize:o,scrollOffset:r,totalItems:t.getSetting("totalColumns"),itemSizeFn:l=>s.getColumnWidth(l),overrideFn:t.getSettingPure("viewportColumnCalculatorOverride"),calculationType:e,stretchMode:t.getSetting("stretchH"),stretchingItemWidthFn:(l,c)=>t.getSetting("onBeforeStretchingColumnWidth",l,c),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createRenderCalculators(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(t){const s=this.createRowsCalculator(Jt),o=this.createColumnsCalculator(Jt);this.areAllProposedVisibleRowsAlreadyRendered(s)&&this.areAllProposedVisibleColumnsAlreadyRendered(o)||(t=!1)}return t||(this.rowsRenderCalculator=this.createRowsCalculator(ko),this.columnsRenderCalculator=this.createColumnsCalculator(ko)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,t}createVisibleCalculators(){this.rowsVisibleCalculator=this.createRowsCalculator(Jt),this.columnsVisibleCalculator=this.createColumnsCalculator(Jt)}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;const{startRow:t,endRow:s,isVisibleInTrimmingContainer:o}=e;if(t===null&&s===null)return!o;const{startRow:r,endRow:a}=this.rowsRenderCalculator;return t<r||t===r&&t>0?!1:!(s>a||s===a&&s<this.wtSettings.getSetting("totalRows")-1)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;const{startColumn:t,endColumn:s,isVisibleInTrimmingContainer:o}=e;if(t===null&&s===null)return!o;const{startColumn:r,endColumn:a}=this.columnsRenderCalculator;return t<r||t===r&&t>0?!1:!(s>a||s===a&&s<this.wtSettings.getSetting("totalColumns")-1)}resetHasOversizedColumnHeadersMarked(){Be(this.hasOversizedColumnHeadersMarked,(e,t,s)=>{s[t]=void 0})}}const w$=p$;class C$ extends jd{constructor(e,t){super(e,new g$(t));const s=this.wtSettings.getSetting("facade",this);this.wtTable=new m$(this.getTableDao(),s,this.domBindings,this.wtSettings),this.wtViewport=new w$(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selections=this.wtSettings.getSetting("selections"),this.wtEvent=new XS(s,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selections),this.wtOverlays=new u$(this,s,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},t=[],s=[];Be(e,(o,r)=>{this.wtSettings.getSetting(r).length&&s.push(o),t.push(o)}),De(this.wtTable.wtRootElement.parentNode,t),oe(this.wtTable.wtRootElement.parentNode,s)}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class ef{constructor(e){e instanceof jd?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=t=>{const s=new ef(t);return()=>s},this._wot=new C$(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selections(){return this._wot.selections}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,t){return this._wot.createCellCoords(e,t)}createCellRange(e,t,s){return this._wot.createCellRange(e,t,s)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,t)}scrollViewport(e,t,s,o,r){return this._wot.scrollViewport(e,t,s,o,r)}scrollViewportHorizontally(e,t,s){return this._wot.scrollViewportHorizontally(e,t,s)}scrollViewportVertically(e,t,s){return this._wot.scrollViewportVertically(e,t,s)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,t){return this._wot.wtSettings.update(e,t),this}getSetting(e,t,s,o,r){return this._wot.wtSettings.getSetting(e,t,s,o,r)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}class y${constructor(e,t){t&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=t,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle={width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"},this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(t),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let t=0,s=this.main.childNodes.length;t<s;t++){const o=this.main.childNodes[t];this.eventManager.addEventListener(o,"mouseenter",r=>this.onMouseEnter(r,this.main.childNodes[t]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,t){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),is(e);const s=this,o=this.wot.rootDocument.body,r=t.getBoundingClientRect();t.style.display="none";function a(c){if(c.clientY<Math.floor(r.top)||c.clientY>Math.ceil(r.top+r.height)||c.clientX<Math.floor(r.left)||c.clientX>Math.ceil(r.left+r.width))return!0}function l(c){a(c)&&(s.eventManager.removeEventListener(o,"mousemove",l),t.style.display="block")}this.eventManager.addEventListener(o,"mousemove",l)}createBorders(e){const{rootDocument:t}=this.wot;this.main=t.createElement("div");const s=["top","start","bottom","end","corner"];let o=this.main.style;o.position="absolute",o.top=0,o.left=0;for(let l=0;l<5;l++){const c=s[l],h=t.createElement("div");h.className=`wtBorder ${this.settings.className||""}`,this.settings[c]&&this.settings[c].hide&&(h.className+=" hidden"),o=h.style,o.backgroundColor=this.settings[c]&&this.settings[c].color?this.settings[c].color:e.border.color,o.height=this.settings[c]&&this.settings[c].width?`${this.settings[c].width}px`:`${e.border.width}px`,o.width=this.settings[c]&&this.settings[c].width?`${this.settings[c].width}px`:`${e.border.width}px`,this.main.appendChild(h)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),os()&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:r}=this.wot;let a=r.bordersHolder;a||(a=t.createElement("div"),a.className="htBorders",r.bordersHolder=a,r.spreader.appendChild(a)),a.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e}=this.wot;this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const t=10,s=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const o={position:"absolute",height:`${s}px`,width:`${s}px`,"border-radius":`${parseInt(s/1.5,10)}px`};Be(o,(a,l)=>{this.selectionHandles.styles.bottomHitArea[l]=a,this.selectionHandles.styles.topHitArea[l]=a});const r={position:"absolute",height:`${t}px`,width:`${t}px`,"border-radius":`${parseInt(t/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"};Be(r,(a,l)=>{this.selectionHandles.styles.bottom[l]=a,this.selectionHandles.styles.top[l]=a}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,t){const s=this.wot.selections.createOrGetArea();return!!(s.cellRange&&(e!==s.cellRange.to.row||t!==s.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,t,s,o,r,a){const c=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:h,topHitArea:u,bottom:f,bottomHitArea:g}=this.selectionHandles.styles,p=parseInt(h.borderWidth,10),C=parseInt(h.width,10),y=parseInt(u.width,10),b=this.wot.wtTable.getWidth(),T=this.wot.wtTable.getHeight();h.top=`${parseInt(s-C-1,10)}px`,h[c]=`${parseInt(o-C-1,10)}px`,u.top=`${parseInt(s-y/4*3,10)}px`,u[c]=`${parseInt(o-y/4*3,10)}px`;const M=Math.min(parseInt(o+r,10),b-C-p*2),_=Math.min(parseInt(o+r-y/4,10),b-y-p*2);f[c]=`${M}px`,g[c]=`${_}px`;const I=Math.min(parseInt(s+a,10),T-C-p*2),D=Math.min(parseInt(s+a-y/4,10),T-y-p*2);f.top=`${I}px`,g.top=`${D}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(h.display="block",u.display="block",this.isPartRange(e,t)?(f.display="none",g.display="none"):(f.display="block",g.display="block")):(h.display="none",f.display="none",u.display="none",g.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||t===this.wot.wtSettings.getSetting("fixedColumnsStart")?(h.zIndex="9999",u.zIndex="9999"):(h.zIndex="",u.zIndex="")}appear(e){if(this.disabled)return;const{wtTable:t,rootDocument:s,rootWindow:o}=this.wot;let r,a,l,c,h,u;const f=t.getRenderedRowsCount();for(let E=0;E<f;E+=1){const d=t.rowFilter.renderedToSource(E);if(d>=e[0]&&d<=e[2]){r=d,h=e[0];break}}for(let E=f-1;E>=0;E-=1){const d=t.rowFilter.renderedToSource(E);if(d>=e[0]&&d<=e[2]){a=d;break}}const g=t.getRenderedColumnsCount();for(let E=0;E<g;E+=1){const d=t.columnFilter.renderedToSource(E);if(d>=e[1]&&d<=e[3]){l=d,u=e[1];break}}for(let E=g-1;E>=0;E-=1){const d=t.columnFilter.renderedToSource(E);if(d>=e[1]&&d<=e[3]){c=d;break}}if(r===void 0||l===void 0){this.disappear();return}let p=t.getCell(this.wot.createCellCoords(r,l));const C=r!==a||l!==c,y=C?t.getCell(this.wot.createCellCoords(a,c)):p,b=Ht(p),T=C?Ht(y):b,M=Ht(t.TABLE),_=at(t.TABLE),I=b.top,D=b.left,K=this.wot.wtSettings.getSetting("rtlMode");let H=0,Q=0;if(K){const E=at(p),d=o.innerWidth-M.left-_;Q=D+E-T.left,H=o.innerWidth-D-E-d-1}else Q=T.left+at(y)-D,H=D-M.left-1;if(this.isEntireColumnSelected(r,a)){const E=this.getDimensionsFromHeader("columns",l,c,h,M);let d=null;E&&([d,H,Q]=E),d&&(p=d)}let q=I-M.top-1,F=T.top+vt(y)-I;if(this.isEntireRowSelected(l,c)){const E=this.getDimensionsFromHeader("rows",r,a,u,M);let d=null;E&&([d,q,F]=E),d&&(p=d)}const Y=Do(p,o);parseInt(Y.borderTopWidth,10)>0&&(q+=1,F=F>0?F-1:0),parseInt(Y[K?"borderRightWidth":"borderLeftWidth"],10)>0&&(H+=1,Q=Q>0?Q-1:0);const te=K?"right":"left";this.topStyle.top=`${q}px`,this.topStyle[te]=`${H}px`,this.topStyle.width=`${Q}px`,this.topStyle.display="block",this.startStyle.top=`${q}px`,this.startStyle[te]=`${H}px`,this.startStyle.height=`${F}px`,this.startStyle.display="block";const ie=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${q+F-ie}px`,this.bottomStyle[te]=`${H}px`,this.bottomStyle.width=`${Q}px`,this.bottomStyle.display="block",this.endStyle.top=`${q}px`,this.endStyle[te]=`${H+Q-ie}px`,this.endStyle.height=`${F+1}px`,this.endStyle.display="block";let fe=this.settings.border.cornerVisible;fe=typeof fe=="function"?fe(this.settings.layerLevel):fe;const Me=this.wot.getSetting("onModifyGetCellCoords",a,c);let[Ge,Oe]=[a,c];if(Me&&Array.isArray(Me)&&([,,Ge,Oe]=Me),os()||!fe||this.isPartRange(Ge,Oe))this.cornerStyle.display="none";else{this.cornerStyle.top=`${q+F+this.cornerCenterPointOffset-1}px`,this.cornerStyle[te]=`${H+Q+this.cornerCenterPointOffset-1}px`,this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let E=bi(t.TABLE);const d=E===o;d&&(E=s.documentElement);const w=parseInt(this.cornerDefaultStyle.width,10)/2,S=parseInt(this.cornerDefaultStyle.height,10)/2;if(c===this.wot.getSetting("totalColumns")-1){const x=d?y.getBoundingClientRect().left:y.offsetLeft;let O=!1,P=0;K?(P=x-parseInt(this.cornerDefaultStyle.width,10)/2,O=P<0):(P=x+at(y)+parseInt(this.cornerDefaultStyle.width,10)/2,O=P>=kl(E)),O&&(this.cornerStyle[te]=`${Math.floor(H+Q+this.cornerCenterPointOffset-w)}px`,this.cornerStyle[K?"borderLeftWidth":"borderRightWidth"]=0)}a===this.wot.getSetting("totalRows")-1&&(d?y.getBoundingClientRect().top:y.offsetTop)+vt(y)+parseInt(this.cornerDefaultStyle.height,10)/2>=qs(E)&&(this.cornerStyle.top=`${Math.floor(q+F+this.cornerCenterPointOffset-S)}px`,this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}os()&&this.updateMultipleSelectionHandlesPosition(a,c,q,H,Q,F)}isEntireColumnSelected(e,t){return e===this.wot.wtTable.getFirstRenderedRow()&&t===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,t){return e===this.wot.wtTable.getFirstRenderedColumn()&&t===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,t,s,o,r){const{wtTable:a}=this.wot,l=a.wtRootElement.parentNode;let c=null,h=null,u=null,f=null,g=null,p=null,C=null,y=null;switch(e){case"rows":c=function(){return a.getRowHeader(...arguments)},h=function(){return vt(...arguments)},u="ht__selection--rows",p="top";break;case"columns":c=function(){return a.getColumnHeader(...arguments)},h=function(){return at(...arguments)},u="ht__selection--columns",p="left";break}if(l.classList.contains(u)){const b=this.wot.getSetting("columnHeaders").length;if(C=c(t,b-o),y=c(s,b-o),!C||!y)return!1;const T=Ht(C),M=Ht(y);return C&&y&&(f=T[p]-r[p]-1,g=M[p]+h(y)-T[p]),[C,f,g]}return!1}changeBorderStyle(e,t){const s=this[e].style,o=t[e];!o||o.hide?oe(this[e],"hidden"):(Ae(this[e],"hidden")&&De(this[e],"hidden"),s.backgroundColor=o.color,(e==="top"||e==="bottom")&&(s.height=`${o.width}px`),(e==="start"||e==="end")&&(s.width=`${o.width}px`))}changeBorderToDefaultStyle(e){const t={width:1,color:"#000"},s=this[e].style;s.backgroundColor=t.color,s.width=`${t.width}px`,s.height=`${t.width}px`}toggleHiddenClass(e,t){this.changeBorderToDefaultStyle(e),t?oe(this[e],"hidden"):De(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",os()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}const S$=y$,v$=class{constructor(e,t){this.settings=e,this.cellRange=t||null,this.instanceBorders={},this.classNames=[this.settings.className],this.classNameGenerator=this.linearClassNameGenerator(this.settings.className,this.settings.layerLevel)}getBorder(e){return this.instanceBorders[e.guid]||(this.instanceBorders[e.guid]=new S$(e,this.settings)),this.instanceBorders[e.guid]}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,t){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=t,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=t,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),t=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,t.row,t.col]}addClassAtCoords(e,t,s,o){let r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;const a=e.wtTable.getCell(this.settings.createCellCoords(t,s));if(typeof a=="object"){let l=o;r&&(l=this.classNameGenerator(a),this.classNames.includes(l)||this.classNames.push(l)),oe(a,l)}return this}linearClassNameGenerator(e,t){return function s(o){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;if(t===0||r===0)return e;let a=r>=0?r:t,l=e;a-=1;const c=a===0?e:`${e}-${a}`;if(Ae(o,c)){const h=a+1;l=`${e}-${h}`}else l=s(o,a);return l}}draw(e){if(this.isEmpty()){this.settings.border&&this.getBorder(e).disappear();return}const t=e.wtTable.getRenderedRowsCount(),s=e.wtTable.getRenderedColumnsCount(),o=this.getCorners(),[r,a,l,c]=o,{highlightHeaderClassName:h,highlightColumnClassName:u,highlightRowClassName:f,highlightOnlyClosestHeader:g,selectionType:p}=this.settings,C=p===void 0||["active-header","header"].includes(p);if(C&&a!==null&&c!==null){let y=0;for(let b=0;b<s;b+=1){const T=e.wtTable.columnFilter.renderedToSource(b);if(T>=a&&T<=c){let M=e.wtTable.getColumnHeaders(T);const _=M.length-1;g&&M.length>1&&(M=[M[_]]);for(let I=0;I<M.length;I+=1){const D=[];let K=M[I];h&&D.push(h),u&&D.push(u),I=g?_:I;const H=e.getSetting("onBeforeHighlightingColumnHeader",T,I,{selectionType:p,columnCursor:y,selectionWidth:c-a+1,classNames:D});H!==T&&(K=e.wtTable.getColumnHeader(H,I)),oe(K,D)}y+=1}}}if(r!==null&&l!==null){let y=0;for(let b=0;b<t;b+=1){const T=e.wtTable.rowFilter.renderedToSource(b);if(C&&T>=r&&T<=l){let M=e.wtTable.getRowHeaders(T);const _=M.length-1;g&&M.length>1&&(M=[M[_]]);for(let I=0;I<M.length;I+=1){const D=[];let K=M[I];h&&D.push(h),f&&D.push(f),I=g?_:I;const H=e.getSetting("onBeforeHighlightingRowHeader",T,I,{selectionType:p,rowCursor:y,selectionHeight:l-r+1,classNames:D});H!==T&&(K=e.wtTable.getRowHeader(H,I)),oe(K,D)}y+=1}if(a!==null&&c!==null)for(let M=0;M<s;M+=1){const _=e.wtTable.columnFilter.renderedToSource(M);T>=r&&T<=l&&_>=a&&_<=c?this.settings.className&&this.addClassAtCoords(e,T,_,this.settings.className,this.settings.markIntersections):T>=r&&T<=l?f&&this.addClassAtCoords(e,T,_,f):_>=a&&_<=c&&u&&this.addClassAtCoords(e,T,_,u);const I=e.getSetting("onAfterDrawSelection",T,_,this.settings.layerLevel);typeof I=="string"&&this.addClassAtCoords(e,T,_,I)}}}e.getSetting("onBeforeDrawBorders",o,this.settings.className),this.settings.border&&this.getBorder(e).appear(o)}destroy(){Object.values(this.instanceBorders).forEach(e=>e.destroy())}};function uv(n){let{isShiftKey:e,isLeftClick:t,isRightClick:s,coords:o,selection:r,controller:a,cellCoordsFactory:l}=n;const c=r.isSelected()?r.getSelectedRange().current():null,h=r.isSelectedByCorner(),u=r.isSelectedByRowHeader();if(e&&c)o.row>=0&&o.col>=0&&!a.cell?r.setRangeEnd(o):(h||u)&&o.row>=0&&o.col>=0&&!a.cell?r.setRangeEnd(l(o.row,o.col)):h&&o.row<0&&!a.column?r.setRangeEnd(l(c.to.row,o.col)):u&&o.col<0&&!a.row?r.setRangeEnd(l(o.row,c.to.col)):(!h&&!u&&o.col<0||h&&o.col<0)&&!a.row?r.selectRows(Math.max(c.from.row,0),o.row,o.col):(!h&&!u&&o.row<0||u&&o.row<0)&&!a.column&&r.selectColumns(Math.max(c.from.col,0),o.col,o.row);else{const f=!r.inInSelection(o),g=t||s&&f;o.row<0&&o.col>=0&&!a.column?g&&r.selectColumns(o.col,o.col,o.row):o.col<0&&o.row>=0&&!a.row?g&&r.selectRows(o.row,o.row,o.col):o.col>=0&&o.row>=0&&!a.cell?g&&r.setRangeStart(o):o.col<0&&o.row<0&&r.selectAll(!0,!0)}}function b$(n){let{isLeftClick:e,coords:t,selection:s,controller:o,cellCoordsFactory:r}=n;if(!e)return;const a=s.isSelectedByRowHeader(),l=s.isSelectedByColumnHeader(),c=s.tableProps.countCols(),h=s.tableProps.countRows();l&&!o.column?s.setRangeEnd(r(h-1,t.col)):a&&!o.row?s.setRangeEnd(r(t.row,c-1)):o.cell||s.setRangeEnd(t)}const R$=new Map([["mousedown",uv],["mouseover",b$],["touchstart",uv]]);function dv(n,e){let{coords:t,selection:s,controller:o,cellCoordsFactory:r}=e;R$.get(n.type)({coords:t,selection:s,controller:o,cellCoordsFactory:r,isShiftKey:n.shiftKey,isLeftClick:yd(n)||n.type==="touchstart",isRightClick:Ho(n)})}const fv=new WeakMap,tf=Symbol("rootInstance");function E$(n){fv.set(n,!0)}function x$(n){return n===tf}function nf(n){return fv.has(n)}function gv(n,e,t){T$(n,e),e.set(n,t)}function T$(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function eo(n,e,t){return e=M$(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function M$(n){var e=_$(n,"string");return typeof e=="symbol"?e:String(e)}function _$(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function mv(n,e){var t=wv(n,e,"get");return I$(n,t)}function I$(n,e){return e.get?e.get.call(n):e.value}function pv(n,e,t){var s=wv(n,e,"set");return O$(n,s,t),t}function wv(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function O$(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}const Bo=new WeakMap;var sf=new WeakMap,of=new WeakMap;class A${constructor(e){eo(this,"instance",void 0),eo(this,"eventManager",void 0),eo(this,"settings",void 0),eo(this,"THEAD",void 0),eo(this,"TBODY",void 0),eo(this,"_wt",void 0),eo(this,"activeWt",void 0),gv(this,sf,{writable:!0,value:0}),gv(this,of,{writable:!0,value:0}),eo(this,"postponedAdjustElementsSize",!1),this.instance=e,this.eventManager=new bt(this.instance),this.settings=this.instance.getSettings(),Bo.set(this,{selectionMouseDown:!1,mouseDown:void 0,table:void 0,lastWidth:0,lastHeight:0}),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.instance.isRenderSuspended()||(this.instance.runHooks("beforeRender",this.instance.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.instance.forceFullRender),this.instance.runHooks("afterRender",this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1)}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.instance.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(e)}getCellAtCoords(e,t){const s=this._wt.getCell(e,t);return s<0?null:s}scrollViewport(e,t,s,o,r){return this._wt.scrollViewport(e,t,s,o,r)}scrollViewportHorizontally(e,t,s){return this._wt.scrollViewportHorizontally(e,t,s)}scrollViewportVertically(e,t,s){return this._wt.scrollViewportVertically(e,t,s)}createElements(){const e=Bo.get(this),{rootElement:t,rootDocument:s}=this.instance,o=t.getAttribute("style");o&&t.setAttribute("data-originalstyle",o),oe(t,"handsontable"),e.table=s.createElement("TABLE"),oe(e.table,"htCore"),this.instance.getSettings().tableClassName&&oe(e.table,this.instance.getSettings().tableClassName),this.THEAD=s.createElement("THEAD"),e.table.appendChild(this.THEAD),this.TBODY=s.createElement("TBODY"),e.table.appendChild(this.TBODY),this.instance.table=e.table,this.instance.container.insertBefore(e.table,this.instance.container.firstChild)}registerEvents(){const e=Bo.get(this),{rootElement:t,rootDocument:s,selection:o}=this.instance,r=s.documentElement;this.eventManager.addEventListener(t,"mousedown",a=>{if(e.selectionMouseDown=!0,!this.isTextSelectionAllowed(a.target)){const{rootWindow:l}=this.instance;Xy(l),a.preventDefault(),l.focus()}}),this.eventManager.addEventListener(t,"mouseup",()=>{e.selectionMouseDown=!1}),this.eventManager.addEventListener(t,"mousemove",a=>{e.selectionMouseDown&&!this.isTextSelectionAllowed(a.target)&&(this.settings.fragmentSelection&&Xy(this.instance.rootWindow),a.preventDefault())}),this.eventManager.addEventListener(r,"keyup",a=>{o.isInProgress()&&!a.shiftKey&&o.finish()}),this.eventManager.addEventListener(r,"mouseup",a=>{o.isInProgress()&&yd(a)&&o.finish(),e.mouseDown=!1,(fd(s.activeElement)||!o.isSelected()&&!o.isSelectedByAnyHeader()&&!t.contains(a.target)&&!Ho(a))&&this.instance.unlisten()}),this.eventManager.addEventListener(r,"contextmenu",a=>{o.isInProgress()&&Ho(a)&&(o.finish(),e.mouseDown=!1)}),this.eventManager.addEventListener(r,"touchend",()=>{o.isInProgress()&&o.finish(),e.mouseDown=!1}),this.eventManager.addEventListener(r,"mousedown",a=>{const l=a.target,c=a.x||a.clientX,h=a.y||a.clientY;let u=a.target;if(e.mouseDown||!t||!this.instance.view)return;const{holder:f}=this.instance.view._wt.wtTable;if(u===f){const p=Ft(s);if(s.elementFromPoint(c+p,h)!==f||s.elementFromPoint(c,h+p)!==f)return}else for(;u!==r;){if(u===null){if(a.isTargetWebComponent)break;return}if(u===t)return;u=u.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(l):this.settings.outsideClickDeselects)?this.instance.deselectCell():this.instance.destroyEditor(!1,!1)}),this.eventManager.addEventListener(e.table,"selectstart",a=>{this.settings.fragmentSelection||$l(a.target)||a.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:t,col:s}=e;return this.instance._createCellCoords(...this.translateFromRenderableToVisualIndex(t,s))}translateFromRenderableToVisualIndex(e,t){let s=e>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(e):e,o=t>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(t):t;return s===null&&(s=e),o===null&&(o=t),[s,o]}countRenderableIndexes(e,t){const s=Math.min(e.getNotTrimmedIndexesLength(),t),o=e.getNearestNotHiddenIndex(s-1,-1);return o===null?0:e.getRenderableFromVisualIndex(o)+1}countRenderableColumns(){return this.countRenderableIndexes(this.instance.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.instance.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,t){return this.countNotHiddenIndexes(e,t,this.instance.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,t){return this.countNotHiddenIndexes(e,t,this.instance.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,t,s,o){if(isNaN(e)||e<0)return 0;const r=s.getNearestNotHiddenIndex(e,t),a=s.getRenderableFromVisualIndex(r);if(!Number.isInteger(a))return 0;let l=0;return t<0?l=a+1:t>0&&(l=o-a),l}countNotHiddenFixedColumnsStart(){const e=this.instance.countCols(),t=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(t,-1)}countNotHiddenFixedRowsTop(){const e=this.instance.countRows(),t=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(t,-1)}countNotHiddenFixedRowsBottom(){const e=this.instance.countRows(),t=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(t,1)}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),t=this.countNotHiddenFixedColumnsStart();return this.instance.countRenderedRows()>e&&this.instance.countRenderedCols()>t}initializeWalkontable(){const e=Bo.get(this),t={rtlMode:this.instance.isRtl(),externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:e.table,isDataViewInstance:()=>nf(this.instance),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,stretchH:()=>this.settings.stretchH,data:(a,l)=>this.instance.getDataAtCell(...this.translateFromRenderableToVisualIndex(a,l)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||t.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||t.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,rowHeaders:()=>{const a=[];return this.instance.hasRowHeaders()&&a.push((l,c)=>{const h=l>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(l):l;this.appendRowHeader(h,c)}),this.instance.runHooks("afterGetRowHeaderRenderers",a),pv(this,of,a.length),a},columnHeaders:()=>{const a=[];return this.instance.hasColHeaders()&&a.push((l,c)=>{const h=l>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(l):l;this.appendColHeader(h,c)}),this.instance.runHooks("afterGetColumnHeaderRenderers",a),pv(this,sf,a.length),a},columnWidth:a=>{const l=this.instance.columnIndexMapper.getVisualFromRenderableIndex(a);return this.instance.getColWidth(l===null?a:l)},rowHeight:a=>{const l=this.instance.rowIndexMapper.getVisualFromRenderableIndex(a);return this.instance.getRowHeight(l===null?a:l)},cellRenderer:(a,l,c)=>{const[h,u]=this.translateFromRenderableToVisualIndex(a,l),f=this.instance.runHooks("modifyGetCellCoords",h,u);let g=h,p=u;Array.isArray(f)&&([g,p]=f);const C=this.instance.getCellMeta(g,p),y=this.instance.colToProp(p);let b=this.instance.getDataAtRowProp(g,y);this.instance.hasHook("beforeValueRender")&&(b=this.instance.runHooks("beforeValueRender",b,C)),this.instance.runHooks("beforeRenderer",c,h,u,y,b,C),this.instance.getCellRenderer(C)(this.instance,c,h,u,y,b,C),this.instance.runHooks("afterRenderer",c,h,u,y,b,C)},selections:this.instance.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.instance&&!this.instance.isDestroyed&&this.instance.refreshDimensions()},onContainerElementResize:()=>{this.instance&&!this.instance.isDestroyed&&this.instance.refreshDimensions()},onCellMouseDown:(a,l,c,h)=>{const u=this.translateFromRenderableToVisualCoords(l),f={row:!1,column:!1,cell:!1};this.instance.listen(),this.activeWt=h,e.mouseDown=!0,this.instance.runHooks("beforeOnCellMouseDown",a,u,c,f),!Ei(a)&&(dv(a,{coords:u,selection:this.instance.selection,controller:f,cellCoordsFactory:(g,p)=>this.instance._createCellCoords(g,p)}),this.instance.runHooks("afterOnCellMouseDown",a,u,c),this.activeWt=this._wt)},onCellContextMenu:(a,l,c,h)=>{const u=this.translateFromRenderableToVisualCoords(l);this.activeWt=h,e.mouseDown=!1,this.instance.selection.isInProgress()&&this.instance.selection.finish(),this.instance.runHooks("beforeOnCellContextMenu",a,u,c),!Ei(a)&&(this.instance.runHooks("afterOnCellContextMenu",a,u,c),this.activeWt=this._wt)},onCellMouseOut:(a,l,c,h)=>{const u=this.translateFromRenderableToVisualCoords(l);this.activeWt=h,this.instance.runHooks("beforeOnCellMouseOut",a,u,c),!Ei(a)&&(this.instance.runHooks("afterOnCellMouseOut",a,u,c),this.activeWt=this._wt)},onCellMouseOver:(a,l,c,h)=>{const u=this.translateFromRenderableToVisualCoords(l),f={row:!1,column:!1,cell:!1};this.activeWt=h,this.instance.runHooks("beforeOnCellMouseOver",a,u,c,f),!Ei(a)&&(e.mouseDown&&dv(a,{coords:u,selection:this.instance.selection,controller:f,cellCoordsFactory:(g,p)=>this.instance._createCellCoords(g,p)}),this.instance.runHooks("afterOnCellMouseOver",a,u,c),this.activeWt=this._wt)},onCellMouseUp:(a,l,c,h)=>{const u=this.translateFromRenderableToVisualCoords(l);this.activeWt=h,this.instance.runHooks("beforeOnCellMouseUp",a,u,c),!(Ei(a)||this.instance.isDestroyed)&&(this.instance.runHooks("afterOnCellMouseUp",a,u,c),this.activeWt=this._wt)},onCellCornerMouseDown:a=>{a.preventDefault(),this.instance.runHooks("afterOnCellCornerMouseDown",a)},onCellCornerDblClick:a=>{a.preventDefault(),this.instance.runHooks("afterOnCellCornerDblClick",a)},beforeDraw:(a,l)=>this.beforeRender(a,l),onDraw:a=>this.afterRender(a),onScrollVertically:()=>this.instance.runHooks("afterScrollVertically"),onScrollHorizontally:()=>this.instance.runHooks("afterScrollHorizontally"),onBeforeRemoveCellClassNames:()=>this.instance.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(a,l,c)=>{const h=this.instance.rowIndexMapper,u=h.getVisualFromRenderableIndex(a),f=this.instance.runHooks("beforeHighlightingRowHeader",u,l,c);return h.getRenderableFromVisualIndex(h.getNearestNotHiddenIndex(f,1))},onBeforeHighlightingColumnHeader:(a,l,c)=>{const h=this.instance.columnIndexMapper,u=h.getVisualFromRenderableIndex(a),f=this.instance.runHooks("beforeHighlightingColumnHeader",u,l,c);return h.getRenderableFromVisualIndex(h.getNearestNotHiddenIndex(f,1))},onAfterDrawSelection:(a,l,c)=>{let h;const[u,f]=this.translateFromRenderableToVisualIndex(a,l),g=this.instance.selection.getSelectedRange(),p=g.size();if(p>0){const C=(c??0)+1-p,y=g.peekByIndex(C);h=[y.from.row,y.from.col,y.to.row,y.to.col]}return this.instance.runHooks("afterDrawSelection",u,f,h,c)},onBeforeDrawBorders:(a,l)=>{const[c,h,u,f]=a,g=[this.instance.rowIndexMapper.getVisualFromRenderableIndex(c),this.instance.columnIndexMapper.getVisualFromRenderableIndex(h),this.instance.rowIndexMapper.getVisualFromRenderableIndex(u),this.instance.columnIndexMapper.getVisualFromRenderableIndex(f)];return this.instance.runHooks("beforeDrawBorders",g,l)},onBeforeTouchScroll:()=>this.instance.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.instance.runHooks("afterMomentumScroll"),onBeforeStretchingColumnWidth:(a,l)=>{const c=this.instance.columnIndexMapper.getVisualFromRenderableIndex(l);return this.instance.runHooks("beforeStretchingColumnWidth",a,c)},onModifyRowHeaderWidth:a=>this.instance.runHooks("modifyRowHeaderWidth",a),onModifyGetCellCoords:(a,l,c)=>{const h=this.instance.rowIndexMapper,u=this.instance.columnIndexMapper,f=l>=0?u.getVisualFromRenderableIndex(l):l,g=a>=0?h.getVisualFromRenderableIndex(a):a,p=this.instance.runHooks("modifyGetCellCoords",g,f,c);if(Array.isArray(p)){const[C,y,b,T]=p;return[C>=0?h.getRenderableFromVisualIndex(h.getNearestNotHiddenIndex(C,1)):C,y>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(y,1)):y,b>=0?h.getRenderableFromVisualIndex(h.getNearestNotHiddenIndex(b,-1)):b,T>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(T,-1)):T]}},viewportRowCalculatorOverride:a=>{let l=this.settings.viewportRowRenderingOffset;if(l==="auto"&&this.settings.fixedRowsTop&&(l=10),l>0||l==="auto"){const c=this.countRenderableRows(),h=a.startRow,u=a.endRow;if(typeof l=="number")a.startRow=Math.max(h-l,0),a.endRow=Math.min(u+l,c-1);else if(l==="auto"){const f=Math.ceil(u/c*12);a.startRow=Math.max(h-f,0),a.endRow=Math.min(u+f,c-1)}}this.instance.runHooks("afterViewportRowCalculatorOverride",a)},viewportColumnCalculatorOverride:a=>{let l=this.settings.viewportColumnRenderingOffset;if(l==="auto"&&this.settings.fixedColumnsStart&&(l=10),l>0||l==="auto"){const c=this.countRenderableColumns(),h=a.startColumn,u=a.endColumn;if(typeof l=="number"&&(a.startColumn=Math.max(h-l,0),a.endColumn=Math.min(u+l,c-1)),l==="auto"){const f=Math.ceil(u/c*6);a.startColumn=Math.max(h-f,0),a.endColumn=Math.min(u+f,c-1)}}this.instance.runHooks("afterViewportColumnCalculatorOverride",a)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const a=this.instance.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||a}};this.instance.runHooks("beforeInitWalkontable",t),this._wt=new ef(t),this.activeWt=this._wt;const s=this._wt.wtTable.spreader,{width:o,height:r}=this.instance.rootElement.getBoundingClientRect();this.setLastSize(o,r),this.eventManager.addEventListener(s,"mousedown",a=>{a.target===s&&a.which===3&&a.stopPropagation()}),this.eventManager.addEventListener(s,"contextmenu",a=>{a.target===s&&a.which===3&&a.stopPropagation()}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.instance.forceFullRender=!0,this.render())})}isTextSelectionAllowed(e){if($l(e))return!0;const t=Oo(e,this.instance.view._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&t||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&t||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return Bo.get(this).mouseDown}isSelectedOnlyCell(){var e,t;return(e=(t=this.instance.getSelectedRangeLast())===null||t===void 0?void 0:t.isSingle())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.instance.getActiveEditor();return e&&e.isOpened()}beforeRender(e,t){e&&this.instance.runHooks("beforeViewRender",this.instance.forceFullRender,t)}afterRender(e){e&&this.instance.runHooks("afterViewRender",this.instance.forceFullRender)}appendRowHeader(e,t){if(t.firstChild){const s=t.firstChild;if(!Ae(s,"relative")){ss(t),this.appendRowHeader(e,t);return}this.updateCellHeader(s.querySelector(".rowHeader"),e,this.instance.getRowHeader)}else{const{rootDocument:s,getRowHeader:o}=this.instance,r=s.createElement("div"),a=s.createElement("span");r.className="relative",a.className="rowHeader",this.updateCellHeader(a,e,o),r.appendChild(a),t.appendChild(r)}this.instance.runHooks("afterGetRowHeader",e,t)}appendColHeader(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.instance.getColHeader,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(t.firstChild){const r=t.firstChild;Ae(r,"relative")?this.updateCellHeader(r.querySelector(".colHeader"),e,s,o):(ss(t),this.appendColHeader(e,t,s,o))}else{const{rootDocument:r}=this.instance,a=r.createElement("div"),l=r.createElement("span");a.className="relative",l.className="colHeader",this.updateCellHeader(l,e,s,o),a.appendChild(l),t.appendChild(a)}this.instance.runHooks("afterGetColHeader",e,t,o)}updateCellHeader(e,t,s){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,r=t;const a=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(Ae(e,"colHeader")?r=a.wtTable.columnFilter.sourceToRendered(t):Ae(e,"rowHeader")&&(r=a.wtTable.rowFilter.sourceToRendered(t))),r>-1?Si(e,s(t,o)):(Po(e,String.fromCharCode(160)),oe(e,"cornerHeader"))}maximumVisibleElementWidth(e){const s=this._wt.wtViewport.getWorkspaceWidth()-e;return s>0?s:0}maximumVisibleElementHeight(e){const s=this._wt.wtViewport.getWorkspaceHeight()-e;return s>0?s:0}setLastSize(e,t){const s=Bo.get(this);[s.lastWidth,s.lastHeight]=[e,t]}getLastSize(){const e=Bo.get(this);return{width:e.lastWidth,height:e.lastHeight}}getFirstFullyVisibleRow(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleColumn())}getColumnHeadersCount(){return mv(this,sf)}getRowHeadersCount(){return mv(this,of)}destroy(){this._wt.destroy(),this.eventManager.destroy()}}const P$=A$,Cv="ABCDEFGHIJKLMNOPQRSTUVWXYZ".length;function D$(n){let e=n+1,t="",s;for(;e>0;)s=(e-1)%Cv,t=String.fromCharCode(65+s)+t,e=parseInt((e-s)/Cv,10);return t}function yv(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=n;const s=[];return(!Array.isArray(n)||!Array.isArray(n[0]))&&(t=[n]),t.forEach((o,r)=>{Array.isArray(o)?o.forEach((a,l)=>{s.push([r+e,l,a])}):Object.keys(o).forEach(a=>{s.push([r+e,a,o[a]])})}),s}function Sv(n){let e=0;return Array.isArray(n)&&(n[0]&&Array.isArray(n[0])?e=n[0].length:n[0]&&Fe(n[0])&&(e=wd(n[0]))),e}function N$(n){return!!(Array.isArray(n)&&n.length&&n.every(e=>Array.isArray(e)))}function H$(n){return!!(Array.isArray(n)&&n.length&&n.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}class k${constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];this.hot=e,this.data=t,this.dataType="array",this.colToProp=()=>{},this.propToCol=()=>{}}modifyRowData(e){let t;return this.hot.hasHook("modifyRowData")&&(t=this.hot.runHooks("modifyRowData",e)),t!==void 0&&!Number.isInteger(t)?t:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const t=[];return N(this.data,(s,o)=>{const r=this.getAtCell(o,e);t.push(r)}),t}getAtRow(e,t,s){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const r=t===void 0&&s===void 0;let a=null,l=null;if(a=this.modifyRowData(e),Array.isArray(a))l=[],r?a.forEach((c,h)=>{l[h]=this.getAtPhysicalCell(e,h,a)}):Ce(t,s,c=>{l[c-t]=this.getAtPhysicalCell(e,c,a)});else if(Fe(a)||ht(a))if(o?l=[]:l={},!r||o){const h=this.countFirstRowKeys()-1;Ce(0,h,u=>{const f=this.colToProp(u);if(u>=(t||0)&&u<=(s||h)&&!Number.isInteger(f)){const g=this.getAtPhysicalCell(e,f,a);o?l.push(g):pd(l,f,g)}})}else Be(a,(c,h)=>{pd(l,h,this.getAtPhysicalCell(e,h,a))});return l}setAtCell(e,t,s){if(!(e>=this.countRows()||t>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const o=Ri(s);this.hot.runHooks("modifySourceData",e,t,o,"set"),o.isTouched()&&(s=o.value)}Number.isInteger(t)?this.data[e][t]=s:pd(this.data[e],t,s)}}getAtPhysicalCell(e,t,s){let o=null;if(s&&(typeof t=="string"?o=Lk(s,t):typeof t=="function"?o=t(s):o=s[t]),this.hot.hasHook("modifySourceData")){const r=Ri(o);this.hot.runHooks("modifySourceData",e,t,r,"get"),r.isTouched()&&(o=r.value)}return o}getAtCell(e,t){const s=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(t),s)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=!1,r=null,a=null,l=null,c=null;e===null||t===null?(o=!0,r=0,l=this.countRows()-1):(r=Math.min(e.row,t.row),a=Math.min(e.col,t.col),l=Math.max(e.row,t.row),c=Math.max(e.col,t.col));const h=[];return Ce(r,l,u=>{h.push(o?this.getAtRow(u,void 0,void 0,s):this.getAtRow(u,a,c,s))}),h}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return Sv(this.data)}destroy(){this.data=null,this.hot=null}}const L$=k$,V$="localHooks",vv={_localHooks:Object.create(null),addLocalHook(n,e){return this._localHooks[n]||(this._localHooks[n]=[]),this._localHooks[n].push(e),this},runLocalHooks(n,e,t,s,o,r,a){if(this._localHooks[n]){const l=this._localHooks[n].length;for(let c=0;c<l;c++)gd(this._localHooks[n][c],this,e,t,s,o,r,a)}},clearLocalHooks(){return this._localHooks={},this}};Os(vv,"MIXIN_NAME",V$,{writable:!1,enumerable:!1});const gn=vv;class Wo{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.indexedValues=[],this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const t=this.indexedValues;if(e<t.length)return t[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,t){return e<this.indexedValues.length?(this.indexedValues[e]=t,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,ht(this.initValueOrFn)?Ce(e-1,t=>this.indexedValues.push(this.initValueOrFn(t))):Ce(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}lt(Wo,gn);function rf(n,e,t,s){const o=t.length?t[0]:void 0;return[...n.slice(0,o),...t.map((r,a)=>ht(s)?s(r,a):s),...o===void 0?[]:n.slice(o)]}function af(n,e){return Pn(n,(t,s)=>e.includes(s)===!1)}class to extends Wo{insert(e,t){this.indexedValues=rf(this.indexedValues,e,t,this.initValueOrFn),super.insert(e,t)}remove(e){this.indexedValues=af(this.indexedValues,e),super.remove(e)}}class ql extends to{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return Qt(this.getValues(),(e,t,s)=>(t&&e.push(s),e),[])}}function lf(n,e,t){return[...n.slice(0,e),...t,...n.slice(e)]}function Kr(n,e){return Pn(n,t=>e.includes(t)===!1)}function cf(n,e){return $e(n,t=>t-e.filter(s=>s<t).length)}function hf(n,e){const t=e[0],s=e.length;return $e(n,o=>o>=t?o+s:o)}function $$(n,e,t){return e=F$(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function F$(n){var e=B$(n,"string");return typeof e=="symbol"?e:String(e)}function B$(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Zl extends Wo{constructor(){super(...arguments),$$(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=t,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(s,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=Kr(this.orderOfIndexes,[e]),ht(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,t){this.indexedValues=rf(this.indexedValues,e,t,this.initValueOrFn),this.orderOfIndexes=hf(this.orderOfIndexes,t),super.insert(e,t)}remove(e){this.indexedValues=af(this.indexedValues,e),this.orderOfIndexes=Kr(this.orderOfIndexes,e),this.orderOfIndexes=cf(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class Xr extends to{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return Qt(this.getValues(),(e,t,s)=>(t&&e.push(s),e),[])}}const bv=new Map([["indexesSequence",{getListWithInsertedItems:lf,getListWithRemovedItems:Kr}],["physicallyIndexed",{getListWithInsertedItems:rf,getListWithRemovedItems:af}]]),Rv=n=>{if(bv.has(n)===!1)throw new Error(`Alter strategy with ID '${n}' does not exist.`);return bv.get(n)};class Ev extends Wo{constructor(){super(e=>e)}insert(e,t){const s=hf(this.indexedValues,t);this.indexedValues=lf(s,e,t),super.insert(e,t)}remove(e){const t=Kr(this.indexedValues,e);this.indexedValues=cf(t,e),super.remove(e)}}const xv=new Map([["hiding",ql],["index",Wo],["linkedPhysicalIndexToValue",Zl],["physicalIndexToValue",to],["trimming",Xr]]);function W$(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!xv.has(n))throw new Error(`The provided map type ("${n}") does not exist.`);return new(xv.get(n))(e)}class uf{constructor(){this.collection=new Map}register(e,t){this.collection.has(e)===!1&&(this.collection.set(e,t),t.addLocalHook("change",()=>this.runLocalHooks("change",t)))}unregister(e){const t=this.collection.get(e);he(t)&&(t.destroy(),this.collection.delete(e),this.runLocalHooks("change",t))}unregisterAll(){this.collection.forEach((e,t)=>this.unregister(t)),this.collection.clear()}get(e){return ct(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(t=>{t.remove(e)})}insertToEvery(e,t){this.collection.forEach(s=>{s.insert(e,t)})}initEvery(e){this.collection.forEach(t=>{t.init(e)})}}lt(uf,gn);class Tv extends uf{constructor(e,t){super(),this.mergedValuesCache=[],this.aggregationFunction=e,this.fallbackValue=t}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const t=$e(this.get(),r=>r.getValues()),s=[],o=he(t[0])&&t[0].length||0;for(let r=0;r<o;r+=1){const a=[];for(let l=0;l<this.getLength();l+=1)a.push(t[l][r]);s.push(a)}return $e(s,this.aggregationFunction)}getMergedValueAtIndex(e,t){const s=this.getMergedValues(t)[e];return he(s)?s:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function U$(n,e,t){z$(n,e),e.set(n,t)}function z$(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Y$(n,e,t){var s=Mv(n,e,"set");return G$(n,s,t),t}function G$(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}function j$(n,e){var t=Mv(n,e,"get");return K$(n,t)}function Mv(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function K$(n,e){return e.get?e.get.call(n):e.value}var df=new WeakMap;class _v{constructor(){U$(this,df,{writable:!0,value:[]})}subscribe(e){return this.addLocalHook("change",e),this._write(j$(this,df)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){Y$(this,df,e)}}lt(_v,gn);function Iv(n,e){const t=[];let s=0,o=0;for(;s<n.length&&o<e.length;s++,o++)n[s]!==e[o]&&t.push({op:"replace",index:o,oldValue:n[s],newValue:e[o]});for(;s<e.length;s++)t.push({op:"insert",index:s,oldValue:void 0,newValue:e[s]});for(;o<n.length;o++)t.push({op:"remove",index:o,oldValue:n[o],newValue:void 0});return t}function qr(n,e,t){X$(n,e),e.set(n,t)}function X$(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kn(n,e){var t=Ov(n,e,"get");return q$(n,t)}function q$(n,e){return e.get?e.get.call(n):e.value}function Ql(n,e,t){var s=Ov(n,e,"set");return Z$(n,s,t),t}function Ov(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function Z$(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}var Jl=new WeakMap,Zr=new WeakMap,ec=new WeakMap,tc=new WeakMap,nc=new WeakMap;class Q${constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};qr(this,Jl,{writable:!0,value:new Set}),qr(this,Zr,{writable:!0,value:[]}),qr(this,ec,{writable:!0,value:[]}),qr(this,tc,{writable:!0,value:!1}),qr(this,nc,{writable:!0,value:!1}),Ql(this,nc,e??!1)}createObserver(){const e=new _v;return kn(this,Jl).add(e),e.addLocalHook("unsubscribe",()=>{kn(this,Jl).delete(e)}),e._writeInitialChanges(Iv(kn(this,Zr),kn(this,ec))),e}emit(e){let t=kn(this,ec);(!kn(this,tc)||kn(this,Zr).length!==e.length)&&(e.length===0?e=new Array(t.length).fill(kn(this,nc)):Ql(this,Zr,new Array(e.length).fill(kn(this,nc))),kn(this,tc)||(Ql(this,tc,!0),t=kn(this,Zr)));const s=Iv(t,e);kn(this,Jl).forEach(o=>o._write(s)),Ql(this,ec,e)}}class ff{constructor(){this.indexesSequence=new Ev,this.trimmingMapsCollection=new Tv(e=>e.some(t=>t===!0),!1),this.hidingMapsCollection=new Tv(e=>e.some(t=>t===!0),!1),this.variousMapsCollection=new uf,this.hidingChangesObservable=new Q$({initialIndexValue:!1}),this.notTrimmedIndexesCache=[],this.notHiddenIndexesCache=[],this.isBatched=!1,this.indexesSequenceChanged=!1,this.indexesChangeSource=void 0,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1,this.renderablePhysicalIndexesCache=[],this.fromPhysicalToVisualIndexesCache=new Map,this.fromVisualToRenderableIndexesCache=new Map,this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,t,s){return this.registerMap(e,W$(t,s))}registerMap(e,t){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);t instanceof Xr?this.trimmingMapsCollection.register(e,t):t instanceof ql?this.hidingMapsCollection.register(e,t):this.variousMapsCollection.register(e,t);const s=this.getNumberOfIndexes();return s>0&&t.init(s),t}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const t=this.notTrimmedIndexesCache[e];return he(t)?t:null}getPhysicalFromRenderableIndex(e){const t=this.renderablePhysicalIndexesCache[e];return he(t)?t:null}getVisualFromPhysicalIndex(e){const t=this.fromPhysicalToVisualIndexesCache.get(e);return he(t)?t:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const t=this.fromVisualToRenderableIndexesCache.get(e);return he(t)?t:null}getNearestNotHiddenIndex(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const r=Array.from(this.fromVisualToRenderableIndexesCache.keys());let a=-1;return t>0?a=r.findIndex(l=>l>e):a=r.reverse().findIndex(l=>l<e),a===-1?s?this.getNearestNotHiddenIndex(e,-t,!1):null:r[a]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const t=this.getNumberOfIndexes();if(e<t){const s=[...Array(this.getNumberOfIndexes()-e).keys()].map(o=>o+e);this.removeIndexes(s)}else this.insertIndexes(t,e-t)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(s=>this.isTrimmed(s)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(s=>this.isHidden(s)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(s=>this.isHidden(s)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,t){typeof e=="number"&&(e=[e]);const s=$e(e,h=>this.getPhysicalFromVisualIndex(h)),o=this.getNotTrimmedIndexesLength(),r=e.length,a=Kr(this.getIndexesSequence(),s),l=a.filter(h=>this.isTrimmed(h)===!1);let c=a.indexOf(l[l.length-1])+1;if(t+r<o){const h=l[t];c=a.indexOf(h)}this.indexesChangeSource="move",this.setIndexesSequence(lf(a,c,s)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,t){const s=this.getNotTrimmedIndexes()[e],o=he(s)?s:this.getNumberOfIndexes(),r=this.getIndexesSequence().includes(s)?this.getIndexesSequence().indexOf(s):this.getNumberOfIndexes(),a=$e(new Array(t).fill(o),(l,c)=>l+c);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(r,a),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(r,a),this.hidingMapsCollection.insertToEvery(r,a),this.variousMapsCollection.insertToEvery(r,a),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const t=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&t===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let t=0;t<e;t+=1){const s=this.getPhysicalFromVisualIndex(t);this.fromPhysicalToVisualIndexesCache.set(s,t)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let t=0;t<e;t+=1){const s=this.getPhysicalFromRenderableIndex(t),o=this.getVisualFromPhysicalIndex(s);this.fromVisualToRenderableIndexesCache.set(o,t)}}}lt(ff,gn);function J$(n,e){return Be(e,(t,s)=>{ct(n[s])&&(n[s]=t)}),n}function Av(n){const t=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(n);return t?`${t[1].toLowerCase()}-${t[2].toUpperCase()}`:n}function Pv(n){he(n)&&Sd(rt`Language with code "${n}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function eF(n,e){return Array.isArray(n)&&Number.isInteger(e)?n[e]:n}const{register:tF,getValues:nF}=Nn("phraseFormatters");function sF(n,e){tF(n,e)}function oF(){return nF()}sF("pluralize",eF);const Dv="ContextMenu:items",Ne=Dv,gf=`${Ne}.noItems`,mf=`${Ne}.insertRowAbove`,pf=`${Ne}.insertRowBelow`,wf=`${Ne}.insertColumnOnTheLeft`,Cf=`${Ne}.insertColumnOnTheRight`,yf=`${Ne}.removeRow`,Sf=`${Ne}.removeColumn`,vf=`${Ne}.undo`,bf=`${Ne}.redo`,Rf=`${Ne}.readOnly`,Ef=`${Ne}.clearColumn`,xf=`${Ne}.copy`,Tf=`${Ne}.copyWithHeaders`,Mf=`${Ne}.copyWithGroupHeaders`,_f=`${Ne}.copyHeadersOnly`,If=`${Ne}.cut`,Of=`${Ne}.freezeColumn`,Af=`${Ne}.unfreezeColumn`,Pf=`${Ne}.mergeCells`,Df=`${Ne}.unmergeCells`,Nf=`${Ne}.addComment`,Hf=`${Ne}.editComment`,kf=`${Ne}.removeComment`,Lf=`${Ne}.readOnlyComment`,Vf=`${Ne}.align`,$f=`${Ne}.align.left`,Ff=`${Ne}.align.center`,Bf=`${Ne}.align.right`,Wf=`${Ne}.align.justify`,Uf=`${Ne}.align.top`,zf=`${Ne}.align.middle`,Yf=`${Ne}.align.bottom`,Gf=`${Ne}.borders`,jf=`${Ne}.borders.top`,Kf=`${Ne}.borders.right`,Xf=`${Ne}.borders.bottom`,qf=`${Ne}.borders.left`,Zf=`${Ne}.borders.remove`,Qf=`${Ne}.nestedHeaders.insertChildRow`,Jf=`${Ne}.nestedHeaders.detachFromParent`,eg=`${Ne}.hideColumn`,tg=`${Ne}.showColumn`,ng=`${Ne}.hideRow`,sg=`${Ne}.showRow`,an="Filters:",Rt=`${an}conditions`,sc=`${Rt}.none`,og=`${Rt}.isEmpty`,ig=`${Rt}.isNotEmpty`,rg=`${Rt}.isEqualTo`,ag=`${Rt}.isNotEqualTo`,lg=`${Rt}.beginsWith`,cg=`${Rt}.endsWith`,hg=`${Rt}.contains`,ug=`${Rt}.doesNotContain`,iF=`${Rt}.byValue`,dg=`${Rt}.greaterThan`,fg=`${Rt}.greaterThanOrEqualTo`,gg=`${Rt}.lessThan`,mg=`${Rt}.lessThanOrEqualTo`,pg=`${Rt}.isBetween`,wg=`${Rt}.isNotBetween`,Cg=`${Rt}.after`,yg=`${Rt}.before`,Sg=`${Rt}.today`,vg=`${Rt}.tomorrow`,bg=`${Rt}.yesterday`,Rg=`${an}labels.filterByCondition`,Eg=`${an}labels.filterByValue`,xg=`${an}labels.conjunction`,oc=`${an}labels.disjunction`,ic=`${an}values.blankCells`,Tg=`${an}buttons.selectAll`,Mg=`${an}buttons.clear`,_g=`${an}buttons.ok`,Ig=`${an}buttons.cancel`,Og=`${an}buttons.placeholder.search`,Ag=`${an}buttons.placeholder.value`,Pg=`${an}buttons.placeholder.secondValue`,rF=Object.freeze(Object.defineProperty({__proto__:null,CONTEXTMENU_ITEMS_ADD_COMMENT:Nf,CONTEXTMENU_ITEMS_ALIGNMENT:Vf,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:Yf,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:Ff,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:Wf,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:$f,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:zf,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:Bf,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:Uf,CONTEXTMENU_ITEMS_BORDERS:Gf,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:Xf,CONTEXTMENU_ITEMS_BORDERS_LEFT:qf,CONTEXTMENU_ITEMS_BORDERS_RIGHT:Kf,CONTEXTMENU_ITEMS_BORDERS_TOP:jf,CONTEXTMENU_ITEMS_CLEAR_COLUMN:Ef,CONTEXTMENU_ITEMS_COPY:xf,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:_f,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:Mf,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:Tf,CONTEXTMENU_ITEMS_CUT:If,CONTEXTMENU_ITEMS_EDIT_COMMENT:Hf,CONTEXTMENU_ITEMS_FREEZE_COLUMN:Of,CONTEXTMENU_ITEMS_HIDE_COLUMN:eg,CONTEXTMENU_ITEMS_HIDE_ROW:ng,CONTEXTMENU_ITEMS_INSERT_LEFT:wf,CONTEXTMENU_ITEMS_INSERT_RIGHT:Cf,CONTEXTMENU_ITEMS_MERGE_CELLS:Pf,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:Jf,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:Qf,CONTEXTMENU_ITEMS_NO_ITEMS:gf,CONTEXTMENU_ITEMS_READ_ONLY:Rf,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:Lf,CONTEXTMENU_ITEMS_REDO:bf,CONTEXTMENU_ITEMS_REMOVE_BORDERS:Zf,CONTEXTMENU_ITEMS_REMOVE_COLUMN:Sf,CONTEXTMENU_ITEMS_REMOVE_COMMENT:kf,CONTEXTMENU_ITEMS_REMOVE_ROW:yf,CONTEXTMENU_ITEMS_ROW_ABOVE:mf,CONTEXTMENU_ITEMS_ROW_BELOW:pf,CONTEXTMENU_ITEMS_SHOW_COLUMN:tg,CONTEXTMENU_ITEMS_SHOW_ROW:sg,CONTEXTMENU_ITEMS_UNDO:vf,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:Af,CONTEXTMENU_ITEMS_UNMERGE_CELLS:Df,CONTEXT_MENU_ITEMS_NAMESPACE:Dv,FILTERS_BUTTONS_CANCEL:Ig,FILTERS_BUTTONS_CLEAR:Mg,FILTERS_BUTTONS_OK:_g,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:Og,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:Pg,FILTERS_BUTTONS_PLACEHOLDER_VALUE:Ag,FILTERS_BUTTONS_SELECT_ALL:Tg,FILTERS_CONDITIONS_AFTER:Cg,FILTERS_CONDITIONS_BEFORE:yg,FILTERS_CONDITIONS_BEGINS_WITH:lg,FILTERS_CONDITIONS_BETWEEN:pg,FILTERS_CONDITIONS_BY_VALUE:iF,FILTERS_CONDITIONS_CONTAINS:hg,FILTERS_CONDITIONS_EMPTY:og,FILTERS_CONDITIONS_ENDS_WITH:cg,FILTERS_CONDITIONS_EQUAL:rg,FILTERS_CONDITIONS_GREATER_THAN:dg,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:fg,FILTERS_CONDITIONS_LESS_THAN:gg,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:mg,FILTERS_CONDITIONS_NAMESPACE:Rt,FILTERS_CONDITIONS_NONE:sc,FILTERS_CONDITIONS_NOT_BETWEEN:wg,FILTERS_CONDITIONS_NOT_CONTAIN:ug,FILTERS_CONDITIONS_NOT_EMPTY:ig,FILTERS_CONDITIONS_NOT_EQUAL:ag,FILTERS_CONDITIONS_TODAY:Sg,FILTERS_CONDITIONS_TOMORROW:vg,FILTERS_CONDITIONS_YESTERDAY:bg,FILTERS_DIVS_FILTER_BY_CONDITION:Rg,FILTERS_DIVS_FILTER_BY_VALUE:Eg,FILTERS_LABELS_CONJUNCTION:xg,FILTERS_LABELS_DISJUNCTION:oc,FILTERS_NAMESPACE:an,FILTERS_VALUES_BLANK_CELLS:ic},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const Nv={languageCode:"en-US",[gf]:"No available options",[mf]:"Insert row above",[pf]:"Insert row below",[wf]:"Insert column left",[Cf]:"Insert column right",[yf]:["Remove row","Remove rows"],[Sf]:["Remove column","Remove columns"],[vf]:"Undo",[bf]:"Redo",[Rf]:"Read only",[Ef]:"Clear column",[Vf]:"Alignment",[$f]:"Left",[Ff]:"Center",[Bf]:"Right",[Wf]:"Justify",[Uf]:"Top",[zf]:"Middle",[Yf]:"Bottom",[Of]:"Freeze column",[Af]:"Unfreeze column",[Gf]:"Borders",[jf]:"Top",[Kf]:"Right",[Xf]:"Bottom",[qf]:"Left",[Zf]:"Remove border(s)",[Nf]:"Add comment",[Hf]:"Edit comment",[kf]:"Delete comment",[Lf]:"Read-only comment",[Pf]:"Merge cells",[Df]:"Unmerge cells",[xf]:"Copy",[Tf]:["Copy with header","Copy with headers"],[Mf]:["Copy with group header","Copy with group headers"],[_f]:["Copy header only","Copy headers only"],[If]:"Cut",[Qf]:"Insert child row",[Jf]:"Detach from parent",[eg]:["Hide column","Hide columns"],[tg]:["Show column","Show columns"],[ng]:["Hide row","Hide rows"],[sg]:["Show row","Show rows"],[sc]:"None",[og]:"Is empty",[ig]:"Is not empty",[rg]:"Is equal to",[ag]:"Is not equal to",[lg]:"Begins with",[cg]:"Ends with",[hg]:"Contains",[ug]:"Does not contain",[dg]:"Greater than",[fg]:"Greater than or equal to",[gg]:"Less than",[mg]:"Less than or equal to",[pg]:"Is between",[wg]:"Is not between",[Cg]:"After",[yg]:"Before",[Sg]:"Today",[vg]:"Tomorrow",[bg]:"Yesterday",[ic]:"Blank cells",[Rg]:"Filter by condition",[Eg]:"Filter by value",[xg]:"And",[oc]:"Or",[Tg]:"Select all",[Mg]:"Clear",[_g]:"OK",[Ig]:"Cancel",[Og]:"Search",[Ag]:"Value",[Pg]:"Second value"},aF=rF,Dg=Nv.languageCode,{register:lF,getItem:Hv,hasItem:cF,getValues:hF}=Nn("languagesDictionaries");kv(Nv);function kv(n,e){let t=n,s=e;return Fe(n)&&(s=n,t=s.languageCode),uF(t,s),lF(t,rn(s)),rn(s)}function uF(n,e){n!==Dg&&J$(e,Hv(Dg))}function Lv(n){return Ng(n)?rn(Hv(n)):null}function Ng(n){return cF(n)}function dF(){return hF()}function Vv(n,e,t){const s=Lv(n);if(s===null)return null;const o=s[e];if(ct(o))return null;const r=fF(o,t);return Array.isArray(r)?r[0]:r}function fF(n,e){let t=n;return N(oF(),s=>{t=s(n,e)}),t}function gF(n){let e=Av(n);return Ng(e)||(e=Dg,Pv(n)),e}const rc="active-header",ac="area",Qr="cell",Hg="fill",Jr="header",kg="custom-selection";function mF(n,e,t){return e=pF(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function pF(n){var e=wF(n,"string");return typeof e=="symbol"?e:String(e)}function wF(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class CF extends v${constructor(e,t){super(e,null),mF(this,"visualCellRange",null),this.visualCellRange=t||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:t,to:s}=e,o=this.getNearestNotHiddenCoords(t,1),r=this.getNearestNotHiddenCoords(s,-1);if(o===null||r===null)return null;if(o.row>r.row||o.col>r.col){if(!(this.settings.type==="header"||this.settings.type==="active-header"))return null;o=t,r=s}return this.settings.createCellRange(o,o,r)}getNearestNotHiddenCoords(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const o=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper(),e.row,t);if(o===null)return null;const r=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper(),e.col,s);return r===null?null:this.settings.createCellCoords(o,r)}getNearestNotHiddenIndex(e,t,s){if(t<0)return t;const o=e.getNearestNotHiddenIndex(t,s);return(this.settings.type==="header"||this.settings.type==="active-header")&&o===null?-1:o}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const t=e.getVerticalDirection()==="N-S"?1:-1,s=e.getHorizontalDirection()==="W-E"?1:-1,o=this.getNearestNotHiddenCoords(e.from.clone().normalize(),t,s);if(o!==null&&e.overlaps(o)){if(this.cellRange===null){const r=this.settings.visualToRenderableCoords(o);this.cellRange=this.settings.createCellRange(r)}return e.setHighlight(o),this}return e.setHighlight(e.from),this}getCorners(){const{from:e,to:t}=this.cellRange,s=e.row===null||t.row===null,o=e.col===null||t.col===null,r=this.settings.createCellCoords(s?null:Math.min(e.row,t.row),o?null:Math.min(e.col,t.col)),a=this.settings.createCellCoords(s?null:Math.max(e.row,t.row),o?null:Math.max(e.col,t.col));return[r.row,r.col,a.row,a.col]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),t=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,t.row,t.col]}createRenderableCellRange(e,t){const s=this.settings.visualToRenderableCoords(e),o=this.settings.visualToRenderableCoords(t);return this.settings.createCellRange(s,s,o)}}const Oi=CF;function yF(n){let{activeHeaderClassName:e,...t}=n;return new Oi({highlightHeaderClassName:e,...t,selectionType:rc})}function SF(n){let{layerLevel:e,areaCornerVisible:t,...s}=n;return new Oi({className:"area",markIntersections:!0,layerLevel:Math.min(e,7),border:{width:1,color:"#4b89ff",cornerVisible:t},...s,selectionType:ac})}function vF(n){let{cellCornerVisible:e,...t}=n;return new Oi({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:e},...t,selectionType:Qr})}function bF(n){let{border:e,visualCellRange:t,...s}=n;return new Oi({...e,...s,selectionType:kg},t)}function RF(n){let{...e}=n;return new Oi({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:Hg})}function EF(n){let{headerClassName:e,rowClassName:t,columnClassName:s,...o}=n;return new Oi({className:"highlight",highlightHeaderClassName:e,highlightRowClassName:t,highlightColumnClassName:s,...o,highlightOnlyClosestHeader:!0,selectionType:Jr})}const{register:Ai,getItem:xF}=Nn("highlight/types");Ai(rc,yF),Ai(ac,SF),Ai(Qr,vF),Ai(kg,bF),Ai(Hg,RF),Ai(Jr,EF);function Pi(n,e){return xF(n)({type:n,...e})}class TF{constructor(e){this.options=e,this.layerLevel=0,this.cell=Pi(Qr,e),this.fill=Pi(Hg,e),this.areas=new Map,this.headers=new Map,this.activeHeaders=new Map,this.customSelections=[]}isEnabledFor(e,t){let s=e;e===Qr&&(s="current");let o=this.options.disabledCellSelection(t.row,t.col);return typeof o=="string"&&(o=[o]),o===!1||Array.isArray(o)&&!o.includes(s)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getCell(){return this.cell}getFill(){return this.fill}createOrGetArea(){const e=this.layerLevel;let t;return this.areas.has(e)?t=this.areas.get(e):(t=Pi(ac,{layerLevel:e,...this.options}),this.areas.set(e,t)),t}getAreas(){return[...this.areas.values()]}createOrGetHeader(){const e=this.layerLevel;let t;return this.headers.has(e)?t=this.headers.get(e):(t=Pi(Jr,{...this.options}),this.headers.set(e,t)),t}getHeaders(){return[...this.headers.values()]}createOrGetActiveHeader(){const e=this.layerLevel;let t;return this.activeHeaders.has(e)?t=this.activeHeaders.get(e):(t=Pi(rc,{...this.options}),this.activeHeaders.set(e,t)),t}getActiveHeaders(){return[...this.activeHeaders.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(Pi(kg,{...this.options,...e}))}clear(){this.cell.clear(),this.fill.clear(),N(this.areas.values(),e=>void e.clear()),N(this.headers.values(),e=>void e.clear()),N(this.activeHeaders.values(),e=>void e.clear())}[Symbol.iterator](){return[this.cell,this.fill,...this.areas.values(),...this.headers.values(),...this.activeHeaders.values(),...this.customSelections][Symbol.iterator]()}}const MF=TF;class _F{constructor(e){this.ranges=[],this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(0)}previous(){return this.peekByIndex(-1)}includes(e){return this.ranges.some(t=>t.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;const t=this.size()+e-1;let s;return t>=0&&(s=this.ranges[t]),s}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}const IF=_F;class $v{constructor(e,t){this.range=e,this.options=t}transformStart(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const o=this.options.createCellCoords(e,t),r=this.range.current().highlight,{row:a,col:l}=this.options.visualToRenderableCoords(r);let c=r,h=0,u=0;if(this.runLocalHooks("beforeTransformStart",o),a!==null&&l!==null){let f=this.options.countRows(),g=this.options.countCols();const p=this.options.fixedRowsBottom(),C=this.options.minSpareRows(),y=this.options.minSpareCols(),b=this.options.autoWrapRow(),T=this.options.autoWrapCol();a+e>f-1?s&&C>0&&!(p&&a>=f-p-1)?(this.runLocalHooks("insertRowRequire",f),f=this.options.countRows()):T&&(o.row=1-f,o.col=l+o.col===g-1?1-g:1):T&&a+o.row<0&&l+o.col>=0&&(o.row=f-1,o.col=l+o.col===0?g-1:-1),l+o.col>g-1?s&&y>0?(this.runLocalHooks("insertColRequire",g),g=this.options.countCols()):b&&(o.row=a+o.row===f-1?1-f:1,o.col=1-g):b&&l+o.col<0&&a+o.row>=0&&(o.row=a+o.row===0?f-1:-1,o.col=g-1);const M=this.options.createCellCoords(a+o.row,l+o.col);h=0,u=0,M.row<0?(h=-1,M.row=0):M.row>0&&M.row>=f&&(h=1,M.row=f-1),M.col<0?(u=-1,M.col=0):M.col>0&&M.col>=g&&(u=1,M.col=g-1),c=this.options.renderableToVisualCoords(M)}return this.runLocalHooks("afterTransformStart",c,h,u),c}transformEnd(e,t){const s=this.options.createCellCoords(e,t),o=this.range.current();let r=o.to,a=0,l=0;this.runLocalHooks("beforeTransformEnd",s);const{row:c,col:h}=this.options.visualToRenderableCoords(o.highlight);if(c!==null&&h!==null){const u=this.options.countRows(),f=this.options.countCols(),{row:g,col:p}=this.options.visualToRenderableCoords(o.to),C=this.options.createCellCoords(g+s.row,p+s.col);a=0,l=0,C.row<0?(a=-1,C.row=0):C.row>0&&C.row>=u&&(a=1,C.row=u-1),C.col<0?(l=-1,C.col=0):C.col>0&&C.col>=f&&(l=1,C.col=f-1),r=this.options.renderableToVisualCoords(C)}return this.runLocalHooks("afterTransformEnd",r,a,l),r}}lt($v,gn);const OF=$v,lc=0,cc=1,Fv=2,Lg=3,AF=[Lg,Fv],PF=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],Vg=Symbol("root"),Bv=Symbol("child");function Di(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Vg;if(e!==Vg&&e!==Bv)throw new Error("The second argument is used internally only and cannot be overwritten.");const t=Array.isArray(n),s=e===Vg;let o=lc;if(t){const r=n[0];n.length===0?o=cc:s&&r instanceof Wd?o=Lg:s&&Array.isArray(r)?o=Di(r,Bv):n.length>=2&&n.length<=4&&!n.some((l,c)=>!PF[c].includes(typeof l))&&(o=Fv)}return o}function ea(n){let{keepDirection:e=!1,propToCol:t}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!AF.includes(n))throw new Error("Unsupported selection ranges schema type was provided.");return function(s){const o=n===Lg;let r=o?s.from.row:s[0],a=o?s.from.col:s[1],l=o?s.to.row:s[2],c=o?s.to.col:s[3];if(typeof t=="function"&&(typeof a=="string"&&(a=t(a)),typeof c=="string"&&(c=t(c))),ct(l)&&(l=r),ct(c)&&(c=a),!e){const h=r,u=a,f=l,g=c;r=Math.min(h,f),a=Math.min(u,g),l=Math.max(h,f),c=Math.max(u,g)}return[r,a,l,c]}}function DF(n){const e=Di(n);if(e===lc||e===cc)return[];const t=ea(e),s=new Set;N(n,a=>{const[,l,,c]=t(a),h=Math.max(l,0),u=c-h+1;N(Array.from(new Array(u),(f,g)=>h+g),f=>{s.has(f)||s.add(f)})});const o=Array.from(s).sort((a,l)=>a-l);return Qt(o,(a,l,c,h)=>(c!==0&&l===h[c-1]+1?a[a.length-1][1]+=1:a.push([l,1]),a),[])}function NF(n){const e=Di(n);if(e===lc||e===cc)return[];const t=ea(e),s=new Set;N(n,a=>{const[l,,c]=t(a),h=Math.max(l,0),u=c-h+1;N(Array.from(new Array(u),(f,g)=>h+g),f=>{s.has(f)||s.add(f)})});const o=Array.from(s).sort((a,l)=>a-l);return Qt(o,(a,l,c,h)=>(c!==0&&l===h[c-1]+1?a[a.length-1][1]+=1:a.push([l,1]),a),[])}function no(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;return typeof n=="number"&&n>=0&&n<e}class Wv{constructor(e,t){var s=this;this.settings=e,this.tableProps=t,this.inProgress=!1,this.selectedByCorner=!1,this.selectedByRowHeader=new Set,this.selectedByColumnHeader=new Set,this.selectedRange=new IF((o,r,a)=>this.tableProps.createCellRange(o,r,a)),this.highlight=new MF({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,disabledCellSelection:(o,r)=>this.tableProps.isDisabledCellSelection(o,r),cellCornerVisible:function(){return s.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return s.isAreaCornerVisible(...arguments)},visualToRenderableCoords:o=>this.tableProps.visualToRenderableCoords(o),renderableToVisualCoords:o=>this.tableProps.renderableToVisualCoords(o),createCellCoords:(o,r)=>this.tableProps.createCellCoords(o,r),createCellRange:(o,r,a)=>this.tableProps.createCellRange(o,r,a),rowIndexMapper:()=>this.tableProps.rowIndexMapper(),columnIndexMapper:()=>this.tableProps.columnIndexMapper()}),this.transformation=new OF(this.selectedRange,{countRows:()=>this.tableProps.countRowsTranslated(),countCols:()=>this.tableProps.countColsTranslated(),visualToRenderableCoords:o=>this.tableProps.visualToRenderableCoords(o),renderableToVisualCoords:o=>this.tableProps.renderableToVisualCoords(o),createCellCoords:(o,r)=>this.tableProps.createCellCoords(o,r),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol}),this.transformation.addLocalHook("beforeTransformStart",function(){for(var o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return s.runLocalHooks("beforeModifyTransformStart",...r)}),this.transformation.addLocalHook("afterTransformStart",function(){for(var o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return s.runLocalHooks("afterModifyTransformStart",...r)}),this.transformation.addLocalHook("beforeTransformEnd",function(){for(var o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return s.runLocalHooks("beforeModifyTransformEnd",...r)}),this.transformation.addLocalHook("afterTransformEnd",function(){for(var o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return s.runLocalHooks("afterModifyTransformEnd",...r)}),this.transformation.addLocalHook("insertRowRequire",function(){for(var o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return s.runLocalHooks("insertRowRequire",...r)}),this.transformation.addLocalHook("insertColRequire",function(){for(var o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return s.runLocalHooks("insertColRequire",...r)})}getSelectedRange(){return this.selectedRange}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}isInProgress(){return this.inProgress}setRangeStart(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const o=this.settings.selectionMode==="multiple",r=ct(t)?this.tableProps.getShortcutManager().isCtrlPressed():t,a=e.row<0,l=e.col<0,c=a&&l,h=e.clone();this.selectedByCorner=c,this.runLocalHooks(`beforeSetRangeStart${s?"Only":""}`,h),(!o||o&&!r&&ct(t))&&this.selectedRange.clear(),this.selectedRange.add(h),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),!c&&l&&this.selectedByRowHeader.add(this.getLayerLevel()),!c&&a&&this.selectedByColumnHeader.add(this.getLayerLevel()),s||this.setRangeEnd(e)}setRangeStartOnly(e,t){this.setRangeStart(e,t,!0)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const t=e.clone();this.runLocalHooks("beforeSetRangeEnd",t),this.begin();const s=this.selectedRange.current();this.settings.selectionMode!=="single"&&s.setTo(this.tableProps.createCellCoords(t.row,t.col)),this.highlight.getCell().clear(),this.highlight.isEnabledFor(Qr,s.highlight)&&this.highlight.getCell().add(this.selectedRange.current().highlight).commit().syncWith(s);const o=this.getLayerLevel();o<this.highlight.layerLevel&&(N(this.highlight.getAreas(),c=>void c.clear()),N(this.highlight.getHeaders(),c=>void c.clear()),N(this.highlight.getActiveHeaders(),c=>void c.clear())),this.highlight.useLayerLevel(o);const r=this.highlight.createOrGetArea(),a=this.highlight.createOrGetHeader(),l=this.highlight.createOrGetActiveHeader();if(r.clear(),a.clear(),l.clear(),this.highlight.isEnabledFor(ac,s.highlight)&&(this.isMultiple()||o>=1)&&(r.add(s.from).add(s.to).commit(),o===1)){const c=this.selectedRange.previous();this.highlight.useLayerLevel(o-1).createOrGetArea().add(c.from).commit().syncWith(c),this.highlight.useLayerLevel(o)}if(this.highlight.isEnabledFor(Jr,s.highlight)){const c=this.tableProps.countRowsTranslated()===0,h=this.tableProps.countColsTranslated()===0;let u=s;(c||h)&&(u=s.clone()),c&&(u.from.row=-1),h&&(u.from.col=-1),this.settings.selectionMode==="single"?(this.isSelectedByAnyHeader()&&u.from.normalize(),a.add(u.from).commit()):a.add(u.from).add(u.to).commit(),this.isEntireRowSelected()&&this.tableProps.countCols()===s.getWidth()&&l.add(this.tableProps.createCellCoords(s.from.row,-1)).add(this.tableProps.createCellCoords(s.to.row,-1)).commit(),this.isEntireColumnSelected()&&this.tableProps.countRows()===s.getHeight()&&l.add(this.tableProps.createCellCoords(-1,s.from.col)).add(this.tableProps.createCellCoords(-1,s.to.col)).commit()}this.runLocalHooks("afterSetRangeEnd",e)}isMultiple(){const e=Ri(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}transformStart(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.setRangeStart(this.transformation.transformStart(e,t,s))}transformEnd(e,t){this.setRangeEnd(this.transformation.transformEnd(e,t))}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&this.isEntireRowSelected(e)}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e)}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&this.isEntireColumnSelected(e)}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e)}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByCorner}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const s=this.tableProps.countRows(),o=this.tableProps.countCols();if(!e&&!t&&(s===0||o===0))return;const r=this.tableProps.createCellCoords(t?-1:0,e?-1:0),a=this.tableProps.createCellCoords(s-1,o-1);this.clear(),this.setRangeStartOnly(r),this.selectedByRowHeader.add(this.getLayerLevel()),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(a),this.finish()}selectCells(e){const t=Di(e);if(t===cc)return!1;if(t===lc)throw new Error(rt`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const s=ea(t,{propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),o=this.tableProps.countRows(),r=this.tableProps.countCols(),a=!e.some(l=>{const[c,h,u,f]=s(l);return!(no(c,o)&&no(h,r)&&no(u,o)&&no(f,r))});return a&&(this.clear(),N(e,l=>{const[c,h,u,f]=s(l);this.setRangeStartOnly(this.tableProps.createCellCoords(c,h),!1),this.setRangeEnd(this.tableProps.createCellCoords(u,f)),this.finish()})),a}selectColumns(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1;const o=typeof e=="string"?this.tableProps.propToCol(e):e,r=typeof t=="string"?this.tableProps.propToCol(t):t,a=this.tableProps.countCols(),l=this.tableProps.countRows(),c=no(o,a)&&no(r,a);return c&&(this.setRangeStartOnly(this.tableProps.createCellCoords(s,o)),this.setRangeEnd(this.tableProps.createCellCoords(l-1,r)),this.finish()),c}selectRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1;const o=this.tableProps.countRows(),r=this.tableProps.countCols(),a=no(e,o)&&no(t,o);return a&&(this.setRangeStartOnly(this.tableProps.createCellCoords(e,s)),this.setRangeEnd(this.tableProps.createCellCoords(t,r-1)),this.finish()),a}refresh(){if(this.highlight.getCustomSelections().forEach(o=>{o.commit()}),!this.isSelected())return;const t=this.highlight.getCell(),s=this.getLayerLevel();t.commit().syncWith(this.selectedRange.current());for(let o=0;o<this.selectedRange.size();o+=1){this.highlight.useLayerLevel(o);const r=this.highlight.createOrGetArea(),a=this.highlight.createOrGetHeader(),l=this.highlight.createOrGetActiveHeader();r.commit(),a.commit(),l.commit()}this.highlight.useLayerLevel(s)}}lt(Wv,gn);const HF=Wv,Uv=/^(\r\n|\n\r|\r|\n)/,kF=/^[^\t\r\n]+/,zv=/^\t/;function LF(n){const e=[[""]];if(n.length===0)return e;let t=0,s=0,o;for(;n.length>0&&o!==n.length;)if(o=n.length,n.match(zv))n=n.replace(zv,""),t+=1,e[s][t]="";else if(n.match(Uv))n=n.replace(Uv,""),t=0,s+=1,e[s]=[""];else{let r="";if(n.startsWith('"')){let a=0,l=!0;for(;l;){const c=n.slice(0,1);c==='"'&&(a+=1),r+=c,n=n.slice(1),(n.length===0||n.match(/^[\t\r\n]/)&&a%2===0)&&(l=!1)}r=r.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,c=>new Array(Math.floor(c.length/2)).fill('"').join(""))}else{const a=n.match(kF);r=a?a[0]:"",n=n.slice(r.length)}e[s][t]=r}return e}function ta(n){let e,t,s,o,r="",a;for(e=0,t=n.length;e<t;e+=1){for(o=n[e].length,s=0;s<o;s+=1)s>0&&(r+="	"),a=n[e][s],typeof a=="string"?a.indexOf(`
`)>-1?r+=`"${a.replace(/"/g,'""')}"`:r+=a:a==null?r+="":r+=a;e!==t-1&&(r+=`
`)}return r}class Ni{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,t,s){this.instance=e,this.metaManager=s,this.tableMeta=s.getTableMeta(),this.dataSource=t,this.duckSchema=this.createDuckSchema(),this.colToPropCache=void 0,this.propToColCache=void 0,this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const t=this.tableMeta.columns;let s;if(this.colToPropCache=[],this.propToColCache=new Map,t){let o=0,r=0,a=!1;if(typeof t=="function"){const l=wd(e);o=l>0?l:this.countFirstRowKeys(),a=!0}else{const l=this.tableMeta.maxCols;o=Math.min(l,t.length)}for(s=0;s<o;s++){const l=a?t(s):t[s];if(Fe(l)){if(typeof l.data<"u"){const c=a?r:s;this.colToPropCache[c]=l.data,this.propToColCache.set(l.data,c)}r+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return Sv(this.dataSource)}recursiveDuckColumns(e,t,s){let o=t,r=s,a;return typeof o>"u"&&(o=0,r=""),typeof e=="object"&&!Array.isArray(e)&&Be(e,(l,c)=>{l===null?(a=r+c,this.colToPropCache.push(a),this.propToColCache.set(a,o),o+=1):o=this.recursiveDuckColumns(l,o,`${c}.`)}),o}colToProp(e){if(Number.isInteger(e)===!1)return e;const t=this.instance.toPhysicalColumn(e);return t===null?e:this.colToPropCache&&he(this.colToPropCache[t])?this.colToPropCache[t]:t}propToCol(e){const t=this.propToColCache.get(e);if(he(t))return this.instance.toVisualColumn(t);const s=this.instance.toVisualColumn(e);return s===null?e:s}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?Fr(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:s,mode:o="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=this.instance.countSourceRows();let a=r,l=0,c=e;if((typeof c!="number"||c>=r)&&(c=r),c<this.instance.countRows()&&(a=this.instance.toPhysicalRow(c)),this.instance.runHooks("beforeCreateRow",c,t,s)===!1||a===null)return{delta:0};const u=this.tableMeta.maxRows,f=this.getSchema().length,g=[];for(;l<t&&r+l<u;){let C=null;this.instance.dataType==="array"?this.tableMeta.dataSchema?C=rn(this.getSchema()):(C=[],Ce(f-1,()=>C.push(null))):this.instance.dataType==="function"?C=this.tableMeta.dataSchema(c+l):(C={},Bl(C,this.getSchema())),g.push(C),l+=1}this.instance.rowIndexMapper.insertIndexes(c,l),o==="below"&&(a=Math.min(a+1,r)),this.spliceData(a,0,g);const p=this.instance.toVisualRow(a);return this.instance.countSourceRows()===g.length&&this.instance.columnIndexMapper.initToLength(this.instance.getInitialColumnCount()),l>0&&(e==null?this.metaManager.createRow(null,l):s!=="auto"&&this.metaManager.createRow(a,t)),this.instance.runHooks("afterCreateRow",p,l,s),this.instance.forceFullRender=!0,{delta:l,startPhysicalIndex:a}}createCol(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:s,mode:o="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const r=this.dataSource,a=this.tableMeta.maxCols,l=this.instance.countSourceCols();let c=e;if((typeof c!="number"||c>=l)&&(c=l),this.instance.runHooks("beforeCreateCol",c,t,s)===!1)return{delta:0};let u=l;c<this.instance.countCols()&&(u=this.instance.toPhysicalColumn(c));const f=this.instance.countSourceRows();let g=this.instance.countCols(),p=0,C=u;o==="end"&&(C=Math.min(C+1,l));const y=C;for(;p<t&&g<a;){if(typeof c!="number"||c>=g)if(f>0)for(let T=0;T<f;T+=1)typeof r[T]>"u"&&(r[T]=[]),r[T].push(null);else r.push([null]);else for(let T=0;T<f;T++)r[T].splice(C,0,null);p+=1,C+=1,g+=1}this.instance.columnIndexMapper.insertIndexes(c,p),p>0&&(e==null?this.metaManager.createColumn(null,p):s!=="auto"&&this.metaManager.createColumn(y,t));const b=this.instance.toVisualColumn(y);return this.instance.runHooks("afterCreateCol",b,p,s),this.instance.forceFullRender=!0,this.refreshDuckSchema(),{delta:p,startPhysicalIndex:y}}removeRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,s=arguments.length>2?arguments[2]:void 0,o=Number.isInteger(e)?e:-t;const r=this.visualRowsToPhysical(o,t),a=this.instance.countSourceRows();if(o=(a+o)%a,this.instance.runHooks("beforeRemoveRow",o,r.length,r,s)===!1)return!1;const c=r.length;if(this.filterData(o,c,r),o<this.instance.countRows()){this.instance.rowIndexMapper.removeIndexes(r);const u=he(this.tableMeta.columns)||he(this.tableMeta.dataSchema);this.instance.rowIndexMapper.getNotTrimmedIndexesLength()===0&&u===!1&&this.instance.columnIndexMapper.setIndexesSequence([])}return r.slice(0).sort((u,f)=>f-u).forEach(u=>{this.metaManager.removeRow(u,1)}),this.instance.runHooks("afterRemoveRow",o,c,r,s),this.instance.forceFullRender=!0,!0}removeCol(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,s=arguments.length>2?arguments[2]:void 0;if(this.instance.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let o=typeof e!="number"?-t:e;o=(this.instance.countCols()+o)%this.instance.countCols();const r=this.visualColumnsToPhysical(o,t),a=r.slice(0).sort((f,g)=>g-f);if(this.instance.runHooks("beforeRemoveCol",o,t,r,s)===!1)return!1;let c=!0;const h=a.length,u=this.dataSource;for(let f=0;f<h;f++)c&&r[0]!==r[f]-f&&(c=!1);if(c)for(let f=0,g=this.instance.countSourceRows();f<g;f++)u[f].splice(r[0],t),f===0&&this.metaManager.removeColumn(r[0],t);else for(let f=0,g=this.instance.countSourceRows();f<g;f++)for(let p=0;p<h;p++)u[f].splice(a[p],1),f===0&&this.metaManager.removeColumn(a[p],1);return o<this.instance.countCols()&&(this.instance.columnIndexMapper.removeIndexes(r),this.instance.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.instance.rowIndexMapper.setIndexesSequence([])),this.instance.runHooks("afterRemoveCol",o,t,r,s),this.instance.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(e,t,s){const o=this.instance.getDataAtCol(e),r=o.slice(t,t+s),a=o.slice(t+s);for(var l=arguments.length,c=new Array(l>3?l-3:0),h=3;h<l;h++)c[h-3]=arguments[h];Ny(c,a);let u=0;for(;u<s;)c.push(null),u+=1;return ok(c),this.instance.populateFromArray(t,e,c,null,null,"spliceCol"),r}spliceRow(e,t,s){const o=this.instance.getSourceDataAtRow(e),r=o.slice(t,t+s),a=o.slice(t+s);for(var l=arguments.length,c=new Array(l>3?l-3:0),h=3;h<l;h++)c[h-3]=arguments[h];Ny(c,a);let u=0;for(;u<s;)c.push(null),u+=1;return this.instance.populateFromArray(e,t,[c],null,null,"spliceRow"),r}spliceData(e,t,s){if(this.instance.runHooks("beforeDataSplice",e,t,s)!==!1){const r=[...this.dataSource.slice(0,e),...s,...this.dataSource.slice(e)];this.dataSource.length=0,r.forEach(a=>this.dataSource.push(a))}}filterData(e,t,s){let o=this.instance.runHooks("filterData",e,t,s);Array.isArray(o)===!1&&(o=this.dataSource.filter((r,a)=>s.indexOf(a)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,o)}get(e,t){const s=this.instance.toPhysicalRow(e);let o=this.dataSource[s];const r=this.instance.runHooks("modifyRowData",s);o=isNaN(r)?r:o;let a=null;if(o&&o.hasOwnProperty&&Mt(o,t))a=o[t];else if(typeof t=="string"&&t.indexOf(".")>-1){const l=t.split(".");let c=o;if(!c)return null;for(let h=0,u=l.length;h<u;h++)if(c=c[l[h]],typeof c>"u")return null;a=c}else typeof t=="function"&&(a=t(this.dataSource.slice(s,s+1)[0]));if(this.instance.hasHook("modifyData")){const l=Ri(a);this.instance.runHooks("modifyData",s,this.propToCol(t),l,"get"),l.isTouched()&&(a=l.value)}return a}getCopyable(e,t){return this.instance.getCellMeta(e,this.propToCol(t)).copyable?this.get(e,t):""}set(e,t,s){const o=this.instance.toPhysicalRow(e);let r=s,a=this.dataSource[o];const l=this.instance.runHooks("modifyRowData",o);if(a=isNaN(l)?l:a,this.instance.hasHook("modifyData")){const c=Ri(r);this.instance.runHooks("modifyData",o,this.propToCol(t),c,"set"),c.isTouched()&&(r=c.value)}if(a&&a.hasOwnProperty&&Mt(a,t))a[t]=r;else if(typeof t=="string"&&t.indexOf(".")>-1){const c=t.split(".");let h=a,u=0,f;for(u=0,f=c.length-1;u<f;u++)typeof h[c[u]]>"u"&&(h[c[u]]={}),h=h[c[u]];h[c[u]]=r}else typeof t=="function"?t(this.dataSource.slice(o,o+1)[0],r):a[t]=r}visualRowsToPhysical(e,t){const s=this.instance.countSourceRows(),o=[];let r=(s+e)%s,a=t,l;for(;r<s&&a;)l=this.instance.toPhysicalRow(r),o.push(l),a-=1,r+=1;return o}visualColumnsToPhysical(e,t){const s=this.instance.countCols(),o=[];let r=(s+e)%s,a=t;for(;r<s&&a;){const l=this.instance.toPhysicalColumn(r);o.push(l),a-=1,r+=1}return o}clear(){for(let e=0;e<this.instance.countSourceRows();e++)for(let t=0;t<this.instance.countCols();t++)this.set(e,this.colToProp(t),"")}getLength(){const e=this.tableMeta.maxRows;let t;e<0||e===0?t=0:t=e||1/0;const s=this.instance.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(s,t)}getAll(){const e={row:0,col:0},t={row:Math.max(this.instance.countRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return e.row-t.row===0&&!this.instance.countSourceRows()?[]:this.getRange(e,t,Ni.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,t,s){const o=[];let r,a,l;const c=this.tableMeta.maxRows,h=this.tableMeta.maxCols;if(c===0||h===0)return[];const u=s===Ni.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,f=Math.min(Math.max(c-1,0),Math.max(e.row,t.row)),g=Math.min(Math.max(h-1,0),Math.max(e.col,t.col));for(r=Math.min(e.row,t.row);r<=f;r++){l=[];const p=r>=0?this.instance.toPhysicalRow(r):r;for(a=Math.min(e.col,t.col);a<=g&&p!==null;a++)l.push(u.call(this,r,this.colToProp(a)));p!==null&&o.push(l)}return o}getText(e,t){return ta(this.getRange(e,t,Ni.DESTINATION_RENDERER))}getCopyableText(e,t){return ta(this.getRange(e,t,Ni.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.instance=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const VF=Ni,{register:$F,getItem:FF,hasItem:Yv,getNames:W3,getValues:U3}=Nn("cellTypes");function BF(n){if(!Yv(n))throw Error(`You declared cell type "${n}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return FF(n)}function cs(n,e){typeof n!="string"&&(e=n,n=e.CELL_TYPE);const{editor:t,renderer:s,validator:o}=e;t&&Sn(n,t),s&&As(n,s),o&&zr(n,o),$F(n,e)}function WF(n,e){var t;return n==="CELL_TYPE"?!1:((t=e._automaticallyAssignedMetaProps)===null||t===void 0?void 0:t.has(n))||!Mt(e,n)}function hc(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n;const s=typeof e.type=="string"?BF(e.type):e.type;if(n._automaticallyAssignedMetaProps&&Be(e,(r,a)=>void n._automaticallyAssignedMetaProps.delete(a)),!Fe(s))return;t===n&&!n._automaticallyAssignedMetaProps&&(n._automaticallyAssignedMetaProps=new Set);const o={};Be(s,(r,a)=>{if(WF(a,t)){var l;o[a]=r,(l=n._automaticallyAssignedMetaProps)===null||l===void 0||l.add(a)}}),kt(n,o)}function UF(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function t(){}Qs(t,n);for(let s=0;s<e.length;s++)t.prototype[e[s]]=void 0;return t}function uc(n){return Number.isInteger(n)&&n>=0}function dc(n,e){if(!n())throw new Error(`Assertion failed: ${e}`)}function fc(n){return n==null}const Gv=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",isEmptyCol(n){let e,t,s;for(e=0,t=this.countRows();e<t;e++)if(s=this.getDataAtCell(e,n),Vt(s)===!1)return!1;return!0},isEmptyRow(n){let e,t,s,o;for(e=0,t=this.countCols();e<t;e++)if(s=this.getDataAtCell(n,e),Vt(s)===!1)return typeof s=="object"?(o=this.getCellMeta(n,e),md(this.getSchema()[o.prop],s)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:void 0,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0});function zF(){return class{}}class YF{constructor(e){this.metaCtor=zF(),this.meta=this.metaCtor.prototype,kt(this.meta,Gv()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var t;kt(this.meta,e),hc(this.meta,{...e,type:(t=e.type)!==null&&t!==void 0?t:this.meta.type},e)}}class GF{constructor(e){const t=e.getMetaConstructor();this.meta=new t}getMeta(){return this.meta}updateMeta(e){kt(this.meta,e),hc(this.meta,e,e)}}class $g{constructor(e){this.valueFactory=e,this.data=[],this.index=[],this.holes=new Set}obtain(e){dc(()=>uc(e),"Expecting an unsigned number.");const t=this._getStorageIndexByKey(e);let s;if(t>=0)s=this.data[t],s===void 0&&(s=this.valueFactory(e),this.data[t]=s);else if(s=this.valueFactory(e),this.holes.size>0){const o=this.holes.values().next().value;this.holes.delete(o),this.data[o]=s,this.index[e]=o}else this.data.push(s),this.index[e]=this.data.length-1;return s}insert(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;dc(()=>uc(e)||fc(e),"Expecting an unsigned number or null/undefined argument.");const s=[],o=this.data.length;for(let a=0;a<t;a++)s.push(o+a),this.data.push(void 0);const r=fc(e)?this.index.length:e;this.index=[...this.index.slice(0,r),...s,...this.index.slice(r)]}remove(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;dc(()=>uc(e)||fc(e),"Expecting an unsigned number or null/undefined argument.");const s=this.index.splice(fc(e)?this.index.length-t:e,t);for(let o=0;o<s.length;o++){const r=s[o];typeof r=="number"&&this.holes.add(r)}}size(){return this.data.length-this.holes.size}values(){return Pn(this.data,(e,t)=>!this.holes.has(t))[Symbol.iterator]()}entries(){const e=[];for(let s=0;s<this.data.length;s++){const o=this._getKeyByStorageIndex(s);o!==-1&&e.push([o,this.data[s]])}let t=0;return{next:()=>{if(t<e.length){const s=e[t];return t+=1,{value:s,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}const jF=["data","width"];class KF{constructor(e){this.globalMeta=e,this.metas=new $g(()=>this._createMeta())}updateMeta(e,t){const s=this.getMeta(e);kt(s,t),hc(s,t)}createColumn(e,t){this.metas.insert(e,t)}removeColumn(e,t){this.metas.remove(e,t)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return UF(this.globalMeta.getMetaConstructor(),jF).prototype}}class XF{constructor(e){this.columnMeta=e,this.metas=new $g(()=>this._createRow())}updateMeta(e,t,s){const o=this.getMeta(e,t);kt(o,s),hc(o,s)}createRow(e,t){this.metas.insert(e,t)}createColumn(e,t){for(let s=0;s<this.metas.size();s++)this.metas.obtain(s).insert(e,t)}removeRow(e,t){this.metas.remove(e,t)}removeColumn(e,t){for(let s=0;s<this.metas.size();s++)this.metas.obtain(s).remove(e,t)}getMeta(e,t,s){const o=this.metas.obtain(e).obtain(t);return s===void 0?o:o[s]}setMeta(e,t,s,o){var r;const a=this.metas.obtain(e).obtain(t);(r=a._automaticallyAssignedMetaProps)===null||r===void 0||r.delete(s),a[s]=o}removeMeta(e,t,s){const o=this.metas.obtain(e).obtain(t);delete o[s]}getMetas(){const e=[],t=Array.from(this.metas.values());for(let s=0;s<t.length;s++)e.push(...t[s].values());return e}getMetasAtRow(e){dc(()=>uc(e),"Expecting an unsigned number.");const t=new Map(this.metas);return t.has(e)?Array.from(t.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new $g(e=>this._createMeta(e))}_createMeta(e){const t=this.columnMeta.getMetaConstructor(e);return new t}}class jv{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new YF(e),this.tableMeta=new GF(this.globalMeta),this.columnMeta=new KF(this.globalMeta),this.cellMeta=new XF(this.columnMeta),s.forEach(o=>new o(this)),this.globalMeta.updateMeta(t)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,t){this.columnMeta.updateMeta(e,t)}getCellMeta(e,t,s){let{visualRow:o,visualColumn:r}=s;const a=this.cellMeta.getMeta(e,t);return a.visualRow=o,a.visualCol=r,a.row=e,a.col=t,this.runLocalHooks("afterGetCellMeta",a),a}getCellMetaKeyValue(e,t,s){if(typeof s!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,t,s)}setCellMeta(e,t,s,o){this.cellMeta.setMeta(e,t,s,o)}updateCellMeta(e,t,s){this.cellMeta.updateMeta(e,t,s)}removeCellMeta(e,t,s){this.cellMeta.removeMeta(e,t,s)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,t)}removeRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,t)}createColumn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,t),this.columnMeta.createColumn(e,t)}removeColumn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,t),this.columnMeta.removeColumn(e,t)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}lt(jv,gn);function Kv(n,e,t,s){const{hotInstance:o,dataMap:r,dataSource:a,internalSource:l,source:c,metaManager:h,firstRun:u}=s,f=jn(l),g=o.getSettings();Array.isArray(g.dataSchema)?o.dataType="array":ht(g.dataSchema)?o.dataType="function":o.dataType="object",r&&r.destroy(),n=o.runHooks(`before${f}`,n,u,c);const p=new VF(o,n,h);if(e(p),typeof n=="object"&&n!==null)n.push&&n.splice||(n=[n]);else if(n===null){const C=p.getSchema();n=[];let y,b=0,T=0;for(b=0,T=g.startRows;b<T;b++)if((o.dataType==="object"||o.dataType==="function")&&g.dataSchema)y=rn(C),n.push(y);else if(o.dataType==="array")y=rn(C[0]),n.push(y);else{y=[];for(let M=0,_=g.startCols;M<_;M++)y.push(null);n.push(y)}}else throw new Error(`${l} only accepts array of objects or array of arrays (${typeof n} given)`);Array.isArray(n[0])&&(o.dataType="array"),g.data=n,p.dataSource=n,a.data=n,a.dataType=o.dataType,a.colToProp=p.colToProp.bind(p),a.propToCol=p.propToCol.bind(p),a.countCachedColumns=p.countCachedColumns.bind(p),t(p),o.runHooks(`after${f}`,n,u,c),u||(o.runHooks("afterChange",null,l),o.render())}class qF{constructor(e){this.metaManager=e,this.metaSyncMemo=new Map,e.addLocalHook("afterGetCellMeta",t=>this.extendCellMeta(t)),de.getSingleton().add("beforeRender",t=>{t&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var t;const{row:s,col:o}=e;if((t=this.metaSyncMemo.get(s))!==null&&t!==void 0&&t.has(o))return;const{visualRow:r,visualCol:a}=e,l=this.metaManager.hot,c=l.colToProp(a);e.prop=c,l.runHooks("beforeGetCellMeta",r,a,e);const h=Mt(e,"type")?e.type:null;let u=ht(e.cells)?e.cells(s,o,c):null;if(h)if(u){var f;u.type=(f=u.type)!==null&&f!==void 0?f:h}else u={type:h};u&&this.metaManager.updateCellMeta(s,o,u),l.runHooks("afterGetCellMeta",r,a,e),this.metaSyncMemo.has(s)||this.metaSyncMemo.set(s,new Set),this.metaSyncMemo.get(s).add(o)}}class ZF{constructor(e){this.metaManager=e,this.usageTracker=new Set,this.propDescriptors=new Map([["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(t){if(this.metaManager.hot.isRtl()&&t==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange(t,s,o){if(!o)throw new Error(`The \`${t}\` option can not be updated after the Handsontable is initialized.`)}}]]),this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,t)=>{const{target:s,onChange:o=()=>{}}=e,r=typeof s=="string",a=r?s:t,l=`_${a}`;this.metaManager.globalMeta.meta[l]=this.metaManager.globalMeta.meta[a],this.installPropWatcher(t,l,o),r&&this.installPropWatcher(s,l,o)})}installPropWatcher(e,t,s){const o=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[t]},set(r){const a=!o.usageTracker.has(e);o.usageTracker.add(e),s.call(o,e,r,a),this[t]=r},enumerable:!0,configurable:!0})}}const Xv=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),gc=n=>n.map(e=>{const t=e.toLowerCase();return Xv.has(t)?Xv.get(t):t}).sort().join("+"),QF=n=>n.split("+"),qv=n=>n.toLowerCase(),JF=n=>{const e=Ul({errorIdExists:c=>`The "${c}" shortcut is already registered in the "${n}" context.`}),t=function(){let{keys:c,callback:h,group:u,runOnlyIf:f=()=>!0,captureCtrl:g=!1,preventDefault:p=!0,stopPropagation:C=!1,relativeToGroup:y,position:b}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(ct(u))throw new Error("You need to define the shortcut's group.");if(ht(h)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(c)===!1)throw new Error(rt`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const T={callback:h,group:u,runOnlyIf:f,captureCtrl:g,preventDefault:p,stopPropagation:C};he(y)&&([T.relativeToGroup,T.position]=[y,b]),c.forEach(M=>{const _=gc(M);if(e.hasItem(_)){const D=e.getItem(_);let K=D.findIndex(H=>H.group===y);K!==-1?b==="before"?K-=1:K+=1:K=D.length,D.splice(K,0,T)}else e.addItem(_,[T])})},s=function(c){let h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};c.forEach(u=>{Be(h,(f,g)=>{Object.prototype.hasOwnProperty.call(u,g)===!1&&(u[g]=h[g])}),t(u)})},o=c=>{const h=gc(c);e.removeItem(h)};return{addShortcut:t,addShortcuts:s,getShortcuts:c=>{const h=gc(c),u=e.getItem(h);return he(u)?u.slice():[]},hasShortcut:c=>{const h=gc(c);return e.hasItem(h)},removeShortcutsByKeys:o,removeShortcutsByGroup:c=>{e.getItems().forEach(u=>{let[f,g]=u;const p=g.filter(C=>C.group!==c);p.length===0?o(QF(f)):(g.length=0,g.push(...p))})}}};function eB(){const n=new Set;return{press(e){n.add(e)},release(e){n.delete(e)},releaseAll(){n.clear()},isPressed(e){return n.has(e)}}}const tB=["meta","alt","shift","control"],na=eB();function nB(n,e,t,s,o){const r=g=>tB.includes(g),a=function(g){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const C=[];return g.altKey&&C.push("alt"),p&&(g.ctrlKey||g.metaKey)?C.push("control/meta"):(g.ctrlKey&&C.push("control"),g.metaKey&&C.push("meta")),g.shiftKey&&C.push("shift"),C},l=g=>{if(e(g)===!1)return;const p=t(g);if(g.keyCode===229||p===!1||Ei(g))return;const C=qv(g.key);let y=[];r(C)?na.press(C):y=a(g);const b=[C].concat(y);!o(g,b)&&(wS()&&y.includes("meta")||!wS()&&y.includes("control"))&&o(g,[C].concat(a(g,!0))),s(g)},c=g=>{if(e(g)===!1)return;const p=qv(g.key);r(p)!==!1&&na.release(p)},h=()=>{na.releaseAll()};return{mount:()=>{let g=n;for(;g;)g.document.documentElement.addEventListener("keydown",l),g.document.documentElement.addEventListener("keyup",c),g.document.documentElement.addEventListener("blur",h),g=Pl(g)},unmount:()=>{let g=n;for(;g;)g.document.documentElement.removeEventListener("keydown",l),g.document.documentElement.removeEventListener("keyup",c),g.document.documentElement.removeEventListener("blur",h),g=Pl(g)},isPressed:g=>na.isPressed(g),releasePressedKeys:()=>na.releaseAll()}}const sB=n=>{let{ownerWindow:e,handleEvent:t,beforeKeyDown:s,afterKeyDown:o}=n;const r=Ul({errorIdExists:p=>`The "${p}" context name is already registered.`});let a="grid";const l=p=>{const C=JF(p);return r.addItem(p,C),C},c=()=>a,h=p=>r.getItem(p),u=p=>{a=p};let f=!1;const g=nB(e,t,s,o,(p,C)=>{const y=h(c());let b=!1;if(!y.hasShortcut(C))return b;const T=y.getShortcuts(C);for(let M=0;M<T.length;M++){const{callback:_,runOnlyIf:I,preventDefault:D,stopPropagation:K,captureCtrl:H}=T[M];if(I(p)!==!1&&(f=H,b=_(p,C)===!1,f=!1,D&&p.preventDefault(),K&&p.stopPropagation(),b))break}return b});return g.mount(),{addContext:l,getActiveContextName:c,getContext:h,setActiveContextName:u,isCtrlPressed:()=>!f&&(g.isPressed("control")||g.isPressed("meta")),releasePressedKeys:()=>g.releasePressedKeys(),destroy:()=>g.unmount()}},oB="gridDefault";let Fg=null;function Bg(n,e){var t;let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=!1,r=this;const a=new bt(r);let l,c,h,u,f=!0;x$(s)&&E$(this),this.rootElement=n,this.rootDocument=n.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const g=(t=e==null?void 0:e.layoutDirection)!==null&&t!==void 0?t:"inherit",p=["rtl","ltr"].includes(g)?g:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",p),this.isRtl=function(){return p==="rtl"},this.isLtr=function(){return!r.isRtl()},this.getDirectionFactor=function(){return r.isLtr()?1:-1},e.language=gF(e.language);const C=new jv(r,e,[qF,ZF]),y=C.getTableMeta(),b=C.getGlobalMeta(),T=Ul();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,n.insertBefore(this.container,n.firstChild),nf(this)&&lk(e.licenseKey,n),this.guid=`ht_${Wy()}`,this.columnIndexMapper=new ff,this.rowIndexMapper=new ff,this.columnIndexMapper.addLocalHook("indexesSequenceChange",d=>{r.runHooks("afterColumnSequenceChange",d)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",d=>{r.runHooks("afterRowSequenceChange",d)}),c=new L$(r),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const M=d=>{const{row:w,col:S}=d;return r._createCellCoords(w>=0?r.rowIndexMapper.getRenderableFromVisualIndex(w):w,S>=0?r.columnIndexMapper.getRenderableFromVisualIndex(S):S)},_=d=>{const{row:w,col:S}=d;return r._createCellCoords(w>=0?r.rowIndexMapper.getVisualFromRenderableIndex(w):w,S>=0?r.columnIndexMapper.getVisualFromRenderableIndex(S):S)};let I=new HF(y,{rowIndexMapper:()=>r.rowIndexMapper,columnIndexMapper:()=>r.columnIndexMapper,countCols:()=>r.countCols(),countRows:()=>r.countRows(),propToCol:d=>l.propToCol(d),isEditorOpened:()=>r.getActiveEditor()?r.getActiveEditor().isOpened():!1,countColsTranslated:()=>this.view.countRenderableColumns(),countRowsTranslated:()=>this.view.countRenderableRows(),getShortcutManager:()=>r.getShortcutManager(),createCellCoords:(d,w)=>r._createCellCoords(d,w),createCellRange:(d,w,S)=>r._createCellRange(d,w,S),visualToRenderableCoords:M,renderableToVisualCoords:_,isDisabledCellSelection:(d,w)=>r.getCellMeta(d,w).disableVisualSelection});this.selection=I;const D=d=>{let{hiddenIndexesChanged:w}=d;w&&this.selection.refresh()};this.columnIndexMapper.addLocalHook("cacheUpdated",D),this.rowIndexMapper.addLocalHook("cacheUpdated",D),this.selection.addLocalHook("beforeSetRangeStart",d=>{this.runHooks("beforeSetRangeStart",d)}),this.selection.addLocalHook("beforeSetRangeStartOnly",d=>{this.runHooks("beforeSetRangeStartOnly",d)}),this.selection.addLocalHook("beforeSetRangeEnd",d=>{this.runHooks("beforeSetRangeEnd",d),d.row<0&&(d.row=this.view._wt.wtTable.getFirstVisibleRow()),d.col<0&&(d.col=this.view._wt.wtTable.getFirstVisibleColumn())}),this.selection.addLocalHook("afterSetRangeEnd",d=>{const w=Ri(!1),S=this.selection.getSelectedRange(),{from:x,to:O}=S.current(),P=S.size()-1;this.runHooks("afterSelection",x.row,x.col,O.row,O.col,w,P),this.runHooks("afterSelectionByProp",x.row,r.colToProp(x.col),O.row,r.colToProp(O.col),w,P);const X=this.selection.isSelectedByAnyHeader(),z=this.selection.selectedRange.current();let ee=!0;o&&(ee=!1),w.isTouched()&&(ee=!w.value);const se=this.selection.isSelectedByRowHeader(),J=this.selection.isSelectedByColumnHeader();ee!==!1&&(X?se?this.view.scrollViewportVertically(r.rowIndexMapper.getRenderableFromVisualIndex(d.row)):J&&this.view.scrollViewportHorizontally(r.columnIndexMapper.getRenderableFromVisualIndex(d.col)):z&&!this.selection.isMultiple()?this.view.scrollViewport(M(z.from)):this.view.scrollViewport(M(d))),se&&J?oe(this.rootElement,["ht__selection--rows","ht__selection--columns"]):se?(De(this.rootElement,"ht__selection--columns"),oe(this.rootElement,"ht__selection--rows")):J?(De(this.rootElement,"ht__selection--rows"),oe(this.rootElement,"ht__selection--columns")):De(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this._refreshBorders(null)}),this.selection.addLocalHook("afterSelectionFinished",d=>{const w=d.length-1,{from:S,to:x}=d[w];this.runHooks("afterSelectionEnd",S.row,S.col,x.row,x.col,w),this.runHooks("afterSelectionEndByProp",S.row,r.colToProp(S.col),x.row,r.colToProp(x.col),w)}),this.selection.addLocalHook("afterIsMultipleSelection",d=>{const w=this.runHooks("afterIsMultipleSelection",d.value);d.value&&(d.value=w)}),this.selection.addLocalHook("beforeModifyTransformStart",d=>{this.runHooks("modifyTransformStart",d)}),this.selection.addLocalHook("afterModifyTransformStart",(d,w,S)=>{this.runHooks("afterModifyTransformStart",d,w,S)}),this.selection.addLocalHook("beforeModifyTransformEnd",d=>{this.runHooks("modifyTransformEnd",d)}),this.selection.addLocalHook("afterModifyTransformEnd",(d,w,S)=>{this.runHooks("afterModifyTransformEnd",d,w,S)}),this.selection.addLocalHook("afterDeselect",()=>{u.destroyEditor(),this._refreshBorders(),De(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("insertRowRequire",d=>{this.alter("insert_row_above",d,1,"auto")}),this.selection.addLocalHook("insertColRequire",d=>{this.alter("insert_col_start",d,1,"auto")}),h={alter(d,w){var S,x;let O=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,P=arguments.length>3?arguments[3]:void 0,X=arguments.length>4?arguments[4]:void 0;const z=ee=>{if(ee.length===0)return[];const se=[...ee];return se.sort((pe,He)=>{let[xe]=pe,[Te]=He;return xe===Te?0:xe>Te?1:-1}),Qt(se,(pe,He)=>{let[xe,Te]=He;const Z=pe[pe.length-1],[je,Le]=Z,ve=je+Le;if(xe<=ve){const Pe=Math.max(Te-(ve-xe),0);Z[1]+=Pe}else pe.push([xe,Te]);return pe},[se[0]])};switch(d){case"insert_row_below":case"insert_row_above":const ee=r.countSourceRows();if(y.maxRows===ee)return;const se=d==="insert_row_below"?"below":"above";w=(S=w)!==null&&S!==void 0?S:se==="below"?ee:0;const{delta:J,startPhysicalIndex:pe}=l.createRow(w,O,{source:P,mode:se});if(J){const Le=I.selectedRange.current(),ve=Le==null?void 0:Le.from,Pe=ve==null?void 0:ve.row,Se=r.toVisualRow(pe);if(I.isSelectedByCorner())r.selectAll();else if(he(Pe)&&Pe>=Se){const{row:v,col:R}=Le.to;let A=ve.col;I.isSelectedByRowHeader()&&(A=-1),I.getSelectedRange().pop(),I.setRangeStartOnly(r._createCellCoords(Pe+J,A),!0),I.setRangeEnd(r._createCellCoords(v+J,R))}else r._refreshBorders()}break;case"insert_col_start":case"insert_col_end":const He=d==="insert_col_end"?"end":"start";w=(x=w)!==null&&x!==void 0?x:He==="end"?r.countSourceCols():0;const{delta:xe,startPhysicalIndex:Te}=l.createCol(w,O,{source:P,mode:He});if(xe){if(Array.isArray(y.colHeaders)){const v=[r.toVisualColumn(Te),0];v.length+=xe,Array.prototype.splice.apply(y.colHeaders,v)}const Le=I.selectedRange.current(),ve=Le==null?void 0:Le.from,Pe=ve==null?void 0:ve.col,Se=r.toVisualColumn(Te);if(I.isSelectedByCorner())r.selectAll();else if(he(Pe)&&Pe>=Se){const{row:v,col:R}=Le.to;let A=ve.row;I.isSelectedByColumnHeader()&&(A=-1),I.getSelectedRange().pop(),I.setRangeStartOnly(r._createCellCoords(A,Pe+xe),!0),I.setRangeEnd(r._createCellCoords(v,R+xe))}else r._refreshBorders()}break;case"remove_row":const Z=Le=>{let ve=0;N(Le,Pe=>{let[Se,v]=Pe;const R=Vt(Se)?r.countRows()-1:Math.max(Se-ve,0);if(Number.isInteger(Se)&&(Se=Math.max(Se-ve,0)),!l.removeRow(Se,v,P))return;const U=r.countRows(),k=y.fixedRowsTop;k>=R+1&&(y.fixedRowsTop-=Math.min(v,k-R));const W=y.fixedRowsBottom;W&&R>=U-W&&(y.fixedRowsBottom-=Math.min(v,W)),ve+=v})};Array.isArray(w)?Z(z(w)):Z([[w,O]]),h.adjustRowsAndCols(),r._refreshBorders();break;case"remove_col":const je=Le=>{let ve=0;N(Le,Pe=>{let[Se,v]=Pe;const R=Vt(Se)?r.countCols()-1:Math.max(Se-ve,0);let A=r.toPhysicalColumn(R);if(Number.isInteger(Se)&&(Se=Math.max(Se-ve,0)),!l.removeCol(Se,v,P))return;const k=y.fixedColumnsStart;k>=R+1&&(y.fixedColumnsStart-=Math.min(v,k-R)),Array.isArray(y.colHeaders)&&(typeof A>"u"&&(A=-1),y.colHeaders.splice(A,v)),ve+=v})};Array.isArray(w)?je(z(w)):je([[w,O]]),h.adjustRowsAndCols(),r._refreshBorders();break;default:throw new Error(`There is no such action "${d}"`)}X||h.adjustRowsAndCols()},adjustRowsAndCols(){const d=y.minRows,w=y.minSpareRows,S=y.minCols,x=y.minSpareCols;if(r.countRows()===0&&r.countCols()===0&&I.deselect(),d){const O=r.countRows();O<d&&l.createRow(O,d-O,{source:"auto"})}if(w){const O=r.countEmptyRows(!0);if(O<w){const P=w-O,X=Math.min(P,y.maxRows-r.countSourceRows());l.createRow(r.countRows(),X,{source:"auto"})}}{let O;(S||x)&&(O=r.countEmptyCols(!0));let P=r.countCols();if(S&&!y.columns&&P<S){const X=S-P;O+=X,l.createCol(P,X,{source:"auto"})}if(x&&!y.columns&&r.dataType==="array"&&O<x){P=r.countCols();const X=x-O,z=Math.min(X,y.maxCols-P);l.createCol(P,z,{source:"auto"})}}if(I.isSelected()){const O=r.countRows(),P=r.countCols();N(I.selectedRange,X=>{let z=!1,ee=X.from.row,se=X.from.col,J=X.to.row,pe=X.to.col;ee>O-1?(ee=O-1,z=!0,J>ee&&(J=ee)):J>O-1&&(J=O-1,z=!0,ee>J&&(ee=J)),se>P-1?(se=P-1,z=!0,pe>se&&(pe=se)):pe>P-1&&(pe=P-1,z=!0,se>pe&&(se=pe)),z&&r.selectCell(ee,se,J,pe)})}r.view&&r.view.adjustElementsSize()},populateFromArray(d,w,S,x,O){let P,X,z,ee;const se=[],J={},pe=[],He=d.row,xe=d.col;if(X=w.length,X===0)return!1;let Te=0,Z=0;switch(Fe(S)&&(Te=S.col-xe+1,Z=S.row-He+1),O){case"shift_down":const je=Ol(w),Le=je.length,ve=Math.max(Le,Te),Pe=r.getData().slice(He),Se=Ol(Pe).slice(xe,xe+ve);for(z=0;z<ve;z+=1)if(z<Le){for(P=0,X=je[z].length;P<Z-X;P+=1)je[z].push(je[z][P%X]);z<Se.length?pe.push(je[z].concat(Se[z])):pe.push(je[z].concat(new Array(Pe.length).fill(null)))}else pe.push(je[z%Le].concat(Se[z]));r.populateFromArray(He,xe,Ol(pe));break;case"shift_right":const v=w.length,R=Math.max(v,Z),A=r.getData().slice(He).map(j=>j.slice(xe));for(P=0;P<R;P+=1)if(P<v){for(z=0,ee=w[P].length;z<Te-ee;z+=1)w[P].push(w[P][z%ee]);if(P<A.length)for(let j=0;j<A[P].length;j+=1)w[P].push(A[P][j]);else w[P].push(...new Array(A[0].length).fill(null))}else w.push(w[P%X].slice(0,R).concat(A[P]));r.populateFromArray(He,xe,w);break;case"overwrite":default:J.row=d.row,J.col=d.col;let U=0,k=0,W=!0,L;const V=function(le){let ge=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const ye=w[le%w.length];return ge!==null?ye[ge%ye.length]:ye},G=w.length,B=S?S.row-d.row+1:0;for(S?X=B:X=Math.max(G,B),P=0;P<X&&!(S&&J.row>S.row&&B>G||!y.allowInsertRow&&J.row>r.countRows()-1||J.row>=y.maxRows);P++){const j=P-U,le=V(j).length,ge=S?S.col-d.col+1:0;if(S?ee=ge:ee=Math.max(le,ge),J.col=d.col,L=r.getCellMeta(J.row,J.col),(x==="CopyPaste.paste"||x==="Autofill.fill")&&L.skipRowOnPaste){U+=1,J.row+=1,X+=1;continue}for(k=0,z=0;z<ee&&!(S&&J.col>S.col&&ge>le||!y.allowInsertColumn&&J.col>r.countCols()-1||J.col>=y.maxCols);z++){if(L=r.getCellMeta(J.row,J.col),(x==="CopyPaste.paste"||x==="Autofill.fill")&&L.skipColumnOnPaste){k+=1,J.col+=1,ee+=1;continue}if(L.readOnly&&x!=="UndoRedo.undo"){J.col+=1;continue}const ye=z-k;let _e=V(j,ye),ke=r.getDataAtCell(J.row,J.col);if(_e!==null&&typeof _e=="object")if(Array.isArray(_e)&&ke===null&&(ke=[]),ke===null||typeof ke!="object")W=!1;else{const dt=Fr(Array.isArray(ke)?ke:ke[0]||ke),ze=Fr(Array.isArray(_e)?_e:_e[0]||_e);md(dt,ze)||Array.isArray(dt)&&Array.isArray(ze)?_e=rn(_e):W=!1}else ke!==null&&typeof ke=="object"&&(W=!1);W&&se.push([J.row,J.col,_e]),W=!0,J.col+=1}J.row+=1}r.setDataAtCell(se,null,null,x||"populateFromArray");break}}};function K(d){const w=Av(d);Ng(w)?(r.runHooks("beforeLanguageChange",w),b.language=w,r.runHooks("afterLanguageChange",w)):Pv(d)}function H(d,w){const S=d==="className"?r.rootElement:r.table;if(f)oe(S,w);else{let x=[],O=[];b[d]&&(x=Array.isArray(b[d])?b[d]:Ly(b[d])),w&&(O=Array.isArray(w)?w:Ly(w));const P=ky(x,O),X=ky(O,x);P.length&&De(S,P),X.length&&oe(S,X)}b[d]=w}this.init=function(){c.setData(y.data),r.runHooks("beforeInit"),(os()||mS())&&oe(r.rootElement,"mobile"),this.updateSettings(y,!0),this.view=new P$(this),u=Jk.getInstance(r,y,I),r.runHooks("init"),this.forceFullRender=!0,this.view.render(),f&&r.rootElement.offsetParent===null&&Sk(r.rootElement,()=>{r.view._wt.wtOverlays.updateLastSpreaderSize(),r.render(),r.view.adjustElementsSize()}),typeof f=="object"&&(r.runHooks("afterChange",f[0],f[1]),f=!1),r.runHooks("afterInit")};function Q(){let d=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,d=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&d===!1&&(d=!0,this.onQueueEmpty(this.valid))}}}function q(d){const w=d.replace(",",".");return isNaN(parseFloat(w))===!1?parseFloat(w):d}function F(d,w,S){if(!d.length)return;const x=r.getActiveEditor(),O=new Q;let P=!0;O.onQueueEmpty=X=>{x&&P&&x.cancelChanges(),S(X)};for(let X=d.length-1;X>=0;X--){const[z,ee,,se]=d[X],J=l.propToCol(ee),pe=r.getCellMeta(z,J);pe.type==="numeric"&&typeof se=="string"&&sL(se)&&(d[X][3]=q(se)),r.getCellValidator(pe)&&(O.addValidatorToQueue(),r.validateCell(d[X][3],pe,function(He,xe){return function(Te){if(typeof Te!="boolean")throw new Error("Validation error: result is not boolean");if(Te===!1&&xe.allowInvalid===!1){P=!1,d.splice(He,1),xe.valid=!0;const Z=r.getCell(xe.visualRow,xe.visualCol);Z!==null&&De(Z,y.invalidCellClassName)}O.removeValidatorFormQueue()}}(X,pe),w))}O.checkIfQueueIsEmpty()}function Y(d,w){let S=d.length-1;if(S<0)return;for(;S>=0;S--){let O=!1;if(d[S]===null){d.splice(S,1);continue}if(!((d[S][2]===null||d[S][2]===void 0)&&(d[S][3]===null||d[S][3]===void 0))){if(y.allowInsertRow)for(;d[S][0]>r.countRows()-1;){const{delta:P}=l.createRow(void 0,void 0,{source:w});if(P===0){O=!0;break}}if(r.dataType==="array"&&(!y.columns||y.columns.length===0)&&y.allowInsertColumn)for(;l.propToCol(d[S][1])>r.countCols()-1;){const{delta:P}=l.createCol(void 0,void 0,{source:w});if(P===0){O=!0;break}}O||l.set(d[S][0],d[S][1],d[S][3])}}r.forceFullRender=!0,h.adjustRowsAndCols(),r.runHooks("beforeChangeRender",d,w),u.lockEditor(),r._refreshBorders(null),u.unlockEditor(),r.view.adjustElementsSize(),r.runHooks("afterChange",d,w||"edit");const x=r.getActiveEditor();x&&he(x.refreshValue)&&x.refreshValue()}this._createCellCoords=function(d,w){return r.view._wt.createCellCoords(d,w)},this._createCellRange=function(d,w,S){return r.view._wt.createCellRange(d,w,S)},this.validateCell=function(d,w,S,x){let O=r.getCellValidator(w);function P(X){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||w.hidden===!0){S(X);return}const ee=w.visualCol,se=w.visualRow,J=r.getCell(se,ee,!0);if(J&&J.nodeName!=="TH"){const pe=r.rowIndexMapper.getRenderableFromVisualIndex(se),He=r.columnIndexMapper.getRenderableFromVisualIndex(ee);r.view._wt.getSetting("cellRenderer",pe,He,J)}S(X)}ik(O)&&(O=function(X){return function(z,ee){ee(X.test(z))}}(O)),ht(O)?(d=r.runHooks("beforeValidate",d,w.visualRow,w.prop,x),r._registerImmediate(()=>{O.call(w,d,X=>{r&&(X=r.runHooks("afterValidate",X,d,w.visualRow,w.prop,x),w.valid=X,P(X),r.runHooks("postAfterValidate",X,d,w.visualRow,w.prop,x))})})):r._registerImmediate(()=>{w.valid=!0,P(w.valid,!1)})};function te(d,w,S){return Array.isArray(d)?d:[[d,w,S]]}function ie(d,w){const S=r.getActiveEditor(),x=r.runHooks("beforeChange",d,w||"edit"),O=d.filter(P=>P!==null);return x===!1||O.length===0?(S&&S.cancelChanges(),[]):O}this.setDataAtCell=function(d,w,S,x){const O=te(d,w,S),P=[];let X=x,z,ee,se;for(z=0,ee=O.length;z<ee;z++){if(typeof O[z]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof O[z][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");O[z][1]>=this.countCols()?se=O[z][1]:se=l.colToProp(O[z][1]),P.push([O[z][0],se,c.getAtCell(this.toPhysicalRow(O[z][0]),O[z][1]),O[z][2]])}!X&&typeof d=="object"&&(X=w);const J=ie(P,x);r.runHooks("afterSetDataAtCell",J,X),F(J,X,()=>{Y(J,X)})},this.setDataAtRowProp=function(d,w,S,x){const O=te(d,w,S),P=[];let X=x,z,ee;for(z=0,ee=O.length;z<ee;z++)P.push([O[z][0],O[z][1],c.getAtCell(this.toPhysicalRow(O[z][0]),O[z][1]),O[z][2]]);!X&&typeof d=="object"&&(X=w);const se=ie(P,x);r.runHooks("afterSetDataAtRowProp",se,X),F(se,X,()=>{Y(se,X)})},this.listen=function(){r&&!r.isListening()&&(Fg=r.guid,r.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(Fg=null,r.runHooks("afterUnlisten"))},this.isListening=function(){return Fg===r.guid},this.destroyEditor=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;r._refreshBorders(d,w)},this.populateFromArray=function(d,w,S,x,O,P,X){if(!(typeof S=="object"&&typeof S[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const z=typeof x=="number"?r._createCellCoords(x,O):null;return h.populateFromArray(r._createCellCoords(d,w),S,z,P,X)},this.spliceCol=function(d,w,S){for(var x=arguments.length,O=new Array(x>3?x-3:0),P=3;P<x;P++)O[P-3]=arguments[P];return l.spliceCol(d,w,S,...O)},this.spliceRow=function(d,w,S){for(var x=arguments.length,O=new Array(x>3?x-3:0),P=3;P<x;P++)O[P-3]=arguments[P];return l.spliceRow(d,w,S,...O)},this.getSelected=function(){if(I.isSelected())return $e(I.getSelectedRange(),d=>{let{from:w,to:S}=d;return[w.row,w.col,S.row,S.col]})},this.getSelectedLast=function(){const d=this.getSelected();let w;return d&&d.length>0&&(w=d[d.length-1]),w},this.getSelectedRange=function(){if(I.isSelected())return Array.from(I.getSelectedRange())},this.getSelectedRangeLast=function(){const d=this.getSelectedRange();let w;return d&&d.length>0&&(w=d[d.length-1]),w},this.emptySelectedCells=function(d){if(!I.isSelected()||this.countRows()===0||this.countCols()===0)return;const w=[];N(I.getSelectedRange(),S=>{const x=S.getTopStartCorner(),O=S.getBottomEndCorner();Ce(x.row,O.row,P=>{Ce(x.col,O.col,X=>{this.getCellMeta(P,X).readOnly||w.push([P,X,null])})})}),w.length>0&&this.setDataAtCell(w,d)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const d=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(d,0),!this.isRenderSuspended()&&d===this.renderSuspendedCounter&&(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(u.lockEditor(),this._refreshBorders(null),u.unlockEditor()))},this.batchRender=function(d){this.suspendRender();const w=d();return this.resumeRender(),w},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const w=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(w,0),(!this.isExecutionSuspended()&&w===this.executionSuspendedCounter||d)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(d){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const S=d();return this.resumeExecution(w),S},this.batch=function(d){this.suspendRender(),this.suspendExecution();const w=d();return this.resumeExecution(),this.resumeRender(),w},this.refreshDimensions=function(){if(!r.view)return;const{width:d,height:w}=r.view.getLastSize(),{width:S,height:x}=r.rootElement.getBoundingClientRect(),O=S!==d||x!==w;r.runHooks("beforeRefreshDimensions",{width:d,height:w},{width:S,height:x},O)!==!1&&((O||r.view._wt.wtOverlays.scrollableElement===r.rootWindow)&&(r.view.setLastSize(S,x),r.render()),r.runHooks("afterRefreshDimensions",{width:d,height:w},{width:S,height:x},O))},this.updateData=function(d,w){Kv(d,S=>{l=S},S=>{l=S,r.columnIndexMapper.fitToLength(this.getInitialColumnCount()),r.rowIndexMapper.fitToLength(this.countSourceRows()),h.adjustRowsAndCols()},{hotInstance:r,dataMap:l,dataSource:c,internalSource:"updateData",source:w,metaManager:C,firstRun:f})},this.loadData=function(d,w){Kv(d,S=>{l=S},()=>{C.clearCellsCache(),r.initIndexMappers(),h.adjustRowsAndCols(),f&&(f=[null,"loadData"])},{hotInstance:r,dataMap:l,dataSource:c,internalSource:"loadData",source:w,metaManager:C,firstRun:f})},this.getInitialColumnCount=function(){const d=y.columns;let w=0;if(Array.isArray(d))w=d.length;else if(ht(d))if(r.dataType==="array"){const S=this.countSourceCols();for(let x=0;x<S;x+=1)d(x)&&(w+=1)}else(r.dataType==="object"||r.dataType==="function")&&(w=l.colToPropCache.length);else if(he(y.dataSchema)){const S=l.getSchema();w=Array.isArray(S)?S.length:wd(S)}else w=this.countSourceCols();return w},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(d,w,S,x){return ct(d)?l.getAll():l.getRange(r._createCellCoords(d,w),r._createCellCoords(S,x),l.DESTINATION_RENDERER)},this.getCopyableText=function(d,w,S,x){return l.getCopyableText(r._createCellCoords(d,w),r._createCellCoords(S,x))},this.getCopyableData=function(d,w){return l.getCopyable(d,l.colToProp(w))},this.getSchema=function(){return l.getSchema()},this.updateSettings=function(d){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const S=(f?r.loadData:r.updateData).bind(this);let x=!1,O,P;if(he(d.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(he(d.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(he(d.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(O in d)O==="data"||(O==="language"?K(d.language):O==="className"?H("className",d.className):O==="tableClassName"&&r.table?(H("tableClassName",d.tableClassName),r.view._wt.wtOverlays.syncOverlayTableClassNames()):de.getSingleton().isRegistered(O)||de.getSingleton().isDeprecated(O)?(ht(d[O])||Array.isArray(d[O]))&&(d[O].initialHook=!0,r.addHook(O,d[O])):!w&&Mt(d,O)&&(b[O]=d[O]));d.data===void 0&&y.data===void 0?S(null,"updateSettings"):d.data!==void 0?S(d.data,"updateSettings"):d.columns!==void 0&&(l.createMap(),r.initIndexMappers());const X=r.countCols(),z=y.columns;if(z&&ht(z)&&(x=!0),(d.cell!==void 0||d.cells!==void 0||d.columns!==void 0)&&C.clearCache(),X>0)for(O=0,P=0;O<X;O++){if(z){const J=x?z(O):z[P];J&&C.updateColumnMeta(P,J)}P+=1}he(d.cell)&&Be(d.cell,J=>{r.setCellMetaObject(J.row,J.col,J)}),r.runHooks("afterCellMetaReset");let ee=r.rootElement.style.height;ee!==""&&(ee=parseInt(r.rootElement.style.height,10));let se=d.height;if(ht(se)&&(se=se()),w&&r.rootElement.getAttribute("style")&&r.rootElement.setAttribute("data-initialstyle",r.rootElement.getAttribute("style")),se===null){const J=r.rootElement.getAttribute("data-initialstyle");J&&(J.indexOf("height")>-1||J.indexOf("overflow")>-1)?r.rootElement.setAttribute("style",J):(r.rootElement.style.height="",r.rootElement.style.overflow="")}else se!==void 0&&(r.rootElement.style.height=isNaN(se)?`${se}`:`${se}px`,r.rootElement.style.overflow="hidden");if(typeof d.width<"u"){let J=d.width;ht(J)&&(J=J()),r.rootElement.style.width=isNaN(J)?`${J}`:`${J}px`}w||(r.view&&(r.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),r.view._wt.exportSettingsAsClassNames()),r.runHooks("afterUpdateSettings",d)),h.adjustRowsAndCols(),r.view&&!f&&(r.forceFullRender=!0,u.lockEditor(),r._refreshBorders(null),r.view._wt.wtOverlays.adjustElementsSize(),u.unlockEditor()),!w&&r.view&&(ee===""||se===""||se===void 0)&&ee!==se&&r.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const d=r.getSelectedLast();if(y.getValue){if(ht(y.getValue))return y.getValue.call(r);if(d)return r.getData()[d[0][0]][y.getValue]}else if(d)return r.getDataAtCell(d[0],d[1])},this.getSettings=function(){return y},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(d,w,S,x,O){h.alter(d,w,S,x,O)},this.getCell=function(d,w){let S=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,x=w,O=d;if(w>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(w)))return null;x=this.columnIndexMapper.getRenderableFromVisualIndex(w)}if(d>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(d)))return null;O=this.rowIndexMapper.getRenderableFromVisualIndex(d)}return O===null||x===null?null:r.view.getCellAtCoords(r._createCellCoords(O,x),S)},this.getCoords=function(d){const w=this.view._wt.wtTable.getCoords(d);if(w===null)return null;const{row:S,col:x}=w;let O=S,P=x;return S>=0&&(O=this.rowIndexMapper.getVisualFromRenderableIndex(S)),x>=0&&(P=this.columnIndexMapper.getVisualFromRenderableIndex(x)),r._createCellCoords(O,P)},this.colToProp=function(d){return l.colToProp(d)},this.propToCol=function(d){return l.propToCol(d)},this.toVisualRow=d=>this.rowIndexMapper.getVisualFromPhysicalIndex(d),this.toVisualColumn=d=>this.columnIndexMapper.getVisualFromPhysicalIndex(d),this.toPhysicalRow=d=>this.rowIndexMapper.getPhysicalFromVisualIndex(d),this.toPhysicalColumn=d=>this.columnIndexMapper.getPhysicalFromVisualIndex(d),this.getDataAtCell=function(d,w){return l.get(d,l.colToProp(w))},this.getDataAtRowProp=function(d,w){return l.get(d,w)},this.getDataAtCol=function(d){const w=[],S=l.getRange(r._createCellCoords(0,d),r._createCellCoords(y.data.length-1,d),l.DESTINATION_RENDERER);for(let x=0;x<S.length;x+=1)for(let O=0;O<S[x].length;O+=1)w.push(S[x][O]);return w},this.getDataAtProp=function(d){const w=[],S=l.getRange(r._createCellCoords(0,l.propToCol(d)),r._createCellCoords(y.data.length-1,l.propToCol(d)),l.DESTINATION_RENDERER);for(let x=0;x<S.length;x+=1)for(let O=0;O<S[x].length;O+=1)w.push(S[x][O]);return w},this.getSourceData=function(d,w,S,x){let O;return d===void 0?O=c.getData():O=c.getByRange(r._createCellCoords(d,w),r._createCellCoords(S,x)),O},this.getSourceDataArray=function(d,w,S,x){let O;return d===void 0?O=c.getData(!0):O=c.getByRange(r._createCellCoords(d,w),r._createCellCoords(S,x),!0),O},this.getSourceDataAtCol=function(d){return c.getAtColumn(d)},this.setSourceDataAtCell=function(d,w,S,x){const O=te(d,w,S),P=this.hasHook("afterSetSourceDataAtCell"),X=[];P&&N(O,ee=>{let[se,J,pe]=ee;X.push([se,J,c.getAtCell(se,J),pe])}),N(O,ee=>{let[se,J,pe]=ee;c.setAtCell(se,J,pe)}),P&&this.runHooks("afterSetSourceDataAtCell",X,x),this.render();const z=r.getActiveEditor();z&&he(z.refreshValue)&&z.refreshValue()},this.getSourceDataAtRow=function(d){return c.getAtRow(d)},this.getSourceDataAtCell=function(d,w){return c.getAtCell(d,w)},this.getDataAtRow=function(d){return l.getRange(r._createCellCoords(d,0),r._createCellCoords(d,this.countCols()-1),l.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(d,w,S,x){const O=d===void 0?[0,0,this.countRows(),this.countCols()]:[d,w,S,x],[P,X]=O;let[,,z,ee]=O,se=null,J=null;z===void 0&&(z=P),ee===void 0&&(ee=X);let pe="mixed";return Ce(Math.max(Math.min(P,z),0),Math.max(P,z),He=>{let xe=!0;return Ce(Math.max(Math.min(X,ee),0),Math.max(X,ee),Te=>(J=this.getCellMeta(He,Te).type,se?xe=se===J:se=J,xe)),pe=xe?J:"mixed",xe}),pe},this.removeCellMeta=function(d,w,S){const[x,O]=[this.toPhysicalRow(d),this.toPhysicalColumn(w)];let P=C.getCellMetaKeyValue(x,O,S);r.runHooks("beforeRemoveCellMeta",d,w,S,P)!==!1&&(C.removeCellMeta(x,O,S),r.runHooks("afterRemoveCellMeta",d,w,S,P)),P=null},this.spliceCellsMeta=function(d){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var S=arguments.length,x=new Array(S>2?S-2:0),O=2;O<S;O++)x[O-2]=arguments[O];if(x.length>0&&!Array.isArray(x[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");w>0&&C.removeRow(this.toPhysicalRow(d),w),x.length>0&&N(x.reverse(),P=>{C.createRow(this.toPhysicalRow(d)),N(P,(X,z)=>this.setCellMetaObject(d,z,X))}),r.render()},this.setCellMetaObject=function(d,w,S){typeof S=="object"&&Be(S,(x,O)=>{this.setCellMeta(d,w,O,x)})},this.setCellMeta=function(d,w,S,x){if(r.runHooks("beforeSetCellMeta",d,w,S,x)===!1)return;let P=d,X=w;d<this.countRows()&&(P=this.toPhysicalRow(d)),w<this.countCols()&&(X=this.toPhysicalColumn(w)),C.setCellMeta(P,X,S,x),r.runHooks("afterSetCellMeta",d,w,S,x)},this.getCellsMeta=function(){return C.getCellsMeta()},this.getCellMeta=function(d,w){let S=this.toPhysicalRow(d),x=this.toPhysicalColumn(w);return S===null&&(S=d),x===null&&(x=w),C.getCellMeta(S,x,{visualRow:d,visualColumn:w})},this.getCellMetaAtRow=function(d){return C.getCellsMetaAtRow(d)},this.isColumnModificationAllowed=function(){return!(r.dataType==="object"||y.columns)},this.getCellRenderer=function(d,w){const S=typeof d=="number"?r.getCellMeta(d,w).renderer:d.renderer;return typeof S=="string"?NS(S):ct(S)?NS("text"):S},this.getCellEditor=function(d,w){const S=typeof d=="number"?r.getCellMeta(d,w).editor:d.editor;return typeof S=="string"?RS(S):ct(S)?RS("text"):S},this.getCellValidator=function(d,w){const S=typeof d=="number"?r.getCellMeta(d,w).validator:d.validator;return typeof S=="string"?CL(S):S},this.validateCells=function(d){this._validateCells(d)},this.validateRows=function(d,w){if(!Array.isArray(d))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(w,d)},this.validateColumns=function(d,w){if(!Array.isArray(d))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(w,void 0,d)},this._validateCells=function(d,w,S){const x=new Q;d&&(x.onQueueEmpty=d);let O=r.countRows()-1;for(;O>=0;){if(w!==void 0&&w.indexOf(O)===-1){O-=1;continue}let P=r.countCols()-1;for(;P>=0;){if(S!==void 0&&S.indexOf(P)===-1){P-=1;continue}x.addValidatorToQueue(),r.validateCell(r.getDataAtCell(O,P),r.getCellMeta(O,P),X=>{if(typeof X!="boolean")throw new Error("Validation error: result is not boolean");X===!1&&(x.valid=!1),x.removeValidatorFormQueue()},"validateCells"),P-=1}O-=1}x.checkIfQueueIsEmpty()},this.getRowHeader=function(d){let w=y.rowHeaders,S=d;return S!==void 0&&(S=r.runHooks("modifyRowHeader",S)),S===void 0?(w=[],Ce(r.countRows()-1,x=>{w.push(r.getRowHeader(x))})):Array.isArray(w)&&w[S]!==void 0?w=w[S]:ht(w)?w=w(S):w&&typeof w!="string"&&typeof w!="number"&&(w=S+1),w},this.hasRowHeaders=function(){return!!y.rowHeaders},this.hasColHeaders=function(){if(y.colHeaders!==void 0&&y.colHeaders!==null)return!!y.colHeaders;for(let d=0,w=r.countCols();d<w;d++)if(r.getColHeader(d))return!0;return!1},this.getColHeader=function(d){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const S=r.runHooks("modifyColHeader",d);if(S===void 0){const z=[],ee=r.countCols();for(let se=0;se<ee;se++)z.push(r.getColHeader(se));return z}let x=y.colHeaders;const O=function(z){const ee=[],se=r.countCols();let J=0;for(;J<se;J++)ht(y.columns)&&y.columns(J)&&ee.push(J);return ee[z]},P=r.toPhysicalColumn(S),X=O(P);return y.colHeaders===!1?x=null:y.columns&&ht(y.columns)&&y.columns(X)&&y.columns(X).title?x=y.columns(X).title:y.columns&&y.columns[P]&&y.columns[P].title?x=y.columns[P].title:Array.isArray(y.colHeaders)&&y.colHeaders[P]!==void 0?x=y.colHeaders[P]:ht(y.colHeaders)?x=y.colHeaders(P):y.colHeaders&&typeof y.colHeaders!="string"&&typeof y.colHeaders!="number"&&(x=D$(S)),x=r.runHooks("modifyColumnHeaderValue",x,d,w),x},this._getColWidthFromSettings=function(d){let w;if(d>=0&&(w=r.getCellMeta(0,d).width),(w===void 0||w===y.width)&&(w=y.colWidths),w!=null){switch(typeof w){case"object":w=w[d];break;case"function":w=w(d);break}typeof w=="string"&&(w=parseInt(w,10))}return w},this.getColWidth=function(d){let w=r._getColWidthFromSettings(d);return w=r.runHooks("modifyColWidth",w,d),w===void 0&&(w=Ld.DEFAULT_WIDTH),w},this._getRowHeightFromSettings=function(d){let w=y.rowHeights;if(w!=null){switch(typeof w){case"object":w=w[d];break;case"function":w=w(d);break}typeof w=="string"&&(w=parseInt(w,10))}return w},this.getRowHeight=function(d){let w=r._getRowHeightFromSettings(d);return w=r.runHooks("modifyRowHeight",w,d),w},this.countSourceRows=function(){return c.countRows()},this.countSourceCols=function(){return c.countFirstRowKeys()},this.countRows=function(){return l.getLength()},this.countCols=function(){const d=y.maxCols,w=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(d,w)},this.countRenderedRows=function(){return r.view._wt.drawn?r.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return r.view._wt.drawn?r.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return r.view._wt.drawn?r.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return r.view._wt.drawn?r.view._wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,w=0;return Td(r.countRows()-1,S=>{if(r.isEmptyRow(S))w+=1;else if(d===!0)return!1}),w},this.countEmptyCols=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,w=0;return Td(r.countCols()-1,S=>{if(r.isEmptyCol(S))w+=1;else if(d===!0)return!1}),w},this.isEmptyRow=function(d){return y.isEmptyRow.call(r,d)},this.isEmptyCol=function(d){return y.isEmptyCol.call(r,d)},this.selectCell=function(d,w,S,x){let O=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,P=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return ct(d)||ct(w)?!1:this.selectCells([[d,w,S,x]],O,P)},this.selectCells=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,S=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;w===!1&&(o=!0);const x=I.selectCells(d);return x&&S&&r.listen(),o=!1,x},this.selectColumns=function(d){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:d;return I.selectColumns(d,w)},this.selectRows=function(d){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:d;return I.selectRows(d,w)},this.deselectCell=function(){I.deselect()},this.selectAll=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;const w=d&&this.hasRowHeaders(),S=d&&this.hasColHeaders();o=!0,I.selectAll(w,S),o=!1};const fe=(d,w)=>d.getNearestNotHiddenIndex(w,1,!0);this.scrollViewportTo=function(d,w){let S=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,x=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,O=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0;const P=!S,X=!x;let z=d,ee=w;if(O){const pe=Number.isInteger(d),He=Number.isInteger(w),xe=pe?fe(this.rowIndexMapper,d):void 0,Te=He?fe(this.columnIndexMapper,w):void 0;if(xe===null||Te===null)return!1;z=pe?r.rowIndexMapper.getRenderableFromVisualIndex(xe):void 0,ee=He?r.columnIndexMapper.getRenderableFromVisualIndex(Te):void 0}const se=Number.isInteger(z),J=Number.isInteger(ee);return se&&J?r.view.scrollViewport(r._createCellCoords(z,ee),P,x,S,X):se&&J===!1?r.view.scrollViewportVertically(z,P,S):J&&se===!1?r.view.scrollViewportHorizontally(ee,x,X):!1},this.destroy=function(){if(r._clearTimeouts(),r._clearImmediates(),r.view&&r.view.destroy(),c&&c.destroy(),c=null,this.getShortcutManager().destroy(),C.clearCache(),nf(r)){const d=this.rootDocument.querySelector(".hot-display-license-info");d&&d.parentNode.removeChild(d)}ss(r.rootElement),a.destroy(),u&&u.destroy(),r.batchExecution(()=>{r.rowIndexMapper.unregisterAll(),r.columnIndexMapper.unregisterAll(),T.getItems().forEach(d=>{let[,w]=d;w.destroy()}),T.clear(),r.runHooks("afterDestroy")},!0),de.getSingleton().destroy(r),Be(r,(d,w,S)=>{ht(d)?S[w]=Me(w):w!=="guid"&&(S[w]=null)}),r.isDestroyed=!0,l&&l.destroy(),l=null,h=null,I=null,u=null,r=null};function Me(d){return()=>{throw new Error(`The "${d}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return u.getActiveEditor()},this.getPlugin=function(d){const w=jn(d);return w==="UndoRedo"?this.undoRedo:T.getItem(w)},this.getPluginName=function(d){return d===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:T.getId(d)},this.getInstance=function(){return r},this.addHook=function(d,w){de.getSingleton().add(d,w,r)},this.hasHook=function(d){return de.getSingleton().has(d,r)||de.getSingleton().has(d)},this.addHookOnce=function(d,w){de.getSingleton().once(d,w,r)},this.removeHook=function(d,w){de.getSingleton().remove(d,w,r)},this.runHooks=function(d,w,S,x,O,P,X){return de.getSingleton().run(r,d,w,S,x,O,P,X)},this.getTranslatedPhrase=function(d,w){return Vv(y.language,d,w)},this.toHTML=()=>TS(this),this.toTableElement=()=>{const d=this.rootDocument.createElement("div");return d.insertAdjacentHTML("afterbegin",TS(this)),d.firstElementChild},this.timeouts=[],this._registerTimeout=function(d){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,S=d;typeof S=="function"&&(S=setTimeout(S,w)),this.timeouts.push(S)},this._clearTimeouts=function(){N(this.timeouts,d=>{clearTimeout(d)})},this.immediates=[],this._registerImmediate=function(d){this.immediates.push(setImmediate(d))},this._clearImmediates=function(){N(this.immediates,d=>{clearImmediate(d)})},this._refreshBorders=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;u.destroyEditor(d),r.view.render(),w&&I.isSelected()&&u.prepareEditor()},this.isRtl=function(){return r.rootWindow.getComputedStyle(r.rootElement).direction==="rtl"},this.isLtr=function(){return!r.isRtl()},this.getDirectionFactor=function(){return r.isLtr()?1:-1};const Ge=sB({handleEvent(d){const w=r.isListening(),S=(d==null?void 0:d.key)!==void 0;return w&&S},beforeKeyDown:d=>this.runHooks("beforeKeyDown",d),afterKeyDown:d=>{this.isDestroyed||r.runHooks("afterDocumentKeyDown",d)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",d=>{d.ctrlKey===!1&&d.metaKey===!1&&Ge.releasePressedKeys()}),this.getShortcutManager=function(){return Ge};const Oe=Ge.addContext("grid"),E={runOnlyIf:()=>he(r.getSelected())&&r.countRenderedRows()>0&&r.countRenderedCols()>0,group:oB};Ge.setActiveContextName("grid"),Oe.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>{r.selectAll()}},{keys:[["Control/Meta","Enter"]],callback:()=>{const d=r.getSelectedRange(),{row:w,col:S}=d[d.length-1].highlight,x=r.getDataAtCell(w,S),O=new Map;for(let P=0;P<d.length;P++)d[P].forAll((X,z)=>{if(X>=0&&z>=0&&(X!==w||z!==S)){const{readOnly:ee}=r.getCellMeta(X,z);ee||O.set(`${X}x${z}`,[X,z,x])}});r.setDataAtCell(Array.from(O.values()))},runOnlyIf:()=>r.getSelectedRangeLast().getCellsCount()>1},{keys:[["ArrowUp"]],callback:()=>{I.transformStart(-1,0)}},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>{I.setRangeStart(r._createCellCoords(r.rowIndexMapper.getNearestNotHiddenIndex(0,1),r.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowUp","Shift"]],callback:()=>{I.transformEnd(-1,0)}},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>{const{from:d,to:w}=r.getSelectedRangeLast(),S=r.rowIndexMapper.getNearestNotHiddenIndex(0,1);I.setRangeStart(d.clone()),I.setRangeEnd(r._createCellCoords(S,w.col))},runOnlyIf:()=>!(r.selection.isSelectedByCorner()||r.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>{I.transformStart(1,0)}},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>{I.setRangeStart(r._createCellCoords(r.rowIndexMapper.getNearestNotHiddenIndex(r.countRows()-1,-1),r.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowDown","Shift"]],callback:()=>{I.transformEnd(1,0)}},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>{const{from:d,to:w}=r.getSelectedRangeLast(),S=r.rowIndexMapper.getNearestNotHiddenIndex(r.countRows()-1,-1);I.setRangeStart(d.clone()),I.setRangeEnd(r._createCellCoords(S,w.col))},runOnlyIf:()=>!(r.selection.isSelectedByCorner()||r.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>{I.transformStart(0,-1*r.getDirectionFactor())}},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>{const d=r.getSelectedRangeLast().highlight.row,w=r.columnIndexMapper.getNearestNotHiddenIndex(...r.isRtl()?[r.countCols()-1,-1]:[0,1]);I.setRangeStart(r._createCellCoords(d,w))}},{keys:[["ArrowLeft","Shift"]],callback:()=>{I.transformEnd(0,-1*r.getDirectionFactor())}},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>{const{from:d,to:w}=r.getSelectedRangeLast(),S=r.columnIndexMapper.getNearestNotHiddenIndex(...r.isRtl()?[r.countCols()-1,-1]:[0,1]);I.setRangeStart(d.clone()),I.setRangeEnd(r._createCellCoords(w.row,S))},runOnlyIf:()=>!(r.selection.isSelectedByCorner()||r.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>{I.transformStart(0,r.getDirectionFactor())}},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>{const d=r.getSelectedRangeLast().highlight.row,w=r.columnIndexMapper.getNearestNotHiddenIndex(...r.isRtl()?[0,1]:[r.countCols()-1,-1]);I.setRangeStart(r._createCellCoords(d,w))}},{keys:[["ArrowRight","Shift"]],callback:()=>{I.transformEnd(0,r.getDirectionFactor())}},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>{const{from:d,to:w}=r.getSelectedRangeLast(),S=r.columnIndexMapper.getNearestNotHiddenIndex(...r.isRtl()?[0,1]:[r.countCols()-1,-1]);I.setRangeStart(d.clone()),I.setRangeEnd(r._createCellCoords(w.row,S))},runOnlyIf:()=>!(r.selection.isSelectedByCorner()||r.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>{const d=parseInt(r.getSettings().fixedColumnsStart,10),w=r.getSelectedRangeLast().highlight.row,S=r.columnIndexMapper.getNearestNotHiddenIndex(d,1);I.setRangeStart(r._createCellCoords(w,S))},runOnlyIf:()=>r.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>{I.setRangeEnd(r._createCellCoords(I.selectedRange.current().from.row,r.columnIndexMapper.getNearestNotHiddenIndex(0,1)))}},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>{const d=parseInt(r.getSettings().fixedRowsTop,10),w=parseInt(r.getSettings().fixedColumnsStart,10),S=r.rowIndexMapper.getNearestNotHiddenIndex(d,1),x=r.columnIndexMapper.getNearestNotHiddenIndex(w,1);I.setRangeStart(r._createCellCoords(S,x))},runOnlyIf:()=>r.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>{I.setRangeStart(r._createCellCoords(r.getSelectedRangeLast().highlight.row,r.columnIndexMapper.getNearestNotHiddenIndex(r.countCols()-1,-1)))},runOnlyIf:()=>r.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>{I.setRangeEnd(r._createCellCoords(I.selectedRange.current().from.row,r.columnIndexMapper.getNearestNotHiddenIndex(r.countCols()-1,-1)))}},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>{const d=parseInt(r.getSettings().fixedRowsBottom,10),w=r.rowIndexMapper.getNearestNotHiddenIndex(r.countRows()-d-1,-1),S=r.columnIndexMapper.getNearestNotHiddenIndex(r.countCols()-1,-1);I.setRangeStart(r._createCellCoords(w,S))},runOnlyIf:()=>r.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>{I.transformStart(-r.countVisibleRows(),0)}},{keys:[["PageUp","Shift"]],callback:()=>{const{to:d}=r.getSelectedRangeLast(),w=Math.max(d.row-r.countVisibleRows(),0),S=r.rowIndexMapper.getNearestNotHiddenIndex(w,1);if(S!==null){const x=r._createCellCoords(S,d.col),O=d.row-r.view.getFirstFullyVisibleRow(),P=Math.max(x.row-O,0);I.setRangeEnd(x),r.scrollViewportTo(P)}}},{keys:[["PageDown"]],callback:()=>{I.transformStart(r.countVisibleRows(),0)}},{keys:[["PageDown","Shift"]],callback:()=>{const{to:d}=r.getSelectedRangeLast(),w=Math.min(d.row+r.countVisibleRows(),r.countRows()-1),S=r.rowIndexMapper.getNearestNotHiddenIndex(w,-1);if(S!==null){const x=r._createCellCoords(S,d.col),O=d.row-r.view.getFirstFullyVisibleRow(),P=Math.min(x.row-O,r.countRows()-1);I.setRangeEnd(x),r.scrollViewportTo(P)}}},{keys:[["Tab"]],callback:d=>{const w=typeof y.tabMoves=="function"?y.tabMoves(d):y.tabMoves;I.transformStart(w.row,w.col,!0)}},{keys:[["Shift","Tab"]],callback:d=>{const w=typeof y.tabMoves=="function"?y.tabMoves(d):y.tabMoves;I.transformStart(-w.row,-w.col)}}],E),PS().forEach(d=>{const w=Od(d);T.addItem(d,new w(this))}),de.getSingleton().run(r,"construct")}const iB="hooksRefRegisterer",Zv={_hooksStorage:Object.create(null),addHook(n,e){return this._hooksStorage[n]||(this._hooksStorage[n]=[]),this.hot.addHook(n,e),this._hooksStorage[n].push(e),this},removeHooksByKey(n){N(this._hooksStorage[n]||[],e=>{this.hot.removeHook(n,e)})},clearHooks(){Be(this._hooksStorage,(n,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};Os(Zv,"MIXIN_NAME",iB,{writable:!1,enumerable:!1});const rB=Zv,aB="base",Bt=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),Wg="baseEditor";class Hi{static get EDITOR_TYPE(){return aB}constructor(e){this.hot=e,this.instance=e,this.state=Bt.VIRGIN,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.TD=null,this.row=null,this.col=null,this.prop=null,this.originalValue=null,this.cellProperties=null,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,t,s,o,r,a){this.TD=o,this.row=e,this.col=t,this.prop=s,this.originalValue=r,this.cellProperties=a,this.state=Bt.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,t){let s,o,r,a;if(t){const f=this.hot.getSelectedLast();s=Math.max(Math.min(f[0],f[2]),0),o=Math.max(Math.min(f[1],f[3]),0),r=Math.max(f[0],f[2]),a=Math.max(f[1],f[3])}else[s,o,r,a]=[this.row,this.col,null,null];const l=this.hot.runHooks("modifyGetCellCoords",s,o);Array.isArray(l)&&([s,o]=l);const h=this.hot.getShortcutManager().getContext("editor"),u={runOnlyIf:()=>he(this.hot.getSelected()),group:Wg};this.isInFullEditMode()&&h.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.hot.selection.transformStart(0,-1*this.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.hot.selection.transformStart(0,this.hot.getDirectionFactor())}}],u),this.hot.populateFromArray(s,o,e,r,a,"edit")}beginEditing(e,t){if(this.state!==Bt.VIRGIN)return;const s=this.hot,o=s.rowIndexMapper.getRenderableFromVisualIndex(this.row),r=s.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(s.view.scrollViewport(s._createCellCoords(o,r)),this.state=Bt.EDITING,this.isInFullEditMode()){const a=typeof e=="string"?e:At(this.originalValue);this.setValue(a)}this.open(t),this._opened=!0,this.focus(),s.view.render(),s.runHooks("afterBeginEditing",this.row,this.col)}finishEditing(e,t,s){let o;if(s){const l=this._closeCallback;this._closeCallback=c=>{l&&l(c),s(c),this.hot.view.render()}}if(this.isWaiting())return;const a=this.hot.getShortcutManager().getContext("editor");if(a.removeShortcutsByGroup(Wg),a.removeShortcutsByGroup(Wl),this.state===Bt.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===Bt.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const l=this.getValue();this.cellProperties.trimWhitespace?o=[[typeof l=="string"?String.prototype.trim.call(l||""):l]]:o=[[l]],this.state=Bt.WAITING,this.saveValue(o,t),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",c=>{this.state=Bt.FINISHED,this.discardEditor(c)}):(this.state=Bt.FINISHED,this.discardEditor(!0))}}cancelChanges(){this.state=Bt.FINISHED,this.discardEditor()}discardEditor(e){this.state===Bt.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=Bt.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=Bt.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===Bt.WAITING}getEditedCellRect(){var e;const t=this.getEditedCell();if(!t)return;const{wtOverlays:s,wtViewport:o}=this.hot.view._wt,r=this.hot.rootWindow,a=Ht(t),l=at(t),c=Ht(this.hot.rootElement),h=at(this.hot.rootElement),u=s.topOverlay.holder,f=s.inlineStartOverlay.holder,g=u!==r?u.scrollTop:0,p=f!==r?f.scrollLeft:0,C=r.innerWidth-c.left-h,{wtTable:y}=(e=s.getParentOverlay(t))!==null&&e!==void 0?e:this.hot.view._wt,b=y.name,T=["master","inline_start"].includes(b)?g:0,M=["master","top","bottom"].includes(b)?p:0,_=a.top===c.top?0:1;let I=a.top-c.top-_-T,D=0;this.hot.isRtl()?D=r.innerWidth-a.left-l-C-1+M:D=a.left-c.left-1-M,["top","top_inline_start_corner"].includes(b)&&(I+=s.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(b)&&(D+=Math.abs(s.inlineStartOverlay.getOverlayOffset()));const K=this.hot.hasColHeaders(),H=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),Q=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),F=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(K&&H<=0||H===F)&&(I+=1),Q<=0&&(D+=1);const Y=o.rowsRenderCalculator.startPosition,te=o.columnsRenderCalculator.startPosition,ie=Math.abs(s.inlineStartOverlay.getScrollPosition()),fe=s.topOverlay.getScrollPosition(),Me=Ft(this.hot.rootDocument),Ge=t.offsetTop+Y-fe;let Oe=0;if(this.hot.isRtl()){const se=t.offsetLeft;se>=0?Oe=y.getWidth()-t.offsetLeft:Oe=Math.abs(se),Oe+=te-ie-l}else Oe=t.offsetLeft+te-ie;const E=Do(this.TD,this.hot.rootWindow),d=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",w=parseInt(E[d],10)>0?0:1,S=parseInt(E.borderTopWidth,10)>0?0:1,x=at(t)+w,O=vt(t)+S,P=wk(u)?Me:0,X=Ck(f)?Me:0,z=this.hot.view.maximumVisibleElementWidth(Oe)-P+w,ee=Math.max(this.hot.view.maximumVisibleElementHeight(Ge)-X+S,23);return{top:I,start:D,height:O,maxHeight:ee,width:x,maxWidth:z}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let t="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?t="top-inline-start-corner":t="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?t="bottom-inline-start-corner":t="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(t="inline-start"),t}}lt(Hi,rB);function lB(){var n={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},e,t=document.body,s=document.createTextNode(""),o=document.createElement("SPAN"),r=function(g,p,C){g.addEventListener(p,C,!1)},a=function(g,p,C){g.removeEventListener(p,C,!1)},l=function(g){var p,C;g?/^[a-zA-Z \.,\\\/\|0-9]$/.test(g)||(g="."):g="",s.textContent!==void 0?s.textContent=e.value+g:s.data=e.value+g,o.style.position="absolute",o.style.fontSize=f(e).fontSize,o.style.fontFamily=f(e).fontFamily,o.style.whiteSpace="pre",t.appendChild(o),p=o.clientWidth+2,t.removeChild(o),e.style.height=n.minHeight+"px",n.minWidth>p?e.style.width=n.minWidth+"px":p>n.maxWidth?e.style.width=n.maxWidth+"px":e.style.width=p+"px",C=e.scrollHeight?e.scrollHeight-1:0,n.minHeight>C?e.style.height=n.minHeight+"px":n.maxHeight<C?(e.style.height=n.maxHeight+"px",e.style.overflowY="visible"):e.style.height=C+"px"},c=function(){window.setTimeout(l,0)},h=function(g){if(g&&g.minHeight)if(g.minHeight=="inherit")n.minHeight=e.clientHeight;else{var p=parseInt(g.minHeight);isNaN(p)||(n.minHeight=p)}if(g&&g.maxHeight)if(g.maxHeight=="inherit")n.maxHeight=e.clientHeight;else{var C=parseInt(g.maxHeight);isNaN(C)||(n.maxHeight=C)}if(g&&g.minWidth)if(g.minWidth=="inherit")n.minWidth=e.clientWidth;else{var y=parseInt(g.minWidth);isNaN(y)||(n.minWidth=y)}if(g&&g.maxWidth)if(g.maxWidth=="inherit")n.maxWidth=e.clientWidth;else{var b=parseInt(g.maxWidth);isNaN(b)||(n.maxWidth=b)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(s))},u=function(g,p,C){e=g,h(p),e.nodeName=="TEXTAREA"&&(e.style.resize="none",e.style.overflowY="",e.style.height=n.minHeight+"px",e.style.minWidth=n.minWidth+"px",e.style.maxWidth=n.maxWidth+"px",e.style.overflowY="hidden"),C&&(r(e,"change",l),r(e,"cut",c),r(e,"paste",c),r(e,"drop",c),r(e,"keydown",c),r(e,"focus",l),r(e,"compositionstart",c),r(e,"compositionupdate",c),r(e,"compositionend",c)),l()};function f(g){return g.currentStyle||document.defaultView.getComputedStyle(g)}return{init:function(g,p,C){u(g,p,C)},unObserve:function(){a(e,"change",l),a(e,"cut",c),a(e,"paste",c),a(e,"drop",c),a(e,"keydown",c),a(e,"focus",l),a(e,"compositionstart",c),a(e,"compositionupdate",c),a(e,"compositionend",c)},resize:l}}function Qv(n,e){const t=Ky(e),s=e.value.split(`
`);let o=t,r=0;for(let a=0;a<s.length;a++){const l=s[a];a!==0&&(r+=s[a-1].length+1);const c=r+l.length;if(n==="home"?o=r:n==="end"&&(o=c),t<=c)break}Ll(e,o)}const cB="ht_editor_visible",mc="ht_editor_hidden",Jv="textEditor",hB="text";class Uo extends Hi{static get EDITOR_TYPE(){return hB}constructor(e){super(e),this.eventManager=new bt(this),this.autoResize=lB(),this.TEXTAREA=void 0,this.textareaStyle=void 0,this.TEXTAREA_PARENT=void 0,this.textareaParentStyle=void 0,this.layerClass=void 0,this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.addHook("afterDocumentKeyDown",t=>this.onAfterDocumentKeyDown(t)),this.registerShortcuts()}close(){this.autoResize.unObserve(),this.hot.rootDocument.activeElement===this.TEXTAREA&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts(),this.removeHooksByKey("afterDocumentKeyDown")}prepare(e,t,s,o,r,a){const l=this.state;if(super.prepare(e,t,s,o,r,a),!a.readOnly){this.refreshDimensions(!0);const{allowInvalid:c,fragmentSelection:h}=a;c&&(this.TEXTAREA.value=""),l!==Bt.FINISHED&&this.hideEditableElement(),!h&&!os()&&this.focus()}}beginEditing(e,t){this.state===Bt.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,t))}focus(){this.TEXTAREA.select(),Ll(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.tabIndex=-1,oe(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),oe(this.TEXTAREA_PARENT,"handsontableInputHolder"),Ae(this.TEXTAREA_PARENT,this.layerClass)&&De(this.TEXTAREA_PARENT,this.layerClass),oe(this.TEXTAREA_PARENT,mc),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){Wk()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",De(this.TEXTAREA_PARENT,this.layerClass),oe(this.TEXTAREA_PARENT,mc)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";const e=this.TEXTAREA_PARENT.childNodes;let t=!1;Ce(e.length-1,s=>{const o=e[s];if(Ae(o,"handsontableEditor"))return t=!0,!1}),Ae(this.TEXTAREA_PARENT,mc)&&De(this.TEXTAREA_PARENT,mc),t?(this.layerClass=cB,oe(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),oe(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),t=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=t,this.setValue(t),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==Bt.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:t,start:s,width:o,maxWidth:r,height:a,maxHeight:l}=this.getEditedCellRect();this.textareaParentStyle.top=`${t}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${s}px`,this.showEditableElement();const c=Do(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=c.fontSize,this.TEXTAREA.style.fontFamily=c.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;const h=Do(this.TEXTAREA),u=parseInt(h.paddingLeft,10)+parseInt(h.paddingRight,10),f=parseInt(h.paddingTop,10)+parseInt(h.paddingBottom,10),g=o-u,p=a-f,C=r-u,y=l-f;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(g,C),minHeight:Math.min(p,y),maxWidth:C,maxHeight:y},!0)}bindEvents(){this.eventManager.addEventListener(this.TEXTAREA,"cut",e=>e.stopPropagation()),this.eventManager.addEventListener(this.TEXTAREA,"paste",e=>e.stopPropagation()),gS()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("editor"),s={runOnlyIf:()=>he(this.hot.getSelected()),group:Jv},o=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};t.addShortcuts([{keys:[["Tab"]],callback:r=>{const a=this.hot.getSettings(),l=typeof a.tabMoves=="function"?a.tabMoves(r):a.tabMoves;this.hot.selection.transformStart(l.row,l.col,!0)}},{keys:[["Shift","Tab"]],callback:r=>{const a=this.hot.getSettings(),l=typeof a.tabMoves=="function"?a.tabMoves(r):a.tabMoves;this.hot.selection.transformStart(-l.row,-l.col)}},{keys:[["Control","Enter"]],callback:()=>(o(),!1),runOnlyIf:r=>!this.hot.selection.isMultiple()&&!r.altKey,relativeToGroup:Ur,position:"before"},{keys:[["Meta","Enter"]],callback:()=>(o(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple(),relativeToGroup:Ur,position:"before"},{keys:[["Alt","Enter"]],callback:()=>(o(),!1),relativeToGroup:Ur,position:"before"},{keys:[["PageUp"]],callback:()=>{this.hot.selection.transformStart(-this.hot.countVisibleRows(),0)}},{keys:[["PageDown"]],callback:()=>{this.hot.selection.transformStart(this.hot.countVisibleRows(),0)}},{keys:[["Home"]],callback:(r,a)=>{let[l]=a;Qv(l,this.TEXTAREA)}},{keys:[["End"]],callback:(r,a)=>{let[l]=a;Qv(l,this.TEXTAREA)}},{keys:[["Control/Meta","Z"]],preventDefault:!1,callback:()=>{this.hot._registerTimeout(()=>{this.autoResize.resize()},10)}},{keys:[["Control/Meta","Shift","Z"]],preventDefault:!1,callback:()=>{this.hot._registerTimeout(()=>{this.autoResize.resize()},10)}}],s)}unregisterShortcuts(){const t=this.hot.getShortcutManager().getContext("editor");t.removeShortcutsByGroup(Wl),t.removeShortcutsByGroup(Jv),t.removeShortcutsByGroup(Wg)}onAfterDocumentKeyDown(e){[we.ARROW_UP,we.ARROW_RIGHT,we.ARROW_DOWN,we.ARROW_LEFT].indexOf(e.keyCode)===-1&&this.autoResize.resize(String.fromCharCode(e.keyCode))}}const uB="base";function sa(n,e,t,s,o,r,a){const l=[],c=[];a.className&&oe(e,a.className),a.readOnly&&l.push(a.readOnlyCellClassName),a.valid===!1&&a.invalidCellClassName?l.push(a.invalidCellClassName):c.push(a.invalidCellClassName),a.wordWrap===!1&&a.noWordWrapClassName&&l.push(a.noWordWrapClassName),!r&&a.placeholder&&l.push(a.placeholderCellClassName),De(e,c),oe(e,l)}sa.RENDERER_TYPE=uB;const dB="text";function so(n,e,t,s,o,r,a){sa.apply(this,[n,e,t,s,o,r,a]);let l=r;if(!l&&a.placeholder&&(l=a.placeholder),l=At(l),a.trimWhitespace&&(l=l.trim()),a.rendererTemplate){ss(e);const c=n.rootDocument.createElement("TEMPLATE");c.setAttribute("bind","{{}}"),c.innerHTML=a.rendererTemplate,HTMLTemplateElement.decorate(c),c.model=n.getSourceDataAtRow(t),e.appendChild(c)}else Po(e,l)}so.RENDERER_TYPE=dB;const eb={CELL_TYPE:"text",editor:Uo,renderer:so};cs(eb),vn.editors={BaseEditor:Hi};function vn(n,e){const t=new Bg(n,e||{},tf);return t.init(),t}vn.Core=function(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Bg(n,e,tf)},vn.DefaultSettings=Gv(),vn.hooks=de.getSingleton(),vn.CellCoords=Gl,vn.CellRange=Wd,vn.packageName="handsontable",vn.buildDate="31/08/2023 08:23:33",vn.version="13.1.0",vn.languages={dictionaryKeys:aF,getLanguageDictionary:Lv,getLanguagesDictionaries:dF,registerLanguageDictionary:kv,getTranslatedPhrase:Vv};var ki=Symbol("unassigned"),fB="The Handsontable instance bound to this component was destroyed and cannot be used properly.";function pc(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function tb(n){var e=vn.hooks.getRegistered(),t={};Object.assign(t,vn.DefaultSettings);for(var s in t)t[s]={default:ki};for(var o=0;o<e.length;o++)t[e[o]]={default:ki};return t.settings={default:ki},n==="HotTable"&&(t.id={type:String,default:"hot-".concat(Math.random().toString(36).substring(5))}),t}function nb(n){var e={},t=n.settings;if(t!==ki)for(var s in t)pc(t,s)&&t[s]!==ki&&(e[s]=t[s]);for(var o in n)pc(n,o)&&o!=="settings"&&n[o]!==ki&&(e[o]=n[o]);return e}function sb(n,e){var t=nb(n),s=n.settings?n.settings:t,o=n.settings?t:null,r={};for(var a in s)pc(s,a)&&s[a]!==void 0&&(!(e&&a!=="data")||!ob(e[a],s[a]))&&(r[a]=s[a]);for(var l in o)pc(o,l)&&l!=="id"&&l!=="settings"&&o[l]!==void 0&&(!(e&&l!=="data")||!ob(e[l],o[l]))&&(r[l]=o[l]);return r}function ob(n,e){return JSON.stringify(n)===JSON.stringify(e)}var gB="13.1.0",Ug=m.defineComponent({name:"HotTable",props:tb("HotTable"),provide:function(){return{columnsCache:this.columnsCache}},watch:{$props:{handler:function(e){var t=sb(e,this.hotInstance?this.hotInstance.getSettings():void 0);!this.hotInstance||t===void 0||(t.data&&(this.hotInstance.isColumnModificationAllowed()||!this.hotInstance.isColumnModificationAllowed()&&this.hotInstance.countSourceCols()===this.miscCache.currentSourceColumns)&&(this.matchHotMappersSize(),delete t.data),Object.keys(t).length?this.hotInstance.updateSettings(t):this.hotInstance.render(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols())},deep:!0,immediate:!0}},data:function(){return{__hotInstance:null,miscCache:{currentSourceColumns:null},columnSettings:null,columnsCache:new Map,get hotInstance(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn(fB),null)},set hotInstance(e){this.__hotInstance=e}}},methods:{hotInit:function(){var e=sb(this.$props);e.columns=this.columnSettings?this.columnSettings:e.columns,this.hotInstance=m.markRaw(new vn.Core(this.$el,e)),this.hotInstance.init(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols()},matchHotMappersSize:function(){var e=this;if(this.hotInstance){var t=this.hotInstance.getSourceData(),s=[],o=[],r=this.hotInstance.rowIndexMapper.getNumberOfIndexes(),a=this.hotInstance.isColumnModificationAllowed(),l=0;if(t&&t.length!==r&&t.length<r)for(var c=t.length;c<r;c++)s.push(c);if(a){var h;if(l=this.hotInstance.columnIndexMapper.getNumberOfIndexes(),t&&t[0]&&((h=t[0])===null||h===void 0?void 0:h.length)!==l&&t[0].length<l)for(var u=t[0].length;u<l;u++)o.push(u)}this.hotInstance.batch(function(){s.length>0?e.hotInstance.rowIndexMapper.removeIndexes(s):e.hotInstance.rowIndexMapper.insertIndexes(r-1,t.length-r),a&&t.length!==0&&(o.length>0?e.hotInstance.columnIndexMapper.removeIndexes(o):e.hotInstance.columnIndexMapper.insertIndexes(l-1,t[0].length-l))})}},getColumnSettings:function(){var e=Array.from(this.columnsCache.values());return e.length?e:void 0}},mounted:function(){this.columnSettings=this.getColumnSettings(),this.hotInit()},beforeUnmount:function(){this.hotInstance&&this.hotInstance.destroy()},version:gB}),mB=["id"];function pB(n,e,t,s,o,r){return m.openBlock(),m.createElementBlock("div",{id:n.id},[m.renderSlot(n.$slots,"default")],8,mB)}Ug.render=pB,Ug.__file="src/HotTable.vue";function ib(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);e&&(s=s.filter(function(o){return Object.getOwnPropertyDescriptor(n,o).enumerable})),t.push.apply(t,s)}return t}function wB(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?ib(Object(t),!0).forEach(function(s){CB(n,s,t[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):ib(Object(t)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(t,s))})}return n}function CB(n,e,t){return e=SB(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function yB(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function SB(n){var e=yB(n,"string");return typeof e=="symbol"?e:String(e)}var vB=m.defineComponent({name:"HotColumn",props:tb("HotColumn"),inject:["columnsCache"],methods:{createColumnSettings:function(){var e=nb(this.$props),t=wB({},e);e.renderer&&(t.renderer=e.renderer),e.editor&&(t.editor=e.editor),this.columnsCache.set(this,t)}},mounted:function(){this.createColumnSettings()},unmounted:function(){this.columnsCache.delete(this)},render:function(){return null}});vB.__file="src/HotColumn.vue";const Y3="",rb="handsontableEditor",bB="handsontable";class zg extends Uo{static get EDITOR_TYPE(){return bB}open(){super.open(),this.htEditor&&this.htEditor.destroy(),this.htContainer.style.display==="none"&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),Ll(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,t,s,o,r,a){super.prepare(e,t,s,o,r,a);const l=this,c={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,afterOnCellMouseDown(h,u){const f=this.getSourceData(u.row,u.col);f!==void 0&&l.setValue(f),l.instance.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&kt(c,a.handsontable),this.htOptions=c}beginEditing(e,t){const s=this.hot.getSettings().onBeginEditing;s&&s()===!1||super.beginEditing(e,t)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,t,s){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const o=this.htEditor.getInstance().getValue();o!==void 0&&this.setValue(o)}super.finishEditing(e,t,s)}assignHooks(){this.hot.addHook("afterDestroy",()=>{this.htEditor&&this.htEditor.destroy()})}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const s={group:rb,relativeToGroup:Wl,position:"before"},o=(r,a)=>{const l=this.htEditor.getInstance();if(r!==void 0&&(r<0||l.flipped&&r>l.countRows()-1?l.deselectCell():l.selectCell(r,0),l.getData().length))return a.preventDefault(),is(a),this.hot.listen(),this.TEXTAREA.focus(),!1};t.addShortcuts([{keys:[["ArrowUp"]],callback:r=>{const a=this.htEditor.getInstance();let l,c;return!a.getSelectedLast()&&a.flipped?l=a.countRows()-1:a.getSelectedLast()&&(a.flipped?(c=a.getSelectedLast()[0],l=Math.max(0,c-1)):(c=a.getSelectedLast()[0],l=c-1)),o(l,r)},preventDefault:!1},{keys:[["ArrowDown"]],callback:r=>{const a=this.htEditor.getInstance();let l,c;if(!a.getSelectedLast()&&!a.flipped)l=0;else if(a.getSelectedLast()){if(a.flipped)l=a.getSelectedLast()[0]+1;else if(!a.flipped){const h=a.countRows()-1;c=a.getSelectedLast()[0],l=Math.min(h,c+1)}}return o(l,r)},preventDefault:!1}],s)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(rb)}}function RB(n,e,t){return e=EB(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function EB(n){var e=xB(n,"string");return typeof e=="symbol"?e:String(e)}function xB(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const Yg=new WeakMap,TB="autocomplete";class Gg extends zg{static get EDITOR_TYPE(){return TB}constructor(e){super(e),RB(this,"sortByRelevance",function(t,s,o){const r=[],a=[],l=t.length;let c=s.length,h,u,f,g;if(l===0){for(f=0;f<c;f++)a.push(f);return a}for(f=0;f<c;f++){if(u=Yy(At(s[f])),o)g=u.indexOf(t);else{const p=this.cellProperties.locale;g=u.toLocaleLowerCase(p).indexOf(t.toLocaleLowerCase(p))}g!==-1&&(h=u.length-g-l,r.push({baseIndex:f,index:g,charsLeft:h,value:u}))}for(r.sort((p,C)=>{if(C.index===-1)return-1;if(p.index===-1)return 1;if(p.index<C.index)return-1;if(C.index<p.index)return 1;if(p.index===C.index){if(p.charsLeft<C.charsLeft)return-1;if(p.charsLeft>C.charsLeft)return 1}return 0}),f=0,c=r.length;f<c;f++)a.push(r[f].baseIndex);return a}),this.query=null,this.strippedChoices=[],this.rawChoices=[],Yg.set(this,{skipOne:!1,isMacOS:this.hot.rootWindow.navigator.platform.indexOf("Mac")>-1})}getValue(){const e=this.rawChoices.find(t=>this.stripValueIfNeeded(t)===this.TEXTAREA.value);return he(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),oe(this.htContainer,"autocompleteEditor"),oe(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll")}open(){const e=Yg.get(this);super.open();const t=this.htEditor.getInstance(),s=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown;this.showEditableElement(),this.focus();let o=Ft();o===0&&e.isMacOS&&(o+=15),this.addHook("beforeKeyDown",r=>this.onBeforeKeyDown(r)),t.updateSettings({colWidths:s?[at(this.TEXTAREA)-2]:void 0,width:s?at(this.TEXTAREA)+o:void 0,renderer:(r,a,l,c,h,u,f)=>{so(r,a,l,c,h,u,f);const{filteringCaseSensitive:g,allowHtml:p,locale:C}=this.cellProperties,y=this.query;let b=At(u),T,M;b&&!p&&(T=g===!0?b.indexOf(y):b.toLocaleLowerCase(C).indexOf(y.toLocaleLowerCase(C)),T!==-1&&(M=b.substr(T,y.length),b=b.replace(M,`<strong>${M}</strong>`))),a.innerHTML=b},autoColumnSize:!0}),e.skipOne&&(e.skipOne=!1),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close()}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const t=this.cellProperties.source;this.query=e,typeof t=="function"?t.call(this.cellProperties,e,s=>{this.rawChoices=s,this.updateChoicesList(this.stripValuesIfNeeded(s))}):Array.isArray(t)?(this.rawChoices=t,this.updateChoicesList(this.stripValuesIfNeeded(t))):this.updateChoicesList([])}updateChoicesList(e){const t=Ky(this.TEXTAREA),s=gk(this.TEXTAREA),o=this.cellProperties.sortByRelevance,r=this.cellProperties.filter;let a=null,l=null,c=e;o&&(a=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),c,this.cellProperties.filteringCaseSensitive));const h=Array.isArray(a)?a.length:0;if(r===!1)h&&(l=a[0]);else{const u=[];for(let f=0,g=c.length;f<g&&!(o&&h<=f);f++)h?u.push(c[a[f]]):u.push(c[f]);l=0,c=u}this.strippedChoices=c,this.htEditor.loadData(Ol([c])),this.updateDropdownHeight(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(l),this.hot.listen(),Ll(this.TEXTAREA,t,t===s?void 0:s)}flipDropdownIfNeeded(){const e=bi(this.hot.view._wt.wtTable.TABLE),t=e===this.hot.rootWindow,s=this.cellProperties.preventOverflow;if(t||!t&&(s||s==="horizontal"))return!1;const o=Ht(this.TEXTAREA),r=vt(this.TEXTAREA),a=this.getDropdownHeight(),l=e.scrollTop,c=vt(this.hot.view._wt.wtTable.THEAD),h=Ht(e),u=o.top-h.top-c+l,f=e.scrollHeight-u-c-r,g=a>f&&u>f;return g?this.flipDropdown(a):this.unflipDropdown(),this.limitDropdownIfNeeded(g?u:f,a),g}limitDropdownIfNeeded(e,t){if(t>e){let s=0,o=0,r=0,a=null;do r=this.htEditor.getRowHeight(o)||this.htEditor.view._wt.getSetting("defaultRowHeight"),s+=r,o+=1;while(s<e);a=s-r,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+t-a}px`),this.setDropdownHeight(s-r)}}flipDropdown(e){const t=this.htEditor.rootElement.style;t.position="absolute",t.top=`${-e}px`,this.htEditor.flipped=!0}unflipDropdown(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownHeight(){const e=this.htEditor.getColWidth(0)+Ft(this.hot.rootDocument)+2,t=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:t?void 0:e}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e})}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getDropdownHeight(){const e=this.htEditor.getInstance().getRowHeight(0)||23,t=this.cellProperties.visibleRows;return this.strippedChoices.length>=t?t*e:this.strippedChoices.length*e+8}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:t}=this.cellProperties,s=$e(e,r=>At(r));return $e(s,r=>t?r:Yy(r))}allowKeyEventPropagation(e){const t=this.htEditor.getSelectedRangeLast(),s={row:t?t.from.row:-1};let o=!1;return e===we.ARROW_DOWN&&s.row>0&&s.row<this.htEditor.countRows()-1&&(o=!0),e===we.ARROW_UP&&s.row>-1&&(o=!0),o}onBeforeKeyDown(e){const t=Yg.get(this);if(t.skipOne=!1,zk(e.keyCode)||e.keyCode===we.BACKSPACE||e.keyCode===we.DELETE||e.keyCode===we.INSERT){let s=10;if(e.keyCode===we.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(s+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value),t.skipOne=!0},s)}}}const MB="checkbox";class ab extends Hi{static get EDITOR_TYPE(){return MB}beginEditing(e,t){if(t&&t.type==="mouseup"){const s=this.TD.querySelector('input[type="checkbox"]');Ae(s,"htBadValue")||s.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}var lb={exports:{}};const _B=sM(sk);/*!
 * Pikaday
 *
 * Copyright Â© 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */(function(n,e){(function(t,s){var o;{try{o=_B}catch{}n.exports=s(o)}})(Va,function(t){var s=typeof t=="function",o=!!window.addEventListener,r=window.document,a=window.setTimeout,l=function(E,d,w,S){o?E.addEventListener(d,w,!!S):E.attachEvent("on"+d,w)},c=function(E,d,w,S){o?E.removeEventListener(d,w,!!S):E.detachEvent("on"+d,w)},h=function(E){return E.trim?E.trim():E.replace(/^\s+|\s+$/g,"")},u=function(E,d){return(" "+E.className+" ").indexOf(" "+d+" ")!==-1},f=function(E,d){u(E,d)||(E.className=E.className===""?d:E.className+" "+d)},g=function(E,d){E.className=h((" "+E.className+" ").replace(" "+d+" "," "))},p=function(E){return/Array/.test(Object.prototype.toString.call(E))},C=function(E){return/Date/.test(Object.prototype.toString.call(E))&&!isNaN(E.getTime())},y=function(E){var d=E.getDay();return d===0||d===6},b=function(E){return E%4===0&&E%100!==0||E%400===0},T=function(E,d){return[31,b(E)?29:28,31,30,31,30,31,31,30,31,30,31][d]},M=function(E){C(E)&&E.setHours(0,0,0,0)},_=function(E,d){return E.getTime()===d.getTime()},I=function(E,d,w){var S,x;for(S in d)x=E[S]!==void 0,x&&typeof d[S]=="object"&&d[S]!==null&&d[S].nodeName===void 0?C(d[S])?w&&(E[S]=new Date(d[S].getTime())):p(d[S])?w&&(E[S]=d[S].slice(0)):E[S]=I({},d[S],w):(w||!x)&&(E[S]=d[S]);return E},D=function(E,d,w){var S;r.createEvent?(S=r.createEvent("HTMLEvents"),S.initEvent(d,!0,!1),S=I(S,w),E.dispatchEvent(S)):r.createEventObject&&(S=r.createEventObject(),S=I(S,w),E.fireEvent("on"+d,S))},K=function(E){return E.month<0&&(E.year-=Math.ceil(Math.abs(E.month)/12),E.month+=12),E.month>11&&(E.year+=Math.floor(Math.abs(E.month)/12),E.month-=12),E},H={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},Q=function(E,d,w){for(d+=E.firstDay;d>=7;)d-=7;return w?E.i18n.weekdaysShort[d]:E.i18n.weekdays[d]},q=function(E){var d=[],w="false";if(E.isEmpty)if(E.showDaysInNextAndPreviousMonths)d.push("is-outside-current-month"),E.enableSelectionDaysInNextAndPreviousMonths||d.push("is-selection-disabled");else return'<td class="is-empty"></td>';return E.isDisabled&&d.push("is-disabled"),E.isToday&&d.push("is-today"),E.isSelected&&(d.push("is-selected"),w="true"),E.hasEvent&&d.push("has-event"),E.isInRange&&d.push("is-inrange"),E.isStartRange&&d.push("is-startrange"),E.isEndRange&&d.push("is-endrange"),'<td data-day="'+E.day+'" class="'+d.join(" ")+'" aria-selected="'+w+'"><button class="pika-button pika-day" type="button" data-pika-year="'+E.year+'" data-pika-month="'+E.month+'" data-pika-day="'+E.day+'">'+E.day+"</button></td>"},F=function(E,d){E.setHours(0,0,0,0);var w=E.getDate(),S=E.getDay(),x=d,O=x-1,P=7,X=function(pe){return(pe+P-1)%P};E.setDate(w+O-X(S));var z=new Date(E.getFullYear(),0,x),ee=24*60*60*1e3,se=(E.getTime()-z.getTime())/ee,J=1+Math.round((se-O+X(z.getDay()))/P);return J},Y=function(E,d,w,S){var x=new Date(w,d,E),O=s?t(x).isoWeek():F(x,S);return'<td class="pika-week">'+O+"</td>"},te=function(E,d,w,S){return'<tr class="pika-row'+(w?" pick-whole-week":"")+(S?" is-selected":"")+'">'+(d?E.reverse():E).join("")+"</tr>"},ie=function(E){return"<tbody>"+E.join("")+"</tbody>"},fe=function(E){var d,w=[];for(E.showWeekNumber&&w.push("<th></th>"),d=0;d<7;d++)w.push('<th scope="col"><abbr title="'+Q(E,d)+'">'+Q(E,d,!0)+"</abbr></th>");return"<thead><tr>"+(E.isRTL?w.reverse():w).join("")+"</tr></thead>"},Me=function(E,d,w,S,x,O){var P,X,z,ee=E._o,se=w===ee.minYear,J=w===ee.maxYear,pe='<div id="'+O+'" class="pika-title" role="heading" aria-live="assertive">',He,xe,Te=!0,Z=!0;for(z=[],P=0;P<12;P++)z.push('<option value="'+(w===x?P-d:12+P-d)+'"'+(P===S?' selected="selected"':"")+(se&&P<ee.minMonth||J&&P>ee.maxMonth?' disabled="disabled"':"")+">"+ee.i18n.months[P]+"</option>");for(He='<div class="pika-label">'+ee.i18n.months[S]+'<select class="pika-select pika-select-month" tabindex="-1">'+z.join("")+"</select></div>",p(ee.yearRange)?(P=ee.yearRange[0],X=ee.yearRange[1]+1):(P=w-ee.yearRange,X=1+w+ee.yearRange),z=[];P<X&&P<=ee.maxYear;P++)P>=ee.minYear&&z.push('<option value="'+P+'"'+(P===w?' selected="selected"':"")+">"+P+"</option>");return xe='<div class="pika-label">'+w+ee.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+z.join("")+"</select></div>",ee.showMonthAfterYear?pe+=xe+He:pe+=He+xe,se&&(S===0||ee.minMonth>=S)&&(Te=!1),J&&(S===11||ee.maxMonth<=S)&&(Z=!1),d===0&&(pe+='<button class="pika-prev'+(Te?"":" is-disabled")+'" type="button">'+ee.i18n.previousMonth+"</button>"),d===E._o.numberOfMonths-1&&(pe+='<button class="pika-next'+(Z?"":" is-disabled")+'" type="button">'+ee.i18n.nextMonth+"</button>"),pe+="</div>"},Ge=function(E,d,w){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+w+'">'+fe(E)+ie(d)+"</table>"},Oe=function(E){var d=this,w=d.config(E);d._onMouseDown=function(x){if(d._v){x=x||window.event;var O=x.target||x.srcElement;if(O)if(u(O,"is-disabled")||(u(O,"pika-button")&&!u(O,"is-empty")&&!u(O.parentNode,"is-disabled")?(d.setDate(new Date(O.getAttribute("data-pika-year"),O.getAttribute("data-pika-month"),O.getAttribute("data-pika-day"))),w.bound&&a(function(){d.hide(),w.blurFieldOnSelect&&w.field&&w.field.blur()},100)):u(O,"pika-prev")?d.prevMonth():u(O,"pika-next")&&d.nextMonth()),u(O,"pika-select"))d._c=!0;else if(x.preventDefault)x.preventDefault();else return x.returnValue=!1,!1}},d._onChange=function(x){x=x||window.event;var O=x.target||x.srcElement;O&&(u(O,"pika-select-month")?d.gotoMonth(O.value):u(O,"pika-select-year")&&d.gotoYear(O.value))},d._onKeyChange=function(x){if(x=x||window.event,d.isVisible())switch(x.keyCode){case 13:case 27:w.field&&w.field.blur();break;case 37:d.adjustDate("subtract",1);break;case 38:d.adjustDate("subtract",7);break;case 39:d.adjustDate("add",1);break;case 40:d.adjustDate("add",7);break;case 8:case 46:d.setDate(null);break}},d._parseFieldValue=function(){if(w.parse)return w.parse(w.field.value,w.format);if(s){var x=t(w.field.value,w.format,w.formatStrict);return x&&x.isValid()?x.toDate():null}else return new Date(Date.parse(w.field.value))},d._onInputChange=function(x){var O;x.firedBy!==d&&(O=d._parseFieldValue(),C(O)&&d.setDate(O),d._v||d.show())},d._onInputFocus=function(){d.show()},d._onInputClick=function(){d.show()},d._onInputBlur=function(){var x=r.activeElement;do if(u(x,"pika-single"))return;while(x=x.parentNode);d._c||(d._b=a(function(){d.hide()},50)),d._c=!1},d._onClick=function(x){x=x||window.event;var O=x.target||x.srcElement,P=O;if(O){!o&&u(O,"pika-select")&&(O.onchange||(O.setAttribute("onchange","return;"),l(O,"change",d._onChange)));do if(u(P,"pika-single")||P===w.trigger)return;while(P=P.parentNode);d._v&&O!==w.trigger&&P!==w.trigger&&d.hide()}},d.el=r.createElement("div"),d.el.className="pika-single"+(w.isRTL?" is-rtl":"")+(w.theme?" "+w.theme:""),l(d.el,"mousedown",d._onMouseDown,!0),l(d.el,"touchend",d._onMouseDown,!0),l(d.el,"change",d._onChange),w.keyboardInput&&l(r,"keydown",d._onKeyChange),w.field&&(w.container?w.container.appendChild(d.el):w.bound?r.body.appendChild(d.el):w.field.parentNode.insertBefore(d.el,w.field.nextSibling),l(w.field,"change",d._onInputChange),w.defaultDate||(w.defaultDate=d._parseFieldValue(),w.setDefaultDate=!0));var S=w.defaultDate;C(S)?w.setDefaultDate?d.setDate(S,!0):d.gotoDate(S):d.gotoDate(new Date),w.bound?(this.hide(),d.el.className+=" is-bound",l(w.trigger,"click",d._onInputClick),l(w.trigger,"focus",d._onInputFocus),l(w.trigger,"blur",d._onInputBlur)):this.show()};return Oe.prototype={config:function(E){this._o||(this._o=I({},H,!0));var d=I(this._o,E,!0);d.isRTL=!!d.isRTL,d.field=d.field&&d.field.nodeName?d.field:null,d.theme=typeof d.theme=="string"&&d.theme?d.theme:null,d.bound=!!(d.bound!==void 0?d.field&&d.bound:d.field),d.trigger=d.trigger&&d.trigger.nodeName?d.trigger:d.field,d.disableWeekends=!!d.disableWeekends,d.disableDayFn=typeof d.disableDayFn=="function"?d.disableDayFn:null;var w=parseInt(d.numberOfMonths,10)||1;if(d.numberOfMonths=w>4?4:w,C(d.minDate)||(d.minDate=!1),C(d.maxDate)||(d.maxDate=!1),d.minDate&&d.maxDate&&d.maxDate<d.minDate&&(d.maxDate=d.minDate=!1),d.minDate&&this.setMinDate(d.minDate),d.maxDate&&this.setMaxDate(d.maxDate),p(d.yearRange)){var S=new Date().getFullYear()-10;d.yearRange[0]=parseInt(d.yearRange[0],10)||S,d.yearRange[1]=parseInt(d.yearRange[1],10)||S}else d.yearRange=Math.abs(parseInt(d.yearRange,10))||H.yearRange,d.yearRange>100&&(d.yearRange=100);return d},toString:function(E){return E=E||this._o.format,C(this._d)?this._o.toString?this._o.toString(this._d,E):s?t(this._d).format(E):this._d.toDateString():""},getMoment:function(){return s?t(this._d):null},setMoment:function(E,d){s&&t.isMoment(E)&&this.setDate(E.toDate(),d)},getDate:function(){return C(this._d)?new Date(this._d.getTime()):null},setDate:function(E,d){if(!E)return this._d=null,this._o.field&&(this._o.field.value="",D(this._o.field,"change",{firedBy:this})),this.draw();if(typeof E=="string"&&(E=new Date(Date.parse(E))),!!C(E)){var w=this._o.minDate,S=this._o.maxDate;C(w)&&E<w?E=w:C(S)&&E>S&&(E=S),this._d=new Date(E.getTime()),M(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),D(this._o.field,"change",{firedBy:this})),!d&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())}},clear:function(){this.setDate(null)},gotoDate:function(E){var d=!0;if(C(E)){if(this.calendars){var w=new Date(this.calendars[0].year,this.calendars[0].month,1),S=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),x=E.getTime();S.setMonth(S.getMonth()+1),S.setDate(S.getDate()-1),d=x<w.getTime()||S.getTime()<x}d&&(this.calendars=[{month:E.getMonth(),year:E.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(E,d){var w=this.getDate()||new Date,S=parseInt(d)*24*60*60*1e3,x;E==="add"?x=new Date(w.valueOf()+S):E==="subtract"&&(x=new Date(w.valueOf()-S)),this.setDate(x)},adjustCalendars:function(){this.calendars[0]=K(this.calendars[0]);for(var E=1;E<this._o.numberOfMonths;E++)this.calendars[E]=K({month:this.calendars[0].month+E,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(E){isNaN(E)||(this.calendars[0].month=parseInt(E,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(E){isNaN(E)||(this.calendars[0].year=parseInt(E,10),this.adjustCalendars())},setMinDate:function(E){E instanceof Date?(M(E),this._o.minDate=E,this._o.minYear=E.getFullYear(),this._o.minMonth=E.getMonth()):(this._o.minDate=H.minDate,this._o.minYear=H.minYear,this._o.minMonth=H.minMonth,this._o.startRange=H.startRange),this.draw()},setMaxDate:function(E){E instanceof Date?(M(E),this._o.maxDate=E,this._o.maxYear=E.getFullYear(),this._o.maxMonth=E.getMonth()):(this._o.maxDate=H.maxDate,this._o.maxYear=H.maxYear,this._o.maxMonth=H.maxMonth,this._o.endRange=H.endRange),this.draw()},setStartRange:function(E){this._o.startRange=E},setEndRange:function(E){this._o.endRange=E},draw:function(E){if(!(!this._v&&!E)){var d=this._o,w=d.minYear,S=d.maxYear,x=d.minMonth,O=d.maxMonth,P="",X;this._y<=w&&(this._y=w,!isNaN(x)&&this._m<x&&(this._m=x)),this._y>=S&&(this._y=S,!isNaN(O)&&this._m>O&&(this._m=O));for(var z=0;z<d.numberOfMonths;z++)X="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),P+='<div class="pika-lendar">'+Me(this,z,this.calendars[z].year,this.calendars[z].month,this.calendars[0].year,X)+this.render(this.calendars[z].year,this.calendars[z].month,X)+"</div>";this.el.innerHTML=P,d.bound&&d.field.type!=="hidden"&&a(function(){d.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),d.bound&&d.field.setAttribute("aria-label",d.ariaLabel)}},adjustPosition:function(){var E,d,w,S,x,O,P,X,z,ee,se,J;if(!this._o.container){if(this.el.style.position="absolute",E=this._o.trigger,d=E,w=this.el.offsetWidth,S=this.el.offsetHeight,x=window.innerWidth||r.documentElement.clientWidth,O=window.innerHeight||r.documentElement.clientHeight,P=window.pageYOffset||r.body.scrollTop||r.documentElement.scrollTop,se=!0,J=!0,typeof E.getBoundingClientRect=="function")ee=E.getBoundingClientRect(),X=ee.left+window.pageXOffset,z=ee.bottom+window.pageYOffset;else for(X=d.offsetLeft,z=d.offsetTop+d.offsetHeight;d=d.offsetParent;)X+=d.offsetLeft,z+=d.offsetTop;(this._o.reposition&&X+w>x||this._o.position.indexOf("right")>-1&&X-w+E.offsetWidth>0)&&(X=X-w+E.offsetWidth,se=!1),(this._o.reposition&&z+S>O+P||this._o.position.indexOf("top")>-1&&z-S-E.offsetHeight>0)&&(z=z-S-E.offsetHeight,J=!1),this.el.style.left=X+"px",this.el.style.top=z+"px",f(this.el,se?"left-aligned":"right-aligned"),f(this.el,J?"bottom-aligned":"top-aligned"),g(this.el,se?"right-aligned":"left-aligned"),g(this.el,J?"top-aligned":"bottom-aligned")}},render:function(E,d,w){var S=this._o,x=new Date,O=T(E,d),P=new Date(E,d,1).getDay(),X=[],z=[];M(x),S.firstDay>0&&(P-=S.firstDay,P<0&&(P+=7));for(var ee=d===0?11:d-1,se=d===11?0:d+1,J=d===0?E-1:E,pe=d===11?E+1:E,He=T(J,ee),xe=O+P,Te=xe;Te>7;)Te-=7;xe+=7-Te;for(var Z=!1,je=0,Le=0;je<xe;je++){var ve=new Date(E,d,1+(je-P)),Pe=C(this._d)?_(ve,this._d):!1,Se=_(ve,x),v=S.events.indexOf(ve.toDateString())!==-1,R=je<P||je>=O+P,A=1+(je-P),U=d,k=E,W=S.startRange&&_(S.startRange,ve),L=S.endRange&&_(S.endRange,ve),V=S.startRange&&S.endRange&&S.startRange<ve&&ve<S.endRange,G=S.minDate&&ve<S.minDate||S.maxDate&&ve>S.maxDate||S.disableWeekends&&y(ve)||S.disableDayFn&&S.disableDayFn(ve);R&&(je<P?(A=He+A,U=ee,k=J):(A=A-O,U=se,k=pe));var B={day:A,month:U,year:k,hasEvent:v,isSelected:Pe,isToday:Se,isDisabled:G,isEmpty:R,isStartRange:W,isEndRange:L,isInRange:V,showDaysInNextAndPreviousMonths:S.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:S.enableSelectionDaysInNextAndPreviousMonths};S.pickWholeWeek&&Pe&&(Z=!0),z.push(q(B)),++Le===7&&(S.showWeekNumber&&z.unshift(Y(je-P,d,E,S.firstWeekOfYearMinDays)),X.push(te(z,S.isRTL,S.pickWholeWeek,Z)),z=[],Le=0,Z=!1)}return Ge(S,X,w)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),g(this.el,"is-hidden"),this._o.bound&&(l(r,"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){var E=this._v;E!==!1&&(this._o.bound&&c(r,"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),f(this.el,"is-hidden"),this._v=!1,E!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){var E=this._o;this.hide(),c(this.el,"mousedown",this._onMouseDown,!0),c(this.el,"touchend",this._onMouseDown,!0),c(this.el,"change",this._onChange),E.keyboardInput&&c(r,"keydown",this._onKeyChange),E.field&&(c(E.field,"change",this._onInputChange),E.bound&&(c(E.trigger,"click",this._onInputClick),c(E.trigger,"focus",this._onInputFocus),c(E.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},Oe})})(lb);var IB=lb.exports;const cb=jp(IB),hb="date",ub="dateEditor";class db extends Uo{static get EDITOR_TYPE(){return hb}constructor(e){super(e),this.defaultDateFormat="DD/MM/YYYY",this.isCellEdited=!1,this.parentDestroyed=!1,this.$datePicker=null}init(){if(typeof ne!="function")throw new Error("You need to include moment.js to your project.");if(typeof cb!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.instance.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),oe(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker),new bt(this).addEventListener(this.datePicker,"mousedown",t=>t.stopPropagation())}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,t,s,o,r,a){super.prepare(e,t,s,o,r,a)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const s=this.hot.getShortcutManager().getContext("editor");super.open(),this.showDatepicker(e),s.addShortcut({keys:[["Enter"]],callback:o=>{o.stopPropagation()},group:ub})}close(){var e;this._opened=!1,(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.instance._registerTimeout(()=>{this.instance._refreshBorders()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(ub),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(e){const s=this.originalValue;s!==void 0&&this.setValue(s)}super.finishEditing(e,t)}showDatepicker(e){const t=this.TD.getBoundingClientRect(),s=this.cellProperties.dateFormat||this.defaultDateFormat,o=this.instance.view.isMouseDown(),r=e?CS(e.keyCode):!1;let a;this.datePicker.style.display="block",this.$datePicker=new cb(this.getDatePickerConfig()),this.$datePicker._onInputFocus=function(){},this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+t.top+vt(this.TD)}px`;let l=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?l=t.right-at(this.datePicker):l=t.left,this.datePickerStyle.left=`${l}px`,this.originalValue?(a=this.originalValue,ne(a,s,!0).isValid()&&this.$datePicker.setMoment(ne(a,s),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!r&&!o&&this.setValue("")):this.cellProperties.defaultDate?(a=this.cellProperties.defaultDate,ne(a,s,!0).isValid()&&this.$datePicker.setMoment(ne(a,s),!0),!r&&!o&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){const e=this.TEXTAREA,t={};this.cellProperties&&this.cellProperties.datePickerConfig&&Bl(t,this.cellProperties.datePickerConfig);const s=t.onSelect,o=t.onClose;return t.field=e,t.trigger=e,t.container=this.datePicker,t.bound=!1,t.format=t.format||this.defaultDateFormat,t.reposition=t.reposition||!1,t.isRTL=!1,t.onSelect=r=>{let a=r;isNaN(a.getTime())||(a=ne(a).format(this.cellProperties.dateFormat||this.defaultDateFormat)),this.setValue(a),this.hideDatepicker(),s&&s()},t.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),o&&o()},t}}const OB="dropdown";class jg extends Gg{static get EDITOR_TYPE(){return OB}prepare(e,t,s,o,r,a){super.prepare(e,t,s,o,r,a),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}de.getSingleton().add("beforeValidate",function(n,e,t){const s=this.getCellMeta(e,this.propToCol(t));s.editor===jg&&s.strict===void 0&&(s.filter=!1,s.strict=!0)});const AB="numeric";class fb extends Uo{static get EDITOR_TYPE(){return AB}}const PB="password";class gb extends Uo{static get EDITOR_TYPE(){return PB}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,ss(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const Kg="ht_editor_visible",mb="selectEditor",DB="select";class NB extends Hi{static get EDITOR_TYPE(){return DB}init(){this.select=this.hot.rootDocument.createElement("SELECT"),oe(this.select,"htSelectEditor"),this.select.style.display="none",this.hot.rootElement.appendChild(this.select),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.select.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.select.style.display="none",Ae(this.select,Kg)&&De(this.select,Kg),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,t,s,o,r,a){super.prepare(e,t,s,o,r,a);const l=this.cellProperties.selectOptions;let c;typeof l=="function"?c=this.prepareOptions(l(this.row,this.col,this.prop)):c=this.prepareOptions(l),ss(this.select),Be(c,(h,u)=>{const f=this.hot.rootDocument.createElement("OPTION");f.value=u,Si(f,h),this.select.appendChild(f)})}prepareOptions(e){let t={};if(Array.isArray(e))for(let s=0,o=e.length;s<o;s++)t[e[s]]=e[s];else typeof e=="object"&&(t=e);return t}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==Bt.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:t,width:s,height:o}=this.getEditedCellRect(),r=this.select.style;r.height=`${o}px`,r.width=`${s}px`,r.top=`${e}px`,r[this.hot.isRtl()?"right":"left"]=`${t}px`,r.margin="0px",oe(this.select,Kg)}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("editor"),s={group:mb};this.isInFullEditMode()!==!1&&t.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const o=this.select.selectedIndex-1;o>=0&&(this.select[o].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const o=this.select.selectedIndex+1;o<=this.select.length-1&&(this.select[o].selected=!0)}}],s)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(mb)}}const HB="time";class pb extends Uo{static get EDITOR_TYPE(){return HB}prepare(e,t,s,o,r,a){super.prepare(e,t,s,o,r,a),this.TEXTAREA.dir="ltr"}}function kB(){Sn(Hi),Sn(Gg),Sn(ab),Sn(db),Sn(jg),Sn(zg),Sn(fb),Sn(gb),Sn(NB),Sn(Uo),Sn(pb)}const LB="html";function Xg(n,e,t,s,o,r,a){sa.apply(this,[n,e,t,s,o,r,a]),Si(e,r??"",!1)}Xg.RENDERER_TYPE=LB;const VB="autocomplete";function Li(n,e,t,s,o,r,a){const{rootDocument:l}=n,c=a.allowHtml?Xg:so,h=l.createElement("DIV");if(h.className="htAutocompleteArrow",h.appendChild(l.createTextNode(String.fromCharCode(9660))),c.apply(this,[n,e,t,s,o,r,a]),e.firstChild||e.appendChild(l.createTextNode(String.fromCharCode(160))),e.insertBefore(h,e.firstChild),oe(e,"htAutocomplete"),!n.acArrowListener){const u=new bt(n);n.acArrowListener=function(f){Ae(f.target,"htAutocompleteArrow")&&n.view._wt.getSetting("onCellDblClick",null,n._createCellCoords(t,s),e)},u.addEventListener(n.rootElement,"mousedown",n.acArrowListener),n.addHookOnce("afterDestroy",()=>{u.destroy()})}}Li.RENDERER_TYPE=VB;const wb=new WeakMap,Cb=new WeakMap,$B="htBadValue",Vi="data-row",$i="data-col",FB="checkboxRenderer",yb="checkbox";de.getSingleton().add("modifyAutoColumnSizeSeed",function(n,e,t){const{label:s,type:o,row:r,column:a,prop:l}=e;if(o===yb){if(s){const{value:c,property:h}=s;let u=t;if(c)u=typeof c=="function"?c(r,a,l,t):c;else if(h){const f=this.getDataAtRowProp(r,h);u=f!==null?f:t}n=u}return n}});function qg(n,e,t,s,o,r,a){const{rootDocument:l}=n;sa.apply(this,[n,e,t,s,o,r,a]),BB(n);let c=WB(l);const h=a.label;let u=!1;if(typeof a.checkedTemplate>"u"&&(a.checkedTemplate=!0),typeof a.uncheckedTemplate>"u"&&(a.uncheckedTemplate=!1),ss(e),r===a.checkedTemplate||At(r).toLocaleLowerCase(a.locale)===At(a.checkedTemplate).toLocaleLowerCase(a.locale)?c.checked=!0:r===a.uncheckedTemplate||At(r).toLocaleLowerCase(a.locale)===At(a.uncheckedTemplate).toLocaleLowerCase(a.locale)?c.checked=!1:Vt(r)?oe(c,"noValue"):(c.style.display="none",oe(c,$B),u=!0),c.setAttribute(Vi,t),c.setAttribute($i,s),!u&&h){let C="";if(h.value)C=typeof h.value=="function"?h.value.call(this,t,s,o,r):h.value;else if(h.property){const b=n.getDataAtRowProp(t,h.property);C=b!==null?b:""}const y=UB(l,C,h.separated!==!0);h.position==="before"?h.separated?(e.appendChild(y),e.appendChild(c)):(y.appendChild(c),c=y):(!h.position||h.position==="after")&&(h.separated?(e.appendChild(c),e.appendChild(y)):(y.insertBefore(c,y.firstChild),c=y))}(!h||h&&!h.separated)&&e.appendChild(c),u&&e.appendChild(l.createTextNode("#bad-value#")),wb.has(n)||(wb.set(n,!0),f());function f(){const y=n.getShortcutManager().getContext("grid"),b={group:FB};y.addShortcuts([{keys:[["space"]],callback:()=>(g(),!p())},{keys:[["enter"]],callback:()=>(g(),!p()),runOnlyIf:()=>n.getSettings().enterBeginsEditing},{keys:[["delete"],["backspace"]],callback:()=>(g(!0),!p()),relativeToGroup:Ur,position:"before"}],b)}function g(){let C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const y=n.getSelectedRange();if(y)for(let b=0;b<y.length;b++){const{row:T,col:M}=y[b].getTopStartCorner(),{row:_,col:I}=y[b].getBottomEndCorner(),D=[];for(let K=T;K<=_;K+=1)for(let H=M;H<=I;H+=1){const Q=n.getCellMeta(K,H);if(Q.type!=="checkbox")return;if(Q.readOnly===!0)continue;typeof Q.checkedTemplate>"u"&&(Q.checkedTemplate=!0),typeof Q.uncheckedTemplate>"u"&&(Q.uncheckedTemplate=!1);const q=n.getDataAtCell(K,H);C===!1?[Q.checkedTemplate,Q.checkedTemplate.toString()].includes(q)?D.push([K,H,Q.uncheckedTemplate]):[Q.uncheckedTemplate,Q.uncheckedTemplate.toString(),null,void 0].includes(q)&&D.push([K,H,Q.checkedTemplate]):D.push([K,H,Q.uncheckedTemplate])}D.length>0&&n.setDataAtCell(D)}}function p(){const C=n.getSelectedRange();if(C){for(let y=0;y<C.length;y++){const b=C[y].getTopStartCorner(),T=C[y].getBottomEndCorner();for(let M=b.row;M<=T.row;M++)for(let _=b.col;_<=T.col;_++){const I=n.getCellMeta(M,_);if(I.type!=="checkbox")return!1;const D=n.getCell(M,_);if(D==null)return!0;if(D.querySelectorAll("input[type=checkbox]").length>0&&!I.readOnly)return!0}}return!1}}}qg.RENDERER_TYPE=yb;function BB(n){let e=Cb.get(n);if(!e){const{rootElement:t}=n;e=new bt(n),e.addEventListener(t,"click",s=>YB(s,n)),e.addEventListener(t,"mouseup",s=>zB(s,n)),e.addEventListener(t,"change",s=>GB(s,n)),Cb.set(n,e)}return e}function WB(n){const e=n.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("autocomplete","off"),e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function UB(n,e,t){const s=n.createElement("label");return s.className=`htCheckboxRendererLabel ${t?"fullWidth":""}`,s.appendChild(n.createTextNode(e)),s.cloneNode(!0)}function zB(n,e){const{target:t}=n;Zg(t)&&(!t.hasAttribute(Vi)||!t.hasAttribute($i)||setTimeout(e.listen,10))}function YB(n,e){const{target:t}=n;if(!Zg(t)||!t.hasAttribute(Vi)||!t.hasAttribute($i))return;const s=parseInt(t.getAttribute(Vi),10),o=parseInt(t.getAttribute($i),10);e.getCellMeta(s,o).readOnly&&n.preventDefault()}function GB(n,e){const{target:t}=n;if(!Zg(t)||!t.hasAttribute(Vi)||!t.hasAttribute($i))return;const s=parseInt(t.getAttribute(Vi),10),o=parseInt(t.getAttribute($i),10),r=e.getCellMeta(s,o);if(!r.readOnly){let a=null;n.target.checked?a=r.uncheckedTemplate===void 0?!0:r.checkedTemplate:a=r.uncheckedTemplate===void 0?!1:r.uncheckedTemplate,e.setDataAtCell(s,o,a)}}function Zg(n){return n.tagName==="INPUT"&&n.getAttribute("type")==="checkbox"}function wc(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Sb={exports:{}};(function(n,e){(function(t){n.exports=t()})(function(){return function t(s,o,r){function a(h,u){if(!o[h]){if(!s[h]){var f=typeof wc=="function"&&wc;if(!u&&f)return f(h,!0);if(l)return l(h,!0);var g=new Error("Cannot find module '"+h+"'");throw g.code="MODULE_NOT_FOUND",g}var p=o[h]={exports:{}};s[h][0].call(p.exports,function(C){return a(s[h][1][C]||C)},p,p.exports,t,s,o,r)}return o[h].exports}for(var l=typeof wc=="function"&&wc,c=0;c<r.length;c++)a(r[c]);return a}({1:[function(t,s,o){(function(r){var a,l=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,c=Math.ceil,h=Math.floor,u="[BigNumber Error] ",f=u+"Number primitive has more than 15 significant digits: ",g=1e14,p=14,C=9007199254740991,y=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],b=1e7,T=1e9;function M(q){var F=0|q;return 0<q||q===F?F:F-1}function _(q){for(var F,Y,te=1,ie=q.length,fe=q[0]+"";te<ie;){for(F=q[te++]+"",Y=p-F.length;Y--;F="0"+F);fe+=F}for(ie=fe.length;fe.charCodeAt(--ie)===48;);return fe.slice(0,ie+1||1)}function I(q,F){var Y,te,ie=q.c,fe=F.c,Me=q.s,Ge=F.s,Oe=q.e,E=F.e;if(!Me||!Ge)return null;if(Y=ie&&!ie[0],te=fe&&!fe[0],Y||te)return Y?te?0:-Ge:Me;if(Me!=Ge)return Me;if(Y=Me<0,te=Oe==E,!ie||!fe)return te?0:!ie^Y?1:-1;if(!te)return E<Oe^Y?1:-1;for(Ge=(Oe=ie.length)<(E=fe.length)?Oe:E,Me=0;Me<Ge;Me++)if(ie[Me]!=fe[Me])return ie[Me]>fe[Me]^Y?1:-1;return Oe==E?0:E<Oe^Y?1:-1}function D(q,F,Y,te){if(q<F||Y<q||q!==(q<0?c(q):h(q)))throw Error(u+(te||"Argument")+(typeof q=="number"?q<F||Y<q?" out of range: ":" not an integer: ":" not a primitive number: ")+String(q))}function K(q){var F=q.c.length-1;return M(q.e/p)==F&&q.c[F]%2!=0}function H(q,F){return(1<q.length?q.charAt(0)+"."+q.slice(1):q)+(F<0?"e":"e+")+F}function Q(q,F,Y){var te,ie;if(F<0){for(ie=Y+".";++F;ie+=Y);q=ie+q}else if(++F>(te=q.length)){for(ie=Y,F-=te;--F;ie+=Y);q+=ie}else F<te&&(q=q.slice(0,F)+"."+q.slice(F));return q}(a=function q(F){var Y,te,ie,fe,Me,Ge,Oe,E,d,w,S=Z.prototype={constructor:Z,toString:null,valueOf:null},x=new Z(1),O=20,P=4,X=-7,z=21,ee=-1e7,se=1e7,J=!1,pe=1,He=0,xe={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"Â ",suffix:""},Te="0123456789abcdefghijklmnopqrstuvwxyz";function Z(v,R){var A,U,k,W,L,V,G,B,j=this;if(!(j instanceof Z))return new Z(v,R);if(R==null){if(v instanceof Z)return j.s=v.s,j.e=v.e,void(j.c=(v=v.c)?v.slice():v);if((V=typeof v=="number")&&0*v==0){if(j.s=1/v<0?(v=-v,-1):1,v===~~v){for(W=0,L=v;10<=L;L/=10,W++);return j.e=W,void(j.c=[v])}B=String(v)}else{if(B=String(v),!l.test(B))return ie(j,B,V);j.s=B.charCodeAt(0)==45?(B=B.slice(1),-1):1}-1<(W=B.indexOf("."))&&(B=B.replace(".","")),0<(L=B.search(/e/i))?(W<0&&(W=L),W+=+B.slice(L+1),B=B.substring(0,L)):W<0&&(W=B.length)}else{if(D(R,2,Te.length,"Base"),B=String(v),R==10)return Pe(j=new Z(v instanceof Z?v:B),O+j.e+1,P);if(V=typeof v=="number"){if(0*v!=0)return ie(j,B,V,R);if(j.s=1/v<0?(B=B.slice(1),-1):1,Z.DEBUG&&15<B.replace(/^0\.0*|\./,"").length)throw Error(f+v);V=!1}else j.s=B.charCodeAt(0)===45?(B=B.slice(1),-1):1;for(A=Te.slice(0,R),W=L=0,G=B.length;L<G;L++)if(A.indexOf(U=B.charAt(L))<0){if(U=="."){if(W<L){W=G;continue}}else if(!k&&(B==B.toUpperCase()&&(B=B.toLowerCase())||B==B.toLowerCase()&&(B=B.toUpperCase()))){k=!0,L=-1,W=0;continue}return ie(j,String(v),V,R)}-1<(W=(B=te(B,R,10,j.s)).indexOf("."))?B=B.replace(".",""):W=B.length}for(L=0;B.charCodeAt(L)===48;L++);for(G=B.length;B.charCodeAt(--G)===48;);if(B=B.slice(L,++G)){if(G-=L,V&&Z.DEBUG&&15<G&&(C<v||v!==h(v)))throw Error(f+j.s*v);if(se<(W=W-L-1))j.c=j.e=null;else if(W<ee)j.c=[j.e=0];else{if(j.e=W,j.c=[],L=(W+1)%p,W<0&&(L+=p),L<G){for(L&&j.c.push(+B.slice(0,L)),G-=p;L<G;)j.c.push(+B.slice(L,L+=p));B=B.slice(L),L=p-B.length}else L-=G;for(;L--;B+="0");j.c.push(+B)}}else j.c=[j.e=0]}function je(v,R,A,U){var k,W,L,V,G;if(A==null?A=P:D(A,0,8),!v.c)return v.toString();if(k=v.c[0],L=v.e,R==null)G=_(v.c),G=U==1||U==2&&(L<=X||z<=L)?H(G,L):Q(G,L,"0");else if(W=(v=Pe(new Z(v),R,A)).e,V=(G=_(v.c)).length,U==1||U==2&&(R<=W||W<=X)){for(;V<R;G+="0",V++);G=H(G,W)}else if(R-=L,G=Q(G,W,"0"),V<W+1){if(0<--R)for(G+=".";R--;G+="0");}else if(0<(R+=W-V))for(W+1==V&&(G+=".");R--;G+="0");return v.s<0&&k?"-"+G:G}function Le(v,R){for(var A,U=1,k=new Z(v[0]);U<v.length;U++){if(!(A=new Z(v[U])).s){k=A;break}R.call(k,A)&&(k=A)}return k}function ve(v,R,A){for(var U=1,k=R.length;!R[--k];R.pop());for(k=R[0];10<=k;k/=10,U++);return(A=U+A*p-1)>se?v.c=v.e=null:v.c=A<ee?[v.e=0]:(v.e=A,R),v}function Pe(v,R,A,U){var k,W,L,V,G,B,j,le=v.c,ge=y;if(le){e:{for(k=1,V=le[0];10<=V;V/=10,k++);if((W=R-k)<0)W+=p,L=R,j=(G=le[B=0])/ge[k-L-1]%10|0;else if((B=c((W+1)/p))>=le.length){if(!U)break e;for(;le.length<=B;le.push(0));G=j=0,L=(W%=p)-p+(k=1)}else{for(G=V=le[B],k=1;10<=V;V/=10,k++);j=(L=(W%=p)-p+k)<0?0:G/ge[k-L-1]%10|0}if(U=U||R<0||le[B+1]!=null||(L<0?G:G%ge[k-L-1]),U=A<4?(j||U)&&(A==0||A==(v.s<0?3:2)):5<j||j==5&&(A==4||U||A==6&&(0<W?0<L?G/ge[k-L]:0:le[B-1])%10&1||A==(v.s<0?8:7)),R<1||!le[0])return le.length=0,U?(R-=v.e+1,le[0]=ge[(p-R%p)%p],v.e=-R||0):le[0]=v.e=0,v;if(W==0?(le.length=B,V=1,B--):(le.length=B+1,V=ge[p-W],le[B]=0<L?h(G/ge[k-L]%ge[L])*V:0),U)for(;;){if(B==0){for(W=1,L=le[0];10<=L;L/=10,W++);for(L=le[0]+=V,V=1;10<=L;L/=10,V++);W!=V&&(v.e++,le[0]==g&&(le[0]=1));break}if(le[B]+=V,le[B]!=g)break;le[B--]=0,V=1}for(W=le.length;le[--W]===0;le.pop());}v.e>se?v.c=v.e=null:v.e<ee&&(v.c=[v.e=0])}return v}function Se(v){var R,A=v.e;return A===null?v.toString():(R=_(v.c),R=A<=X||z<=A?H(R,A):Q(R,A,"0"),v.s<0?"-"+R:R)}return Z.clone=q,Z.ROUND_UP=0,Z.ROUND_DOWN=1,Z.ROUND_CEIL=2,Z.ROUND_FLOOR=3,Z.ROUND_HALF_UP=4,Z.ROUND_HALF_DOWN=5,Z.ROUND_HALF_EVEN=6,Z.ROUND_HALF_CEIL=7,Z.ROUND_HALF_FLOOR=8,Z.EUCLID=9,Z.config=Z.set=function(v){var R,A;if(v!=null){if(typeof v!="object")throw Error(u+"Object expected: "+v);if(v.hasOwnProperty(R="DECIMAL_PLACES")&&(D(A=v[R],0,T,R),O=A),v.hasOwnProperty(R="ROUNDING_MODE")&&(D(A=v[R],0,8,R),P=A),v.hasOwnProperty(R="EXPONENTIAL_AT")&&((A=v[R])&&A.pop?(D(A[0],-T,0,R),D(A[1],0,T,R),X=A[0],z=A[1]):(D(A,-T,T,R),X=-(z=A<0?-A:A))),v.hasOwnProperty(R="RANGE"))if((A=v[R])&&A.pop)D(A[0],-T,-1,R),D(A[1],1,T,R),ee=A[0],se=A[1];else{if(D(A,-T,T,R),!A)throw Error(u+R+" cannot be zero: "+A);ee=-(se=A<0?-A:A)}if(v.hasOwnProperty(R="CRYPTO")){if((A=v[R])!==!!A)throw Error(u+R+" not true or false: "+A);if(A){if(typeof crypto>"u"||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw J=!A,Error(u+"crypto unavailable");J=A}else J=A}if(v.hasOwnProperty(R="MODULO_MODE")&&(D(A=v[R],0,9,R),pe=A),v.hasOwnProperty(R="POW_PRECISION")&&(D(A=v[R],0,T,R),He=A),v.hasOwnProperty(R="FORMAT")){if(typeof(A=v[R])!="object")throw Error(u+R+" not an object: "+A);xe=A}if(v.hasOwnProperty(R="ALPHABET")){if(typeof(A=v[R])!="string"||/^.$|[+-.\s]|(.).*\1/.test(A))throw Error(u+R+" invalid: "+A);Te=A}}return{DECIMAL_PLACES:O,ROUNDING_MODE:P,EXPONENTIAL_AT:[X,z],RANGE:[ee,se],CRYPTO:J,MODULO_MODE:pe,POW_PRECISION:He,FORMAT:xe,ALPHABET:Te}},Z.isBigNumber=function(v){return v instanceof Z||v&&v._isBigNumber===!0||!1},Z.maximum=Z.max=function(){return Le(arguments,S.lt)},Z.minimum=Z.min=function(){return Le(arguments,S.gt)},Z.random=(fe=9007199254740992,Me=Math.random()*fe&2097151?function(){return h(Math.random()*fe)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(v){var R,A,U,k,W,L=0,V=[],G=new Z(x);if(v==null?v=O:D(v,0,T),k=c(v/p),J)if(crypto.getRandomValues){for(R=crypto.getRandomValues(new Uint32Array(k*=2));L<k;)9e15<=(W=131072*R[L]+(R[L+1]>>>11))?(A=crypto.getRandomValues(new Uint32Array(2)),R[L]=A[0],R[L+1]=A[1]):(V.push(W%1e14),L+=2);L=k/2}else{if(!crypto.randomBytes)throw J=!1,Error(u+"crypto unavailable");for(R=crypto.randomBytes(k*=7);L<k;)9e15<=(W=281474976710656*(31&R[L])+1099511627776*R[L+1]+4294967296*R[L+2]+16777216*R[L+3]+(R[L+4]<<16)+(R[L+5]<<8)+R[L+6])?crypto.randomBytes(7).copy(R,L):(V.push(W%1e14),L+=7);L=k/7}if(!J)for(;L<k;)(W=Me())<9e15&&(V[L++]=W%1e14);for(k=V[--L],v%=p,k&&v&&(W=y[p-v],V[L]=h(k/W)*W);V[L]===0;V.pop(),L--);if(L<0)V=[U=0];else{for(U=-1;V[0]===0;V.splice(0,1),U-=p);for(L=1,W=V[0];10<=W;W/=10,L++);L<p&&(U-=p-L)}return G.e=U,G.c=V,G}),Z.sum=function(){for(var v=1,R=arguments,A=new Z(R[0]);v<R.length;)A=A.plus(R[v++]);return A},te=function(){var v="0123456789";function R(A,U,k,W){for(var L,V,G=[0],B=0,j=A.length;B<j;){for(V=G.length;V--;G[V]*=U);for(G[0]+=W.indexOf(A.charAt(B++)),L=0;L<G.length;L++)G[L]>k-1&&(G[L+1]==null&&(G[L+1]=0),G[L+1]+=G[L]/k|0,G[L]%=k)}return G.reverse()}return function(A,U,k,W,L){var V,G,B,j,le,ge,ye,_e,ke=A.indexOf("."),dt=O,ze=P;for(0<=ke&&(j=He,He=0,A=A.replace(".",""),ge=(_e=new Z(U)).pow(A.length-ke),He=j,_e.c=R(Q(_(ge.c),ge.e,"0"),10,k,v),_e.e=_e.c.length),B=j=(ye=R(A,U,k,L?(V=Te,v):(V=v,Te))).length;ye[--j]==0;ye.pop());if(!ye[0])return V.charAt(0);if(ke<0?--B:(ge.c=ye,ge.e=B,ge.s=W,ye=(ge=Y(ge,_e,dt,ze,k)).c,le=ge.r,B=ge.e),ke=ye[G=B+dt+1],j=k/2,le=le||G<0||ye[G+1]!=null,le=ze<4?(ke!=null||le)&&(ze==0||ze==(ge.s<0?3:2)):j<ke||ke==j&&(ze==4||le||ze==6&&1&ye[G-1]||ze==(ge.s<0?8:7)),G<1||!ye[0])A=le?Q(V.charAt(1),-dt,V.charAt(0)):V.charAt(0);else{if(ye.length=G,le)for(--k;++ye[--G]>k;)ye[G]=0,G||(++B,ye=[1].concat(ye));for(j=ye.length;!ye[--j];);for(ke=0,A="";ke<=j;A+=V.charAt(ye[ke++]));A=Q(A,B,V.charAt(0))}return A}}(),Y=function(){function v(U,k,W){var L,V,G,B,j=0,le=U.length,ge=k%b,ye=k/b|0;for(U=U.slice();le--;)j=((V=ge*(G=U[le]%b)+(L=ye*G+(B=U[le]/b|0)*ge)%b*b+j)/W|0)+(L/b|0)+ye*B,U[le]=V%W;return j&&(U=[j].concat(U)),U}function R(U,k,W,L){var V,G;if(W!=L)G=L<W?1:-1;else for(V=G=0;V<W;V++)if(U[V]!=k[V]){G=U[V]>k[V]?1:-1;break}return G}function A(U,k,W,L){for(var V=0;W--;)U[W]-=V,V=U[W]<k[W]?1:0,U[W]=V*L+U[W]-k[W];for(;!U[0]&&1<U.length;U.splice(0,1));}return function(U,k,W,L,V){var G,B,j,le,ge,ye,_e,ke,dt,ze,nt,yt,rr,Pa,It,Yt,oi,hn=U.s==k.s?1:-1,$t=U.c,pt=k.c;if(!($t&&$t[0]&&pt&&pt[0]))return new Z(U.s&&k.s&&($t?!pt||$t[0]!=pt[0]:pt)?$t&&$t[0]==0||!pt?0*hn:hn/0:NaN);for(dt=(ke=new Z(hn)).c=[],hn=W+(B=U.e-k.e)+1,V||(V=g,B=M(U.e/p)-M(k.e/p),hn=hn/p|0),j=0;pt[j]==($t[j]||0);j++);if(pt[j]>($t[j]||0)&&B--,hn<0)dt.push(1),le=!0;else{for(Pa=$t.length,Yt=pt.length,hn+=2,1<(ge=h(V/(pt[j=0]+1)))&&(pt=v(pt,ge,V),$t=v($t,ge,V),Yt=pt.length,Pa=$t.length),rr=Yt,nt=(ze=$t.slice(0,Yt)).length;nt<Yt;ze[nt++]=0);oi=pt.slice(),oi=[0].concat(oi),It=pt[0],pt[1]>=V/2&&It++;do{if(ge=0,(G=R(pt,ze,Yt,nt))<0){if(yt=ze[0],Yt!=nt&&(yt=yt*V+(ze[1]||0)),1<(ge=h(yt/It)))for(V<=ge&&(ge=V-1),_e=(ye=v(pt,ge,V)).length,nt=ze.length;R(ye,ze,_e,nt)==1;)ge--,A(ye,Yt<_e?oi:pt,_e,V),_e=ye.length,G=1;else ge==0&&(G=ge=1),_e=(ye=pt.slice()).length;if(_e<nt&&(ye=[0].concat(ye)),A(ze,ye,nt,V),nt=ze.length,G==-1)for(;R(pt,ze,Yt,nt)<1;)ge++,A(ze,Yt<nt?oi:pt,nt,V),nt=ze.length}else G===0&&(ge++,ze=[0]);dt[j++]=ge,ze[0]?ze[nt++]=$t[rr]||0:(ze=[$t[rr]],nt=1)}while((rr++<Pa||ze[0]!=null)&&hn--);le=ze[0]!=null,dt[0]||dt.splice(0,1)}if(V==g){for(j=1,hn=dt[0];10<=hn;hn/=10,j++);Pe(ke,W+(ke.e=j+B*p-1)+1,L,le)}else ke.e=B,ke.r=+le;return ke}}(),Ge=/^(-?)0([xbo])(?=\w[\w.]*$)/i,Oe=/^([^.]+)\.$/,E=/^\.([^.]+)$/,d=/^-?(Infinity|NaN)$/,w=/^\s*\+(?=[\w.])|^\s+|\s+$/g,ie=function(v,R,A,U){var k,W=A?R:R.replace(w,"");if(d.test(W))v.s=isNaN(W)?null:W<0?-1:1,v.c=v.e=null;else{if(!A&&(W=W.replace(Ge,function(L,V,G){return k=(G=G.toLowerCase())=="x"?16:G=="b"?2:8,U&&U!=k?L:V}),U&&(k=U,W=W.replace(Oe,"$1").replace(E,"0.$1")),R!=W))return new Z(W,k);if(Z.DEBUG)throw Error(u+"Not a"+(U?" base "+U:"")+" number: "+R);v.c=v.e=v.s=null}},S.absoluteValue=S.abs=function(){var v=new Z(this);return v.s<0&&(v.s=1),v},S.comparedTo=function(v,R){return I(this,new Z(v,R))},S.decimalPlaces=S.dp=function(v,R){var A,U,k;if(v!=null)return D(v,0,T),R==null?R=P:D(R,0,8),Pe(new Z(this),v+this.e+1,R);if(!(A=this.c))return null;if(U=((k=A.length-1)-M(this.e/p))*p,k=A[k])for(;k%10==0;k/=10,U--);return U<0&&(U=0),U},S.dividedBy=S.div=function(v,R){return Y(this,new Z(v,R),O,P)},S.dividedToIntegerBy=S.idiv=function(v,R){return Y(this,new Z(v,R),0,1)},S.exponentiatedBy=S.pow=function(v,R){var A,U,k,W,L,V,G,B,j=this;if((v=new Z(v)).c&&!v.isInteger())throw Error(u+"Exponent not an integer: "+Se(v));if(R!=null&&(R=new Z(R)),L=14<v.e,!j.c||!j.c[0]||j.c[0]==1&&!j.e&&j.c.length==1||!v.c||!v.c[0])return B=new Z(Math.pow(+Se(j),L?2-K(v):+Se(v))),R?B.mod(R):B;if(V=v.s<0,R){if(R.c?!R.c[0]:!R.s)return new Z(NaN);(U=!V&&j.isInteger()&&R.isInteger())&&(j=j.mod(R))}else{if(9<v.e&&(0<j.e||j.e<-1||(j.e==0?1<j.c[0]||L&&24e7<=j.c[1]:j.c[0]<8e13||L&&j.c[0]<=9999975e7)))return W=j.s<0&&K(v)?-0:0,-1<j.e&&(W=1/W),new Z(V?1/W:W);He&&(W=c(He/p+2))}for(G=L?(A=new Z(.5),V&&(v.s=1),K(v)):(k=Math.abs(+Se(v)))%2,B=new Z(x);;){if(G){if(!(B=B.times(j)).c)break;W?B.c.length>W&&(B.c.length=W):U&&(B=B.mod(R))}if(k){if((k=h(k/2))===0)break;G=k%2}else if(Pe(v=v.times(A),v.e+1,1),14<v.e)G=K(v);else{if((k=+Se(v))==0)break;G=k%2}j=j.times(j),W?j.c&&j.c.length>W&&(j.c.length=W):U&&(j=j.mod(R))}return U?B:(V&&(B=x.div(B)),R?B.mod(R):W?Pe(B,He,P,void 0):B)},S.integerValue=function(v){var R=new Z(this);return v==null?v=P:D(v,0,8),Pe(R,R.e+1,v)},S.isEqualTo=S.eq=function(v,R){return I(this,new Z(v,R))===0},S.isFinite=function(){return!!this.c},S.isGreaterThan=S.gt=function(v,R){return 0<I(this,new Z(v,R))},S.isGreaterThanOrEqualTo=S.gte=function(v,R){return(R=I(this,new Z(v,R)))===1||R===0},S.isInteger=function(){return!!this.c&&M(this.e/p)>this.c.length-2},S.isLessThan=S.lt=function(v,R){return I(this,new Z(v,R))<0},S.isLessThanOrEqualTo=S.lte=function(v,R){return(R=I(this,new Z(v,R)))===-1||R===0},S.isNaN=function(){return!this.s},S.isNegative=function(){return this.s<0},S.isPositive=function(){return 0<this.s},S.isZero=function(){return!!this.c&&this.c[0]==0},S.minus=function(v,R){var A,U,k,W,L=this,V=L.s;if(R=(v=new Z(v,R)).s,!V||!R)return new Z(NaN);if(V!=R)return v.s=-R,L.plus(v);var G=L.e/p,B=v.e/p,j=L.c,le=v.c;if(!G||!B){if(!j||!le)return j?(v.s=-R,v):new Z(le?L:NaN);if(!j[0]||!le[0])return le[0]?(v.s=-R,v):new Z(j[0]?L:P==3?-0:0)}if(G=M(G),B=M(B),j=j.slice(),V=G-B){for((k=(W=V<0)?(V=-V,j):(B=G,le)).reverse(),R=V;R--;k.push(0));k.reverse()}else for(U=(W=(V=j.length)<(R=le.length))?V:R,V=R=0;R<U;R++)if(j[R]!=le[R]){W=j[R]<le[R];break}if(W&&(k=j,j=le,le=k,v.s=-v.s),0<(R=(U=le.length)-(A=j.length)))for(;R--;j[A++]=0);for(R=g-1;V<U;){if(j[--U]<le[U]){for(A=U;A&&!j[--A];j[A]=R);--j[A],j[U]+=g}j[U]-=le[U]}for(;j[0]==0;j.splice(0,1),--B);return j[0]?ve(v,j,B):(v.s=P==3?-1:1,v.c=[v.e=0],v)},S.modulo=S.mod=function(v,R){var A,U,k=this;return v=new Z(v,R),!k.c||!v.s||v.c&&!v.c[0]?new Z(NaN):!v.c||k.c&&!k.c[0]?new Z(k):(pe==9?(U=v.s,v.s=1,A=Y(k,v,0,3),v.s=U,A.s*=U):A=Y(k,v,0,pe),(v=k.minus(A.times(v))).c[0]||pe!=1||(v.s=k.s),v)},S.multipliedBy=S.times=function(v,R){var A,U,k,W,L,V,G,B,j,le,ge,ye,_e,ke,dt,ze=this,nt=ze.c,yt=(v=new Z(v,R)).c;if(!(nt&&yt&&nt[0]&&yt[0]))return!ze.s||!v.s||nt&&!nt[0]&&!yt||yt&&!yt[0]&&!nt?v.c=v.e=v.s=null:(v.s*=ze.s,nt&&yt?(v.c=[0],v.e=0):v.c=v.e=null),v;for(U=M(ze.e/p)+M(v.e/p),v.s*=ze.s,(G=nt.length)<(le=yt.length)&&(_e=nt,nt=yt,yt=_e,k=G,G=le,le=k),k=G+le,_e=[];k--;_e.push(0));for(ke=g,dt=b,k=le;0<=--k;){for(A=0,ge=yt[k]%dt,ye=yt[k]/dt|0,W=k+(L=G);k<W;)A=((B=ge*(B=nt[--L]%dt)+(V=ye*B+(j=nt[L]/dt|0)*ge)%dt*dt+_e[W]+A)/ke|0)+(V/dt|0)+ye*j,_e[W--]=B%ke;_e[W]=A}return A?++U:_e.splice(0,1),ve(v,_e,U)},S.negated=function(){var v=new Z(this);return v.s=-v.s||null,v},S.plus=function(v,R){var A,U=this,k=U.s;if(R=(v=new Z(v,R)).s,!k||!R)return new Z(NaN);if(k!=R)return v.s=-R,U.minus(v);var W=U.e/p,L=v.e/p,V=U.c,G=v.c;if(!W||!L){if(!V||!G)return new Z(k/0);if(!V[0]||!G[0])return G[0]?v:new Z(V[0]?U:0*k)}if(W=M(W),L=M(L),V=V.slice(),k=W-L){for((A=0<k?(L=W,G):(k=-k,V)).reverse();k--;A.push(0));A.reverse()}for((k=V.length)-(R=G.length)<0&&(A=G,G=V,V=A,R=k),k=0;R;)k=(V[--R]=V[R]+G[R]+k)/g|0,V[R]=g===V[R]?0:V[R]%g;return k&&(V=[k].concat(V),++L),ve(v,V,L)},S.precision=S.sd=function(v,R){var A,U,k;if(v!=null&&v!==!!v)return D(v,1,T),R==null?R=P:D(R,0,8),Pe(new Z(this),v,R);if(!(A=this.c))return null;if(U=(k=A.length-1)*p+1,k=A[k]){for(;k%10==0;k/=10,U--);for(k=A[0];10<=k;k/=10,U++);}return v&&this.e+1>U&&(U=this.e+1),U},S.shiftedBy=function(v){return D(v,-C,C),this.times("1e"+v)},S.squareRoot=S.sqrt=function(){var v,R,A,U,k,W=this,L=W.c,V=W.s,G=W.e,B=O+4,j=new Z("0.5");if(V!==1||!L||!L[0])return new Z(!V||V<0&&(!L||L[0])?NaN:L?W:1/0);if((A=(V=Math.sqrt(+Se(W)))==0||V==1/0?(((R=_(L)).length+G)%2==0&&(R+="0"),V=Math.sqrt(+R),G=M((G+1)/2)-(G<0||G%2),new Z(R=V==1/0?"1e"+G:(R=V.toExponential()).slice(0,R.indexOf("e")+1)+G)):new Z(V+"")).c[0]){for((V=(G=A.e)+B)<3&&(V=0);;)if(k=A,A=j.times(k.plus(Y(W,k,B,1))),_(k.c).slice(0,V)===(R=_(A.c)).slice(0,V)){if(A.e<G&&--V,(R=R.slice(V-3,V+1))!="9999"&&(U||R!="4999")){+R&&(+R.slice(1)||R.charAt(0)!="5")||(Pe(A,A.e+O+2,1),v=!A.times(A).eq(W));break}if(!U&&(Pe(k,k.e+O+2,0),k.times(k).eq(W))){A=k;break}B+=4,V+=4,U=1}}return Pe(A,A.e+O+1,P,v)},S.toExponential=function(v,R){return v!=null&&(D(v,0,T),v++),je(this,v,R,1)},S.toFixed=function(v,R){return v!=null&&(D(v,0,T),v=v+this.e+1),je(this,v,R)},S.toFormat=function(v,R,A){var U;if(A==null)v!=null&&R&&typeof R=="object"?(A=R,R=null):v&&typeof v=="object"?(A=v,v=R=null):A=xe;else if(typeof A!="object")throw Error(u+"Argument not an object: "+A);if(U=this.toFixed(v,R),this.c){var k,W=U.split("."),L=+A.groupSize,V=+A.secondaryGroupSize,G=A.groupSeparator||"",B=W[0],j=W[1],le=this.s<0,ge=le?B.slice(1):B,ye=ge.length;if(V&&(k=L,L=V,ye-=V=k),0<L&&0<ye){for(k=ye%L||L,B=ge.substr(0,k);k<ye;k+=L)B+=G+ge.substr(k,L);0<V&&(B+=G+ge.slice(k)),le&&(B="-"+B)}U=j?B+(A.decimalSeparator||"")+((V=+A.fractionGroupSize)?j.replace(new RegExp("\\d{"+V+"}\\B","g"),"$&"+(A.fractionGroupSeparator||"")):j):B}return(A.prefix||"")+U+(A.suffix||"")},S.toFraction=function(v){var R,A,U,k,W,L,V,G,B,j,le,ge,ye=this,_e=ye.c;if(v!=null&&(!(V=new Z(v)).isInteger()&&(V.c||V.s!==1)||V.lt(x)))throw Error(u+"Argument "+(V.isInteger()?"out of range: ":"not an integer: ")+Se(V));if(!_e)return new Z(ye);for(R=new Z(x),B=A=new Z(x),U=G=new Z(x),ge=_(_e),W=R.e=ge.length-ye.e-1,R.c[0]=y[(L=W%p)<0?p+L:L],v=!v||0<V.comparedTo(R)?0<W?R:B:V,L=se,se=1/0,V=new Z(ge),G.c[0]=0;j=Y(V,R,0,1),(k=A.plus(j.times(U))).comparedTo(v)!=1;)A=U,U=k,B=G.plus(j.times(k=B)),G=k,R=V.minus(j.times(k=R)),V=k;return k=Y(v.minus(A),U,0,1),G=G.plus(k.times(B)),A=A.plus(k.times(U)),G.s=B.s=ye.s,le=Y(B,U,W*=2,P).minus(ye).abs().comparedTo(Y(G,A,W,P).minus(ye).abs())<1?[B,U]:[G,A],se=L,le},S.toNumber=function(){return+Se(this)},S.toPrecision=function(v,R){return v!=null&&D(v,1,T),je(this,v,R,2)},S.toString=function(v){var R,A=this,U=A.s,k=A.e;return k===null?U?(R="Infinity",U<0&&(R="-"+R)):R="NaN":(R=v==null?k<=X||z<=k?H(_(A.c),k):Q(_(A.c),k,"0"):v===10?Q(_((A=Pe(new Z(A),O+k+1,P)).c),A.e,"0"):(D(v,2,Te.length,"Base"),te(Q(_(A.c),k,"0"),10,v,U,!0)),U<0&&A.c[0]&&(R="-"+R)),R},S.valueOf=S.toJSON=function(){return Se(this)},S._isBigNumber=!0,typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(S[Symbol.toStringTag]="BigNumber",S[Symbol.for("nodejs.util.inspect.custom")]=S.valueOf),F!=null&&Z.set(F),Z}()).default=a.BigNumber=a,s!==void 0&&s.exports?s.exports=a:(r||(r=typeof self<"u"&&self?self:window),r.BigNumber=a)})(this)},{}],2:[function(t,s,o){s.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(r){var a=r%10;return~~(r%100/10)==1?"th":a===1?"st":a===2?"nd":a===3?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(t,s,o){function r(M,_){return function(I){if(Array.isArray(I))return I}(M)||function(I,D){var K=[],H=!0,Q=!1,q=void 0;try{for(var F,Y=I[Symbol.iterator]();!(H=(F=Y.next()).done)&&(K.push(F.value),!D||K.length!==D);H=!0);}catch(te){Q=!0,q=te}finally{try{H||Y.return==null||Y.return()}finally{if(Q)throw q}}return K}(M,_)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var a=t("./globalState"),l=t("./validating"),c=t("./parsing"),h=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],u={general:{scale:1024,suffixes:h,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:h,marker:"d"}},f={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function g(M){var _=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},I=2<arguments.length?arguments[2]:void 0;if(typeof _=="string"&&(_=c.parseFormat(_)),!l.validateFormat(_))return"ERROR: invalid format";var D=_.prefix||"",K=_.postfix||"",H=function(Q,q,F){switch(q.output){case"currency":return q=T(q,a.currentCurrencyDefaultFormat()),function(Te,Z,je){var Le=je.currentCurrency(),ve=Object.assign({},f,Z),Pe=void 0,Se="",v=!!ve.totalLength||!!ve.forceAverage||ve.average,R=Z.currencyPosition||Le.position,A=Z.currencySymbol||Le.symbol;ve.spaceSeparated&&(Se=" "),R==="infix"&&(Pe=Se+A+Se);var U=b({instance:Te,providedFormat:Z,state:je,decimalSeparator:Pe});return R==="prefix"&&(U=Te._value<0&&ve.negative==="sign"?"-".concat(Se).concat(A).concat(U.slice(1)):A+Se+U),R&&R!=="postfix"||(U=U+(Se=v?"":Se)+A),U}(Q,q,a);case"percent":return q=T(q,a.currentPercentageDefaultFormat()),function(Te,Z,je,Le){var ve=Z.prefixSymbol,Pe=b({instance:Le(100*Te._value),providedFormat:Z,state:je}),Se=Object.assign({},f,Z);return ve?"%".concat(Se.spaceSeparated?" ":"").concat(Pe):"".concat(Pe).concat(Se.spaceSeparated?" ":"","%")}(Q,q,a,F);case"byte":return q=T(q,a.currentByteDefaultFormat()),x=Q,P=a,X=F,z=(O=q).base||"binary",ee=u[z],se=p(x._value,ee.suffixes,ee.scale),J=se.value,pe=se.suffix,He=b({instance:X(J),providedFormat:O,state:P,defaults:P.currentByteDefaultFormat()}),xe=P.currentAbbreviations(),"".concat(He).concat(xe.spaced?" ":"").concat(pe);case"time":return q=T(q,a.currentTimeDefaultFormat()),E=Q,d=Math.floor(E._value/60/60),w=Math.floor((E._value-60*d*60)/60),S=Math.round(E._value-60*d*60-60*w),"".concat(d,":").concat(w<10?"0":"").concat(w,":").concat(S<10?"0":"").concat(S);case"ordinal":return q=T(q,a.currentOrdinalDefaultFormat()),Y=Q,te=q,fe=(ie=a).currentOrdinal(),Me=Object.assign({},f,te),Ge=b({instance:Y,providedFormat:te,state:ie}),Oe=fe(Y._value),"".concat(Ge).concat(Me.spaceSeparated?" ":"").concat(Oe);case"number":default:return b({instance:Q,providedFormat:q,numbro:F})}var Y,te,ie,fe,Me,Ge,Oe,E,d,w,S,x,O,P,X,z,ee,se,J,pe,He,xe}(M,_,I);return H=(H=D+H)+K}function p(M,_,I){var D=_[0],K=Math.abs(M);if(I<=K){for(var H=1;H<_.length;++H){var Q=Math.pow(I,H),q=Math.pow(I,H+1);if(Q<=K&&K<q){D=_[H],M/=Q;break}}D===_[0]&&(M/=Math.pow(I,_.length-1),D=_[_.length-1])}return{value:M,suffix:D}}function C(M){for(var _="",I=0;I<M;I++)_+="0";return _}function y(M,_){return M.toString().indexOf("e")!==-1?function(I,D){var K=I.toString(),H=r(K.split("e"),2),Q=H[0],q=H[1],F=r(Q.split("."),2),Y=F[0],te=F[1],ie=te===void 0?"":te;if(0<+q)K=Y+ie+C(q-ie.length);else{var fe=".";fe=+Y<0?"-0".concat(fe):"0".concat(fe);var Me=(C(-q-1)+Math.abs(Y)+ie).substr(0,D);Me.length<D&&(Me+=C(D-Me.length)),K=fe+Me}return 0<+q&&0<D&&(K+=".".concat(C(D))),K}(M,_):(Math.round(+"".concat(M,"e+").concat(_))/Math.pow(10,_)).toFixed(_)}function b(M){var _=M.instance,I=M.providedFormat,D=M.state,K=D===void 0?a:D,H=M.decimalSeparator,Q=M.defaults,q=Q===void 0?K.currentDefaults():Q,F=_._value;if(F===0&&K.hasZeroFormat())return K.getZeroFormat();if(!isFinite(F))return F.toString();var Y,te,ie,fe,Me,Ge,Oe,E,d=Object.assign({},f,q,I),w=d.totalLength,S=w?0:d.characteristic,x=d.optionalCharacteristic,O=d.forceAverage,P=!!w||!!O||d.average,X=w?-1:P&&I.mantissa===void 0?0:d.mantissa,z=!w&&(I.optionalMantissa===void 0?X===-1:d.optionalMantissa),ee=d.trimMantissa,se=d.thousandSeparated,J=d.spaceSeparated,pe=d.negative,He=d.forceSign,xe=d.exponential,Te="";if(P){var Z=function(v){var R=v.value,A=v.forceAverage,U=v.abbreviations,k=v.spaceSeparated,W=k!==void 0&&k,L=v.totalLength,V=L===void 0?0:L,G="",B=Math.abs(R),j=-1;if(B>=Math.pow(10,12)&&!A||A==="trillion"?(G=U.trillion,R/=Math.pow(10,12)):B<Math.pow(10,12)&&B>=Math.pow(10,9)&&!A||A==="billion"?(G=U.billion,R/=Math.pow(10,9)):B<Math.pow(10,9)&&B>=Math.pow(10,6)&&!A||A==="million"?(G=U.million,R/=Math.pow(10,6)):(B<Math.pow(10,6)&&B>=Math.pow(10,3)&&!A||A==="thousand")&&(G=U.thousand,R/=Math.pow(10,3)),G&&(G=(W?" ":"")+G),V){var le=R.toString().split(".")[0];j=Math.max(V-le.length,0)}return{value:R,abbreviation:G,mantissaPrecision:j}}({value:F,forceAverage:O,abbreviations:K.currentAbbreviations(),spaceSeparated:J,totalLength:w});F=Z.value,Te+=Z.abbreviation,w&&(X=Z.mantissaPrecision)}if(xe){var je=(te=(Y={value:F,characteristicPrecision:S}).value,ie=Y.characteristicPrecision,fe=ie===void 0?0:ie,Me=r(te.toExponential().split("e"),2),Ge=Me[0],Oe=Me[1],E=+Ge,fe&&1<fe&&(E*=Math.pow(10,fe-1),Oe=0<=(Oe=+Oe-(fe-1))?"+".concat(Oe):Oe),{value:E,abbreviation:"e".concat(Oe)});F=je.value,Te=je.abbreviation+Te}var Le,ve,Pe,Se=function(v,R,A,U,k){if(U===-1)return v;var W=y(R,U),L=r(W.toString().split("."),2),V=L[0],G=L[1],B=G===void 0?"":G;if(B.match(/^0+$/)&&(A||k))return V;var j=B.match(/0+$/);return k&&j?"".concat(V,".").concat(B.toString().slice(0,j.index)):W.toString()}(F.toString(),F,z,X,ee);return Se=function(v,R,A,U,k){var W=U.currentDelimiters(),L=W.thousands;k=k||W.decimal;var V=W.thousandsSize||3,G=v.toString(),B=G.split(".")[0],j=G.split(".")[1];return A&&(R<0&&(B=B.slice(1)),function(le,ge){for(var ye=[],_e=0,ke=le;0<ke;ke--)_e===ge&&(ye.unshift(ke),_e=0),_e++;return ye}(B.length,V).forEach(function(le,ge){B=B.slice(0,le+ge)+L+B.slice(le+ge)}),R<0&&(B="-".concat(B))),G=j?B+k+j:B}(Se=function(v,R,A,U){var k=v,W=r(k.toString().split("."),2),L=W[0],V=W[1];if(L.match(/^-?0$/)&&A)return V?"".concat(L.replace("0",""),".").concat(V):L.replace("0","");if(L.length<U)for(var G=U-L.length,B=0;B<G;B++)k="0".concat(k);return k.toString()}(Se,0,x,S),F,se,K,H),(P||xe)&&(Se=Se+Te),(He||F<0)&&(Le=Se,Pe=pe,Se=(ve=F)===0?Le:+Le==0?Le.replace("-",""):0<ve?"+".concat(Le):Pe==="sign"?Le:"(".concat(Le.replace("-",""),")")),Se}function T(M,_){if(!M)return _;var I=Object.keys(M);return I.length===1&&I[0]==="output"?_:M}s.exports=function(M){return{format:function(){for(var _=arguments.length,I=new Array(_),D=0;D<_;D++)I[D]=arguments[D];return g.apply(void 0,I.concat([M]))},getByteUnit:function(){for(var _=arguments.length,I=new Array(_),D=0;D<_;D++)I[D]=arguments[D];return(function(K){var H=u.general;return p(K._value,H.suffixes,H.scale).suffix}).apply(void 0,I.concat([M]))},getBinaryByteUnit:function(){for(var _=arguments.length,I=new Array(_),D=0;D<_;D++)I[D]=arguments[D];return(function(K){var H=u.binary;return p(K._value,H.suffixes,H.scale).suffix}).apply(void 0,I.concat([M]))},getDecimalByteUnit:function(){for(var _=arguments.length,I=new Array(_),D=0;D<_;D++)I[D]=arguments[D];return(function(K){var H=u.decimal;return p(K._value,H.suffixes,H.scale).suffix}).apply(void 0,I.concat([M]))},formatOrDefault:T}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(t,s,o){var r=t("./en-US"),a=t("./validating"),l=t("./parsing"),c={},h=void 0,u={},f=null,g={};function p(y){h=y}function C(){return u[h]}c.languages=function(){return Object.assign({},u)},c.currentLanguage=function(){return h},c.currentCurrency=function(){return C().currency},c.currentAbbreviations=function(){return C().abbreviations},c.currentDelimiters=function(){return C().delimiters},c.currentOrdinal=function(){return C().ordinal},c.currentDefaults=function(){return Object.assign({},C().defaults,g)},c.currentOrdinalDefaultFormat=function(){return Object.assign({},c.currentDefaults(),C().ordinalFormat)},c.currentByteDefaultFormat=function(){return Object.assign({},c.currentDefaults(),C().byteFormat)},c.currentPercentageDefaultFormat=function(){return Object.assign({},c.currentDefaults(),C().percentageFormat)},c.currentCurrencyDefaultFormat=function(){return Object.assign({},c.currentDefaults(),C().currencyFormat)},c.currentTimeDefaultFormat=function(){return Object.assign({},c.currentDefaults(),C().timeFormat)},c.setDefaults=function(y){y=l.parseFormat(y),a.validateFormat(y)&&(g=y)},c.getZeroFormat=function(){return f},c.setZeroFormat=function(y){return f=typeof y=="string"?y:null},c.hasZeroFormat=function(){return f!==null},c.languageData=function(y){if(y){if(u[y])return u[y];throw new Error('Unknown tag "'.concat(y,'"'))}return C()},c.registerLanguage=function(y){var b=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(!a.validateLanguage(y))throw new Error("Invalid language data");u[y.languageTag]=y,b&&p(y.languageTag)},c.setLanguage=function(y){var b=1<arguments.length&&arguments[1]!==void 0?arguments[1]:r.languageTag;if(!u[y]){var T=y.split("-")[0],M=Object.keys(u).find(function(_){return _.split("-")[0]===T});return u[M]?void p(M):void p(b)}p(y)},c.registerLanguage(r),h=r.languageTag,s.exports=c},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(t,s,o){s.exports=function(r){return{loadLanguagesInNode:function(a){return l=r,void a.forEach(function(c){var h=void 0;try{h=t("../languages/".concat(c))}catch{console.error('Unable to load "'.concat(c,'". No matching language file found.'))}h&&l.registerLanguage(h)});var l}}}},{}],6:[function(t,s,o){var r=t("bignumber.js");function a(l,c,h){var u=new r(l._value),f=c;return h.isNumbro(c)&&(f=c._value),f=new r(f),l._value=u.minus(f).toNumber(),l}s.exports=function(l){return{add:function(c,h){return f=h,g=l,p=new r((u=c)._value),C=f,g.isNumbro(f)&&(C=f._value),C=new r(C),u._value=p.plus(C).toNumber(),u;var u,f,g,p,C},subtract:function(c,h){return a(c,h,l)},multiply:function(c,h){return f=h,g=l,p=new r((u=c)._value),C=f,g.isNumbro(f)&&(C=f._value),C=new r(C),u._value=p.times(C).toNumber(),u;var u,f,g,p,C},divide:function(c,h){return f=h,g=l,p=new r((u=c)._value),C=f,g.isNumbro(f)&&(C=f._value),C=new r(C),u._value=p.dividedBy(C).toNumber(),u;var u,f,g,p,C},set:function(c,h){return u=c,g=f=h,l.isNumbro(f)&&(g=f._value),u._value=g,u;var u,f,g},difference:function(c,h){return u=h,a(g=(f=l)(c._value),u,f),Math.abs(g._value);var u,f,g}}}},{"bignumber.js":1}],7:[function(t,s,o){function r(b,T){for(var M=0;M<T.length;M++){var _=T[M];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(b,_.key,_)}}var a=t("./globalState"),l=t("./validating"),c=t("./loading")(y),h=t("./unformatting"),u=t("./formatting")(y),f=t("./manipulating")(y),g=t("./parsing"),p=function(){function b(_){(function(I,D){if(!(I instanceof D))throw new TypeError("Cannot call a class as a function")})(this,b),this._value=_}var T,M;return T=b,(M=[{key:"clone",value:function(){return y(this._value)}},{key:"format",value:function(){var _=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return u.format(this,_)}},{key:"formatCurrency",value:function(_){return typeof _=="string"&&(_=g.parseFormat(_)),(_=u.formatOrDefault(_,a.currentCurrencyDefaultFormat())).output="currency",u.format(this,_)}},{key:"formatTime",value:function(){var _=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return _.output="time",u.format(this,_)}},{key:"binaryByteUnits",value:function(){return u.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return u.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return u.getByteUnit(this)}},{key:"difference",value:function(_){return f.difference(this,_)}},{key:"add",value:function(_){return f.add(this,_)}},{key:"subtract",value:function(_){return f.subtract(this,_)}},{key:"multiply",value:function(_){return f.multiply(this,_)}},{key:"divide",value:function(_){return f.divide(this,_)}},{key:"set",value:function(_){return f.set(this,C(_))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&r(T.prototype,M),b}();function C(b){var T=b;return y.isNumbro(b)?T=b._value:typeof b=="string"?T=y.unformat(b):isNaN(b)&&(T=NaN),T}function y(b){return new p(C(b))}y.version="2.1.2",y.isNumbro=function(b){return b instanceof p},y.language=a.currentLanguage,y.registerLanguage=a.registerLanguage,y.setLanguage=a.setLanguage,y.languages=a.languages,y.languageData=a.languageData,y.zeroFormat=a.setZeroFormat,y.defaultFormat=a.currentDefaults,y.setDefaults=a.setDefaults,y.defaultCurrencyFormat=a.currentCurrencyDefaultFormat,y.validate=l.validate,y.loadLanguagesInNode=c.loadLanguagesInNode,y.unformat=h.unformat,s.exports=y},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(t,s,o){s.exports={parseFormat:function(r){var a,l,c,h,u,f,g,p,C,y,b,T,M,_,I,D,K,H,Q,q,F=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return typeof r!="string"?r:(l=F,r=(c=(a=r).match(/^{([^}]*)}/))?(l.prefix=c[1],a.slice(c[0].length)):a,u=F,function(Y,te){if(Y.indexOf("$")===-1){if(Y.indexOf("%")===-1)return Y.indexOf("bd")!==-1?(te.output="byte",te.base="general"):Y.indexOf("b")!==-1?(te.output="byte",te.base="binary"):Y.indexOf("d")!==-1?(te.output="byte",te.base="decimal"):Y.indexOf(":")===-1?Y.indexOf("o")!==-1&&(te.output="ordinal"):te.output="time";te.output="percent"}else te.output="currency"}(r=(f=(h=r).match(/{([^}]*)}$/))?(u.postfix=f[1],h.slice(0,-f[0].length)):h,F),g=F,(p=r.match(/[1-9]+[0-9]*/))&&(g.totalLength=+p[0]),C=F,(y=r.split(".")[0].match(/0+/))&&(C.characteristic=y[0].length),function(Y,te){if(Y.indexOf(".")!==-1){var ie=Y.split(".")[0];te.optionalCharacteristic=ie.indexOf("0")===-1}}(r,F),b=F,r.indexOf("a")!==-1&&(b.average=!0),M=F,(T=r).indexOf("K")!==-1?M.forceAverage="thousand":T.indexOf("M")!==-1?M.forceAverage="million":T.indexOf("B")!==-1?M.forceAverage="billion":T.indexOf("T")!==-1&&(M.forceAverage="trillion"),function(Y,te){var ie=Y.split(".")[1];if(ie){var fe=ie.match(/0+/);fe&&(te.mantissa=fe[0].length)}}(r,F),I=F,(_=r).match(/\[\.]/)?I.optionalMantissa=!0:_.match(/\./)&&(I.optionalMantissa=!1),D=F,r.indexOf(",")!==-1&&(D.thousandSeparated=!0),K=F,r.indexOf(" ")!==-1&&(K.spaceSeparated=!0),Q=F,(H=r).match(/^\+?\([^)]*\)$/)&&(Q.negative="parenthesis"),H.match(/^\+?-/)&&(Q.negative="sign"),q=F,r.match(/^\+/)&&(q.forceSign=!0),F)}}},{}],9:[function(t,s,o){var r=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function a(c){return c.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function l(c,h){var u=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",f=3<arguments.length?arguments[3]:void 0,g=4<arguments.length?arguments[4]:void 0,p=5<arguments.length?arguments[5]:void 0,C=6<arguments.length?arguments[6]:void 0;if(c!=="")return c===g?0:function y(b,T){var M=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",_=3<arguments.length?arguments[3]:void 0,I=4<arguments.length?arguments[4]:void 0,D=5<arguments.length?arguments[5]:void 0,K=6<arguments.length?arguments[6]:void 0;if(!isNaN(+b))return+b;var H="",Q=b.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(Q!==b)return-1*y(Q,T,M,_,I,D,K);for(var q=0;q<r.length;q++){var F=r[q];if((H=b.replace(F.key,""))!==b)return y(H,T,M,_,I,D,K)*F.factor}if((H=b.replace("%",""))!==b)return y(H,T,M,_,I,D,K)/100;var Y=parseFloat(b);if(!isNaN(Y)){var te=_(Y);if(te&&te!=="."&&(H=b.replace(new RegExp("".concat(a(te),"$")),""))!==b)return y(H,T,M,_,I,D,K);var ie={};Object.keys(D).forEach(function(w){ie[D[w]]=w});for(var fe=Object.keys(ie).sort().reverse(),Me=fe.length,Ge=0;Ge<Me;Ge++){var Oe=fe[Ge],E=ie[Oe];if((H=b.replace(Oe,""))!==b){var d=void 0;switch(E){case"thousand":d=Math.pow(10,3);break;case"million":d=Math.pow(10,6);break;case"billion":d=Math.pow(10,9);break;case"trillion":d=Math.pow(10,12)}return y(H,T,M,_,I,D,K)*d}}}}(function(y,b){var T=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",M=y.replace(T,"");return M=(M=M.replace(new RegExp("([0-9])".concat(a(b.thousands),"([0-9])"),"g"),"$1$2")).replace(b.decimal,".")}(c,h,u),h,u,f,g,p,C)}s.exports={unformat:function(c,h){var u,f,g,p=t("./globalState"),C=p.currentDelimiters(),y=p.currentCurrency().symbol,b=p.currentOrdinal(),T=p.getZeroFormat(),M=p.currentAbbreviations(),_=void 0;if(typeof c=="string")_=function(I,D){if(!I.indexOf(":")||D.thousands===":")return!1;var K=I.split(":");if(K.length!==3)return!1;var H=+K[0],Q=+K[1],q=+K[2];return!isNaN(H)&&!isNaN(Q)&&!isNaN(q)}(c,C)?(u=c.split(":"),f=+u[0],g=+u[1],+u[2]+60*g+3600*f):l(c,C,y,b,T,M,h);else{if(typeof c!="number")return;_=c}if(_!==void 0)return _}}},{"./globalState":4}],10:[function(t,s,o){function r(C){return function(y){if(Array.isArray(y)){for(var b=0,T=new Array(y.length);b<y.length;b++)T[b]=y[b];return T}}(C)||function(y){if(Symbol.iterator in Object(y)||Object.prototype.toString.call(y)==="[object Arguments]")return Array.from(y)}(C)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function a(C){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(y){return typeof y}:function(y){return y&&typeof Symbol=="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":typeof y})(C)}var l=t("./unformatting"),c=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,h={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(C,y){return y.output==="byte"},message:"`base` must be provided only when the output is `byte`",mandatory:function(C){return C.output==="byte"}},characteristic:{type:"number",restriction:function(C){return 0<=C},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(C){return 0<=C},message:"value must be positive"},{restriction:function(C,y){return!y.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(C){return 0<=C},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(C,y){return y.output==="percent"},message:"`prefixSymbol` can be provided only when the output is `percent`"}},u={languageTag:{type:"string",mandatory:!0,restriction:function(C){return C.match(c)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function f(C){return!!l.unformat(C)}function g(C,y,b){var T=3<arguments.length&&arguments[3]!==void 0&&arguments[3],M=Object.keys(C).map(function(_){if(!y[_])return console.error("".concat(b," Invalid key: ").concat(_)),!1;var I=C[_],D=y[_];if(typeof D=="string"&&(D={type:D}),D.type==="format"){if(!g(I,h,"[Validate ".concat(_,"]"),!0))return!1}else if(a(I)!==D.type)return console.error("".concat(b," ").concat(_,' type mismatched: "').concat(D.type,'" expected, "').concat(a(I),'" provided')),!1;if(D.restrictions&&D.restrictions.length)for(var K=D.restrictions.length,H=0;H<K;H++){var Q=D.restrictions[H],q=Q.restriction,F=Q.message;if(!q(I,C))return console.error("".concat(b," ").concat(_," invalid value: ").concat(F)),!1}return D.restriction&&!D.restriction(I,C)?(console.error("".concat(b," ").concat(_," invalid value: ").concat(D.message)),!1):D.validValues&&D.validValues.indexOf(I)===-1?(console.error("".concat(b," ").concat(_," invalid value: must be among ").concat(JSON.stringify(D.validValues),', "').concat(I,'" provided')),!1):!(D.children&&!g(I,D.children,"[Validate ".concat(_,"]")))});return T||M.push.apply(M,r(Object.keys(y).map(function(_){var I=y[_];if(typeof I=="string"&&(I={type:I}),I.mandatory){var D=I.mandatory;if(typeof D=="function"&&(D=D(C)),D&&C[_]===void 0)return console.error("".concat(b,' Missing mandatory key "').concat(_,'"')),!1}return!0}))),M.reduce(function(_,I){return _&&I},!0)}function p(C){return g(C,h,"[Validate format]")}s.exports={validate:function(C,y){var b=f(C),T=p(y);return b&&T},validateFormat:p,validateInput:f,validateLanguage:function(C){return g(C,u,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)})})(Sb);var jB=Sb.exports;const zo=jp(jB),KB="numeric";function Qg(n,e,t,s,o,r,a){let l=r;if(fn(l)){const c=a.numericFormat,h=c&&c.culture||"-",u=c&&c.pattern,f=a.className||"",g=f.length?f.split(" "):[];if(typeof h<"u"&&!zo.languages()[h]){const p=h.replace("-",""),C=zo.allLanguages?zo.allLanguages[h]:zo[p];C&&zo.registerLanguage(C)}zo.setLanguage(h),l=zo(l).format(u||"0"),g.indexOf("htLeft")<0&&g.indexOf("htCenter")<0&&g.indexOf("htRight")<0&&g.indexOf("htJustify")<0&&g.push("htRight"),g.indexOf("htNumeric")<0&&g.push("htNumeric"),a.className=g.join(" "),e.dir="ltr"}so(n,e,t,s,o,l,a)}Qg.RENDERER_TYPE=KB;const XB="password";function Jg(n,e,t,s,o,r,a){so.apply(this,[n,e,t,s,o,r,a]);const l=a.hashLength||e.innerHTML.length,c=a.hashSymbol||"*";let h="";Ce(l-1,()=>{h+=c}),Si(e,h)}Jg.RENDERER_TYPE=XB;const qB="time";function em(n,e,t,s,o,r,a){so.apply(this,[n,e,t,s,o,r,a]),e.dir="ltr"}em.RENDERER_TYPE=qB;function ZB(){As(Li),As(sa),As(qg),As(Xg),As(Qg),As(Jg),As(so),As(em)}const QB="autocomplete";function Cc(n,e){let t=n;if(t==null&&(t=""),this.allowEmpty&&t===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(t,vb(t,e)):vb(t,e)(this.source):e(!0)}Cc.VALIDATOR_TYPE=QB;function vb(n,e){const t=n;return function(s){let o=!1;for(let r=0,a=s.length;r<a;r++)if(t===s[r]){o=!0;break}e(o)}}function JB(n){const e=new Date(n);return isNaN(new Date(`${n}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const eW="date";function tm(n,e){const t=bS(hb,this.instance);let s=n,o=!0;s==null&&(s="");let r=ne(s,this.dateFormat||t.defaultDateFormat,!0).isValid(),a=ne(new Date(s)).isValid()||r;if(this.allowEmpty&&s===""&&(a=!0,r=!0),a||(o=!1),!a&&r&&(o=!0),a&&!r)if(this.correctFormat===!0){const l=tW(s,this.dateFormat),c=this.instance.toVisualRow(this.row),h=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(c,h,l,"dateValidator"),o=!0}else o=!1;e(o)}tm.VALIDATOR_TYPE=eW;function tW(n,e){const t=ne(JB(n)),s=ne(n,e),o=n.search(/[A-z]/g)>-1;let r;return t.isValid()&&t.format("x")===s.format("x")||!s.isValid()||o?r=t:r=s,r.format(e)}const nW="numeric";function nm(n,e){let t=n;t==null&&(t=""),this.allowEmpty&&t===""?e(!0):e(t===""?!1:fn(n))}nm.VALIDATOR_TYPE=nW;const sW=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],oW="time";function sm(n,e){const t=this.timeFormat||"h:mm:ss a";let s=!0,o=n;o===null&&(o=""),o=/^\d{3,}$/.test(o)?parseInt(o,10):o;const r=/^\d{1,2}$/.test(o);r&&(o+=":00");const a=ne(o,sW,!0).isValid()?ne(o):ne(o,t);let l=a.isValid(),c=ne(o,t,!0).isValid()&&!r;if(this.allowEmpty&&o===""&&(l=!0,c=!0),l||(s=!1),!l&&c&&(s=!0),l&&!c)if(this.correctFormat===!0){const h=a.format(t),u=this.instance.toVisualRow(this.row),f=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(u,f,h,"timeValidator"),s=!0}else s=!1;e(s)}sm.VALIDATOR_TYPE=oW;function iW(){zr(Cc),zr(tm),zr(nm),zr(sm)}const rW={CELL_TYPE:"autocomplete",editor:Gg,renderer:Li,validator:Cc},aW={CELL_TYPE:"checkbox",editor:ab,renderer:qg},lW={CELL_TYPE:"date",editor:db,renderer:Li,validator:tm},cW={CELL_TYPE:"dropdown",editor:jg,renderer:Li,validator:Cc},hW={CELL_TYPE:"handsontable",editor:zg,renderer:Li},uW={CELL_TYPE:"numeric",editor:fb,renderer:Qg,validator:nm,dataType:"number"},dW={CELL_TYPE:"password",editor:gb,renderer:Jg,copyable:!1},fW={CELL_TYPE:"time",editor:pb,renderer:em,validator:sm};function gW(){cs(rW),cs(aW),cs(lW),cs(cW),cs(hW),cs(uW),cs(dW),cs(eb),cs(fW)}function mW(n,e){pW(n,e),e.add(n)}function pW(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wW(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}const bb=new Map([["plugin",uL],["cell-type",Yv],["editor",vS],["renderer",DS],["validator",HS]]),CW="base",Yo=new WeakMap,om=[];let hs=null;var Rb=new WeakSet;class et{static get PLUGIN_KEY(){return CW}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}constructor(e){mW(this,Rb),Os(this,"hot",e,{writable:!1}),Yo.set(this,{hooks:{}}),hs=null,this.pluginName=null,this.pluginsInitializedCallbacks=[],this.isPluginsReady=!1,this.enabled=!1,this.initialized=!1,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",t=>this.onUpdateSettings(t)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,t=Array.isArray(e)?e:[];if(t.length>0){const o=[];if(t.forEach(r=>{const[a,l]=r.split(":");if(!bb.has(a))throw new Error(`Unknown plugin dependency type "${a}" was found.`);bb.get(a)(l)||o.push(` - ${l} (${a})`)}),o.length>0){const r=[`The ${this.pluginName} plugin requires the following modules:
`,`${o.join(`
`)}
`].join("");om.push(r)}}if(hs||(hs=PS()),hs.indexOf("UndoRedo")>=0&&hs.splice(hs.indexOf("UndoRedo"),1),hs.indexOf(this.pluginName)>=0&&hs.splice(hs.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),hs.length===0){if(om.length>0){const o=[`${om.join(`
`)}
`,"You have to import and register them manually."].join("");throw new Error(o)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){this.eventManager&&this.eventManager.clear(),this.clearHooks(),this.enabled=!1}addHook(e,t){Yo.get(this).hooks[e]=Yo.get(this).hooks[e]||[];const s=Yo.get(this).hooks[e];this.hot.addHook(e,t),s.push(t),Yo.get(this).hooks[e]=s}removeHooks(e){N(Yo.get(this).hooks[e]||[],t=>{this.hot.removeHook(e,t)})}clearHooks(){const e=Yo.get(this).hooks;Be(e,(t,s)=>this.removeHooks(s)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){N(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const t=wW(this,Rb,yW).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&t&&this.updatePlugin(e))}updatePlugin(){}destroy(){this.eventManager&&this.eventManager.destroy(),this.clearHooks(),Be(this,(e,t)=>{t!=="hot"&&(this[t]=null)}),delete this.t,delete this.hot}}function yW(n){if(!n)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let t=0;t<e.length;t++)if(n[e[t]]!==void 0)return!0;return!1}const Eb=class{constructor(e){this.hot=e,this.container=null,this.injected=!1,this.rows=[],this.columns=[],this.samples=null,this.settings={useHeaders:!0}}addRow(e,t){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const s={row:e};this.rows.push(s),this.samples=t,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),s.table=this.table.table}addColumnHeadersRow(e){const t=this.hot.getColHeader(0);if(t!=null){const s={row:-1};this.rows.push(s),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),s.table=this.table.table}}addColumn(e,t){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const s={col:e};this.columns.push(s),this.samples=t,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),s.table=this.table.table}getHeights(e){this.injected||this.injectTable(),N(this.rows,t=>{e(t.row,vt(t.table)-1)})}getWidths(e){this.injected||this.injectTable(),N(this.columns,t=>{const{width:s}=t.table.getBoundingClientRect();e(t.col,Math.ceil(s))})}setSettings(e){this.settings=e}setSetting(e,t){this.settings||(this.settings={}),this.settings[e]=t}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(){const e=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&e.appendChild(this.createColElement(-1)),this.samples.forEach(t=>{N(t.strings,s=>{e.appendChild(this.createColElement(s.col))})}),e}createRow(e){const{rootDocument:t}=this.hot,s=t.createDocumentFragment(),o=t.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,o),s.appendChild(o)),this.samples.forEach(r=>{N(r.strings,a=>{const l=a.col,c=this.hot.getCellMeta(e,l);c.col=l,c.row=e;const h=this.hot.getCellRenderer(c),u=t.createElement("td");u.setAttribute("ghost-table",1),h(this.hot,u,e,l,this.hot.colToProp(l),a.value,c),s.appendChild(u)})}),s}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,t=e.createDocumentFragment(),s=[];if(this.hot.hasRowHeaders()){const o=e.createElement("th");s.push([-1,o]),t.appendChild(o)}this.samples.forEach(o=>{N(o.strings,r=>{const a=r.col,l=e.createElement("th");s.push([a,l]),t.appendChild(l)})}),this.table.tHead.appendChild(t),N(s,o=>{const[r,a]=o;this.hot.view.appendColHeader(r,a)})}createCol(e){const{rootDocument:t}=this.hot,s=t.createDocumentFragment();return this.samples.forEach(o=>{N(o.strings,r=>{const a=r.row,l=this.hot.getCellMeta(a,e);l.col=e,l.row=a;const c=this.hot.getCellRenderer(l),h=t.createElement("td"),u=t.createElement("tr");h.setAttribute("ghost-table",1),c(this.hot,h,a,e,this.hot.colToProp(e),r.value,l),u.appendChild(h),s.appendChild(u)})}),s}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e){const t=this.hot.rootDocument.createElement("col");return t.style.width=`${this.hot.view._wt.wtTable.getStretchedColumnWidth(e)}px`,t}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:t}=this.hot,s=t.createDocumentFragment(),o=t.createElement("table"),r=t.createElement("thead"),a=t.createElement("tbody"),l=t.createElement("colgroup"),c=t.createElement("tr"),h=t.createElement("th");return this.isVertical()&&o.appendChild(l),this.isHorizontal()&&(c.appendChild(h),r.appendChild(c),o.style.tableLayout="auto",o.style.width="auto"),o.appendChild(r),this.isVertical()&&a.appendChild(c),o.appendChild(a),oe(o,e),s.appendChild(o),{fragment:s,table:o,tHead:r,tBody:a,colGroup:l,tr:c,th:h}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:t}=this.hot,s=t.createDocumentFragment(),o=t.createElement("div"),r=`htGhostTable htAutoSize ${e.trim()}`;return oe(o,r),s.appendChild(o),{fragment:s,container:o}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};class im{static get SAMPLE_COUNT(){return 3}constructor(e){this.samples=null,this.dataFactory=e,this.customSampleCount=null,this.allowDuplicates=!1}getSampleCount(){return this.customSampleCount?this.customSampleCount:im.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,t){return this.generateSamples("row",t,e)}generateColumnSamples(e,t){return this.generateSamples("col",t,e)}generateSamples(e,t,s){const o=new Map,{from:r,to:a}=typeof s=="number"?{from:s,to:s}:s;return Ce(r,a,l=>{const c=this.generateSample(e,t,l);o.set(l,c)}),o}generateSample(e,t,s){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const o=new Map,r=e==="row"?"col":"row",a=[];return Ce(t.from,t.to,l=>{const{value:c,bundleSeed:h}=e==="row"?this.dataFactory(s,l):this.dataFactory(l,s),u=typeof h=="string"&&h.length>0;let f;u?f=h:Fe(c)?f=`${Object.keys(c).length}`:Array.isArray(c)?f=`${c.length}`:f=`${At(c).length}`,o.has(f)||o.set(f,{needed:this.getSampleCount(),strings:[]});const g=o.get(f);g.needed&&(!(a.indexOf(c)>-1)||this.allowDuplicates||u)&&(g.strings.push({value:c,[r]:l}),a.push(c),g.needed-=1)}),o}}const xb=im;de.getSingleton().register("modifyAutoColumnSizeSeed");const oa="autoColumnSize",SW=10,rm=new WeakMap,vW="autoColumnSize";class ia extends et{static get PLUGIN_KEY(){return oa}static get PLUGIN_PRIORITY(){return SW}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),rm.set(this,{cachedColumnHeaders:[]}),this.ghostTable=new Eb(this.hot),this.samplesGenerator=new xb((t,s)=>{const o=this.hot.getCellMeta(t,s);let r="";o.spanned||(r=this.hot.getDataAtCell(t,s));let a="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(a=this.hot.runHooks("modifyAutoColumnSizeSeed",a,o,r)),{value:r,bundleSeed:a}}),this.firstCalculation=!0,this.inProgress=!1,this.measuredColumns=0,this.columnWidthsMap=new to,this.hot.columnIndexMapper.registerMap(vW,this.columnWidthsMap),this.addHook("beforeColumnResize",(t,s,o)=>this.onBeforeColumnResize(t,s,o))}isEnabled(){return this.hot.getSettings()[oa]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[oa];t&&t.useHeaders!==null&&t.useHeaders!==void 0&&this.ghostTable.setSetting("useHeaders",t.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){return e.onAfterLoadData(...arguments)}),this.addHook("beforeChangeRender",s=>this.onBeforeChange(s)),this.addHook("afterFormulasValuesUpdate",s=>this.onAfterFormulasValuesUpdate(s)),this.addHook("beforeViewRender",s=>this.onBeforeViewRender(s)),this.addHook("modifyColWidth",(s,o)=>this.getColumnWidth(o,s)),this.addHook("afterInit",()=>this.onAfterInit()),super.enablePlugin()}updatePlugin(){const e=this.findColumnsWhereHeaderWasChanged();e.length&&(this.clearCache(e),this.calculateVisibleColumnsWidth()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,t,s)=>this.onBeforeColumnResize(e,t,s))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const t=this.hot.renderCall,s=this.getFirstVisibleColumn(),o=this.getLastVisibleColumn();s===-1||o===-1||this.calculateColumnsWidth({from:s,to:o},void 0,t)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const o=typeof e=="number"?{from:e,to:e}:e,r=typeof t=="number"?{from:t,to:t}:t;Ce(o.from,o.to,a=>{let l=this.hot.toPhysicalColumn(a);if(l===null&&(l=a),s||this.columnWidthsMap.getValueAtIndex(l)===null&&!this.hot._getColWidthFromSettings(l)){const c=this.samplesGenerator.generateColumnSamples(a,r);N(c,h=>{let[u,f]=h;return this.ghostTable.addColumn(u,f)})}}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((a,l)=>{const c=this.hot.toPhysicalColumn(a);this.columnWidthsMap.setValueAtIndex(c,l)})},!0),this.measuredColumns=o.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},t=0;const s=this.hot.countCols()-1;let o=null;this.inProgress=!0;const r=()=>{if(!this.hot){jl(o),this.inProgress=!1;return}this.calculateColumnsWidth({from:t,to:Math.min(t+ia.CALCULATION_STEP,s)},e),t=t+ia.CALCULATION_STEP+1,t<s?o=Ud(r):(jl(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();this.firstCalculation&&a>=0&&(this.calculateColumnsWidth({from:0,to:a},e),this.firstCalculation=!1,t=a+1),t<s?r():this.inProgress=!1}setSamplingOptions(){const e=this.hot.getSettings()[oa],t=e&&Mt(e,"samplingRatio")?e.samplingRatio:void 0,s=e&&Mt(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),s&&this.samplesGenerator.setAllowDuplicates(s)}recalculateAllColumnsWidth(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}getSyncCalculationLimit(){const e=this.hot.getSettings()[oa];let t=ia.SYNC_CALCULATION_LIMIT;const s=this.hot.countCols()-1;return Fe(e)&&(t=e.syncLimit,Uy(t)?t=_S(s,t):t>>=0),Math.min(t,s)}getColumnWidth(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=t;return o===void 0&&(o=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),s&&typeof o=="number"&&(o=Math.max(o,Ld.DEFAULT_WIDTH))),o}getFirstVisibleColumn(){const e=this.hot.view._wt;if(e.wtViewport.columnsVisibleCalculator){const t=e.wtTable.getFirstVisibleColumn();if(t!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(t)}if(e.wtViewport.columnsRenderCalculator){const t=e.wtTable.getFirstRenderedColumn();if(t!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(t)}return-1}getLastVisibleColumn(){const e=this.hot.view._wt;if(e.wtViewport.columnsVisibleCalculator){const t=e.wtTable.getLastVisibleColumn();if(t!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(t)}if(e.wtViewport.columnsRenderCalculator){const t=e.wtTable.getLastRenderedColumn();if(t!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(t)}return-1}findColumnsWhereHeaderWasChanged(){const e=this.hot.getColHeader(),{cachedColumnHeaders:t}=rm.get(this);return Qt(e,(o,r,a)=>{const l=t.length;return(l-1<a||t[a]!==r)&&o.push(a),l-1<a?t.push(r):t[a]=r,o},[])}clearCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];e.length?this.hot.batchExecution(()=>{N(e,t=>{this.columnWidthsMap.setValueAtIndex(t,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!Pn(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),e=>e===null).length}onBeforeViewRender(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}onAfterLoadData(){this.hot.view?this.recalculateAllColumnsWidth():setTimeout(()=>{this.hot&&this.recalculateAllColumnsWidth()},0)}onBeforeChange(e){const t=$e(e,s=>{let[,o]=s;return this.hot.toPhysicalColumn(this.hot.propToCol(o))});this.clearCache(Array.from(new Set(t)))}onBeforeColumnResize(e,t,s){let o=e;return s&&(this.calculateColumnsWidth(t,void 0,!0),o=this.getColumnWidth(t,void 0,!1)),o}onAfterInit(){rm.get(this).cachedColumnHeaders=this.hot.getColHeader()}onAfterFormulasValuesUpdate(e){const t=Pn(e,o=>{var r;return he((r=o.address)===null||r===void 0?void 0:r.col)}),s=$e(t,o=>o.address.col);this.clearCache(Array.from(new Set(s)))}destroy(){this.ghostTable.clean(),super.destroy()}}const Go={horizontal:"horizontal",vertical:"vertical"};function bW(n,e,t){let s,o,r;return e[0]===n[0]&&e[1]<n[1]?(r="left",s=t(e[0],e[1]),o=t(e[2],n[1]-1)):e[2]===n[2]&&e[0]===n[0]&&e[3]>n[3]?(r="right",s=t(e[0],n[3]+1),o=t(e[2],e[3])):e[0]<n[0]&&e[1]===n[1]?(r="up",s=t(e[0],e[1]),o=t(n[0]-1,e[3])):e[2]>n[2]&&e[1]===n[1]&&(r="down",s=t(n[2]+1,e[1]),o=t(e[2],e[3])),s&&s.normalize(),o&&o.normalize(),{directionOfDrag:r,startOfDragCoords:s,endOfDragCoords:o}}function RW(n){const e={};return n===!0?(e.directions=Object.keys(Go),e.autoInsertRow=!0):Fe(n)?(he(n.autoInsertRow)?n.direction===Go.horizontal?e.autoInsertRow=!1:e.autoInsertRow=n.autoInsertRow:e.autoInsertRow=!1,he(n.direction)?e.directions=[n.direction]:e.directions=Object.keys(Go)):typeof n=="string"?(e.directions=[n],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}de.getSingleton().register("modifyAutofillRange"),de.getSingleton().register("beforeAutofill"),de.getSingleton().register("afterAutofill");const Tb="autofill",EW=20,xW=["fillHandle"],TW="insert_row_below",MW=200;class _W extends et{static get PLUGIN_KEY(){return Tb}static get PLUGIN_PRIORITY(){return EW}static get SETTING_KEYS(){return[Tb,...xW]}constructor(e){super(e),this.eventManager=new bt(this),this.addingStarted=!1,this.mouseDownOnCellCorner=!1,this.mouseDragOutside=!1,this.handleDraggedCells=0,this.directions=[],this.autoInsertRow=!1}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>this.onAfterCellCornerMouseDown(e)),this.addHook("afterOnCellCornerDblClick",e=>this.onCellCornerDblClick(e)),this.addHook("beforeOnCellMouseOver",(e,t)=>this.onBeforeCellMouseOver(t)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:t,col:s}=e.getTopStartCorner(),{row:o,col:r}=e.getBottomEndCorner(),a=this.hot.runHooks("modifyCopyableRange",[{startRow:t,startCol:s,endRow:o,endCol:r}]),l=[],c=[],h=[];return N(a,u=>{for(let f=u.startRow;f<=u.endRow;f+=1)l.indexOf(f)===-1&&l.push(f);for(let f=u.startCol;f<=u.endCol;f+=1)c.indexOf(f)===-1&&c.push(f)}),N(l,u=>{const f=[];N(c,g=>{f.push(this.hot.getCopyableData(u,g))}),h.push(f)}),h}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,t,s,o]=this.hot.selection.highlight.getFill().getVisualCorners(),r=this.hot.getSelectedRangeLast(),a=r.getTopStartCorner(),l=r.getBottomEndCorner();this.resetSelectionOfDraggedArea();const c=[a.row,a.col,l.row,l.col],h=this.hot.runHooks("modifyAutofillRange",[Math.min(a.row,e),Math.min(a.col,t),Math.max(l.row,s),Math.max(l.col,o)],c),{directionOfDrag:u,startOfDragCoords:f,endOfDragCoords:g}=bW(c,h,(p,C)=>this.hot._createCellCoords(p,C));if(f&&f.row>-1&&f.col>-1){const p=this.getSelectionData(),C=r.clone(),y=this.hot._createCellRange(f,f,g),b=this.hot.runHooks("beforeAutofill",p,C,y,u);if(b===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let T=b;const M=b;if(["up","left"].indexOf(u)>-1&&!(M.length===1&&M[0].length===0))if(T=[],u==="up"){const _=g.row-f.row+1,I=_%M.length;for(let D=0;D<_;D++)T.push(M[(D+(M.length-I))%M.length])}else{const _=g.col-f.col+1,I=_%M[0].length;for(let D=0;D<M.length;D++){T.push([]);for(let K=0;K<_;K++)T[D].push(M[D][(K+(M[D].length-I))%M[D].length])}}this.hot.populateFromArray(f.row,f.col,T,g.row,g.col,`${this.pluginName}.fill`,null),this.setSelection(h),this.hot.runHooks("afterAutofill",T,C,y,u),this.hot.render()}else this.hot._refreshBorders();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const t=this.hot.getSelectedRangeLast(),s=t.getBottomEndCorner();let o=e;if(this.directions.includes(Go.vertical)&&this.directions.includes(Go.horizontal)){const r=t.getTopStartCorner();(s.col<=e.col||r.col>=e.col)&&(o=this.hot._createCellCoords(s.row,e.col)),(s.row<e.row||r.row>e.row)&&(o=this.hot._createCellCoords(e.row,s.col))}else if(this.directions.includes(Go.vertical))o=this.hot._createCellCoords(e.row,s.col);else if(this.directions.includes(Go.horizontal))o=this.hot._createCellCoords(s.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(o)}showBorder(e){const t=this.getCoordsOfDragAndDropBorders(e);t&&this.redrawBorders(t)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(TW,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},MW)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),t=this.hot.selection.highlight.getFill().getVisualCorners(),s=this.hot.countRows();e[2]<s-1&&t[2]===s-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const t=this.hot.getData(),s=this.hot.countRows();let o;for(let r=e[2]+1;r<s;r++){for(let c=e[1];c<=e[3];c++)if(t[r][c])return-1;const a=t[r][e[1]-1],l=t[r][e[3]+1];(a||l)&&(o=r)}return o}addSelectionFromStartAreaToSpecificRowIndex(e,t){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(t,e[3])).commit()}setSelection(e){this.hot.selectCell(...$e(e,t=>Math.max(t,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),t=this.getIndexOfLastAdjacentFilledInRow(e);return t===-1||t===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,t),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:t}=this.hot.rootDocument,s=Ht(this.hot.table).top-(this.hot.rootWindow.pageYOffset||t.scrollTop)+vt(this.hot.table),o=Ht(this.hot.table).left-(this.hot.rootWindow.pageXOffset||t.scrollLeft)+at(this.hot.table);return e.clientY>s&&e.clientX<=o}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp()),this.eventManager.addEventListener(e,"mousemove",t=>this.onMouseMove(t))}onCellCornerDblClick(){this.selectAdjacent()&&this.fillIn()}onAfterCellCornerMouseDown(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}onBeforeCellMouseOver(e){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(e),this.addNewRowIfNeeded())}onMouseUp(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}onMouseMove(e){const t=this.getIfMouseWasDraggedOutside(e);this.addingStarted===!1&&this.handleDraggedCells>0&&t?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=RW(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}const yc="autoRowSize",IW=40,OW="autoRowSize";class ra extends et{static get PLUGIN_KEY(){return yc}static get PLUGIN_PRIORITY(){return IW}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),this.rowHeightsMap=void 0,this.headerHeight=null,this.ghostTable=new Eb(this.hot),this.samplesGenerator=new xb((t,s)=>{let o;return t>=0?o=this.hot.getDataAtCell(t,s):t===-1&&(o=this.hot.getColHeader(s)),{value:o}}),this.firstCalculation=!0,this.inProgress=!1,this.measuredRows=0,this.rowHeightsMap=new to,this.hot.rowIndexMapper.registerMap(OW,this.rowHeightsMap),this.addHook("beforeRowResize",(t,s,o)=>this.onBeforeRowResize(t,s,o))}isEnabled(){const e=this.hot.getSettings()[yc];return e===!0||Fe(e)}enablePlugin(){var e=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){return e.onAfterLoadData(...arguments)}),this.addHook("beforeChangeRender",t=>this.onBeforeChange(t)),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("beforeViewRender",t=>this.onBeforeViewRender(t)),this.addHook("modifyRowHeight",(t,s)=>this.getRowHeight(s,t)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin())}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,t,s)=>this.onBeforeRowResize(e,t,s))}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const o=typeof e=="number"?{from:e,to:e}:e,r=typeof t=="number"?{from:t,to:t}:t;if(this.hot.getColHeader(0)!==null){const a=this.samplesGenerator.generateRowSamples(-1,r);this.ghostTable.addColumnHeadersRow(a.get(-1))}Ce(o.from,o.to,a=>{if(s||this.rowHeightsMap.getValueAtIndex(a)===null){const l=this.samplesGenerator.generateRowSamples(a,r);N(l,c=>{let[h,u]=c;return this.ghostTable.addRow(h,u)})}}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((a,l)=>{a<0?this.headerHeight=l:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(a),l)})},!0),this.measuredRows=o.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},t=0;const s=this.hot.countRows()-1;let o=null;this.inProgress=!0;const r=()=>{if(!this.hot){jl(o),this.inProgress=!1;return}this.calculateRowsHeight({from:t,to:Math.min(t+ra.CALCULATION_STEP,s)},e),t=t+ra.CALCULATION_STEP+1,t<s?o=Ud(r):(jl(o),this.inProgress=!1,this.hot.view.adjustElementsSize(!0),this.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},a=this.getSyncCalculationLimit();this.firstCalculation&&a>=0&&(this.calculateRowsHeight({from:0,to:a},e),this.firstCalculation=!1,t=a+1),t<s?r():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}setSamplingOptions(){const e=this.hot.getSettings()[yc],t=e&&Mt(e,"samplingRatio")?e.samplingRatio:void 0,s=e&&Mt(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),s&&this.samplesGenerator.setAllowDuplicates(s)}recalculateAllRowsHeight(){kr(this.hot.view._wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}getSyncCalculationLimit(){const e=this.hot.getSettings()[yc];let t=ra.SYNC_CALCULATION_LIMIT;const s=this.hot.countRows()-1;return Fe(e)&&(t=e.syncLimit,Uy(t)?t=_S(s,t):t>>=0),Math.min(t,s)}getRowHeight(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0;const s=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let o=t;return s!==null&&s>(t||0)&&(o=s),o}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){const e=this.hot.view._wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getFirstVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getFirstRenderedRow():-1}getLastVisibleRow(){const e=this.hot.view._wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getLastVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getLastRenderedRow():-1}clearCache(){this.headerHeight=null,this.rowHeightsMap.init()}clearCacheByRange(e){const{from:t,to:s}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{Ce(Math.min(t,s),Math.max(t,s),o=>{this.rowHeightsMap.setValueAtIndex(o,null)})},!0)}isNeedRecalculate(){return!!Pn(this.rowHeightsMap.getValues().slice(0,this.measuredRows),e=>e===null).length}onBeforeViewRender(){const e=this.hot.renderCall,t=this.hot.getSettings().fixedRowsBottom,s=this.getFirstVisibleRow(),o=this.getLastVisibleRow();if(!(s===-1||o===-1)){if(this.calculateRowsHeight({from:s,to:o},void 0,e),t){const r=this.hot.countRows()-1;this.calculateRowsHeight({from:r-t,to:r})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}onBeforeRowMove(e,t){this.clearCacheByRange({from:e,to:t}),this.calculateAllRowsHeight()}onBeforeRowResize(e,t,s){let o=e;return s&&(this.calculateRowsHeight(t,void 0,!0),o=this.getRowHeight(t)),o}onAfterLoadData(){this.hot.view?this.recalculateAllRowsHeight():setTimeout(()=>{this.hot&&this.recalculateAllRowsHeight()},0)}onBeforeChange(e){let t=null;e.length===1?t=e[0][0]:e.length>1&&(t={from:e[0][0],to:e[e.length-1][0]}),t!==null&&this.clearCacheByRange(t)}destroy(){this.ghostTable.clean(),super.destroy()}}const{getListWithInsertedItems:AW,getListWithRemovedItems:PW}=Rv("physicallyIndexed");class DW extends Wo{constructor(){super(e=>e)}insert(e,t){const s=hf(this.indexedValues,t);this.indexedValues=AW(s,e,t,this.initValueOrFn),super.insert(e,t)}remove(e){const t=PW(this.indexedValues,e);this.indexedValues=cf(t,e),super.remove(e)}}const NW=DW,{getListWithInsertedItems:HW,getListWithRemovedItems:kW}=Rv("physicallyIndexed");class LW extends Wo{constructor(){super(e=>e)}insert(e,t){this.indexedValues=HW(this.indexedValues,e,t,(s,o)=>this.getNextValue(o)),super.insert(e,t)}remove(e){this.indexedValues=kW(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}const VW=LW,am="bindRowsWithHeaders",$W=210,FW="loose",BW=new Map([["loose",NW],["strict",VW]]);class WW extends et{static get PLUGIN_KEY(){return am}static get PLUGIN_PRIORITY(){return $W}constructor(e){super(e),this.headerIndexes=null}isEnabled(){return!!this.hot.getSettings()[am]}enablePlugin(){if(this.enabled)return;let e=this.hot.getSettings()[am];typeof e!="string"&&(e=FW);const t=BW.get(e);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new t),this.addHook("modifyRowHeader",s=>this.onModifyRowHeader(s)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}onModifyRowHeader(e){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(e))}destroy(){super.destroy()}}function UW(n,e,t){zW(n,e),e.set(n,t)}function zW(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lm(n,e,t){return e=YW(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function YW(n){var e=GW(n,"string");return typeof e=="symbol"?e:String(e)}function GW(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Mb(n,e){var t=_b(n,e,"get");return jW(n,t)}function jW(n,e){return e.get?e.get.call(n):e.value}function cm(n,e,t){var s=_b(n,e,"set");return KW(n,s,t),t}function _b(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function KW(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}const hm="collapsibleColumns",XW=290,qW=["nestedHeaders"],Fi="collapsibleIndicator",Ib=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var Bi=new WeakMap;class ZW extends et{constructor(){super(...arguments),lm(this,"nestedHeadersPlugin",null),lm(this,"eventManager",new bt(this)),lm(this,"headerStateManager",null),UW(this,Bi,{writable:!0,value:null})}static get PLUGIN_KEY(){return hm}static get PLUGIN_PRIORITY(){return XW}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[hm,...qW]}isEnabled(){return!!this.hot.getSettings()[hm]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:t}=this.hot.getSettings();t||ut("You need to configure the Nested Headers plugin in order to use collapsible headers."),cm(this,Bi,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>this.onInit()),this.addHook("afterLoadData",function(){return e.onAfterLoadData(...arguments)}),this.addHook("afterGetColHeader",function(){return e.onAfterGetColHeader(...arguments)}),this.addHook("beforeOnCellMouseDown",(s,o,r)=>this.onBeforeOnCellMouseDown(s,o,r)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(t=>({collapsible:t.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),cm(this,Bi,null),this.nestedHeadersPlugin=null,this.clearButtons(),super.disablePlugin()}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,t=this.hot.view._wt.wtTable.THEAD,s=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,o=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,r=function(a){a&&a.parentNode.removeChild(a)};Ce(0,e-1,a=>{const l=t.childNodes[a],c=s.childNodes[a],h=o?o.childNodes[a]:null;Ce(0,l.childNodes.length-1,u=>{let f=l.childNodes[u].querySelector(`.${Fi}`);r(f),c&&c.childNodes[u]&&(f=c.childNodes[u].querySelector(`.${Fi}`),r(f)),o&&h&&h.childNodes[u]&&(f=h.childNodes[u].querySelector(`.${Fi}`),r(f))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const t=this.headerStateManager.mapNodes(s=>{const{collapsible:o,origColspan:r,headerLevel:a,columnIndex:l,isCollapsed:c}=s;if(o===!0&&r>1&&(c&&e==="expand"||!c&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(a),col:l}});this.toggleCollapsibleSection(t,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,t){if(!Ib.has(t))throw new Error(`Unsupported action is passed (${t}).`);if(!Array.isArray(e))return;const s=Pn(e,g=>{let{row:p}=g;return p<0});let o=s.length>0;N(s,g=>{var p;let{row:C,col:y}=g;const{collapsible:b,isCollapsed:T}=(p=this.headerStateManager.getHeaderSettings(C,y))!==null&&p!==void 0?p:{};if(!b||T&&t==="collapse"||!T&&t==="expand")return o=!1,!1});const r=[],a=[];o&&N(s,g=>{let{row:p,col:C}=g;const{colspanCompensation:y,affectedColumns:b,rollbackModification:T}=this.headerStateManager.triggerNodeModification(t,p,C);y>0&&(a.push(...b),r.push(T))});const l=this.getCollapsedColumns();let c=[];t==="collapse"?c=Hy([...l,...a]):t==="expand"&&(c=Pn(l,g=>!a.includes(g)));const h=Ib.get(t);if(this.hot.runHooks(h.beforeHook,l,c,o)===!1){N(r,g=>{g()});return}this.hot.batchExecution(()=>{N(a,g=>{Mb(this,Bi).setValueAtIndex(this.hot.toPhysicalColumn(g),h.hideColumn)})},!0);const f=this.getCollapsedColumns().length!==l.length;this.hot.runHooks(h.afterHook,l,c,o,f),this.hot.render(),this.hot.view.adjustElementsSize(!0)}getCollapsedColumns(){return Mb(this,Bi).getHiddenIndexes()}onAfterGetColHeader(e,t,s){var o;const{collapsible:r,origColspan:a,isCollapsed:l}=(o=this.headerStateManager.getHeaderSettings(s,e))!==null&&o!==void 0?o:{},c=r&&a>1&&e>=this.hot.getSettings().fixedColumnsStart;let h=t.querySelector(`.${Fi}`);if(c)h||(h=this.hot.rootDocument.createElement("div"),oe(h,Fi),t.querySelector("div:first-child").appendChild(h)),De(h,["collapsed","expanded"]),l?(oe(h,"collapsed"),Po(h,"+")):(oe(h,"expanded"),Po(h,"-"));else{var u;(u=h)===null||u===void 0||u.remove()}}onBeforeOnCellMouseDown(e,t){Ae(e.target,Fi)&&(Ae(e.target,"expanded")?(this.eventManager.fireEvent(e.target,"mouseup"),this.toggleCollapsibleSection([t],"collapse")):Ae(e.target,"collapsed")&&(this.eventManager.fireEvent(e.target,"mouseup"),this.toggleCollapsibleSection([t],"expand")),is(e))}onInit(){this.updatePlugin()}onAfterLoadData(e,t){t||this.updatePlugin()}destroy(){cm(this,Bi,null),super.destroy()}}const QW=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],JW=!1,e2=!0,t2=!0;class n2{constructor(e,t){this.hot=e,this.sortingStates=new Zl,this.sortEmptyCells=JW,this.indicator=e2,this.headerAction=t2,this.compareFunctionFactory=void 0,this.mapName=t,this.hot.columnIndexMapper.registerMap(t,this.sortingStates)}updateAllColumnsProperties(e){Fe(e)&&Be(e,(t,s)=>{QW.includes(s)&&(this[s]=t)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var t;return(t=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||t===void 0?void 0:t.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(t=>{let[s]=t;return s===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return Fe(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(t=>{let[s,o]=t;return{column:this.hot.toVisualColumn(s),...o}})}getColumnSortState(e){const t=this.getSortOrderOfColumn(e);if(he(t))return{column:e,sortOrder:t}}setSortStates(e){this.sortingStates.clear();for(let t=0;t<e.length;t+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[t].column),{sortOrder:e[t].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}const Sc="asc",vc="desc",s2="colHeader";function o2(n){if(Fe(n)===!1)return!1;const{column:e,sortOrder:t}=n;return Number.isInteger(e)&&[Sc,vc].includes(t)}function i2(n){if(n.some(t=>o2(t)===!1))return!1;const e=n.map(t=>{let{column:s}=t;return s});return new Set(e).size===e.length}function Ob(n){if(n!==vc)return n===Sc?vc:Sc}function Ab(n){return n.querySelector(`.${s2}`)}function Pb(n,e){if(n<0||!e.parentNode)return!1;const t=e.parentNode.parentNode.childNodes;return Array.from(t).indexOf(e.parentNode)-t.length===-1}function um(n,e,t){return n===-1&&e>=0&&Ho(t)===!1}const r2="ascending",a2="descending",Db="indicatorDisabled",Nb="columnSorting",Hb="sortAction",kb=new Map([[Sc,r2],[vc,a2]]);function l2(n,e,t,s){const o=[Nb];if(s&&o.push(Hb),t===!1)return o.push(Db),o;const r=n.getSortOrderOfColumn(e);return he(r)&&o.push(kb.get(r)),o}function c2(){return Array.from(kb.values()).concat(Hb,Db,Nb)}function Lb(n,e,t){const s=e.locale;return function(o,r){const{sortEmptyCells:a}=t;return typeof o=="string"&&(o=o.toLocaleLowerCase(s)),typeof r=="string"&&(r=r.toLocaleLowerCase(s)),o===r?us:Vt(o)?Vt(r)?us:a&&n==="asc"?Et:xt:Vt(r)?a&&n==="asc"?xt:Et:isNaN(o)&&!isNaN(r)?n==="asc"?xt:Et:!isNaN(o)&&isNaN(r)||(isNaN(o)||isNaN(r)||(o=parseFloat(o),r=parseFloat(r)),o<r)?n==="asc"?Et:xt:o>r?n==="asc"?xt:Et:us}}const Vb="default";function h2(n,e,t){return function(s,o){const r=parseFloat(s),a=parseFloat(o),{sortEmptyCells:l}=t;if(r===a||isNaN(r)&&isNaN(a))return us;if(l){if(Vt(s))return n==="asc"?Et:xt;if(Vt(o))return n==="asc"?xt:Et}return isNaN(r)?xt:isNaN(a)?Et:r<a?n==="asc"?Et:xt:r>a?n==="asc"?xt:Et:us}}const u2="numeric";function d2(n,e,t){const s=e.checkedTemplate,o=e.uncheckedTemplate,{sortEmptyCells:r}=t;return function(a,l){const c=Vt(a),h=Vt(l),u=c?o:a,f=h?o:l,g=u===o||u===s,p=f===o||f===s;if(r===!1){if(c&&h===!1)return xt;if(c===!1&&h)return Et}return g===!1&&p?n==="asc"?Et:xt:g&&p===!1?n==="asc"?xt:Et:g===!1&&p===!1?Lb(n,e,t)(a,l):u===o&&f===s?n==="asc"?Et:xt:u===s&&f===o?n==="asc"?xt:Et:us}}const f2="checkbox";function g2(n,e,t){return function(s,o){const{sortEmptyCells:r}=t;if(s===o)return us;if(Vt(s))return Vt(o)?us:r&&n==="asc"?Et:xt;if(Vt(o))return r&&n==="asc"?xt:Et;const a=e.dateFormat,l=ne(s,a),c=ne(o,a);return l.isValid()?c.isValid()?c.isAfter(l)?n==="asc"?Et:xt:c.isBefore(l)?n==="asc"?xt:Et:us:Et:xt}}const m2="date",{register:bc,getItem:$b,hasItem:p2}=Nn("sorting.compareFunctionFactory"),{register:Fb,getItem:w2}=Nn("sorting.mainSortComparator");function Bb(n){return p2(n)?$b(n):$b(Vb)}bc(u2,h2),bc(f2,d2),bc(m2,g2),bc(Vb,Lb);const us=0,Et=-1,xt=1;function C2(n,e){const t=w2(e);for(var s=arguments.length,o=new Array(s>2?s-2:0),r=2;r<s;r++)o[r-2]=arguments[r];n.sort(t(...o))}function y2(n,e){return function(t,s){const[,...o]=t,[,...r]=s;return function(l){const c=n[l],h=e[l],u=o[l],f=r[l],g=h.columnSorting;return(g.compareFunctionFactory?g.compareFunctionFactory:Bb(h.type))(c,h,g)(u,f)}(0)}}const dm="columnSorting",S2=50,Wb="append",v2="replace";Fb(dm,y2),de.getSingleton().register("beforeColumnSort"),de.getSingleton().register("afterColumnSort");class Ub extends et{static get PLUGIN_KEY(){return dm}static get PLUGIN_PRIORITY(){return S2}constructor(e){super(e),this.columnStatesManager=null,this.columnMetaCache=null,this.pluginKey=dm,this.indexesSequenceCache=null}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;this.enabled||(this.columnStatesManager=new n2(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new to(t=>{let s=this.hot.toVisualColumn(t);return s===null&&(s=t),this.getMergedPluginSettings(s)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(t,s)=>this.onAfterGetColHeader(t,s)),this.addHook("beforeOnCellMouseDown",function(){return e.onBeforeOnCellMouseDown(...arguments)}),this.addHook("afterOnCellMouseDown",(t,s)=>this.onAfterOnCellMouseDown(t,s)),this.addHook("afterInit",()=>this.loadOrSortBySettings()),this.addHook("afterLoadData",function(){return e.onAfterLoadData(...arguments)}),this.hot.view&&this.loadOrSortBySettings(),super.enablePlugin())}disablePlugin(){const e=(t,s)=>{const o=Ab(s);Pb(t,s)===!1||o===null||this.updateHeaderClasses(o)};this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey))},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,super.disablePlugin()}sort(e){const t=this.getSortConfig(),s=this.getNormalizedSortConfigs(e),o=this.areValidSortConfigs(s);this.hot.runHooks("beforeColumnSort",t,s,o)!==!1&&(t.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new Ev),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),o&&(this.columnStatesManager.setSortStates(s),this.sortByPresetSortStates(s),this.saveAllSortSettings(s)),this.hot.runHooks("afterColumnSort",t,o?s:t,o),o&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return he(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const t=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(t)&&this.columnStatesManager.setSortStates(t)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const t=this.hot.countCols();return i2(e)&&e.every(s=>{let{column:o}=s;return o<=t&&o>=0})}saveAllSortSettings(e){const t=this.columnStatesManager.getAllColumnsProperties(),s=o=>{let{column:r,...a}=o;return{column:this.hot.toPhysicalColumn(r),...a}};t.initialConfig=$e(e,s),this.hot.runHooks("persistentStateSave","columnSorting",t)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const t=e.value,s=o=>{let{column:r,...a}=o;return{column:this.hot.toVisualColumn(r),...a}};return he(t)&&Array.isArray(t.initialConfig)&&(t.initialConfig=$e(t.initialConfig,s)),t}getColumnNextConfig(e){const t=this.columnStatesManager.getSortOrderOfColumn(e);if(he(t)){const o=Ob(t);return he(o)?{column:e,sortOrder:o}:void 0}const s=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<s)return{column:e,sortOrder:Ob()}}getNextSortConfig(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Wb;const s=this.columnStatesManager.getIndexOfColumnInSortQueue(e),o=s!==-1,r=this.getSortConfig(),a=this.getColumnNextConfig(e);if(o){if(ct(a))return[...r.slice(0,s),...r.slice(s+1)];if(t===Wb)return[...r.slice(0,s),...r.slice(s+1),a];if(t===v2)return[...r.slice(0,s),a,...r.slice(s+1)]}return he(a)?r.concat(a):r}getPluginColumnConfig(e){if(Fe(e)){const t=e[this.pluginKey];if(Fe(t))return t}return{}}getMergedPluginSettings(e){const t=this.hot.getSettings()[this.pluginKey],s=this.columnStatesManager.getAllColumnsProperties(),o=this.hot.getCellMeta(0,e),r=Object.getPrototypeOf(o);return Array.isArray(r.columns)?Object.assign(s,t,this.getPluginColumnConfig(r.columns[e])):ht(r.columns)?Object.assign(s,t,this.getPluginColumnConfig(r.columns(e))):Object.assign(s,t)}getFirstCellSettings(e){const t=this.hot.getCellMeta(0,e),s=Object.create(t);return s[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),s}getNumberOfRowsToSort(e){const t=this.hot.getSettings();return t.maxRows<=e?t.maxRows:e-t.minSpareRows}sortByPresetSortStates(e){if(e.length===0){this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues());return}const t=[],s=this.hot.countRows(),o=h=>$e(e,u=>this.hot.getDataAtCell(h,u.column));for(let h=0;h<this.getNumberOfRowsToSort(s);h+=1)t.push([this.hot.toPhysicalRow(h)].concat(o(h)));const r=$e(t,h=>h[0]);C2(t,this.pluginKey,$e(e,h=>h.sortOrder),$e(e,h=>this.getFirstCellSettings(h.column)));for(let h=t.length;h<s;h+=1)t.push([h].concat(o(h)));const a=$e(t,h=>h[0]),l=new Map($e(r,(h,u)=>[h,a[u]])),c=$e(this.hot.rowIndexMapper.getIndexesSequence(),h=>l.has(h)?l.get(h):h);this.hot.rowIndexMapper.setIndexesSequence(c)}loadOrSortBySettings(){const e=this.getAllSavedSortSettings();if(Fe(e))this.sortBySettings(e);else{const t=this.hot.getSettings()[this.pluginKey];this.sortBySettings(t)}}sortBySettings(e){if(Fe(e)){this.columnStatesManager.updateAllColumnsProperties(e);const t=e.initialConfig;(Array.isArray(t)||Fe(t))&&this.sort(t)}else this.hot.render()}onAfterGetColHeader(e,t){const s=Ab(t);if(Pb(e,t)===!1||s===null)return;const o=this.getFirstCellSettings(e)[this.pluginKey],r=o.indicator,a=o.headerAction;this.updateHeaderClasses(s,this.columnStatesManager,e,r,a)}updateHeaderClasses(e){if(De(e,c2()),this.enabled!==!1){for(var t=arguments.length,s=new Array(t>1?t-1:0),o=1;o<t;o++)s[o-1]=arguments[o];oe(e,l2(...s))}}onUpdateSettings(e){super.onUpdateSettings(),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),he(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}onAfterLoadData(e){e===!0&&this.hot.view&&this.loadOrSortBySettings()}wasClickableHeaderClicked(e,t){return this.getFirstCellSettings(t)[this.pluginKey].headerAction&&e.target.nodeName==="SPAN"}onBeforeOnCellMouseDown(e,t,s,o){um(t.row,t.col,e)!==!1&&this.wasClickableHeaderClicked(e,t.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(o.column=!0)}onAfterOnCellMouseDown(e,t){um(t.row,t.col,e)!==!1&&this.wasClickableHeaderClicked(e,t.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(t.col)),this.sort(this.getColumnNextConfig(t.col)))}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}class b2{constructor(e,t){this.plugin=e,this.hot=this.plugin.hot,this.endpoints=[],this.settings=t,this.settingsType="array",this.currentEndpoint=null,this.cellsToSetCache=[]}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const t=[];let s=e;if(!s&&typeof this.settings=="function"){this.settingsType="function";return}return s||(s=this.settings),N(s,o=>{const r={};this.assignSetting(o,r,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(o,r,"reversedRowCoords",!1),this.assignSetting(o,r,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(o,r,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(o,r,"sourceColumn",o.destinationColumn),this.assignSetting(o,r,"type","sum"),this.assignSetting(o,r,"forceNumeric",!1),this.assignSetting(o,r,"suppressDataTypeErrors",!0),this.assignSetting(o,r,"suppressDataTypeErrors",!0),this.assignSetting(o,r,"customFunction",null),this.assignSetting(o,r,"readOnly",!0),this.assignSetting(o,r,"roundFloat",!1),t.push(r)}),t}assignSetting(e,t,s,o){if(s==="ranges"&&e[s]===void 0){t[s]=o;return}else if(s==="ranges"&&e[s].length===0)return;if(e[s]===void 0){if(o instanceof Error)throw o;t[s]=o}else s==="destinationRow"&&t.reversedRowCoords?t[s]=this.hot.countRows()-e[s]-1:t[s]=e[s]}resetSetupBeforeStructureAlteration(e,t,s){if(this.settingsType!=="function")return;const o=e.indexOf("row")>-1?"row":"col",r=this.getAllEndpoints();N(r,a=>{o==="row"&&a.destinationRow>=t&&(e==="insert_row"?a.alterRowOffset=s:e==="remove_row"&&(a.alterRowOffset=-1*s)),o==="col"&&a.destinationColumn>=t&&(e==="insert_col"?a.alterColumnOffset=s:e==="remove_col"&&(a.alterColumnOffset=-1*s))}),this.resetAllEndpoints(r,!1)}resetSetupAfterStructureAlteration(e,t,s,o,r){let a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const g=()=>(this.hot.removeHook("beforeViewRender",g),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",g);return}const l=e.indexOf("row")>-1?"row":"col",c=e.indexOf("remove")>-1?-1:1,h=this.getAllEndpoints(),u=e.indexOf("move_row")===0,f=t;N(h,g=>{l==="row"&&g.destinationRow>=f&&(g.alterRowOffset=c*s),l==="col"&&g.destinationColumn>=f&&(g.alterColumnOffset=c*s)}),this.resetAllEndpoints(h,!u),u?N(h,g=>{this.extendEndpointRanges(g,f,o[0],o.length),this.recreatePhysicalRanges(g),this.clearOffsetInformation(g)}):N(h,g=>{this.shiftEndpointCoordinates(g,f)}),a&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,t,s,o){N(e.ranges,r=>{r[1]&&(t>=r[0]&&t<=r[1]?s>r[1]?r[1]+=o:s<r[0]&&(r[0]-=o):s>=r[0]&&s<=r[1]&&(r[1]-=o,t<=r[0]&&(r[0]+=1,r[1]+=1)))})}recreatePhysicalRanges(e){const t=e.ranges,s=[],o=[];N(t,r=>{const a=[];if(r[1])for(let l=r[0];l<=r[1];l++)a.push(this.hot.toPhysicalRow(l));else a.push(this.hot.toPhysicalRow(r[0]));o.push(a)}),N(o,r=>{let a=[];N(r,(l,c)=>{c===0?a.push(l):r[c]!==r[c-1]+1&&(a.push(r[c-1]),s.push(a),a=[],a.push(l)),c===r.length-1&&(a.push(l),s.push(a))})}),e.ranges=s}shiftEndpointCoordinates(e,t){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,N(e.ranges,s=>{N(s,(o,r)=>{o>=t&&(s[r]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(o=>{const r=o.alterRowOffset||0,a=o.alterColumnOffset||0;return o.destinationRow+r>=this.hot.countRows()||o.destinationColumn+a>=this.hot.countCols()})||(this.cellsToSetCache=[],N(e,o=>{this.resetEndpointValue(o,t)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],N(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const t=[];this.cellsToSetCache=[],N(e,(s,o,r)=>{`${s[2]||""}`!=`${s[3]}`&&N(this.getAllEndpoints(),(a,l)=>{this.hot.propToCol(r[o][1])===a.sourceColumn&&t.indexOf(l)===-1&&t.push(l)})}),N(t,s=>{this.refreshEndpoint(this.getEndpoint(s))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const s=e.alterRowOffset||0,o=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(t?s:0)),this.hot.toVisualColumn(e.destinationColumn+(t?o:0)),""])}setEndpointValue(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const o=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const r=this.hot.toVisualRow(e.destinationRow);if(r!==null){const a=this.hot.getCellMeta(r,e.destinationColumn);(t==="init"||a.readOnly!==e.readOnly)&&(a.readOnly=e.readOnly,a.className="columnSummaryResult")}e.roundFloat&&!isNaN(e.result)&&(e.result=e.result.toFixed(e.roundFloat)),s?this.hot.setDataAtCell(o,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([o,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){ut("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}const R2=b2;function fm(n){return n==null||isNaN(n)}const gm="columnSummary",E2=220;class x2 extends et{static get PLUGIN_KEY(){return gm}static get PLUGIN_PRIORITY(){return E2}constructor(e){super(e),this.endpoints=null}isEnabled(){return!!this.hot.getSettings()[gm]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[gm],this.endpoints=new R2(this,this.settings),this.addHook("afterInit",function(){return e.onAfterInit(...arguments)}),this.addHook("afterChange",function(){return e.onAfterChange(...arguments)}),this.addHook("beforeCreateRow",(t,s,o)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",t,s,null,o)),this.addHook("beforeCreateCol",(t,s,o)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",t,s,null,o)),this.addHook("beforeRemoveRow",function(){for(var t=arguments.length,s=new Array(t),o=0;o<t;o++)s[o]=arguments[o];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...s)}),this.addHook("beforeRemoveCol",function(){for(var t=arguments.length,s=new Array(t),o=0;o<t;o++)s[o]=arguments[o];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...s)}),this.addHook("afterCreateRow",(t,s,o)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",t,s,null,o)),this.addHook("afterCreateCol",(t,s,o)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",t,s,null,o)),this.addHook("afterRemoveRow",function(){for(var t=arguments.length,s=new Array(t),o=0;o<t;o++)s[o]=arguments[o];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...s)}),this.addHook("afterRemoveCol",function(){for(var t=arguments.length,s=new Array(t),o=0;o<t;o++)s[o]=arguments[o];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...s)}),this.addHook("afterRowMove",function(){return e.onAfterRowMove(...arguments)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let t=0;return Be(e.ranges,s=>{t+=this.getPartialSum(s,e.sourceColumn)}),t}getPartialSum(e,t){let s=0,o=e[1]||e[0],r=null,a=0;do{if(r=this.getCellValue(o,t),r=fm(r)?null:r,r!==null){const l=(`${r}`.split(".")[1]||[]).length||1;l>a&&(a=l)}s+=r||0,o-=1}while(o>=e[0]);return Math.round(s*10**a)/10**a}calculateMinMax(e,t){let s=null;return Be(e.ranges,o=>{const r=this.getPartialMinMax(o,e.sourceColumn,t);if(s===null&&r!==null&&(s=r),r!==null)switch(t){case"min":s=Math.min(s,r);break;case"max":s=Math.max(s,r);break}}),s===null?"Not enough data":s}getPartialMinMax(e,t,s){let o=null,r=e[1]||e[0],a;do{if(a=this.getCellValue(r,t),a=fm(a)?null:a,o===null)o=a;else if(a!==null)switch(s){case"min":o=Math.min(o,a);break;case"max":o=Math.max(o,a);break}r-=1}while(r>=e[0]);return o}countEmpty(e,t){let s,o=0,r=e[1]||e[0];do s=this.getCellValue(r,t),s=fm(s)?null:s,s===null&&(o+=1),r-=1;while(r>=e[0]);return o}countEntries(e){let t=0;const s=e.ranges;return Be(s,o=>{const r=o[1]===void 0?1:o[1]-o[0]+1,a=this.countEmpty(o,e.sourceColumn);t+=r,t-=a}),t}calculateAverage(e){const t=this.calculateSum(e),s=this.countEntries(e);return t/s}getCellValue(e,t){const s=this.hot.toVisualRow(e),o=this.hot.toVisualColumn(t);let r=this.hot.getSourceDataAtCell(e,t),a="";if(s!==null&&o!==null&&(a=this.hot.getCellMeta(s,o).className||""),a.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof r=="string"&&(r=r.replace(/,/,".")),r=parseFloat(r)),isNaN(r)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(rt`ColumnSummary plugin: cell at (${e}, ${t}) is not in a\x20
          numeric format. Cannot do the calculation.`);return r}onAfterInit(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)}onAfterChange(e,t){e&&t!=="ColumnSummary.reset"&&t!=="ColumnSummary.set"&&t!=="loadData"&&this.endpoints.refreshChangedEndpoints(e)}onAfterRowMove(e,t){this.endpoints.resetSetupBeforeStructureAlteration("move_row",e[0],e.length,e,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",t,e.length,e,this.pluginName)}}class Wi{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,t){this.rootDocument=e,this.isRtl=t,this.container=null,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hidden=!0,this.hide()}setPosition(e,t){this.editorStyle.left=`${e}px`,this.editorStyle.top=`${t}px`}setSize(e,t){if(e&&t){const s=this.getInputElement();s.style.width=`${e}px`,s.style.height=`${t}px`}}getSize(){return{width:at(this.getInputElement()),height:vt(this.getInputElement())}}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const t=this.getInputElement();t.readOnly=e}show(){this.editorStyle.display="block",this.hidden=!1}hide(){this.hidden||(this.editorStyle.display="none"),this.hidden=!0}isVisible(){return this.editorStyle.display==="block"}setValue(){const t=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=t}getValue(){return this.getInputElement().value}isFocused(){return this.rootDocument.activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=this.rootDocument.createElement("div"),t=this.rootDocument.createElement("textarea");return e.style.display="none",this.container=this.rootDocument.createElement("div"),this.container.setAttribute("dir",this.isRtl?"rtl":"ltr"),oe(this.container,Wi.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),oe(e,Wi.CLASS_EDITOR),oe(t,Wi.CLASS_INPUT),e.appendChild(t),this.container.appendChild(e),e}getInputElement(){return this.editor.querySelector(`.${Wi.CLASS_INPUT}`)}destroy(){const e=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,e&&e.removeChild(this.container)}}const T2=Wi,We="---------";function M2(){return{name:We}}function _2(n){return $e(n,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function Rc(n){return Ae(n,"htSeparator")}function I2(n){return Ae(n,"htSubmenu")}function Ec(n){return Ae(n,"htDisabled")}function xc(n){return Ae(n,"htSelectionDisabled")}function jo(n){const e=n.getSelected();return!e||e[0]<0?null:e}function O2(n,e){return n.indexOf(e)!==-1?n:`${n.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function A2(n,e){return n.indexOf(e)!==-1?n:`${n.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function Ko(n,e){const t={};return N(n,s=>{s.forAll((o,r)=>{o>=0&&r>=0&&(t[o]||(t[o]=[]),t[o][r]=e(o,r))})}),t}function oo(n,e,t,s,o){N(n,r=>{r.forAll((a,l)=>{a>=0&&l>=0&&P2(a,l,e,t,s,o)})})}function P2(n,e,t,s,o,r){const a=o(n,e);let l=s;a.className&&(t==="vertical"?l=O2(a.className,s):l=A2(a.className,s)),r(n,e,"className",l)}function ds(n,e){let t=!1;return Array.isArray(n)&&N(n,s=>(s.forAll((o,r)=>{if(o>=0&&r>=0&&e(o,r))return t=!0,!1}),t)),t}function Ds(n){return`<span class="selected">${String.fromCharCode(10003)}</span>${n}`}function D2(n,e){return!n.hidden||!(typeof n.hidden=="function"&&n.hidden.call(e))}function zb(n,e){const t=n.slice(0);for(let s=0;s<t.length&&t[s].name===e;)t.shift();return t}function N2(n,e){let t=n.slice(0);return t.reverse(),t=zb(t,e),t.reverse(),t}function H2(n){const e=[];return N(n,(t,s)=>{s>0?e[e.length-1].name!==t.name&&e.push(t):e.push(t)}),e}function k2(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:We,t=n.slice(0);return t=zb(t,e),t=N2(t,e),t=H2(t),t}const L2=250,V2=250;class Yb{constructor(e){this.wasLastActionShow=!0,this.showDebounced=null,this.hidingTimer=null,this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},V2)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:L2;this.showDebounced=Zy(t=>{this.wasLastActionShow&&this.runLocalHooks("show",t.from.row,t.from.col)},e)}destroy(){this.clearLocalHooks()}}lt(Yb,gn);const $2=Yb,mm="comments",F2=60,Tc=new WeakMap,fs="comment",Ui="value",Gb="style",Mc="readOnly";class B2 extends et{static get PLUGIN_KEY(){return mm}static get PLUGIN_PRIORITY(){return F2}constructor(e){super(e),this.editor=null,this.displaySwitch=null,this.eventManager=null,this.range={},this.preventEditorAutoSwitch=!1,Tc.set(this,{tempEditorDimensions:{},cellBelowCursor:null})}isEnabled(){return!!this.hot.getSettings()[mm]}enablePlugin(){this.enabled||(this.editor||(this.editor=new T2(this.hot.rootDocument,this.hot.isRtl())),this.eventManager||(this.eventManager=new bt(this)),this.displaySwitch||(this.displaySwitch=new $2(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",e=>this.addToContextMenu(e)),this.addHook("afterRenderer",(e,t,s,o,r,a)=>this.onAfterRenderer(e,a)),this.addHook("afterScrollHorizontally",()=>this.hide()),this.addHook("afterScrollVertically",()=>this.hide()),this.addHook("afterBeginEditing",()=>this.hide()),this.displaySwitch.addLocalHook("hide",()=>this.hide()),this.displaySwitch.addLocalHook("show",(e,t)=>this.showAtCell(e,t)),this.registerListeners(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin(),this.displaySwitch.updateDelay(this.getDisplayDelaySetting())}disablePlugin(){super.disablePlugin()}registerListeners(){const{rootDocument:e}=this.hot;this.eventManager.addEventListener(e,"mouseover",t=>this.onMouseOver(t)),this.eventManager.addEventListener(e,"mousedown",t=>this.onMouseDown(t)),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp()),this.eventManager.addEventListener(this.editor.getInputElement(),"blur",()=>this.onEditorBlur()),this.eventManager.addEventListener(this.editor.getInputElement(),"mousedown",t=>this.onEditorMouseDown(t)),this.eventManager.addEventListener(this.editor.getInputElement(),"mouseup",t=>this.onEditorMouseUp(t))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const t=Io(e.target,"TD","TBODY");return!!(t&&Ae(t,"htCommentCell")&&Io(t,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.editor.getInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const t=this.editor.getValue();let s="";e!=null?s=e:t!=null&&(s=t);const o=this.range.from.row,r=this.range.from.col;this.updateCommentMeta(o,r,{[Ui]:s}),this.hot.render()}setCommentAtCell(e,t,s){this.setRange({from:this.hot._createCellCoords(e,t)}),this.setComment(s)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,fs),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,t)}),this.removeComment(s)}getComment(){const e=this.range.from.row,t=this.range.from.col;return this.getCommentMeta(e,t,Ui)}getCommentAtCell(e,t){return this.getCommentMeta(e,t,Ui)}show(){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:e,col:t}}=this.range;if(e<0||e>this.hot.countSourceRows()-1||t<0||t>this.hot.countSourceCols()-1)return!1;const s=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return this.editor.setValue(s[fs]?s[fs][Ui]:""),this.editor.show(),this.refreshEditor(!0),!0}showAtCell(e,t){return this.setRange({from:this.hot._createCellCoords(e,t)}),this.show()}hide(){this.editor.hide()}refreshEditor(){var e,t;if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!this.editor.isVisible()))return;const{rowIndexMapper:o,columnIndexMapper:r}=this.hot,{row:a,col:l}=this.range.from;let c=o.getRenderableFromVisualIndex(a),h=r.getRenderableFromVisualIndex(l);const u=c===null;this.editor.setPosition(0,0),c===null&&(c=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(a,-1))),h===null&&(h=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(l,-1)));const f=c===null,g=h===null;c=(e=c)!==null&&e!==void 0?e:0,h=(t=h)!==null&&t!==void 0?t:0;const{rootWindow:p,view:{_wt:C}}=this.hot,{wtTable:y}=C,b=C.getCell({row:c,col:h},!0),T=this.getCommentMeta(a,l,Gb);T?this.editor.setSize(T.width,T.height):this.editor.resetSize();const M=g?0:y.getStretchedColumnWidth(h),_=u&&!f?vt(b):0,{left:I,top:D,width:K,height:H}=b.getBoundingClientRect(),{width:Q,height:q}=this.editor.getSize(),{innerWidth:F,innerHeight:Y}=this.hot.rootWindow,te=this.hot.rootDocument.documentElement;let ie=I+p.scrollX+M,fe=D+p.scrollY+_;this.hot.isRtl()&&(ie-=Q+M),this.hot.isLtr()&&I+K+Q>F?ie=I+p.scrollX-Q-1:this.hot.isRtl()&&ie<-(te.scrollWidth-te.clientWidth)&&(ie=I+p.scrollX+M+1),D+q>Y&&(fe-=q-H+1),this.editor.setPosition(ie,fe),this.editor.setReadOnlyState(this.getCommentMeta(a,l,Mc))}checkSelectionCommentsConsistency(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;let t=!1;const s=e.getTopStartCorner();return this.getCommentMeta(s.row,s.col,Ui)&&(t=!0),t}updateCommentMeta(e,t,s){const o=this.hot.getCellMeta(e,t)[fs];let r;o?(r=rn(o),Bl(r,s)):r=s,this.hot.setCellMeta(e,t,fs,r)}getCommentMeta(e,t,s){const o=this.hot.getCellMeta(e,t);if(o[fs])return o[fs][s]}onMouseDown(e){if(!(!this.hot.view||!this.hot.view._wt)&&!this.preventEditorAutoSwitch&&!this.targetIsCommentTextArea(e)){const t=Io(e.target,"TD","TBODY");let s=null;t&&(s=this.hot.getCoords(t)),(!t||this.range.from&&s&&(this.range.from.row!==s.row||this.range.from.col!==s.col))&&this.hide()}}onMouseOver(e){const t=Tc.get(this),{rootDocument:s}=this.hot;if(!(this.preventEditorAutoSwitch||this.editor.isFocused()||Ae(e.target,"wtBorder")||t.cellBelowCursor===e.target||!this.editor))if(t.cellBelowCursor=s.elementFromPoint(e.clientX,e.clientY),this.targetIsCellWithComment(e)){const o=this.hot._createCellRange(this.hot.getCoords(e.target));this.displaySwitch.show(o)}else Oo(e.target,s)&&!this.targetIsCommentTextArea(e)&&this.displaySwitch.hide()}onMouseUp(){this.preventEditorAutoSwitch=!1}onAfterRenderer(e,t){t[fs]&&t[fs][Ui]&&oe(e,t.commentedCellClassName)}onEditorBlur(){this.setComment()}onEditorMouseDown(e){const t=Tc.get(this);t.tempEditorDimensions={width:at(e.target),height:vt(e.target)}}onEditorMouseUp(e){const t=Tc.get(this),s=at(e.target),o=vt(e.target);(s!==t.tempEditorDimensions.width+1||o!==t.tempEditorDimensions.height+2)&&this.updateCommentMeta(this.range.from.row,this.range.from.col,{[Gb]:{width:s,height:o}})}onContextMenuAddComment(){const e=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,this.displaySwitch.cancelHiding(),this.setRange({from:e.highlight}),this.show(),this.hot.deselectCell(),this.editor.focus()}onContextMenuRemoveComment(){const e=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,e.forAll((t,s)=>{t>=0&&s>=0&&this.removeCommentAtCell(t,s,!1)}),this.hot.render()}onContextMenuMakeReadOnly(){const e=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,e.forAll((t,s)=>{if(t>=0&&s>=0){const o=!!this.getCommentMeta(t,s,Mc);this.updateCommentMeta(t,s,{[Mc]:!o})}})}addToContextMenu(e){const t=()=>this.hot.rowIndexMapper.getRenderableIndexesLength()>0&&this.hot.columnIndexMapper.getRenderableIndexesLength()>0;e.items.push({name:"---------"},{key:"commentsAddEdit",name:()=>this.checkSelectionCommentsConsistency()?this.hot.getTranslatedPhrase(Hf):this.hot.getTranslatedPhrase(Nf),callback:()=>this.onContextMenuAddComment(),disabled:()=>t()?!(this.hot.getSelectedLast()&&!this.hot.selection.isSelectedByCorner()):!0},{key:"commentsRemove",name(){return this.getTranslatedPhrase(kf)},callback:()=>this.onContextMenuRemoveComment(),disabled:()=>t()?!(this.hot.getSelectedLast()&&!this.hot.selection.isSelectedByCorner()):!0},{key:"commentsReadOnly",name(){let s=this.getTranslatedPhrase(Lf);return ds(this.getSelectedRangeLast(),(r,a)=>{let l=this.getCellMeta(r,a)[fs];if(l&&(l=l[Mc]),l)return!0})&&(s=Ds(s)),s},callback:()=>this.onContextMenuMakeReadOnly(),disabled:()=>t()?!(this.hot.getSelectedLast()&&!this.hot.selection.isSelectedByCorner())||!this.checkSelectionCommentsConsistency():!0})}getDisplayDelaySetting(){const e=this.hot.getSettings()[mm];if(Fe(e))return e.displayDelay}destroy(){this.editor&&this.editor.destroy(),this.displaySwitch&&this.displaySwitch.destroy(),super.destroy()}}var jb=gw,W2=TypeError,U2=function(n,e){if(!delete n[e])throw W2("Cannot delete property "+jb(e)+" of "+jb(n))},z2=vo,Y2=Ya,G2=Qa,j2=jw,K2=U2,X2=Kw,q2=[].unshift(0)!==1,Z2=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(n){return n instanceof TypeError}},Q2=q2||!Z2();z2({target:"Array",proto:!0,arity:1,forced:Q2},{unshift:function(e){var t=Y2(this),s=G2(t),o=arguments.length;if(o){X2(s+o);for(var r=s;r--;){var a=r+o;r in t?t[a]=t[r]:K2(t,a)}for(var l=0;l<o;l++)t[l]=arguments[l]}return j2(t,s+o)}});class J2{constructor(e){this.hot=e,this.commands={},this.commonCallback=null}registerCommand(e,t){this.commands[e]=t}setCommonCallback(e){this.commonCallback=e}execute(e){for(var t=arguments.length,s=new Array(t>1?t-1:0),o=1;o<t;o++)s[o-1]=arguments[o];const r=e.split(":"),a=r[0],l=r.length===2?r[1]:null;let c=this.commands[a];if(!c)throw new Error(`Menu command '${a}' not exists.`);if(l&&c.submenu&&(c=eU(l,c.submenu.items)),c.disabled===!0||typeof c.disabled=="function"&&c.disabled.call(this.hot)===!0||Mt(c,"submenu"))return;const h=[];typeof c.callback=="function"&&h.push(c.callback),typeof this.commonCallback=="function"&&h.push(this.commonCallback),s.unshift(r.join(":")),N(h,u=>u.apply(this.hot,s))}}function eU(n,e){let t;return N(e,s=>{const o=s.key?s.key.split(":"):null;if(Array.isArray(o)&&o[1]===n)return t=s,!1}),t}const Kb=J2,Ln="alignment";function tU(){return{key:Ln,name(){return this.getTranslatedPhrase(Vf)},disabled(){return this.countRows()===0||this.countCols()===0?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${Ln}:left`,name(){let n=this.getTranslatedPhrase($f);return ds(this.getSelectedRange(),(t,s)=>{const o=this.getCellMeta(t,s).className;if(o&&o.indexOf("htLeft")!==-1)return!0})&&(n=Ds(n)),n},callback(){const n=this.getSelectedRange(),e=Ko(n,(o,r)=>this.getCellMeta(o,r).className),t="horizontal",s="htLeft";this.runHooks("beforeCellAlignment",e,n,t,s),oo(n,t,s,(o,r)=>this.getCellMeta(o,r),(o,r,a,l)=>this.setCellMeta(o,r,a,l)),this.render()},disabled:!1},{key:`${Ln}:center`,name(){let n=this.getTranslatedPhrase(Ff);return ds(this.getSelectedRange(),(t,s)=>{const o=this.getCellMeta(t,s).className;if(o&&o.indexOf("htCenter")!==-1)return!0})&&(n=Ds(n)),n},callback(){const n=this.getSelectedRange(),e=Ko(n,(o,r)=>this.getCellMeta(o,r).className),t="horizontal",s="htCenter";this.runHooks("beforeCellAlignment",e,n,t,s),oo(n,t,s,(o,r)=>this.getCellMeta(o,r),(o,r,a,l)=>this.setCellMeta(o,r,a,l)),this.render()},disabled:!1},{key:`${Ln}:right`,name(){let n=this.getTranslatedPhrase(Bf);return ds(this.getSelectedRange(),(t,s)=>{const o=this.getCellMeta(t,s).className;if(o&&o.indexOf("htRight")!==-1)return!0})&&(n=Ds(n)),n},callback(){const n=this.getSelectedRange(),e=Ko(n,(o,r)=>this.getCellMeta(o,r).className),t="horizontal",s="htRight";this.runHooks("beforeCellAlignment",e,n,t,s),oo(n,t,s,(o,r)=>this.getCellMeta(o,r),(o,r,a,l)=>this.setCellMeta(o,r,a,l)),this.render()},disabled:!1},{key:`${Ln}:justify`,name(){let n=this.getTranslatedPhrase(Wf);return ds(this.getSelectedRange(),(t,s)=>{const o=this.getCellMeta(t,s).className;if(o&&o.indexOf("htJustify")!==-1)return!0})&&(n=Ds(n)),n},callback(){const n=this.getSelectedRange(),e=Ko(n,(o,r)=>this.getCellMeta(o,r).className),t="horizontal",s="htJustify";this.runHooks("beforeCellAlignment",e,n,t,s),oo(n,t,s,(o,r)=>this.getCellMeta(o,r),(o,r,a,l)=>this.setCellMeta(o,r,a,l)),this.render()},disabled:!1},{name:We},{key:`${Ln}:top`,name(){let n=this.getTranslatedPhrase(Uf);return ds(this.getSelectedRange(),(t,s)=>{const o=this.getCellMeta(t,s).className;if(o&&o.indexOf("htTop")!==-1)return!0})&&(n=Ds(n)),n},callback(){const n=this.getSelectedRange(),e=Ko(n,(o,r)=>this.getCellMeta(o,r).className),t="vertical",s="htTop";this.runHooks("beforeCellAlignment",e,n,t,s),oo(n,t,s,(o,r)=>this.getCellMeta(o,r),(o,r,a,l)=>this.setCellMeta(o,r,a,l)),this.render()},disabled:!1},{key:`${Ln}:middle`,name(){let n=this.getTranslatedPhrase(zf);return ds(this.getSelectedRange(),(t,s)=>{const o=this.getCellMeta(t,s).className;if(o&&o.indexOf("htMiddle")!==-1)return!0})&&(n=Ds(n)),n},callback(){const n=this.getSelectedRange(),e=Ko(n,(o,r)=>this.getCellMeta(o,r).className),t="vertical",s="htMiddle";this.runHooks("beforeCellAlignment",e,n,t,s),oo(n,t,s,(o,r)=>this.getCellMeta(o,r),(o,r,a,l)=>this.setCellMeta(o,r,a,l)),this.render()},disabled:!1},{key:`${Ln}:bottom`,name(){let n=this.getTranslatedPhrase(Yf);return ds(this.getSelectedRange(),(t,s)=>{const o=this.getCellMeta(t,s).className;if(o&&o.indexOf("htBottom")!==-1)return!0})&&(n=Ds(n)),n},callback(){const n=this.getSelectedRange(),e=Ko(n,(o,r)=>this.getCellMeta(o,r).className),t="vertical",s="htBottom";this.runHooks("beforeCellAlignment",e,n,t,s),oo(n,t,s,(o,r)=>this.getCellMeta(o,r),(o,r,a,l)=>this.setCellMeta(o,r,a,l)),this.render()},disabled:!1}]}}}const _c="clear_column";function nU(){return{key:_c,name(){return this.getTranslatedPhrase(Ef)},callback(n,e){const t=e[0].start.col,s=e[0].end.col;this.countRows()&&this.populateFromArray(0,t,[[null]],Math.max(e[0].start.row,e[0].end.row),s,"ContextMenu.clearColumn")},disabled(){return jo(this)?!this.selection.isSelectedByColumnHeader():!0}}}const aa="col_left";function sU(){return{key:aa,name(){return this.getTranslatedPhrase(wf)},callback(){const n=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,n.col,1,"ContextMenu.columnLeft")},disabled(){return!this.isColumnModificationAllowed()||!jo(this)?!0:this.selection.isSelectedByCorner()?this.countCols()===0:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const la="col_right";function oU(){return{key:la,name(){return this.getTranslatedPhrase(Cf)},callback(){const n=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,n.col,1,"ContextMenu.columnRight")},disabled(){return!this.isColumnModificationAllowed()||!jo(this)?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const ca="make_read_only";function iU(){return{key:ca,name(){let n=this.getTranslatedPhrase(Rf);return ds(this.getSelectedRange(),(t,s)=>this.getCellMeta(t,s).readOnly)&&(n=Ds(n)),n},callback(){const n=this.getSelectedRange(),e=ds(n,(t,s)=>this.getCellMeta(t,s).readOnly);N(n,t=>{t.forAll((s,o)=>{s>=0&&o>=0&&this.setCellMeta(s,o,"readOnly",!e)})}),this.render()},disabled(){return!!(this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const Ic="redo";function rU(){return{key:Ic,name(){return this.getTranslatedPhrase(bf)},callback(){this.redo()},hidden(){const n=this.getPlugin("undoRedo");return!n||!n.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const ha="remove_col";function aU(){return{key:ha,name(){const n=this.getSelected();let e=0;if(n)if(n.length>1)e=1;else{const[,t,,s]=n[0];t-s!==0&&(e=1)}return this.getTranslatedPhrase(Sf,e)},callback(){this.alter("remove_col",DF(this.getSelected()),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed()||!jo(this))return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const Oc="remove_row";function lU(){return{key:Oc,name(){const n=this.getSelected();let e=0;if(n)if(n.length>1)e=1;else{const[t,,s]=n[0];t-s!==0&&(e=1)}return this.getTranslatedPhrase(yf,e)},callback(){this.alter("remove_row",NF(this.getSelected()),1,"ContextMenu.removeRow")},disabled(){if(!jo(this))return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const Ac="row_above";function cU(){return{key:Ac,name(){return this.getTranslatedPhrase(mf)},callback(){const n=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",n.row,1,"ContextMenu.rowAbove")},disabled(){return jo(this)?this.selection.isSelectedByCorner()?this.countRows()===0:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows:!0},hidden(){return!this.getSettings().allowInsertRow}}}const Pc="row_below";function hU(){return{key:Pc,name(){return this.getTranslatedPhrase(pf)},callback(){const n=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",n.row,1,"ContextMenu.rowBelow")},disabled(){return jo(this)?this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows:!0},hidden(){return!this.getSettings().allowInsertRow}}}const ua="no_items";function uU(){return{key:ua,name(){return this.getTranslatedPhrase(gf)},disabled:!0,isCommand:!1}}const Dc="undo";function dU(){return{key:Dc,name(){return this.getTranslatedPhrase(vf)},callback(){this.undo()},hidden(){const n=this.getPlugin("undoRedo");return!n||!n.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const fU=[Ac,Pc,aa,la,_c,Oc,ha,Dc,Ic,ca,Ln,We,ua],gU={[We]:M2,[ua]:uU,[Ac]:cU,[Pc]:hU,[aa]:sU,[la]:oU,[_c]:nU,[Oc]:lU,[ha]:aU,[Dc]:dU,[Ic]:rU,[ca]:iU,[Ln]:tU};function Xb(){const n={};return Be(gU,(e,t)=>{n[t]=e()}),n}class mU{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;this.hot=e,this.predefinedItems=Xb(),this.defaultOrderPattern=t}setPredefinedItems(e){const t={};this.defaultOrderPattern.length=0,Be(e,(s,o)=>{let r="";s.name===We?(t[We]=s,r=We):isNaN(parseInt(o,10))?(s.key=s.key===void 0?o:s.key,t[o]=s,r=s.key):(t[s.key]=s,r=s.key),this.defaultOrderPattern.push(r)}),this.predefinedItems=t}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return pU(e,this.defaultOrderPattern,this.predefinedItems)}}function pU(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const s=[];let o=n;return o&&o.items?o=o.items:Array.isArray(o)||(o=e),Fe(o)?Be(o,(r,a)=>{let l=t[typeof r=="string"?r:a];l||(l=r),Fe(r)?kt(l,r):typeof l=="string"&&(l={name:l}),l.key===void 0&&(l.key=a),s.push(l)}):N(o,(r,a)=>{let l=t[r];!l&&fU.indexOf(r)>=0||(l||(l={name:r,key:`${a}`}),Fe(r)&&kt(l,r),l.key===void 0&&(l.key=a),s.push(l))}),s}const qb=mU;class wU{constructor(e,t){const s=Lr(t),o=vi(t);let r,a,l,c,h,u;this.rootWindow=t,this.type=this.getSourceType(e),this.type==="literal"?(r=parseInt(e.top,10),l=parseInt(e.left,10),h=e.height||0,u=e.width||0,a=r,c=l,r+=s,l+=o):this.type==="event"&&(r=parseInt(e.pageY,10),l=parseInt(e.pageX,10),h=e.target.clientHeight,u=e.target.clientWidth,a=r-s,c=l-o),this.top=r,this.topRelative=a,this.left=l,this.leftRelative=c,this.scrollTop=s,this.scrollLeft=o,this.cellHeight=h,this.cellWidth=u}getSourceType(e){let t="literal";return e instanceof Event&&(t="event"),t}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=t}fitsOnRight(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=t}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}const CU=wU,Zb=215,Qb="menu",yU=Qb;class Nc{constructor(e,t){this.hot=e,this.options=t||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:Zb,container:this.hot.rootDocument.documentElement},this.eventManager=new bt(this),this.container=this.createContainer(this.options.name),this.hotMenu=null,this.hotSubMenus={},this.parentMenu=this.options.parent||null,this.menuItems=null,this.origOutsideClickDeselects=null,this.keyEvent=!1,this.offset={above:0,below:0,left:0,right:0},this._afterScrollCallback=null,this.registerEvents()}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",t=>this.onDocumentMouseDown(t)),this.eventManager.addEventListener(e.document,"contextmenu",t=>this.onDocumentContextMenu(t)),e=Pl(e)}setMenuItems(e){this.menuItems=e}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}setOffset(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.offset[e]=t}isSubMenu(){return this.parentMenu!==null}open(){var e=this;this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const t=Zy(g=>this.openSubMenu(g),300),s=this.options.minWidth||Zb;let o=!1,r=Pn(this.menuItems,g=>(g.key===ua&&(o=!0),D2(g,this.hot)));if(r.length<1&&!o)r.push(Xb()[ua]);else if(r.length===0)return;r=k2(r,We);let a=!1;const l={data:r,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(g){return he(g)&&g<s?s:g},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,maxCols:1,columns:[{data:"name",renderer:(g,p,C,y,b,T)=>this.menuItemRenderer(g,p,C,y,b,T)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",afterOnCellMouseOver:(g,p)=>{this.isAllSubMenusClosed()?t(p.row):this.openSubMenu(p.row)},rowHeights:g=>r[g].name===We?1:23,afterOnCellContextMenu:g=>{g.preventDefault(),pS()&&a&&this.hasSelectedItem()&&this.close(!0)},beforeOnCellMouseUp:g=>{this.hasSelectedItem()&&(a=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(g))},afterOnCellMouseUp:g=>{(!pS()||!Ho(g))&&a&&this.hasSelectedItem()&&(os()||mS()?setTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new Bg(this.container,l),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.addHook("afterSelection",function(){return e.onAfterSelection(...arguments)}),this.hotMenu.init(),this.hotMenu.listen();const c=this.hotMenu.getShortcutManager(),h=c.addContext(yU),f={...{group:Qb},runOnlyIf:g=>$l(g.target)===!1||this.container.contains(g.target)===!1};c.setActiveContextName("menu"),h.addShortcuts([{keys:[["Escape"]],callback:()=>{this.keyEvent=!0,this.close(),this.keyEvent=!1}},{keys:[["ArrowDown"]],callback:()=>{const g=this.hotMenu.getSelectedLast();this.keyEvent=!0,g?this.selectNextCell(g[0],g[1]):this.selectFirstCell(),this.keyEvent=!1}},{keys:[["ArrowUp"]],callback:()=>{const g=this.hotMenu.getSelectedLast();this.keyEvent=!0,g?this.selectPrevCell(g[0],g[1]):this.selectLastCell(),this.keyEvent=!1}},{keys:[["ArrowRight"]],callback:()=>{const g=this.hotMenu.getSelectedLast();if(this.keyEvent=!0,g){const p=this.openSubMenu(g[0]);p&&p.selectFirstCell()}this.keyEvent=!1}},{keys:[["ArrowLeft"]],callback:()=>{const g=this.hotMenu.getSelectedLast();this.keyEvent=!0,g&&this.isSubMenu()&&(this.close(),this.parentMenu&&this.parentMenu.hotMenu.listen()),this.keyEvent=!1}},{keys:[["Enter"]],callback:g=>{const p=this.hotMenu.getSelectedLast();this.keyEvent=!0,this.hotMenu.getSourceDataAtRow(p[0]).submenu||(this.executeCommand(g),this.close(!0)),this.keyEvent=!1}},{keys:[["PageUp"]],callback:()=>{const g=this.hotMenu.getSelectedLast();this.keyEvent=!0,g?this.hotMenu.selection.transformStart(-this.hotMenu.countVisibleRows(),0):this.selectFirstCell(),this.keyEvent=!1}},{keys:[["PageDown"]],callback:()=>{const g=this.hotMenu.getSelectedLast();this.keyEvent=!0,g?this.hotMenu.selection.transformStart(this.hotMenu.countVisibleRows(),0):this.selectLastCell(),this.keyEvent=!1}}],f),this.blockMainTableCallbacks(),this.runLocalHooks("afterOpen")}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.isOpened()&&(e&&this.parentMenu?this.parentMenu.close():(this.closeAllSubMenus(),this.container.style.display="none",this.releaseMainTableCallbacks(),this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.parentMenu&&this.parentMenu.hotMenu.listen()))}openSubMenu(e){if(!this.hotMenu)return!1;const t=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!t||!I2(t))return!1;const s=this.hotMenu.getSourceDataAtRow(e),o=new Nc(this.hot,{parent:this,name:s.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return o.setMenuItems(s.submenu.items),o.open(),o.setPosition(t.getBoundingClientRect()),this.hotSubMenus[s.key]=o,o}closeSubMenu(e){const t=this.hotMenu.getSourceDataAtRow(e),s=this.hotSubMenus[t.key];s&&(s.destroy(),delete this.hotSubMenus[t.key])}closeAllSubMenus(){N(this.hotMenu.getData(),(e,t)=>this.closeSubMenu(t))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const t=this.getSelectedItem();if(this.runLocalHooks("select",t,e),this.isCommandPassive(t))return;const s=this.hot.getSelectedRange(),o=s?_2(s):[];this.runLocalHooks("executeCommand",t.key,o,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",t.key,o,e)}isCommandPassive(e){const{isCommand:t,name:s,disabled:o,submenu:r}=e,a=o===!0||typeof o=="function"&&o.call(this.hot)===!0;return t===!1||s===We||a===!0||r}setPosition(e){const t=new CU(e,this.container.ownerDocument.defaultView);this.options.keepInViewport?(t.fitsBelow(this.container)?this.setPositionBelowCursor(t):t.fitsAbove(this.container)?this.setPositionAboveCursor(t):this.setPositionBelowCursor(t),this.hot.isLtr()?this.setHorizontalPositionForLtr(t):this.setHorizontalPositionForRtl(t)):(this.setPositionBelowCursor(t),this.setPositionOnRightOfCursor(t))}setHorizontalPositionForRtl(e){e.fitsOnLeft(this.container)?this.setPositionOnLeftOfCursor(e):this.setPositionOnRightOfCursor(e)}setHorizontalPositionForLtr(e){e.fitsOnRight(this.container)?this.setPositionOnRightOfCursor(e):this.setPositionOnLeftOfCursor(e)}setPositionAboveCursor(e){let t=this.offset.above+e.top-this.container.offsetHeight;this.isSubMenu()&&(t=e.top+e.cellHeight-this.container.offsetHeight+3),this.container.style.top=`${t}px`}setPositionBelowCursor(e){let t=this.offset.below+e.top+1;this.isSubMenu()&&(t=e.top-1),this.container.style.top=`${t}px`}setPositionOnRightOfCursor(e){let t=e.left;if(this.isSubMenu()){const{right:s}=this.parentMenu.container.getBoundingClientRect();t+=e.cellWidth+s-(e.left+e.cellWidth)}else t+=this.offset.right;this.container.style.left=`${t}px`}setPositionOnLeftOfCursor(e){let t=this.offset.left+e.left-this.container.offsetWidth;if(this.isSubMenu()){const{left:s}=this.parentMenu.container.getBoundingClientRect();t-=e.left-s}this.container.style.left=`${t}px`}selectFirstCell(){const e=this.hotMenu.getCell(0,0);Rc(e)||Ec(e)||xc(e)?this.selectNextCell(0,0):this.hotMenu.selectCell(0,0)}selectLastCell(){const e=this.hotMenu.countRows()-1,t=this.hotMenu.getCell(e,0);Rc(t)||Ec(t)||xc(t)?this.selectPrevCell(e,0):(this.hotMenu.selectCell(e,0,void 0,void 0,!1),this.hotMenu.scrollViewportTo(e,0,!0,!1))}selectNextCell(e,t){const s=e+1,o=s<this.hotMenu.countRows()?this.hotMenu.getCell(s,t):null;o&&(Rc(o)||Ec(o)||xc(o)?this.selectNextCell(s,t):this.hotMenu.selectCell(s,t))}selectPrevCell(e,t){const s=e-1,o=s>=0?this.hotMenu.getCell(s,t):null;o&&(Rc(o)||Ec(o)||xc(o)?this.selectPrevCell(s,t):this.hotMenu.selectCell(s,t))}menuItemRenderer(e,t,s,o,r,a){const l=e.getSourceDataAtRow(s),c=this.hot.rootDocument.createElement("div"),h=C=>Mt(C,"submenu"),u=C=>new RegExp(We,"i").test(C.name),f=C=>C.disabled===!0||typeof C.disabled=="function"&&C.disabled.call(this.hot)===!0,g=C=>C.disableSelection;let p=a;typeof p=="function"&&(p=p.call(this.hot)),ss(t),oe(c,"htItemWrapper"),t.appendChild(c),u(l)?oe(t,"htSeparator"):typeof l.renderer=="function"?(oe(t,"htCustomMenuRenderer"),t.appendChild(l.renderer(e,c,s,o,r,p))):Si(c,p),f(l)?(oe(t,"htDisabled"),this.eventManager.addEventListener(t,"mouseenter",()=>e.deselectCell())):g(l)?(oe(t,"htSelectionDisabled"),this.eventManager.addEventListener(t,"mouseenter",()=>e.deselectCell())):h(l)?(oe(t,"htSubmenu"),g(l)?this.eventManager.addEventListener(t,"mouseenter",()=>e.deselectCell()):this.eventManager.addEventListener(t,"mouseenter",()=>e.selectCell(s,o,void 0,void 0,!1,!1))):(De(t,["htSubmenu","htDisabled"]),g(l)?this.eventManager.addEventListener(t,"mouseenter",()=>e.deselectCell()):this.eventManager.addEventListener(t,"mouseenter",()=>e.selectCell(s,o,void 0,void 0,!1,!1)))}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const t=this.options.container.ownerDocument;let s=e,o;return s&&(ht(s)&&(s=s.call(this.hot),s===null||ct(s)?s="":s=s.toString()),s=s.replace(/[^A-z0-9]/g,"_"),s=`${this.options.className}Sub_${s}`,o=t.querySelector(`.${this.options.className}.${s}`)),o||(o=t.createElement("div"),oe(o,`htMenu ${this.options.className}`),s&&oe(o,s),this.options.container.appendChild(o)),o}blockMainTableCallbacks(){this._afterScrollCallback=function(){},this.hot.addHook("afterScrollVertically",this._afterScrollCallback),this.hot.addHook("afterScrollHorizontally",this._afterScrollCallback)}releaseMainTableCallbacks(){this._afterScrollCallback&&(this.hot.removeHook("afterScrollVertically",this._afterScrollCallback),this.hot.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)}onAfterInit(){const{wtTable:e}=this.hotMenu.view._wt,t=this.hotMenu.getSettings().data,s=e.hider.style,o=e.holder.style,r=parseInt(s.width,10),a=Qt(t,(l,c)=>l+(c.name===We?1:26),0);o.width=`${r+3}px`,o.height=`${a+3}px`,s.height=o.height}onAfterSelection(e,t,s,o,r){this.keyEvent===!1&&(r.value=!0)}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!Oo(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!Oo(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&Ae(e.target,"htCore")&&Oo(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}lt(Nc,gn);const pm=Nc,Hc="contextMenu",SU=70;de.getSingleton().register("afterContextMenuDefaultOptions"),de.getSingleton().register("beforeContextMenuShow"),de.getSingleton().register("afterContextMenuShow"),de.getSingleton().register("afterContextMenuHide"),de.getSingleton().register("afterContextMenuExecute");class kc extends et{static get PLUGIN_KEY(){return Hc}static get PLUGIN_PRIORITY(){return SU}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[Ac,Pc,We,aa,la,We,Oc,ha,We,Dc,Ic,We,ca,We,Ln]}constructor(e){super(e),this.eventManager=new bt(this),this.commandExecutor=new Kb(this.hot),this.itemsFactory=null,this.menu=null}isEnabled(){return!!this.hot.getSettings()[Hc]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[Hc];typeof t.callback=="function"&&this.commandExecutor.setCommonCallback(t.callback),this.menu=new pm(this.hot,{className:"htContextMenu",keepInViewport:!0,container:t.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>this.onMenuBeforeOpen()),this.menu.addLocalHook("afterOpen",()=>this.onMenuAfterOpen()),this.menu.addLocalHook("afterClose",()=>this.onMenuAfterClose()),this.menu.addLocalHook("executeCommand",function(){for(var s=arguments.length,o=new Array(s),r=0;r<s;r++)o[r]=arguments[r];return e.executeCommand.call(e,...o)}),this.addHook("afterOnCellContextMenu",s=>this.onAfterOnCellContextMenu(s)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),super.disablePlugin()}open(e){if(!this.menu||(this.prepareMenuItems(),this.menu.open(),!this.menu.isOpened()))return;let t=0,s=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){const{frameElement:o}=this.hot.rootWindow,{top:r,left:a}=o.getBoundingClientRect();t=r-Lr(e.view),s=a-vi(e.view)}else t=-1*Lr(this.menu.hotMenu.rootWindow),s=-1*vi(this.menu.hotMenu.rootWindow);this.menu.setPosition({top:parseInt(e.pageY,10)+t,left:parseInt(e.pageX,10)+s})}close(){this.menu&&(this.menu.close(),this.itemsFactory=null)}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var t=arguments.length,s=new Array(t>1?t-1:0),o=1;o<t;o++)s[o-1]=arguments[o];this.commandExecutor.execute(e,...s)}prepareMenuItems(){this.itemsFactory=new qb(this.hot,kc.DEFAULT_ITEMS);const e=this.hot.getSettings()[Hc],t={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",t),this.itemsFactory.setPredefinedItems(t.items);const s=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",s),this.menu.setMenuItems(s),N(s,o=>this.commandExecutor.registerCommand(o.key,o))}onAfterOnCellContextMenu(e){const t=this.hot.getSettings(),s=t.rowHeaders,o=t.colHeaders;function r(l){return l.nodeName==="TD"||l.parentNode.nodeName==="TD"}const a=e.target;this.close(),!Ae(a,"handsontableInput")&&(e.preventDefault(),e.stopPropagation(),!(!(s||o)&&!r(a)&&!(Ae(a,"current")&&Ae(a,"wtBorder")))&&this.open(e))}onMenuBeforeOpen(){this.hot.runHooks("beforeContextMenuShow",this)}onMenuAfterOpen(){this.hot.runHooks("afterContextMenuShow",this)}onMenuAfterClose(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}kc.SEPARATOR={name:We};function vU(n){return{key:"copy",name(){return this.getTranslatedPhrase(xf)},callback(){n.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}function bU(n){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),t=e?Math.min(e.getWidth()-1,1):0;return this.getTranslatedPhrase(_f,t)},callback(){n.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}function RU(n){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),t=e?Math.min(e.getWidth()-1,1):0;return this.getTranslatedPhrase(Mf,t)},callback(){n.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}function EU(n){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),t=e?Math.min(e.getWidth()-1,1):0;return this.getTranslatedPhrase(Tf,t)},callback(){n.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}function xU(n){return{key:"cut",name(){return this.getTranslatedPhrase(If)},callback(){n.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}class TU{constructor(){this.data={}}setData(e,t){this.data[e]=t}getData(e){return this.data[e]||void 0}}class MU{constructor(){this.clipboardData=new TU}}class wm{constructor(e){this.rootDocument=e.defaultView?e:e.ownerDocument,this.mainElement=null,this.eventManager=new bt(this),this.listenersCount=new WeakSet,this.container=e}useSecondaryElement(){const e=OU(this.container);this.listenersCount.has(e)||(this.listenersCount.add(e),Jb(this.eventManager,e,this)),this.mainElement=e}setFocusableElement(e){this.listenersCount.has(e)||(this.listenersCount.add(e),Jb(this.eventManager,e,this)),this.mainElement=e}getFocusableElement(){return this.mainElement}focus(){this.mainElement.value=" ",os()||yk(this.mainElement)}}lt(wm,gn);const Lc=new WeakMap;function _U(n){const e=new wm(n);let t=Lc.get(n);return t=isNaN(t)?0:t,Lc.set(n,t+1),e}function IU(n){n.eventManager.clear()}const Cm=(n,e)=>t=>e.runLocalHooks(n,t);function Jb(n,e,t){n.addEventListener(e,"copy",Cm("copy",t)),n.addEventListener(e,"cut",Cm("cut",t)),n.addEventListener(e,"paste",Cm("paste",t))}const Vc=new WeakMap;function OU(n){const e=Vc.get(n);if(e)return e.parentElement||n.appendChild(e),e;const s=(n.defaultView?n:n.ownerDocument).createElement("textarea");return Vc.set(n,s),s.setAttribute("data-hot-input",""),s.className="HandsontableCopyPaste",s.tabIndex=-1,s.autocomplete="off",s.wrap="hard",s.value=" ",n.appendChild(s),s}function eR(n){if(!(n instanceof wm))return;let e=Lc.get(n.container);if(e=isNaN(e)?0:e,e>0&&(e-=1),IU(n),e<=0){e=0;const t=Vc.get(n.container);t&&t.parentNode&&(t.parentNode.removeChild(t),Vc.delete(n.container)),n.mainElement=null}Lc.set(n.container,e)}function tR(n,e){nR(n,e),e.add(n)}function zi(n,e,t){nR(n,e),e.set(n,t)}function nR(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $c(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}function ln(n,e){var t=sR(n,e,"get");return AU(n,t)}function AU(n,e){return e.get?e.get.call(n):e.value}function Yi(n,e,t){var s=sR(n,e,"set");return PU(n,s,t),t}function sR(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function PU(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}var io=new WeakMap,ym=new WeakMap,da=new WeakMap,Sm=new WeakMap,vm=new WeakMap,fa=new WeakMap,Fc=new WeakSet,oR=new WeakSet;class DU{constructor(e){let{countRows:t,countColumns:s,rowsLimit:o,columnsLimit:r,countColumnHeaders:a}=e;tR(this,oR),tR(this,Fc),zi(this,io,{writable:!0,value:void 0}),zi(this,ym,{writable:!0,value:void 0}),zi(this,da,{writable:!0,value:void 0}),zi(this,Sm,{writable:!0,value:void 0}),zi(this,vm,{writable:!0,value:void 0}),zi(this,fa,{writable:!0,value:void 0}),Yi(this,ym,t),Yi(this,da,s),Yi(this,Sm,o),Yi(this,vm,r),Yi(this,fa,a)}setSelectedRange(e){Yi(this,io,e)}getCellsRange(){if(ln(this,ym).call(this)===0||ln(this,da).call(this)===0)return null;const{row:e,col:t}=ln(this,io).getTopStartCorner(),{row:s,col:o}=ln(this,io).getBottomEndCorner(),r=$c(this,oR,NU).call(this,e,s),a=$c(this,Fc,bm).call(this,t,o);return{isRangeTrimmed:s!==r||o!==a,startRow:e,startCol:t,endRow:r,endCol:a}}getMostBottomColumnHeadersRange(){if(ln(this,da).call(this)===0||ln(this,fa).call(this)===0)return null;const{col:e}=ln(this,io).getTopStartCorner(),{col:t}=ln(this,io).getBottomEndCorner(),s=$c(this,Fc,bm).call(this,e,t);return{isRangeTrimmed:t!==s,startRow:-1,startCol:e,endRow:-1,endCol:s}}getAllColumnHeadersRange(){if(ln(this,da).call(this)===0||ln(this,fa).call(this)===0)return null;const{col:e}=ln(this,io).getTopStartCorner(),{col:t}=ln(this,io).getBottomEndCorner(),s=$c(this,Fc,bm).call(this,e,t);return{isRangeTrimmed:t!==s,startRow:-ln(this,fa).call(this),startCol:e,endRow:-1,endCol:s}}}function bm(n,e){return Math.min(e,Math.max(n+ln(this,vm).call(this)-1,n))}function NU(n,e){return Math.min(e,Math.max(n+ln(this,Sm).call(this)-1,n))}function iR(n){const e=[],t=[];return N(n,s=>{const o=Math.min(s.startRow,s.endRow),r=Math.max(s.startRow,s.endRow);Ce(o,r,c=>{e.indexOf(c)===-1&&e.push(c)});const a=Math.min(s.startCol,s.endCol),l=Math.max(s.startCol,s.endCol);Ce(a,l,c=>{t.indexOf(c)===-1&&t.push(c)})}),{rows:e,columns:t}}function HU(n,e){rR(n,e),e.add(n)}function Xo(n,e,t){rR(n,e),e.set(n,t)}function rR(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Gi(n,e,t){return e=kU(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function kU(n){var e=LU(n,"string");return typeof e=="symbol"?e:String(e)}function LU(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function VU(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}function bn(n,e){var t=aR(n,e,"get");return $U(n,t)}function $U(n,e){return e.get?e.get.call(n):e.value}function Ns(n,e,t){var s=aR(n,e,"set");return FU(n,s,t),t}function aR(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function FU(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}de.getSingleton().register("afterCopyLimit"),de.getSingleton().register("modifyCopyableRange"),de.getSingleton().register("beforeCut"),de.getSingleton().register("afterCut"),de.getSingleton().register("beforePaste"),de.getSingleton().register("afterPaste"),de.getSingleton().register("beforeCopy"),de.getSingleton().register("afterCopy");const Bc="copyPaste",BU=80,WU=["fragmentSelection"],lR=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var Rm=new WeakMap,Em=new WeakMap,xm=new WeakMap,ji=new WeakMap,Wc=new WeakMap,Uc=new WeakMap,Ki=new WeakMap,cR=new WeakSet;class UU extends et{constructor(){super(...arguments),HU(this,cR),Gi(this,"columnsLimit",1/0),Gi(this,"rowsLimit",1/0),Gi(this,"pasteMode","overwrite"),Gi(this,"uiContainer",this.hot.rootDocument.body),Xo(this,Rm,{writable:!0,value:!1}),Xo(this,Em,{writable:!0,value:!1}),Xo(this,xm,{writable:!0,value:!1}),Xo(this,ji,{writable:!0,value:"cells-only"}),Xo(this,Wc,{writable:!0,value:!1}),Xo(this,Uc,{writable:!0,value:!1}),Xo(this,Ki,{writable:!0,value:new DU({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})}),Gi(this,"copyableRanges",[]),Gi(this,"focusableElement",void 0)}static get PLUGIN_KEY(){return Bc}static get SETTING_KEYS(){return[Bc,...WU]}static get PLUGIN_PRIORITY(){return BU}isEnabled(){return!!this.hot.getSettings()[Bc]}enablePlugin(){if(this.enabled)return;const{[Bc]:e}=this.hot.getSettings();if(typeof e=="object"){var t,s;this.pasteMode=(t=e.pasteMode)!==null&&t!==void 0?t:this.pasteMode,this.rowsLimit=isNaN(e.rowsLimit)?this.rowsLimit:e.rowsLimit,this.columnsLimit=isNaN(e.columnsLimit)?this.columnsLimit:e.columnsLimit,Ns(this,Rm,!!e.copyColumnHeaders),Ns(this,Em,!!e.copyColumnGroupHeaders),Ns(this,xm,!!e.copyColumnHeadersOnly),this.uiContainer=(s=e.uiContainer)!==null&&s!==void 0?s:this.uiContainer}this.addHook("afterContextMenuDefaultOptions",o=>this.onAfterContextMenuDefaultOptions(o)),this.addHook("afterOnCellMouseUp",()=>this.onAfterOnCellMouseUp()),this.addHook("afterSelectionEnd",()=>this.onAfterSelectionEnd()),this.addHook("beforeKeyDown",()=>this.onBeforeKeyDown()),this.focusableElement=_U(this.uiContainer),this.focusableElement.addLocalHook("copy",o=>this.onCopy(o)).addLocalHook("cut",o=>this.onCut(o)).addLocalHook("paste",o=>this.onPaste(o)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.getOrCreateFocusableElement(),super.updatePlugin()}disablePlugin(){this.focusableElement&&eR(this.focusableElement),super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";Ns(this,ji,e),Ns(this,Wc,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){Ns(this,Uc,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("cut")}getRangedCopyableData(e){return ta(this.getRangedData(e))}getRangedData(e){const t=[],{rows:s,columns:o}=iR(e);return N(s,r=>{const a=[];N(o,l=>{r<0?a.push(this.hot.getColHeader(l,r)):a.push(this.hot.getCopyableData(r,l))}),t.push(a)}),t}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!t)return;const s=new MU;e&&s.clipboardData.setData("text/plain",e),t&&s.clipboardData.setData("text/html",t),this.getOrCreateFocusableElement(),this.onPaste(s)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;bn(this,Ki).setSelectedRange(e);const t=new Map([["headers",null],["cells",null]]);bn(this,ji)==="column-headers-only"?t.set("headers",bn(this,Ki).getMostBottomColumnHeadersRange()):(bn(this,ji)==="with-column-headers"?t.set("headers",bn(this,Ki).getMostBottomColumnHeadersRange()):bn(this,ji)==="with-column-group-headers"&&t.set("headers",bn(this,Ki).getAllColumnHeadersRange()),t.set("cells",bn(this,Ki).getCellsRange())),this.copyableRanges=Array.from(t.values()).filter(o=>o!==null).map(o=>{let{startRow:r,startCol:a,endRow:l,endCol:c}=o;return{startRow:r,startCol:a,endRow:l,endCol:c}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const s=t.get("cells");if(s!==null&&s.isRangeTrimmed){const{startRow:o,startCol:r,endRow:a,endCol:l}=s;this.hot.runHooks("afterCopyLimit",a-o+1,l-r+1,this.rowsLimit,this.columnsLimit)}}getOrCreateFocusableElement(){var e;const t=(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA;t?this.focusableElement.setFocusableElement(t):this.focusableElement.useSecondaryElement()}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const s=e.length,o=e[0].length,r=[],{row:a,col:l}=t.getTopStartCorner(),{row:c,col:h}=t.getBottomEndCorner();let u=a,f=l,g=a,p=l;for(;r.length<s||u<=c;){const{skipRowOnPaste:C,visualRow:y}=this.hot.getCellMeta(u,l);if(u=y+1,C===!0)continue;g=y,f=l;const b=[],T=r.length%s;for(;b.length<o||f<=h;){const{skipColumnOnPaste:M,visualCol:_}=this.hot.getCellMeta(a,f);if(f=_+1,M===!0)continue;p=_;const I=b.length%o;b.push(e[T][I])}r.push(b)}return this.hot.populateFromArray(a,l,r,void 0,void 0,"CopyPaste.paste",this.pasteMode),[a,l,g,p]}onCopy(e){if(!this.hot.isListening()&&!bn(this,Wc)||this.isEditorOpened())return;this.setCopyableText(),Ns(this,Wc,!1);const t=this.getRangedData(this.copyableRanges),s=VU(this,cR,zU).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",t,this.copyableRanges,s)){const r=ta(t);if(e&&e.clipboardData){const a=MS(t,this.hot.rootDocument);e.clipboardData.setData("text/plain",r),e.clipboardData.setData("text/html",[lR,a].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",r);this.hot.runHooks("afterCopy",t,this.copyableRanges,s)}Ns(this,ji,"cells-only"),e.preventDefault()}onCut(e){if(!this.hot.isListening()&&!bn(this,Uc)||this.isEditorOpened())return;this.setCopyableText(),Ns(this,Uc,!1);const t=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",t,this.copyableRanges)){const o=ta(t);if(e&&e.clipboardData){const r=MS(t,this.hot.rootDocument);e.clipboardData.setData("text/plain",o),e.clipboardData.setData("text/html",[lR,r].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",o);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",t,this.copyableRanges)}e.preventDefault()}onPaste(e){if(!this.hot.isListening()||this.isEditorOpened())return;e&&e.preventDefault&&e.preventDefault();let t;if(e&&typeof e.clipboardData<"u"){const l=cd(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});l&&/(<table)|(<TABLE)/g.test(l)?t=nL(l,this.hot.rootDocument).data:t=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(t=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof t=="string"&&(t=LF(t)),t&&t.length===0||this.hot.runHooks("beforePaste",t,this.copyableRanges)===!1)return;const[s,o,r,a]=this.populateValues(t);this.hot.selectCell(s,o,Math.min(this.hot.countRows()-1,r),Math.min(this.hot.countCols()-1,a)),this.hot.runHooks("afterPaste",t,this.copyableRanges)}onAfterContextMenuDefaultOptions(e){e.items.push({name:"---------"},vU(this)),bn(this,Rm)&&e.items.push(EU(this)),bn(this,Em)&&e.items.push(RU(this)),bn(this,xm)&&e.items.push(bU(this)),e.items.push(xU(this))}onAfterOnCellMouseUp(){!this.hot.isListening()||this.isEditorOpened()||this.hot.getSettings().fragmentSelection||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}onAfterSelectionEnd(){this.isEditorOpened()||(this.getOrCreateFocusableElement(),!(this.hot.getSettings().fragmentSelection&&this.focusableElement.getFocusableElement()!==this.hot.rootDocument.activeElement&&mk())&&(this.setCopyableText(),this.focusableElement.focus()))}onBeforeKeyDown(){if(!this.hot.isListening()||this.isEditorOpened())return;const e=this.hot.rootDocument.activeElement,t=this.hot.getActiveEditor();!t||e!==this.focusableElement.getFocusableElement()&&e!==t.select||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}destroy(){this.focusableElement&&(eR(this.focusableElement),this.focusableElement=null),super.destroy()}}function zU(n){const{rows:e}=iR(n);let t=0;for(let s=0;s<e.length&&!(e[s]>=0);s++)t+=1;return{columnHeadersCount:t}}function hR(n,e){return`border_row${n}col${e}`}function ga(){return{width:1,color:"#000"}}function Hs(){return{hide:!0}}function YU(){return{width:1,color:"#000",cornerVisible:!1}}function Tm(n){if(he(n.start)||he(n.left)){var e;n.start=(e=n.start)!==null&&e!==void 0?e:n.left}if(he(n.end)||he(n.right)){var t;n.end=(t=n.end)!==null&&t!==void 0?t:n.right}return delete n.left,delete n.right,n}function ma(n){return he(n.start)&&(n.left=n.start),he(n.end)&&(n.right=n.end),n}function Mm(n,e){return{id:hR(n,e),border:YU(),row:n,col:e,top:Hs(),bottom:Hs(),start:Hs(),end:Hs()}}function GU(n,e){return Mt(e,"border")&&e.border&&(n.border=e.border),Mt(e,"top")&&he(e.top)&&(e.top?(Fe(e.top)||(e.top=ga()),n.top=e.top):(e.top=Hs(),n.top=e.top)),Mt(e,"bottom")&&he(e.bottom)&&(e.bottom?(Fe(e.bottom)||(e.bottom=ga()),n.bottom=e.bottom):(e.bottom=Hs(),n.bottom=e.bottom)),Mt(e,"start")&&he(e.start)&&(e.start?(Fe(e.start)||(e.start=ga()),n.start=e.start):(e.start=Hs(),n.start=e.start)),Mt(e,"end")&&he(e.end)&&(e.end?(Fe(e.end)||(e.end=ga()),n.end=e.end):(e.end=Hs(),n.end=e.end)),n}function ks(n,e){let t=!1;return N(n.getSelectedRange(),s=>{s.forAll((o,r)=>{if(o<0||r<0)return;const a=n.getCellMeta(o,r).borders;if(a)if(e){if(!Mt(a[e],"hide")||a[e].hide===!1)return t=!0,!1}else return t=!0,!1})}),t}function zc(n){return`<span class="selected">${String.fromCharCode(10003)}</span>${n}`}function jU(n){return n.some(e=>he(e.left)||he(e.right))}function KU(n){return n.some(e=>he(e.start)||he(e.end))}const XU=new Map([["left","start"],["right","end"]]);function qU(n){var e;return(e=XU.get(n))!==null&&e!==void 0?e:n}function ZU(n){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(Xf);return ks(this,"bottom")&&(e=zc(e)),e},callback(e,t){const s=ks(this,"bottom");n.prepareBorder(t,"bottom",s)}}}function QU(n){const e=n.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let t=this.getTranslatedPhrase(qf);return ks(this,e)&&(t=zc(t)),t},callback(t,s){const o=ks(this,e);n.prepareBorder(s,e,o)}}}function JU(n){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(Zf)},callback(e,t){n.prepareBorder(t,"noBorders")},disabled(){return!ks(this)}}}function ez(n){const e=n.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let t=this.getTranslatedPhrase(Kf);return ks(this,e)&&(t=zc(t)),t},callback(t,s){const o=ks(this,e);n.prepareBorder(s,e,o)}}}function tz(n){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(jf);return ks(this,"top")&&(e=zc(e)),e},callback(e,t){const s=ks(this,"top");n.prepareBorder(t,"top",s)}}}function nz(n,e,t){return e=sz(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function sz(n){var e=oz(n,"string");return typeof e=="symbol"?e:String(e)}function oz(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const Yc="customBorders",iz=90;class rz extends et{constructor(){super(...arguments),nz(this,"savedBorders",[])}static get PLUGIN_KEY(){return Yc}static get PLUGIN_PRIORITY(){return iz}isEnabled(){return!!this.hot.getSettings()[Yc]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>this.onAfterContextMenuDefaultOptions(e)),this.addHook("init",()=>this.onAfterInit()),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,t){let s=["top","bottom","start","end"],o=null;t&&(this.checkSettingsCohesion([t]),s=Object.keys(t),o=Tm(t));const r=Di(e),a=ea(r);N(e,l=>{const[c,h,u,f]=a(l);for(let g=c;g<=u;g+=1)for(let p=h;p<=f;p+=1)N(s,C=>{this.prepareBorderFromCustomAdded(g,p,o,qU(C))})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const t=Di(e),s=ea(t),o=[];return N(e,r=>{const[a,l,c,h]=s(r);for(let u=a;u<=c;u+=1)for(let f=l;f<=h;f+=1)N(this.savedBorders,g=>{g.row===u&&g.col===f&&o.push(ma(g))})}),o}clearBorders(e){e?this.setBorders(e):(N(this.savedBorders,t=>{this.clearBordersFromSelectionSettings(t.id),this.clearNullCellRange(),this.hot.removeCellMeta(t.row,t.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,t){this.checkSavedBorders(e)||this.savedBorders.push(e);const o=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,o,t)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:o})}prepareBorderFromCustomAdded(e,t,s,o){const r=this.hot.countRows(),a=this.hot.countCols();if(e>=r||t>=a)return;let l=Mm(e,t);s&&(l=GU(l,s),N(this.hot.selection.highlight.customSelections,c=>{if(l.id===c.settings.id)return Object.assign(c.settings,s),l.id=c.settings.id,l.top=c.settings.top,l.bottom=c.settings.bottom,l.start=c.settings.start,l.end=c.settings.end,!1})),this.hot.setCellMeta(e,t,"borders",ma(l)),this.insertBorderIntoSettings(l,o)}prepareBorderFromCustomAddedRange(e,t){const s=Math.min(e.to.row,this.hot.countRows()-1),o=Math.min(e.to.col,this.hot.countCols()-1);Ce(e.from.row,s,r=>{Ce(e.from.col,o,a=>{const l=Mm(r,a);let c=0;r===e.from.row&&Mt(t,"top")&&(c+=1,l.top=t.top),r===e.to.row&&Mt(t,"bottom")&&(c+=1,l.bottom=t.bottom),a===e.from.col&&Mt(t,"start")&&(c+=1,l.start=t.start),a===e.to.col&&Mt(t,"end")&&(c+=1,l.end=t.end),c>0&&(this.hot.setCellMeta(r,a,"borders",ma(l)),this.insertBorderIntoSettings(l))})})}removeAllBorders(e,t){const s=hR(e,t);this.spliceBorder(s),this.clearBordersFromSelectionSettings(s),this.clearNullCellRange(),this.hot.removeCellMeta(e,t,"borders")}setBorder(e,t,s,o){let r=this.hot.getCellMeta(e,t).borders;!r||r.border===void 0?r=Mm(e,t):r=Tm(r),o?(r[s]=Hs(),this.countHide(r)===4?this.removeAllBorders(e,t):(this.checkCustomSelectionsFromContextMenu(r,s,o)||this.insertBorderIntoSettings(r),this.hot.setCellMeta(e,t,"borders",ma(r)))):(r[s]=ga(),this.checkCustomSelectionsFromContextMenu(r,s,o)||this.insertBorderIntoSettings(r),this.hot.setCellMeta(e,t,"borders",ma(r)))}prepareBorder(e,t,s){N(e,o=>{let{start:r,end:a}=o;if(r.row===a.row&&r.col===a.col)t==="noBorders"?this.removeAllBorders(r.row,r.col):this.setBorder(r.row,r.col,t,s);else switch(t){case"noBorders":Ce(r.col,a.col,l=>{Ce(r.row,a.row,c=>{this.removeAllBorders(c,l)})});break;case"top":Ce(r.col,a.col,l=>{this.setBorder(r.row,l,t,s)});break;case"bottom":Ce(r.col,a.col,l=>{this.setBorder(a.row,l,t,s)});break;case"start":Ce(r.row,a.row,l=>{this.setBorder(l,r.col,t,s)});break;case"end":Ce(r.row,a.row,l=>{this.setBorder(l,a.col,t,s)});break}})}createCustomBorders(e){N(e,t=>{const s=Tm(t);t.range?this.prepareBorderFromCustomAddedRange(t.range,s):this.prepareBorderFromCustomAdded(t.row,t.col,s)})}countHide(e){const{top:t,bottom:s,start:o,end:r}=e;return Qt([t,s,o,r],(l,c)=>{let h=l;return c&&c.hide&&(h+=1),h},0)}clearBordersFromSelectionSettings(e){const t=$e(this.hot.selection.highlight.customSelections,s=>s.settings.id).indexOf(e);t>-1&&this.hot.selection.highlight.customSelections[t].clear()}clearNullCellRange(){N(this.hot.selection.highlight.customSelections,(e,t)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[t].destroy(),this.hot.selection.highlight.customSelections.splice(t,1),!1})}hideBorders(){N(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const t=$e(this.savedBorders,s=>s.id).indexOf(e);t>-1&&this.savedBorders.splice(t,1)}checkSavedBorders(e){let t=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),t=!0):N(this.savedBorders,(o,r)=>{if(e.id===o.id)return this.savedBorders[r]=e,t=!0,!1}),t}checkCustomSelectionsFromContextMenu(e,t,s){let o=!1;return N(this.hot.selection.highlight.customSelections,r=>{if(e.id===r.settings.id)return Be(r.instanceBorders,a=>{a.toggleHiddenClass(t,s)}),o=!0,!1}),o}checkCustomSelections(e,t,s){const o=this.countHide(e);let r=!1;return o===4?(this.removeAllBorders(e.row,e.col),r=!0):N(this.hot.selection.highlight.customSelections,a=>{if(e.id===a.settings.id)return a.visualCellRange=t,a.commit(),s&&Be(a.instanceBorders,l=>{l.changeBorderStyle(s,e)}),r=!0,!1}),r}changeBorderSettings(){const e=this.hot.getSettings()[Yc];if(Array.isArray(e)){const t=rn(e);this.checkSettingsCohesion(t),t.length||(this.savedBorders=t),this.createCustomBorders(t)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const t=jU(e),s=KU(e);if(t&&s)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&t)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}onAfterContextMenuDefaultOptions(e){this.hot.getSettings()[Yc]&&e.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(Gf)},disabled(){return this.selection.isSelectedByCorner()},submenu:{items:[tz(this),ez(this),ZU(this),QU(this),JU(this)]}})}onAfterInit(){this.changeBorderSettings()}destroy(){super.destroy()}}const uR="dragToScroll",az=100;class lz extends et{static get PLUGIN_KEY(){return uR}static get PLUGIN_PRIORITY(){return az}constructor(e){super(e),this.eventManager=new bt(this),this.boundaries=null,this.callback=null,this.listening=!1}isEnabled(){return!!this.hot.getSettings()[uR]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>this.setupListening(e)),this.addHook("afterOnCellCornerMouseDown",e=>this.setupListening(e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(e){this.boundaries=e}setCallback(e){this.callback=e}check(e,t){let s=0,o=0;t<this.boundaries.top?o=t-this.boundaries.top:t>this.boundaries.bottom&&(o=t-this.boundaries.bottom),e<this.boundaries.left?s=e-this.boundaries.left:e>this.boundaries.right&&(s=e-this.boundaries.right),this.callback(s,o)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let t=e;for(;t;)this.eventManager.addEventListener(t.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(t.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(t.document,"mousemove",s=>this.onMouseMove(s)),t=Pl(t)}unregisterEvents(){this.eventManager.clear()}setupListening(e){if(Ho(e))return;const t=this.hot.view._wt.wtTable.holder;t!==this.hot.rootWindow&&(this.setBoundaries(t.getBoundingClientRect()),this.setCallback((s,o)=>{s<0?t.scrollLeft-=50:s>0&&(t.scrollLeft+=50),o<0?t.scrollTop-=20:o>0&&(t.scrollTop+=20)}),this.listen())}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}de.getSingleton().register("afterDropdownMenuDefaultOptions"),de.getSingleton().register("beforeDropdownMenuShow"),de.getSingleton().register("afterDropdownMenuShow"),de.getSingleton().register("afterDropdownMenuHide"),de.getSingleton().register("afterDropdownMenuExecute");const _m="dropdownMenu",cz=230,Im="changeType";class Gc extends et{static get PLUGIN_KEY(){return _m}static get PLUGIN_PRIORITY(){return cz}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[aa,la,We,ha,We,_c,We,ca,We,Ln]}constructor(e){super(e),this.eventManager=new bt(this),this.commandExecutor=new Kb(this.hot),this.itemsFactory=null,this.menu=null,this.hot.addHook("afterGetColHeader",(t,s)=>this.onAfterGetColHeader(t,s))}isEnabled(){return this.hot.getSettings()[_m]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new qb(this.hot,Gc.DEFAULT_ITEMS);const t=this.hot.getSettings()[_m],s={items:this.itemsFactory.getItems(t)};this.registerEvents(),typeof t.callback=="function"&&this.commandExecutor.setCommonCallback(t.callback),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",s),this.itemsFactory.setPredefinedItems(s.items);const o=this.itemsFactory.getItems(t);this.menu&&this.menu.destroy(),this.menu=new pm(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:t.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",o),this.menu.setMenuItems(o),this.menu.addLocalHook("beforeOpen",()=>this.onMenuBeforeOpen()),this.menu.addLocalHook("afterOpen",()=>this.onMenuAfterOpen()),this.menu.addLocalHook("afterClose",()=>this.onMenuAfterClose()),this.menu.addLocalHook("executeCommand",function(){for(var r=arguments.length,a=new Array(r),l=0;l<r;l++)a[l]=arguments[l];return e.executeCommand.call(e,...a)}),N(o,r=>this.commandExecutor.registerCommand(r.key,r))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),super.disablePlugin()}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>this.onTableClick(e))}open(e){this.menu&&(this.menu.open(),e.width&&this.menu.setOffset("left",e.width),this.menu.setPosition(e))}close(){this.menu&&this.menu.close()}executeCommand(e){for(var t=arguments.length,s=new Array(t>1?t-1:0),o=1;o<t;o++)s[o-1]=arguments[o];this.commandExecutor.execute(e,...s)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}onTableClick(e){if(e.stopPropagation(),Ae(e.target,Im)&&!this.menu.isOpened()){let t=0,s=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){const{frameElement:r}=this.hot.rootWindow,{top:a,left:l}=r.getBoundingClientRect();t=a,s=l}const o=e.target.getBoundingClientRect();this.open({left:o.left+s,top:o.top+e.target.offsetHeight+3+t,width:o.width,height:o.height})}}onAfterGetColHeader(e,t){const s=t.parentNode;if(!s)return;const o=s.parentNode.childNodes,r=Array.prototype.indexOf.call(o,s);if(e<0||r!==o.length-1)return;const a=t.querySelector(`.${Im}`);if(this.enabled&&a)return;if(!this.enabled){a&&a.parentNode.removeChild(a);return}const l=this.hot.rootDocument.createElement("button");l.className=Im,l.type="button",l.onclick=function(){return!1},t.firstChild.insertBefore(l,t.firstChild.firstChild)}onMenuBeforeOpen(){this.hot.runHooks("beforeDropdownMenuShow",this)}onMenuAfterOpen(){this.hot.runHooks("afterDropdownMenuShow",this)}onMenuAfterClose(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}Gc.SEPARATOR={name:We};class hz{constructor(e){this.hot=e,this.options={}}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:t,endRow:s,endCol:o}=this._getDataRange(),r=this.options,a=[];return Ce(e,s,l=>{const c=[];!r.exportHiddenRows&&this._isHiddenRow(l)||(Ce(t,o,h=>{!r.exportHiddenColumns&&this._isHiddenColumn(h)||c.push(this.hot.getDataAtCell(l,h))}),a.push(c))}),a}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:t,endRow:s}=this._getDataRange(),o=this.hot.getRowHeader();Ce(t,s,r=>{!this.options.exportHiddenRows&&this._isHiddenRow(r)||e.push(o[r])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:t,endCol:s}=this._getDataRange(),o=this.hot.getColHeader();Ce(t,s,r=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(r)||e.push(o[r])})}return e}_getDataRange(){const e=this.hot.countCols()-1,t=this.hot.countRows()-1;let[s=0,o=0,r=t,a=e]=this.options.range;return s=Math.max(s,0),o=Math.max(o,0),r=Math.min(r,t),a=Math.min(a,e),{startRow:s,startCol:o,endRow:r,endCol:a}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}const uz=hz;class Om{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,t){this.dataProvider=e,this.options=this._mergeOptions(t),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let t=dn(this.constructor.DEFAULT_OPTIONS);const s=new Date;return t=kt(dn(Om.DEFAULT_OPTIONS),t),t=kt(t,e),t.filename=zy(t.filename,{YYYY:s.getFullYear(),MM:`${s.getMonth()+1}`.padStart(2,"0"),DD:`${s.getDate()}`.padStart(2,"0")}),t}}const dz=Om,fz=String.fromCharCode(13),gz=String.fromCharCode(34),mz=String.fromCharCode(10);class pz extends dz{static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}export(){const e=this.options,t=this.dataProvider.getData();let s=this.dataProvider.getColumnHeaders();const o=s.length>0,r=this.dataProvider.getRowHeaders(),a=r.length>0;let l=e.bom?String.fromCharCode(65279):"";return o&&(s=$e(s,c=>this._escapeCell(c,!0)),a&&(l+=e.columnDelimiter),l+=s.join(e.columnDelimiter),l+=e.rowDelimiter),N(t,(c,h)=>{h>0&&(l+=e.rowDelimiter),a&&(l+=this._escapeCell(r[h])+e.columnDelimiter),l+=c.map(u=>this._escapeCell(u)).join(e.columnDelimiter)}),l}_escapeCell(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=At(e);return s!==""&&(t||s.indexOf(fz)>=0||s.indexOf(gz)>=0||s.indexOf(mz)>=0||s.indexOf(this.options.columnDelimiter)>=0)&&(s=s.replace(new RegExp('"',"g"),'""'),s=`"${s}"`),s}}const wz=pz,Am={["csv"]:wz};function Cz(n,e,t){return typeof Am[n]=="function"?new Am[n](e,t):null}const yz="exportFile",Sz=240;class vz extends et{static get PLUGIN_KEY(){return yz}static get PLUGIN_PRIORITY(){return Sz}isEnabled(){return!0}exportAsString(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,t).export()}exportAsBlob(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,t))}downloadFile(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:s,rootWindow:o}=this.hot,r=this._createTypeFormatter(e,t),a=this._createBlob(r),l=o.URL||o.webkitURL,c=s.createElement("a"),h=`${r.options.filename}.${r.options.fileExtension}`;if(c.download!==void 0){const u=l.createObjectURL(a);c.style.display="none",c.setAttribute("href",u),c.setAttribute("download",h),s.body.appendChild(c),c.dispatchEvent(new MouseEvent("click")),s.body.removeChild(c),setTimeout(()=>{l.revokeObjectURL(u)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(a,h)}_createTypeFormatter(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Am[e])throw new Error(`Export format type "${e}" is not supported.`);return Cz(e,new uz(this.hot),t)}_createBlob(e){let t=null;return typeof Blob<"u"&&(t=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),t}}class dR{constructor(e,t){let{id:s,stateless:o=!0}=t;this.hot=e,this.id=s,this.elements=[],this.hidden=!1,this.stateId=`Filters.component.${this.id}`,this.state=o?null:this.hot.columnIndexMapper.registerMap(this.stateId,new Zl)}reset(){N(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),N(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}lt(dR,gn);const jc=dR,pa={};function ro(n,e){if(!pa[n])throw Error(`Filter condition "${n}" does not exist.`);const{condition:t,descriptor:s}=pa[n];let o=e;return s.inputValuesDecorator&&(o=s.inputValuesDecorator(o)),function(r){return t.apply(r.meta.instance,[].concat([r],[o]))}}function qo(n){if(!pa[n])throw Error(`Filter condition "${n}" does not exist.`);return pa[n].descriptor}function Pt(n,e,t){t.key=n,pa[n]={condition:e,descriptor:t}}const Wt="none";function bz(){return!0}Pt(Wt,bz,{name:sc,inputsCount:0,showOperators:!1});const wa="empty";function Rz(n){return Vt(n.value)}Pt(wa,Rz,{name:og,inputsCount:0,showOperators:!0});const Kc="not_empty";function Ez(n,e){return!ro(wa,e)(n)}Pt(Kc,Ez,{name:ig,inputsCount:0,showOperators:!0});const Ca="eq";function xz(n,e){let[t]=e;return At(n.value).toLocaleLowerCase(n.meta.locale)===At(t)}Pt(Ca,xz,{name:rg,inputsCount:1,showOperators:!0});const Xc="neq";function Tz(n,e){return!ro(Ca,e)(n)}Pt(Xc,Tz,{name:ag,inputsCount:1,showOperators:!0});const fR="gt";function Mz(n,e){let[t]=e,s=t;return n.meta.type==="numeric"&&(s=parseFloat(s,10)),n.value>s}Pt(fR,Mz,{name:dg,inputsCount:1,showOperators:!0});const gR="gte";function _z(n,e){let[t]=e,s=t;return n.meta.type==="numeric"&&(s=parseFloat(s,10)),n.value>=s}Pt(gR,_z,{name:fg,inputsCount:1,showOperators:!0});const mR="lt";function Iz(n,e){let[t]=e,s=t;return n.meta.type==="numeric"&&(s=parseFloat(s,10)),n.value<s}Pt(mR,Iz,{name:gg,inputsCount:1,showOperators:!0});const pR="lte";function Oz(n,e){let[t]=e,s=t;return n.meta.type==="numeric"&&(s=parseFloat(s,10)),n.value<=s}Pt(pR,Oz,{name:mg,inputsCount:1,showOperators:!0});const Pm="date_after";function Az(n,e){let[t]=e;const s=ne(n.value,n.meta.dateFormat),o=ne(t,n.meta.dateFormat);return!s.isValid()||!o.isValid()?!1:s.diff(o)>=0}Pt(Pm,Az,{name:Cg,inputsCount:1,showOperators:!0});const Dm="date_before";function Pz(n,e){let[t]=e;const s=ne(n.value,n.meta.dateFormat),o=ne(t,n.meta.dateFormat);return!s.isValid()||!o.isValid()?!1:s.diff(o)<=0}Pt(Dm,Pz,{name:yg,inputsCount:1,showOperators:!0});const qc="between";function Dz(n,e){let[t,s]=e,o=t,r=s;if(n.meta.type==="numeric"){const a=parseFloat(o,10),l=parseFloat(r,10);o=Math.min(a,l),r=Math.max(a,l)}else if(n.meta.type==="date"){const a=ro(Dm,[r]),l=ro(Pm,[o]);return a(n)&&l(n)}return n.value>=o&&n.value<=r}Pt(qc,Dz,{name:pg,inputsCount:2,showOperators:!0});const wR="not_between";function Nz(n,e){return!ro(qc,e)(n)}Pt(wR,Nz,{name:wg,inputsCount:2,showOperators:!0});const CR="begins_with";function Hz(n,e){let[t]=e;return At(n.value).toLocaleLowerCase(n.meta.locale).startsWith(At(t))}Pt(CR,Hz,{name:lg,inputsCount:1,showOperators:!0});const yR="ends_with";function kz(n,e){let[t]=e;return At(n.value).toLocaleLowerCase(n.meta.locale).endsWith(At(t))}Pt(yR,kz,{name:cg,inputsCount:1,showOperators:!0});const Nm="contains";function Lz(n,e){let[t]=e;return At(n.value).toLocaleLowerCase(n.meta.locale).indexOf(At(t))>=0}Pt(Nm,Lz,{name:hg,inputsCount:1,showOperators:!0});const SR="not_contains";function Vz(n,e){return!ro(Nm,e)(n)}Pt(SR,Vz,{name:ug,inputsCount:1,showOperators:!0});const vR="date_tomorrow";function $z(n){const e=ne(n.value,n.meta.dateFormat);return e.isValid()?e.isSame(ne().subtract(-1,"days").startOf("day"),"d"):!1}Pt(vR,$z,{name:vg,inputsCount:0});const bR="date_today";function Fz(n){const e=ne(n.value,n.meta.dateFormat);return e.isValid()?e.isSame(ne().startOf("day"),"d"):!1}Pt(bR,Fz,{name:Sg,inputsCount:0});const RR="date_yesterday";function Bz(n){const e=ne(n.value,n.meta.dateFormat);return e.isValid()?e.isSame(ne().subtract(1,"days").startOf("day"),"d"):!1}Pt(RR,Bz,{name:bg,inputsCount:0}),iV();function Wz(n,e){let t=n;return t===""&&(t=`(${e})`),t}const Hm=new Set([1]).has(1),Uz=Hm&&typeof Array.from=="function";function ya(n){let e=n;return Hm&&(e=new Set(e)),function(t){let s;return Hm?s=e.has(t):s=!!~e.indexOf(t),s}}function ER(n){return n??""}function km(n){let e=n;return Uz?e=Array.from(new Set(e)):e=Hy(e),e=e.sort((t,s)=>typeof t=="number"&&typeof s=="number"?t-s:t===s?0:t>s?1:-1),e}function xR(n,e,t,s){const o=[],r=n===e;let a;return r||(a=ya(e)),N(n,l=>{let c=!1;(r||a(l))&&(c=!0);const h={checked:c,value:l,visualValue:Wz(l,t)};s&&s(h),o.push(h)}),o}const Zo="by_value";function zz(n,e){let[t]=e;return t(n.value)}Pt(Zo,zz,{name:"By value",inputsCount:0,inputValuesDecorator(n){let[e]=n;return[ya(e)]},showOperators:!1});const Sa={};function Yz(n){if(!Sa[n])throw Error(`Operation with id "${n}" does not exist.`);const e=Sa[n].func;return function(t,s){return e(t,s)}}function Gz(n){return Sa[n].name}function Lm(n,e,t){Sa[n]={name:e,func:t}}const ao="conjunction",jz=xg;function Kz(n,e){return n.every(t=>t.func(e))}Lm(ao,jz,Kz);const Zc="disjunction",Xz=oc;function qz(n,e){return n.some(t=>t.func(e))}Lm(Zc,Xz,qz);const Vm="disjunctionWithExtraCondition",Zz=oc;function Qz(n,e){if(n.length<3)throw Error("Operation doesn't work on less then three conditions.");return n.slice(0,n.length-1).some(t=>t.func(e))&&n[n.length-1].func(e)}Lm(Vm,Zz,Qz);const Jz="numeric",TR="text",eY="date",MR={[Jz]:[Wt,We,wa,Kc,We,Ca,Xc,We,fR,gR,mR,pR,qc,wR],[TR]:[Wt,We,wa,Kc,We,Ca,Xc,We,CR,yR,We,Nm,SR],[eY]:[Wt,We,wa,Kc,We,Ca,Xc,We,Dm,Pm,qc,We,vR,bR,RR]};function tY(n){const e=[];let t=n;return MR[t]||(t=TR),N(MR[t],s=>{let o;s===We?o={name:We}:o=dn(qo(s)),e.push(o)}),e}const $m="built",Fm="building",_R=["click","input","keydown","keypress","keyup","focus","blur","change"];let IR=class Z0{static get DEFAULTS(){return dn({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,t){this.hot=e,this.eventManager=new bt(this),this.options=kt(Z0.DEFAULTS,t),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName),this.buildState=null}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===Fm?this._element:this.buildState===$m?(this.update(),this._element):(this.buildState=Fm,this.build(),this.buildState=$m,this._element)}isBuilt(){return this.buildState===$m}translateIfPossible(e){return typeof e=="string"&&e.startsWith(an)?this.hot.getTranslatedPhrase(e):e}build(){const e=(t,s)=>{this.eventManager.addEventListener(t,s,o=>this.runLocalHooks(s,o,this))};if(this.buildState||(this.buildState=Fm),this.options.className&&oe(this._element,this.options.className),this.options.children.length)N(this.options.children,t=>this._element.appendChild(t.element));else if(this.options.wrapIt){const t=this.hot.rootDocument.createElement(this.options.tagName);Be(this.options,(s,o)=>{t[o]!==void 0&&o!=="className"&&o!=="tagName"&&o!=="children"&&(t[o]=this.translateIfPossible(s))}),this._element.appendChild(t),N(_R,s=>e(t,s))}else N(_R,t=>e(this._element,t))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};lt(IR,gn);const lo=IR,Qc=new WeakMap;class Bm extends lo{static get DEFAULTS(){return dn({placeholder:"",type:"text",tagName:"input"})}constructor(e,t){super(e,kt(Bm.DEFAULTS,t)),Qc.set(this,{}),this.registerHooks()}registerHooks(){this.addLocalHook("click",()=>this.onClick()),this.addLocalHook("keyup",e=>this.onKeyup(e))}build(){super.build();const e=Qc.get(this),t=this.hot.rootDocument.createElement("div");e.input=this._element.firstChild,oe(this._element,"htUIInput"),oe(t,"htUIInputIcon"),this._element.appendChild(t),this.update()}update(){if(!this.isBuilt())return;const e=Qc.get(this).input;e.type=this.options.type,e.placeholder=this.translateIfPossible(this.options.placeholder),e.value=this.translateIfPossible(this.options.value)}focus(){this.isBuilt()&&Qc.get(this).input.focus()}onClick(){}onKeyup(e){this.options.value=e.target.value}}const Xi=Bm,Jc=new WeakMap;class Wm extends lo{static get DEFAULTS(){return dn({className:"htUISelect",wrapIt:!1})}constructor(e,t){super(e,kt(Wm.DEFAULTS,t)),Jc.set(this,{}),this.menu=null,this.items=[],this.registerHooks()}registerHooks(){this.addLocalHook("click",()=>this.onClick())}setItems(e){this.items=this.translateNames(e),this.menu&&this.menu.setMenuItems(this.items)}translateNames(e){return N(e,t=>{t.name=this.translateIfPossible(t.name)}),e}build(){super.build(),this.menu=new pm(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer}),this.menu.setMenuItems(this.items);const e=new lo(this.hot,{className:"htUISelectCaption"}),t=new lo(this.hot,{className:"htUISelectDropdown"}),s=Jc.get(this);s.caption=e,s.captionElement=e.element,s.dropdown=t,N([e,t],o=>this._element.appendChild(o.element)),this.menu.addLocalHook("select",o=>this.onMenuSelect(o)),this.menu.addLocalHook("afterClose",()=>this.onMenuClosed()),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=this.menu.hot.getTranslatedPhrase(sc),Jc.get(this).captionElement.textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();this.menu&&(this.menu.open(),this.menu.setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}))}closeOptions(){this.menu&&this.menu.close()}onMenuSelect(e){e.name!==We&&(this.options.value=e,this.update(),this.runLocalHooks("select",this.options.value))}onMenuClosed(){this.runLocalHooks("afterClose")}onClick(){this.openOptions()}destroy(){this.menu&&(this.menu.destroy(),this.menu=null);const{caption:e,dropdown:t}=Jc.get(this);e&&e.destroy(),t&&t.destroy(),super.destroy()}}const OR=Wm;class nY extends jc{constructor(e,t){super(e,{id:t.id,stateless:!1}),this.name=t.name,this.addSeparator=t.addSeparator,this.elements.push(new OR(this.hot,{menuContainer:t.menuContainer})),this.elements.push(new Xi(this.hot,{placeholder:Ag})),this.elements.push(new Xi(this.hot,{placeholder:Pg})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>this.onConditionSelect(e)),this.getSelectElement().addLocalHook("afterClose",()=>this.onSelectUIClosed()),N(this.getInputElements(),e=>{e.addLocalHook("keydown",t=>this.onInputKeyDown(t))})}setState(e){if(this.reset(),!e)return;const t=dn(e.command);t.name.startsWith(Rt)&&(t.name=this.hot.getTranslatedPhrase(t.name)),this.getSelectElement().setValue(t),N(e.args,(s,o)=>{if(o>t.inputsCount-1)return!1;const r=this.getInputElement(o);r.setValue(s),r[t.inputsCount>o?"show":"hide"](),o||setTimeout(()=>r.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||qo(Wt),t=[];return N(this.getInputElements(),(s,o)=>{e.inputsCount>o&&t.push(s.getValue())}),{command:e,args:t}}updateState(e,t){const s=qo(e?e.name:Wt);this.state.setValueAtIndex(t,{command:s,args:e?e.args:[]}),e||N(this.getInputElements(),o=>o.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof OR)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof Xi)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t,s,o,r,a)=>{oe(t.parentNode,"htFiltersMenuCondition"),this.addSeparator&&oe(t.parentNode,"border");const l=this.hot.rootDocument.createElement("div");return oe(l,"htFiltersMenuLabel"),l.textContent=a,t.appendChild(l),t.parentNode.hasAttribute("ghost-table")||N(this.elements,c=>t.appendChild(c.element)),t}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let t=[qo(Wt)];if(e!==null){const{visualIndex:s}=e;t=tY(this.hot.getDataType(0,s,this.hot.countRows(),s))}N(this.getInputElements(),s=>s.hide()),this.getSelectElement().setItems(t),super.reset(),this.getSelectElement().setValue(t[0])}onConditionSelect(e){N(this.getInputElements(),(t,s)=>{t[e.inputsCount>s?"show":"hide"](),s===0&&setTimeout(()=>t.focus(),10)}),this.runLocalHooks("change",e)}onSelectUIClosed(){this.runLocalHooks("afterClose")}onInputKeyDown(e){Wr(e.keyCode,"ENTER")?(this.runLocalHooks("accept"),is(e)):Wr(e.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),is(e))}}const Um=nY,eh=new WeakMap;class zm extends lo{static get DEFAULTS(){return dn({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,t){super(e,kt(zm.DEFAULTS,t)),eh.set(this,{})}build(){super.build();const e=eh.get(this);e.input=this._element.firstChild;const t=this.hot.rootDocument.createElement("label");t.textContent=this.translateIfPossible(this.options.label.textContent),t.htmlFor=this.translateIfPossible(this.options.label.htmlFor),e.label=t,this._element.appendChild(t),this.update()}update(){if(!this.isBuilt())return;const e=eh.get(this);e.input.checked=this.options.checked,e.label.textContent=this.translateIfPossible(this.options.label.textContent)}isChecked(){return this.options.checked}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.options.checked=e,this.update()}focus(){this.isBuilt()&&eh.get(this).input.focus()}}const AR=zm,PR=0;class sY extends jc{constructor(e,t){super(e,{id:t.id,stateless:!1}),this.name=t.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t)=>(oe(t.parentNode,"htFiltersMenuOperators"),t.parentNode.hasAttribute("ghost-table")||N(this.elements,s=>t.appendChild(s.element)),t)}}buildOperatorsElement(){const e=[ao,Zc];N(e,t=>{const s=new AR(this.hot,{name:"operator",label:{htmlFor:t,textContent:Gz(t)},value:t,checked:t===e[PR],id:t});s.addLocalHook("change",o=>this.onRadioInputChange(o)),this.elements.push(s)})}setChecked(e){if(this.elements.length<e)throw Error(rt`Radio button with index ${e} doesn't exist.`);N(this.elements,(t,s)=>{t.setChecked(s===e)})}getActiveOperationId(){const e=this.elements.find(t=>t instanceof AR&&t.isChecked());return e?e.getValue():ao}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&N(this.elements,t=>{t.setChecked(t.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ao,t=arguments.length>1?arguments[1]:void 0,s=e;s===Vm&&(s=Zc),this.state.setValueAtIndex(t,s)}reset(){this.setChecked(PR)}onRadioInputChange(e){this.setState(e.target.value)}}const oY=sY,Ym=new WeakMap;class Gm extends lo{static get DEFAULTS(){return dn({href:"#",tagName:"a"})}constructor(e,t){super(e,kt(Gm.DEFAULTS,t)),Ym.set(this,{})}build(){super.build();const e=Ym.get(this);e.link=this._element.firstChild}update(){this.isBuilt()&&(Ym.get(this).link.textContent=this.translateIfPossible(this.options.textContent))}}const DR=Gm,iY=new WeakMap,rY="multipleSelect.itemBox";class jm extends lo{static get DEFAULTS(){return dn({className:"htUIMultipleSelect",value:[]})}constructor(e,t){super(e,kt(jm.DEFAULTS,t)),iY.set(this,{}),this.searchInput=new Xi(this.hot,{placeholder:Og,className:"htUIMultipleSelectSearch"}),this.selectAllUI=new DR(this.hot,{textContent:Tg,className:"htUISelectAll"}),this.clearAllUI=new DR(this.hot,{textContent:Mg,className:"htUIClearAll"}),this.items=[],this.itemsBox=null,this.registerHooks()}registerHooks(){this.searchInput.addLocalHook("keydown",e=>this.onInputKeyDown(e)),this.searchInput.addLocalHook("input",e=>this.onInput(e)),this.selectAllUI.addLocalHook("click",e=>this.onSelectAllClick(e)),this.clearAllUI.addLocalHook("click",e=>this.onClearAllClick(e))}setItems(e){this.items=e,this.itemsBox&&this.itemsBox.loadData(this.items)}setLocale(e){this.locale=e}getLocale(){return this.locale}getItems(){return[...this.items]}getValue(){return lY(this.items)}isSelectedAllValues(){return this.items.length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,t=e.createElement("div"),s=new lo(this.hot,{className:"htUISelectionControls",children:[this.selectAllUI,this.clearAllUI]});this._element.appendChild(this.searchInput.element),this._element.appendChild(s.element),this._element.appendChild(t);const o=r=>{if(!this._element)return;this.itemsBox&&this.itemsBox.destroy(),oe(r,"htUIMultipleSelectHot"),this.itemsBox=new this.hot.constructor(r,{data:this.items,columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(c,h,u,f,g,p)=>{c.title=p.instance.getDataAtRowProp(h,p.label.property)},maxCols:1,autoWrapCol:!0,height:110,colWidths:()=>this.itemsBox.container.scrollWidth-Ft(e),copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:this.hot.isRtl()?"rtl":"ltr"}),this.itemsBox.init(),this.itemsBox.getShortcutManager().getContext("grid").addShortcut({keys:[["Escape"]],callback:c=>{this.runLocalHooks("keydown",c,this)},group:rY})};o(t),setTimeout(()=>o(t),100)}reset(){this.searchInput.reset(),this.selectAllUI.reset(),this.clearAllUI.reset()}update(){this.isBuilt()&&(this.itemsBox.loadData(aY(this.items,this.options.value)),super.update())}destroy(){this.itemsBox&&this.itemsBox.destroy(),this.searchInput.destroy(),this.clearAllUI.destroy(),this.selectAllUI.destroy(),this.searchInput=null,this.clearAllUI=null,this.selectAllUI=null,this.itemsBox=null,this.items=null,super.destroy()}onInput(e){const t=e.target.value.toLocaleLowerCase(this.getLocale());let s;t===""?s=[...this.items]:s=Pn(this.items,o=>`${o.value}`.toLocaleLowerCase(this.getLocale()).indexOf(t)>=0),this.itemsBox.loadData(s)}onInputKeyDown(e){this.runLocalHooks("keydown",e,this),Qy(Wr,e.keyCode)("ARROW_DOWN|TAB")&&!this.itemsBox.isListening()&&(is(e),this.itemsBox.listen(),this.itemsBox.selectCell(0,0))}onSelectAllClick(e){const t=[];e.preventDefault(),N(this.itemsBox.getSourceData(),(s,o)=>{s.checked=!0,t.push(yv(s,o)[0])}),this.itemsBox.setSourceDataAtCell(t)}onClearAllClick(e){const t=[];e.preventDefault(),N(this.itemsBox.getSourceData(),(s,o)=>{s.checked=!1,t.push(yv(s,o)[0])}),this.itemsBox.setSourceDataAtCell(t)}}const NR=jm;function aY(n,e){const t=ya(e);return $e(n,s=>(s.checked=t(s.value),s))}function lY(n){const e=[];return N(n,t=>{t.checked&&e.push(t.value)}),e}class cY extends jc{constructor(e,t){super(e,{id:t.id,stateless:!1}),this.name=t.name,this.elements.push(new NR(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>this.onInputKeyDown(e))}setState(e){if(this.reset(),e&&e.command.key===Zo){const t=this.getMultipleSelectElement();t.setItems(e.itemsSnapshot),t.setValue(e.args[0]),t.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),t=e.getItems();return{command:{key:e.isSelectedAllValues()||!t.length?Wt:Zo},args:[e.getValue()],itemsSnapshot:t}}updateState(e){const t=(s,o,r,a,l)=>{const[c]=Pn(o,f=>f.name===Zo),h={},u=this.hot.getTranslatedPhrase(ic);if(c){const f=km($e(a(s,l),y=>y.value));r&&(c.args[0]=r);const g=[],p=xR(f,c.args[0],u,y=>{y.checked&&g.push(y.value)}),C=e.editedConditionStack.column;h.locale=this.hot.getCellMeta(0,C).locale,h.args=[g],h.command=qo(Zo),h.itemsSnapshot=p}else h.args=[],h.command=qo(Wt);this.state.setValueAtIndex(s,h)};t(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&t(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof NR)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t,s,o,r,a)=>{oe(t.parentNode,"htFiltersMenuValue");const l=this.hot.rootDocument.createElement("div");return oe(l,"htFiltersMenuLabel"),l.textContent=a,t.appendChild(l),t.parentNode.hasAttribute("ghost-table")||N(this.elements,c=>t.appendChild(c.element)),t}}}reset(){const e=this.hot.getTranslatedPhrase(ic),t=km(this._getColumnVisibleValues()),s=xR(t,t,e);this.getMultipleSelectElement().setItems(s),super.reset(),this.getMultipleSelectElement().setValue(t);const o=this.hot.getPlugin("filters").getSelectedColumn();o!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,o.visualIndex).locale)}onInputKeyDown(e){Wr(e.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),is(e))}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:$e(this.hot.getDataAtCol(e.visualIndex),t=>ER(t))}}const hY=cY;class va extends jc{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,t){super(e,{id:t.id,stateless:!0}),this.name=t.name,this.elements.push(new Xi(this.hot,{type:"button",value:_g,className:"htUIButton htUIButtonOK",identifier:va.BUTTON_OK})),this.elements.push(new Xi(this.hot,{type:"button",value:Ig,className:"htUIButton htUIButtonCancel",identifier:va.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){N(this.elements,e=>{e.addLocalHook("click",(t,s)=>this.onButtonClick(t,s))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t)=>(oe(t.parentNode,"htFiltersMenuActionBar"),t.parentNode.hasAttribute("ghost-table")||N(this.elements,s=>t.appendChild(s.element)),t)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}onButtonClick(e,t){t.options.identifier===va.BUTTON_OK?this.accept():this.cancel()}}const uY=va,HR="ConditionCollection.filteringStates";class kR{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.hot=e,this.isMapRegistrable=t,this.filteringStates=new Zl,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(HR,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,t){var s;const o=this.filteringStates.getValueAtIndex(t),r=(s=o==null?void 0:o.conditions)!==null&&s!==void 0?s:[],a=o==null?void 0:o.operation;return this.isMatchInConditions(r,e,a)}isMatchInConditions(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ao;return e.length?Yz(s)(e,t):!0}addCondition(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ao,o=arguments.length>3?arguments[3]:void 0;const r=this.hot.getCellMeta(0,e).locale,a=$e(t.args,u=>typeof u=="string"?u.toLocaleLowerCase(r):u),l=t.name||t.command.key;this.runLocalHooks("beforeAdd",e);const c=this.getOperation(e);if(c){if(c!==s)throw Error(rt`The column of index ${e} has been already applied with a \`${c}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(ct(Sa[s]))throw new Error(rt`Unexpected operation named \`${s}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const h=this.getConditions(e);h.length===0?this.filteringStates.setValueAtIndex(e,{operation:s,conditions:[{name:l,args:a,func:ro(l,a)}]},o):h.push({name:l,args:a,func:ro(l,a)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var t,s;return(t=(s=this.filteringStates.getValueAtIndex(e))===null||s===void 0?void 0:s.conditions)!==null&&t!==void 0?t:[]}getOperation(e){var t;return(t=this.filteringStates.getValueAtIndex(e))===null||t===void 0?void 0:t.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[t]=e;return t})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return Qt(this.filteringStates.getEntries(),(e,t)=>{let[s,{operation:o,conditions:r}]=t;return e.push({column:s,operation:o,conditions:$e(r,a=>{let{name:l,args:c}=a;return{name:l,args:c}})}),e},[])}importAllConditions(e){this.clean(),N(e,t=>{N(t.conditions,s=>this.addCondition(t.column,s))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,t){const s=this.getConditions(e);return t?s.some(o=>o.name===t):s.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(HR),this.filteringStates=null,this.clearLocalHooks()}}lt(kR,gn);const LR=kR;class dY{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];this.conditionCollection=e,this.columnDataFactory=t}filter(){let e=[];return N(this.conditionCollection.getFilteredColumns(),(t,s)=>{let o=this.columnDataFactory(t);s&&(o=this._getIntersectData(o,e)),e=this.filterByColumn(t,o)}),e}filterByColumn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const s=[];return N(t,o=>{o!==void 0&&this.conditionCollection.isMatch(o,e)&&s.push(o)}),s}_getIntersectData(e,t){const s=[];return N(t,o=>{const r=o.meta.visualRow;e[r]!==void 0&&(s[r]=e[r])}),s}}const VR=dY;class $R{constructor(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];this.hot=e,this.conditionCollection=t,this.columnDataFactory=s,this.changes=[],this.grouping=!1,this.latestEditedColumnPosition=-1,this.latestOrderStack=[],this.conditionCollection.addLocalHook("beforeRemove",o=>this._onConditionBeforeModify(o)),this.conditionCollection.addLocalHook("afterRemove",o=>this.updateStatesAtColumn(o)),this.conditionCollection.addLocalHook("afterAdd",o=>this.updateStatesAtColumn(o)),this.conditionCollection.addLocalHook("beforeClean",()=>this._onConditionBeforeClean()),this.conditionCollection.addLocalHook("afterClean",()=>this._onConditionAfterClean())}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,N(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}_onConditionBeforeModify(e){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(e)}updateStatesAtColumn(e,t){var s=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const o=this.conditionCollection.exportAllConditions();let r=this.conditionCollection.getColumnStackPosition(e);r===-1&&(r=this.latestEditedColumnPosition);const a=o.slice(0,r),l=o.slice(r);l.length&&l[0].column===e&&l.shift();const c=vk(function(u,f){let g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const p=new LR(s.hot,!1),C=[].concat(u,g);p.importAllConditions(C);const y=s.columnDataFactory(f);let b;p.isEmpty()?b=y:b=new VR(p,M=>s.columnDataFactory(M)).filter(),b=$e(b,M=>M.meta.visualRow);const T=ya(b);return p.destroy(),Pn(y,M=>T(M.meta.visualRow))})(a),h=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:h},dependentConditionStacks:l,filteredRowsFactory:c,conditionArgsChange:t})}_onConditionBeforeClean(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}_onConditionAfterClean(){N(this.latestOrderStack,e=>{this.updateStatesAtColumn(e)})}destroy(){this.clearLocalHooks(),Be(this,(e,t)=>{this[t]=null})}}lt($R,gn);const fY=$R,FR="filters",gY=250;class mY extends et{static get PLUGIN_KEY(){return FR}static get PLUGIN_PRIORITY(){return gY}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){super(e),this.eventManager=new bt(this),this.dropdownMenuPlugin=null,this.conditionCollection=null,this.conditionUpdateObserver=null,this.components=new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]]),this.filtersRowsMap=null,this.hot.addHook("afterGetColHeader",(t,s)=>this.onAfterGetColHeader(t,s))}isEnabled(){return!!this.hot.getSettings()[FR]}enablePlugin(){if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new Xr),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const e=this.hot.getSettings().dropdownMenu,t=e&&e.uiContainer||this.hot.rootDocument.body,s=a=>(a.addLocalHook("accept",()=>this.onActionBarSubmit("accept")),a.addLocalHook("cancel",()=>this.onActionBarSubmit("cancel")),a.addLocalHook("change",l=>this.onComponentChange(a,l)),a),o=()=>`${this.hot.getTranslatedPhrase(Rg)}:`,r=()=>`${this.hot.getTranslatedPhrase(Eg)}:`;if(!this.components.get("filter_by_condition")){const a=new Um(this.hot,{id:"filter_by_condition",name:o,addSeparator:!1,menuContainer:t});a.addLocalHook("afterClose",()=>this.onSelectUIClosed()),this.components.set("filter_by_condition",s(a))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new oY(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const a=new Um(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:t});a.addLocalHook("afterClose",()=>this.onSelectUIClosed()),this.components.set("filter_by_condition2",s(a))}this.components.get("filter_by_value")||this.components.set("filter_by_value",s(new hY(this.hot,{id:"filter_by_value",name:r}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",s(new uY(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new LR(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new fY(this.hot,this.conditionCollection,a=>this.getDataMapAtColumn(a)),this.conditionUpdateObserver.addLocalHook("update",a=>this.updateComponents(a))),this.components.forEach(a=>a.show()),this.addHook("beforeDropdownMenuSetItems",a=>this.onBeforeDropdownMenuSetItems(a)),this.addHook("afterDropdownMenuDefaultOptions",a=>this.onAfterDropdownMenuDefaultOptions(a)),this.addHook("afterDropdownMenuShow",()=>this.onAfterDropdownMenuShow()),this.addHook("afterDropdownMenuHide",()=>this.onAfterDropdownMenuHide()),this.addHook("afterChange",a=>this.onAfterChange(a)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((t,s)=>{t.destroy(),this.components.set(s,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}super.disablePlugin()}addCondition(e,t,s){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:ao;const r=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(r,{command:{key:t},args:s},o)}removeConditions(e){const t=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(t)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const t=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(t)}}filter(){const e=this._createDataFilter(),t=!this.conditionCollection.isEmpty();let s=[];const o=this.conditionCollection.exportAllConditions();if(this.hot.runHooks("beforeFilter",o)!==!1)if(t){const a=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),s=$e(e.filter(),c=>c.meta.visualRow);const l=ya(s);Ce(this.hot.countSourceRows()-1,c=>{l(c)||a.push(c)}),N(a,c=>{this.filtersRowsMap.setValueAtIndex(c,!0)})},!0),s.length||this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",o),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.clearColumnSelection()}getSelectedColumn(){var e;const t=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return t?{visualIndex:t.col,physicalIndex:this.hot.toPhysicalColumn(t.col)}:null}clearColumnSelection(){const e=this.getSelectedColumn();e!==null&&this.hot.selectCell(0,e.visualIndex)}getDataMapAtColumn(e){const t=this.hot.toVisualColumn(e),s=[];return N(this.hot.getSourceDataAtCol(t),(o,r)=>{var a;const{row:l,col:c,visualCol:h,visualRow:u,type:f,instance:g,dateFormat:p,locale:C}=this.hot.getCellMeta(r,t),y=(a=this.hot.getDataAtCell(this.hot.toVisualRow(r),t))!==null&&a!==void 0?a:o;s.push({meta:{row:l,col:c,visualCol:h,visualRow:u,type:f,instance:g,dateFormat:p,locale:C},value:ER(y)})}),s}onAfterChange(e){e&&N(e,t=>{const[,s]=t,o=this.hot.propToCol(s);this.conditionCollection.hasConditions(o)&&this.updateValueComponentCondition(o)})}updateValueComponentCondition(e){const t=this.hot.getDataAtCol(e),s=km(t);this.conditionUpdateObserver.updateStatesAtColumn(e,s)}restoreComponents(e){var t;const s=(t=this.getSelectedColumn())===null||t===void 0?void 0:t.physicalIndex;e.forEach(o=>{o.isHidden()||o.restoreState(s)}),this.updateDependentComponentsVisibility()}onAfterDropdownMenuShow(){this.restoreComponents(Array.from(this.components.values()))}onAfterDropdownMenuHide(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}onBeforeDropdownMenuSetItems(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.menu.addLocalHook("afterOpen",()=>{this.dropdownMenuPlugin.menu.hotMenu.updateSettings({hiddenRows:!0})})}onAfterDropdownMenuDefaultOptions(e){e.items.push({name:We}),this.components.forEach(t=>{e.items.push(t.getMenuItemDescriptor())})}getOperationBasedOnArguments(e,t,s,o){let r=e;return r===Zc&&t.command.key!==Wt&&s.command.key!==Wt&&o.command.key!==Wt?r=Vm:o.command.key!==Wt&&(t.command.key===Wt||s.command.key===Wt)&&(r=ao),r}onActionBarSubmit(e){var t;if(e==="accept"){const o=this.getSelectedColumn();if(o===null){var s;(s=this.dropdownMenuPlugin)===null||s===void 0||s.close();return}const{physicalIndex:r}=o,a=this.components.get("filter_by_condition").getState(),l=this.components.get("filter_by_condition2").getState(),c=this.components.get("filter_by_value").getState(),h=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),a,l,c);this.conditionUpdateObserver.groupChanges();let u=this.conditionCollection.getColumnStackPosition(r);u===-1&&(u=void 0),this.conditionCollection.removeConditions(r),a.command.key!==Wt&&(this.conditionCollection.addCondition(r,a,h,u),l.command.key!==Wt&&this.conditionCollection.addCondition(r,l,h,u)),c.command.key!==Wt&&this.conditionCollection.addCondition(r,c,h,u),this.conditionUpdateObserver.flush(),this.components.forEach(f=>f.saveState(r)),this.filtersRowsMap.clear(),this.filter()}(t=this.dropdownMenuPlugin)===null||t===void 0||t.close()}onComponentChange(e,t){this.updateDependentComponentsVisibility(),e.constructor===Um&&!t.inputsCount&&this.setListeningDropdownMenu()}onSelectUIClosed(){this.setListeningDropdownMenu()}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:t}=e.getState(),s=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];t.showOperators?this.showComponents(...s):this.hideComponents(...s)}onAfterGetColHeader(e,t){const s=this.hot.toPhysicalColumn(e);this.enabled&&this.conditionCollection.hasConditions(s)?oe(t,"htFiltersActive"):De(t,"htFiltersActive")}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new VR(e,t=>this.getDataMapAtColumn(t))}updateComponents(e){var t;if(!((t=this.dropdownMenuPlugin)!==null&&t!==void 0&&t.enabled))return;const{editedConditionStack:{conditions:s,column:o}}=e,r=s.filter(l=>l.name===Zo),a=s.filter(l=>l.name!==Zo);if(r.length>=2||a.length>=3)ut(rt`The filter conditions have been applied properly, but couldnâ€™t be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const l=this.conditionCollection.getOperation(o);this.components.get("filter_by_condition").updateState(a[0],o),this.components.get("filter_by_condition2").updateState(a[1],o),this.components.get("filter_operators").updateState(l,o),this.components.get("filter_by_value").updateState(e)}}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const t=this.dropdownMenuPlugin.menu;for(var s=arguments.length,o=new Array(s),r=0;r<s;r++)o[r]=arguments[r];return N(o,a=>{N(t.menuItems,(l,c)=>{l.key===a.getMenuItemDescriptor().key&&e.push(c)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const s=this.dropdownMenuPlugin.menu.hotMenu,o=s.getPlugin("hiddenRows");for(var r=arguments.length,a=new Array(r>1?r-1:0),l=1;l<r;l++)a[l-1]=arguments[l];const c=this.getIndexesOfComponents(...a);e?o.showRows(c):o.hideRows(c),s.render()}hideComponents(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];this.changeComponentsVisibility(!1,...t)}showComponents(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];this.changeComponentsVisibility(!0,...t)}destroy(){this.enabled&&(this.components.forEach((e,t)=>{e!==null&&(e.destroy(),this.components.set(t,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}const BR="internal-use-in-handsontable",Km={licenseKey:BR,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function WR(n){var e;return{maxColumns:n.maxColumns,maxRows:n.maxRows,language:(e=n[en])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function UR(n){return Object.keys(n).reduce((e,t)=>(t!=="hyperformula"&&(e[t]=n[t]),e),{})}function pY(n){var e;const t=n[en],s=UR(t!=null&&(e=t.engine)!==null&&e!==void 0&&e.hyperformula?t.engine:{}),o=WR(n);return{...Km,...s,...o}}function wY(n){var e;const t=n[en],s=UR(t!=null&&(e=t.engine)!==null&&e!==void 0&&e.hyperformula?t.engine:{}),o=WR(n);return{...s,...o}}function CY(n,e){return Object.keys(e).some(t=>e[t]!==void 0&&e[t]!==n[t])}function th(){const n="engine_relationship",e=Nn(en);return e.hasItem(n)||e.register(n,new Map),e.getItem(n)}function Xm(){const n="shared_engine_usage",e=Nn(en);return e.hasItem(n)||e.register(n,new Map),e.getItem(n)}function yY(n){const e=n.getSettings(),t=e[en],s=t==null?void 0:t.engine;if(t===!0||ct(s))return null;if(typeof s.hyperformula=="function"||typeof s=="function"){var o;return SY((o=s.hyperformula)!==null&&o!==void 0?o:s,e,n)}else if(typeof s=="object"&&ct(s.hyperformula)){const r=th(),a=Xm().get(s);return r.has(s)||r.set(s,[]),r.get(s).push(n),a&&a.push(n.guid),s.getConfig().licenseKey||s.updateConfig({licenseKey:BR}),(s.getConfig().leapYear1900!==Km.leapYear1900||md(s.getConfig().nullDate,Km.nullDate)===!1)&&ut(rt`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),s}return null}function SY(n,e,t){const s=e[en],o=pY(e),r=th(),a=Xm();vY(n,s.functions),bY(n,s.language);const l=n.buildEmpty(o);return r.set(l,[t]),a.set(l,[t.guid]),RY(l,s.namedExpressions),l.on("sheetAdded",()=>{l.rebuildAndRecalculate()}),l.on("sheetRemoved",()=>{l.rebuildAndRecalculate()}),l}function zR(n){var e;const t=th(),s=t.size===0?[]:Array.from((e=t.get(n))!==null&&e!==void 0?e:[]);return new Map(s.map(o=>[o.getPlugin("formulas").sheetId,o]))}function YR(n,e){if(n){const t=th(),s=t.get(n),o=Xm(),r=o.get(n);s&&s.includes(e)&&(s.splice(s.indexOf(e),1),s.length===0&&t.delete(n)),r&&r.includes(e.guid)&&(r.splice(r.indexOf(e.guid),1),r.length===0&&(o.delete(n),n.destroy()))}}function vY(n,e){e&&e.forEach(t=>{const{name:s,plugin:o,translations:r}=t;try{n.registerFunction(s,o,r)}catch(a){ut(a.message)}})}function bY(n,e){if(e){const{langCode:t}=e;try{n.registerLanguage(t,e)}catch(s){ut(s.message)}}}function RY(n,e){e&&(n.suspendEvaluation(),e.forEach(t=>{const{name:s,expression:o,scope:r,options:a}=t;try{n.addNamedExpression(s,o,r,a)}catch(l){ut(l.message)}}),n.resumeEvaluation())}function EY(n,e){return(ct(e)||!n.doesSheetExist(e))&&(e=n.addSheet(e)),e}const GR="DD/MM/YYYY";function jR(n){return typeof n=="string"&&n.charAt(0)==="'"&&n.charAt(1)==="="}function xY(n){return jR(n)?n.substr(1):n}function TY(n){return typeof n=="string"&&n.startsWith("=")}function qm(n,e){return typeof n=="string"&&e==="date"}function KR(n,e){return ne(n,e,!0).isValid()}function XR(n,e){return ne(n,e,!0).format(GR)}function MY(n,e){return ne(n,GR,!0).format(e)}function qR(n,e){const s=new Date(Date.UTC(0,0,n+-1));return ne(s).format(e)}function Qo(n,e,t){_Y(n,e),e.set(n,t)}function _Y(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mt(n,e){var t=ZR(n,e,"get");return IY(n,t)}function IY(n,e){return e.get?e.get.call(n):e.value}function co(n,e,t){var s=ZR(n,e,"set");return OY(n,s,t),t}function ZR(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function OY(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}var ba=new WeakMap,ho=new WeakMap,Rn=new WeakMap,nh=new WeakMap,Zm=new WeakMap,Qm=new WeakMap,sh=new WeakMap;class AY{constructor(e,t,s){Qo(this,ba,{writable:!0,value:void 0}),Qo(this,ho,{writable:!0,value:void 0}),Qo(this,Rn,{writable:!0,value:void 0}),Qo(this,nh,{writable:!0,value:[]}),Qo(this,Zm,{writable:!0,value:[]}),Qo(this,Qm,{writable:!0,value:void 0}),Qo(this,sh,{writable:!0,value:[]}),co(this,ba,e),co(this,ho,t),co(this,Rn,s)}setRemovedHfIndexes(e){return co(this,sh,e.map(t=>{const s=mt(this,ho).getVisualFromPhysicalIndex(t);return this.getHfIndexFromVisualIndex(s)})),mt(this,sh)}getRemovedHfIndexes(){return mt(this,sh)}getHfIndexFromVisualIndex(e){const t=mt(this,ho).getIndexesSequence(),s=mt(this,ho).getNotTrimmedIndexes();return t.indexOf(s[e])}syncMoves(e){const s=`move${jn(mt(this,ba))}s`;mt(this,Rn).getEngine().batch(()=>{e.forEach(o=>{const r=o.from!==o.to,a=o.from+1!==o.to;r&&a&&mt(this,Rn).getEngine()[s](mt(this,Rn).getSheetId(),o.from,1,o.to)})})}storeMovesInformation(e,t,s){s!==!1&&(co(this,Zm,e.map(o=>this.getHfIndexFromVisualIndex(o))),co(this,Qm,this.getHfIndexFromVisualIndex(t)))}getMoveLine(e,t){const s=mt(this,ho).getNumberOfIndexes(),o=Array.from(Array(s).keys()).filter(a=>e.includes(a)===!1);if(t===0){var r;return(r=o[t])!==null&&r!==void 0?r:0}return o[t-1]+1}getInitiallyCalculatedMoves(e,t){let s=this.getMoveLine(e,t);const o=[];return e.forEach(r=>{const a={from:r,to:s};o.forEach(l=>{const c=l.from>l.to,h=l.to<=a.from;l.from>a.from&&h&&c&&(a.from+=1)}),a.from>=s&&(s+=1),o.push(a)}),o}adjustedCalculatedMoves(e){return e.forEach((t,s)=>{e.slice(s+1).forEach(r=>{const a=r.from<r.to;r.from>t.from&&a&&(r.from-=1)})}),e}calculateAndSyncMoves(e,t){if(mt(this,Rn).isPerformingUndoRedo()||e===!1||t===!1)return;const s=this.adjustedCalculatedMoves(this.getInitiallyCalculatedMoves(mt(this,Zm),mt(this,Qm)));mt(this,Rn).getSheetId()===null?mt(this,Rn).getPostponeAction(()=>this.syncMoves(s)):this.syncMoves(s)}getIndexesChangeSyncMethod(){const e=`set${jn(mt(this,ba))}Order`;return t=>{if(mt(this,Rn).isPerformingUndoRedo())return;const s=mt(this,ho).getIndexesSequence();if(t==="update"){const o=mt(this,nh).map(c=>s.indexOf(c)),r=mt(this,Rn).getEngine().getSheetDimensions(mt(this,Rn).getSheetId());let a;mt(this,ba)==="row"?a=r.height:a=r.width;const l=o.length;for(let c=l;c<a;c+=1)o.push(c);mt(this,Rn).getEngine()[e](mt(this,Rn).getSheetId(),o)}co(this,nh,s)}}init(){co(this,nh,mt(this,ho).getIndexesSequence())}}const QR=AY;function Jo(n,e,t){PY(n,e),e.set(n,t)}function PY(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ls(n,e){var t=JR(n,e,"get");return DY(n,t)}function DY(n,e){return e.get?e.get.call(n):e.value}function ei(n,e,t){var s=JR(n,e,"set");return NY(n,s,t),t}function JR(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function NY(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}var oh=new WeakMap,ih=new WeakMap,Jm=new WeakMap,ep=new WeakMap,tp=new WeakMap,np=new WeakMap,sp=new WeakMap;class HY{constructor(e,t,s){Jo(this,oh,{writable:!0,value:void 0}),Jo(this,ih,{writable:!0,value:void 0}),Jo(this,Jm,{writable:!0,value:void 0}),Jo(this,ep,{writable:!0,value:!1}),Jo(this,tp,{writable:!0,value:!1}),Jo(this,np,{writable:!0,value:null}),Jo(this,sp,{writable:!0,value:null}),ei(this,oh,new QR("row",e,this)),ei(this,ih,new QR("column",t,this)),ei(this,Jm,s)}getForAxis(e){return e==="row"?Ls(this,oh):Ls(this,ih)}setPerformUndo(e){ei(this,ep,e)}setPerformRedo(e){ei(this,tp,e)}isPerformingUndoRedo(){return Ls(this,ep)||Ls(this,tp)}getSheetId(){return Ls(this,sp)}getEngine(){return Ls(this,np)}getPostponeAction(){return Ls(this,Jm)}setupSyncEndpoint(e,t){ei(this,np,e),ei(this,sp,t),Ls(this,oh).init(),Ls(this,ih).init()}}const kY=HY;function qi(n,e,t){return e=LY(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function LY(n){var e=VY(n,"string");return typeof e=="symbol"?e:String(e)}function VY(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function op(n,e,t){$Y(n,e),e.set(n,t)}function $Y(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function uo(n,e,t){var s=e0(n,e,"set");return FY(n,s,t),t}function FY(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}function Zi(n,e){var t=e0(n,e,"get");return BY(n,t)}function e0(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function BY(n,e){return e.get?e.get.call(n):e.value}const en="formulas",WY=["maxRows","maxColumns","language"],UY=260;de.getSingleton().register("afterNamedExpressionAdded"),de.getSingleton().register("afterNamedExpressionRemoved"),de.getSingleton().register("afterSheetAdded"),de.getSingleton().register("afterSheetRemoved"),de.getSingleton().register("afterSheetRenamed"),de.getSingleton().register("afterFormulasValuesUpdate");const Qi=n=>n==="UndoRedo.undo"||n==="UndoRedo.redo"||n==="auto";var Vs=new WeakMap,ip=new WeakMap,Ra=new WeakMap;class zY extends et{constructor(){var e;super(...arguments),e=this,op(this,Vs,{writable:!0,value:!1}),op(this,ip,{writable:!0,value:!1}),op(this,Ra,{writable:!0,value:[["valuesUpdated",function(){return e.onEngineValuesUpdated(...arguments)}],["namedExpressionAdded",function(){return e.onEngineNamedExpressionsAdded(...arguments)}],["namedExpressionRemoved",function(){return e.onEngineNamedExpressionsRemoved(...arguments)}],["sheetAdded",function(){return e.onEngineSheetAdded(...arguments)}],["sheetRenamed",function(){return e.onEngineSheetRenamed(...arguments)}],["sheetRemoved",function(){return e.onEngineSheetRemoved(...arguments)}]]}),qi(this,"staticRegister",Nn("formulas")),qi(this,"engine",null),qi(this,"sheetName",null),qi(this,"indexSyncer",null),qi(this,"rowAxisSyncer",null),qi(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return en}static get PLUGIN_PRIORITY(){return UY}static get SETTING_KEYS(){return[en,...WY]}get sheetId(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}isEnabled(){return!!this.hot.getSettings()[en]}enablePlugin(){var e,t=this;if(!this.enabled){if(this.engine=(e=yY(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){ut("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const s=this.addSheet(this.sheetName,this.hot.getSourceDataArray());s!==!1&&(this.sheetName=s)}this.addHook("beforeLoadData",function(){return t.onBeforeLoadData(...arguments)}),this.addHook("afterLoadData",function(){return t.onAfterLoadData(...arguments)}),this.addHook("beforeUpdateData",function(){return t.onBeforeLoadData(...arguments)}),this.addHook("afterUpdateData",function(){return t.onAfterLoadData(...arguments)}),this.addHook("modifyData",function(){return t.onModifyData(...arguments)}),this.addHook("modifySourceData",function(){return t.onModifySourceData(...arguments)}),this.addHook("beforeValidate",function(){return t.onBeforeValidate(...arguments)}),this.addHook("afterSetSourceDataAtCell",function(){return t.onAfterSetSourceDataAtCell(...arguments)}),this.addHook("afterSetDataAtCell",function(){return t.onAfterSetDataAtCell(...arguments)}),this.addHook("afterSetDataAtRowProp",function(){return t.onAfterSetDataAtCell(...arguments)}),this.addHook("beforeCreateRow",function(){return t.onBeforeCreateRow(...arguments)}),this.addHook("beforeCreateCol",function(){return t.onBeforeCreateCol(...arguments)}),this.addHook("afterCreateRow",function(){return t.onAfterCreateRow(...arguments)}),this.addHook("afterCreateCol",function(){return t.onAfterCreateCol(...arguments)}),this.addHook("beforeRemoveRow",function(){return t.onBeforeRemoveRow(...arguments)}),this.addHook("beforeRemoveCol",function(){return t.onBeforeRemoveCol(...arguments)}),this.addHook("afterRemoveRow",function(){return t.onAfterRemoveRow(...arguments)}),this.addHook("afterRemoveCol",function(){return t.onAfterRemoveCol(...arguments)}),this.indexSyncer=new kY(this.hot.rowIndexMapper,this.hot.columnIndexMapper,s=>{this.hot.addHookOnce("init",()=>{s()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(s,o,r,a)=>{this.rowAxisSyncer.storeMovesInformation(s,o,a)}),this.hot.addHook("beforeColumnMove",(s,o,r,a)=>{this.columnAxisSyncer.storeMovesInformation(s,o,a)}),this.hot.addHook("afterRowMove",(s,o,r,a,l)=>{this.rowAxisSyncer.calculateAndSyncMoves(a,l)}),this.hot.addHook("afterColumnMove",(s,o,r,a,l)=>{this.columnAxisSyncer.calculateAndSyncMoves(a,l)}),this.hot.addHook("beforeColumnFreeze",(s,o)=>{this.columnAxisSyncer.storeMovesInformation([s],this.hot.getSettings().fixedColumnsStart,o)}),this.hot.addHook("afterColumnFreeze",(s,o)=>{this.columnAxisSyncer.calculateAndSyncMoves(o,o)}),this.hot.addHook("beforeColumnUnfreeze",(s,o)=>{this.columnAxisSyncer.storeMovesInformation([s],this.hot.getSettings().fixedColumnsStart-1,o)}),this.hot.addHook("afterColumnUnfreeze",(s,o)=>{this.columnAxisSyncer.calculateAndSyncMoves(o,o)}),this.addHook("afterCellMetaReset",function(){return t.onAfterCellMetaReset(...arguments)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){return t.onAfterDetachChild(...arguments)}),this.addHook("beforeAutofill",function(){return t.onBeforeAutofill(...arguments)}),Zi(this,Ra).forEach(s=>{let[o,r]=s;return this.engine.on(o,r)}),super.enablePlugin()}}disablePlugin(){Zi(this,Ra).forEach(e=>{let[t,s]=e;return this.engine.off(t,s)}),YR(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const t=wY(this.hot.getSettings());CY(this.engine.getConfig(),t)&&this.engine.updateConfig(t);const s=this.hot.getSettings()[en];if(he(s)&&he(s.sheetName)&&s.sheetName!==this.sheetName&&this.switchSheet(s.sheetName),!e.data&&this.sheetName===null){const o=this.hot.getSettings()[en].sheetName;o&&this.engine.doesSheetExist(o)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(o??void 0,this.hot.getSourceDataArray())}super.updatePlugin(e)}destroy(){Zi(this,Ra).forEach(e=>{var t;let[s,o]=e;return(t=this.engine)===null||t===void 0?void 0:t.off(s,o)}),uo(this,Ra,null),YR(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,t){if(he(t)&&!N$(t))return ut("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return ut("Sheet with the provided name already exists."),!1;try{const s=this.engine.addSheet(e??void 0);return t&&this.engine.setSheetContent(this.engine.getSheetId(s),t),s}catch(s){return ut(s.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){Sd(`The sheet named \`${e}\` does not exist, switch aborted.`);return}this.sheetName=e;const t=this.engine.getSheetSerialized(this.sheetId);t.length>0&&this.hot.loadData(t,`${jn(en)}.switchSheet`)}getCellType(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const o=this.hot.toPhysicalRow(e),r=this.hot.toPhysicalColumn(t);return o!==null&&r!==null?this.engine.getCellType({sheet:s,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t)}):"EMPTY"}isFormulaCellType(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:s,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t)})}renderDependentSheets(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const s=new Set;e.forEach(o=>{var r;const a=o==null||(r=o.address)===null||r===void 0?void 0:r.sheet;a!==void 0&&(s.has(a)||s.add(a))}),zR(this.engine).forEach((o,r)=>{if((t||r!==this.sheetId)&&s.has(r)){var a;o.render(),(a=o.view)===null||a===void 0||a.adjustElementsSize()}})}validateDependentCells(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const s=r=>{var a;const{row:l,col:c,sheet:h}=(a=r==null?void 0:r.address)!==null&&a!==void 0?a:{};return he(h)?`${h}:${l}x${c}`:""},o=new Set(t.map(r=>s(r)));e.forEach(r=>{var a,l;const{row:c,col:h}=(a=r.address)!==null&&a!==void 0?a:{};if(he(c)===!1||he(h)===!1||c>=this.hot.countRows()||h>=this.hot.countCols())return;const u=r==null||(l=r.address)===null||l===void 0?void 0:l.sheet,f=s(r);if(u!==void 0&&!o.has(f)){const g=zR(this.engine).get(u);if(!g)return;g.validateCell(g.getDataAtCell(c,h),g.getCellMeta(c,h),()=>{})}})}syncChangeWithEngine(e,t,s){const o={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(o)){ut(`Not possible to set cell data at ${JSON.stringify(o)}`);return}const r=this.hot.getCellMeta(e,t);return qm(s,r.type)&&(KR(s,r.dateFormat)?s=XR(s,r.dateFormat):TY(s)===!1&&(s=`'${s}`)),this.engine.setCellContents(o,s)}onBeforeValidate(e,t,s){const o=this.hot.propToCol(s);if(this.isFormulaCellType(t,o)){const r={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId},a=this.hot.getCellMeta(t,o);let l=this.engine.getCellValue(r);return a.type==="date"&&fn(l)&&(l=qR(l,a.dateFormat)),typeof l=="object"&&l!==null?l.value:l}return e}onBeforeAutofill(e,t,s){const{row:o,col:r}=t.getTopStartCorner(),{row:a,col:l}=t.getBottomEndCorner(),{row:c,col:h}=s.getTopStartCorner(),{row:u,col:f}=s.getBottomEndCorner(),g={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId}},p={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(c),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(h),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(u),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(f),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(p)===!1)return!1;const C=this.engine.getFillRangeData(g,p),{row:y,col:b}=g.start,{row:T,col:M}=g.end,_=T-y+1,I=M-b+1;for(let D=0;D<C.length;D+=1)for(let K=0;K<C[D].length;K+=1){const H=C[D][K],Q=D%_,q=K%I,F=this.hot.getCellMeta(Q,q);qm(H,F.type)&&(H.startsWith("'")?C[D][K]=H.slice(1):this.isFormulaCellType(Q,q,this.sheetId)===!1&&(C[D][K]=MY(H,F.dateFormat)))}return C}onBeforeLoadData(e,t){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(jn(en))||uo(this,ip,ct(this.hot.getSettings().data))}onAfterCellMetaReset(){const e=this.hot.getSourceDataArray();let t=!1;e.forEach((s,o)=>{s.forEach((r,a)=>{const l=this.hot.getCellMeta(o,a),c=l.dateFormat;qm(r,l.type)&&(t=!0,KR(r,c)?e[o][a]=XR(r,c):this.isFormulaCellType(o,a)===!1&&(e[o][a]=`'${r}`))})}),t===!0&&(uo(this,Vs,!0),this.engine.setSheetContent(this.sheetId,e),uo(this,Vs,!1))}onAfterLoadData(e,t){if(!(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(jn(en)))if(this.sheetName=EY(this.engine,this.hot.getSettings()[en].sheetName),Zi(this,ip))this.switchSheet(this.sheetName);else{const o=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,o)){uo(this,Vs,!0);const r=this.engine.setSheetContent(this.sheetId,o);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(r),uo(this,Vs,!1)}}}onModifyData(e,t,s,o){if(o!=="get"||Zi(this,Vs)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const r=this.hot.toVisualRow(e);if(r===null||t===null)return;if(!this.isFormulaCellType(r,t)&&this.getCellType(r,t)!=="ARRAY"){jR(s.value)&&(s.value=xY(s.value));return}const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t),sheet:this.sheetId};let c=this.engine.getCellValue(l);const h=this.hot.getCellMeta(r,t);h.type==="date"&&fn(c)&&(c=qR(c,h.dateFormat));const u=typeof c=="object"&&c!==null?c.value:c;s.value=u}onModifySourceData(e,t,s,o){if(o!=="get"||Zi(this,Vs)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const r=this.hot.toVisualRow(e),a=this.hot.propToCol(t);if(r===null||a===null||!this.isFormulaCellType(r,a)&&this.getCellType(r,a)!=="ARRAY")return;const c=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(c.width===0&&c.height===0)return;const h={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(a),sheet:this.sheetId};s.value=this.engine.getCellSerialized(h)}onAfterSetDataAtCell(e,t){if(Qi(t))return;const s=[],o=[],r=this.engine.batch(()=>{e.forEach(a=>{let[l,c,,h]=a;const u=this.hot.propToCol(c),f=this.hot.toPhysicalRow(l),g=this.hot.toPhysicalColumn(u),p={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(l),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};f!==null&&g!==null?this.syncChangeWithEngine(l,u,h):s.push([l,u,h]),o.push({address:p})})});s.length&&this.hot.addHookOnce("afterChange",()=>{const a=this.engine.batch(()=>{s.forEach(l=>{let[c,h,u]=l;this.syncChangeWithEngine(c,h,u)})});this.renderDependentSheets(a,!0)}),this.renderDependentSheets(r),this.validateDependentCells(r,o)}onAfterSetSourceDataAtCell(e,t){if(Qi(t))return;const s=[],o=[];e.forEach(r=>{let[a,l,,c]=r;const h=this.hot.propToCol(l);if(!fn(h))return;const u={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(h),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(u)){ut(`Not possible to set source cell data at ${JSON.stringify(u)}`);return}o.push({address:u}),s.push(...this.engine.setCellContents(u,c))}),this.renderDependentSheets(s),this.validateDependentCells(s,o)}onBeforeCreateRow(e,t){let s=this.rowAxisSyncer.getHfIndexFromVisualIndex(e);if(e>=this.hot.countRows()&&(s=e),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[s,t]))return!1}onBeforeCreateCol(e,t){let s=this.columnAxisSyncer.getHfIndexFromVisualIndex(e);if(e>=this.hot.countCols()&&(s=e),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[s,t]))return!1}onBeforeRemoveRow(e,t,s){return this.rowAxisSyncer.setRemovedHfIndexes(s).every(a=>this.engine.isItPossibleToRemoveRows(this.sheetId,[a,1]))===!1?!1:void 0}onBeforeRemoveCol(e,t,s){return this.columnAxisSyncer.setRemovedHfIndexes(s).every(a=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[a,1]))===!1?!1:void 0}onAfterCreateRow(e,t,s){if(Qi(s))return;const o=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(e),t]);this.renderDependentSheets(o)}onAfterCreateCol(e,t,s){if(Qi(s))return;const o=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(e),t]);this.renderDependentSheets(o)}onAfterRemoveRow(e,t,s,o){if(Qi(o))return;const r=this.rowAxisSyncer.getRemovedHfIndexes().sort().reverse(),a=this.engine.batch(()=>{r.forEach(l=>{this.engine.removeRows(this.sheetId,[l,1])})});this.renderDependentSheets(a)}onAfterRemoveCol(e,t,s,o){if(Qi(o))return;const r=this.columnAxisSyncer.getRemovedHfIndexes().sort().reverse(),a=this.engine.batch(()=>{r.forEach(l=>{this.engine.removeColumns(this.sheetId,[l,1])})});this.renderDependentSheets(a)}onAfterDetachChild(e,t,s){var o;uo(this,Vs,!0);const r=this.hot.getSourceDataArray(s,0,s+(((o=t.__children)===null||o===void 0?void 0:o.length)||0),this.hot.countSourceCols());uo(this,Vs,!1),r.forEach((a,l)=>{a.forEach((c,h)=>{this.engine.setCellContents({col:h,row:s+l,sheet:this.sheetId},[[c]])})})}onEngineValuesUpdated(e){this.hot.runHooks("afterFormulasValuesUpdate",e)}onEngineNamedExpressionsAdded(e,t){this.hot.runHooks("afterNamedExpressionAdded",e,t)}onEngineNamedExpressionsRemoved(e,t){this.hot.runHooks("afterNamedExpressionRemoved",e,t)}onEngineSheetAdded(e){this.hot.runHooks("afterSheetAdded",e)}onEngineSheetRenamed(e,t){this.hot.runHooks("afterSheetRenamed",e,t)}onEngineSheetRemoved(e,t){this.hot.runHooks("afterSheetRemoved",e,t)}}function YY(n){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let t=0;if(Array.isArray(e)){const[,s,,o]=e;s-o!==0&&(t=1)}return this.getTranslatedPhrase(eg,t)},callback(){const{from:e,to:t}=this.getSelectedRangeLast(),s=Math.max(Math.min(e.col,t.col),0),o=Math.max(e.col,t.col),r=[];for(let c=s;c<=o;c+=1)r.push(c);n.hideColumns(r);const a=r[r.length-1],l=this.columnIndexMapper.getNearestNotHiddenIndex(a,1,!0);Number.isInteger(l)&&l>=0?this.selectColumns(l):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function GY(n){const e=[];return{key:"hidden_columns_show",name(){const t=e.length>1?1:0;return this.getTranslatedPhrase(tg,t)},callback(){var t,s;if(e.length===0)return;let o=e[0],r=e[e.length-1];o=(t=this.columnIndexMapper.getNearestNotHiddenIndex(o-1,-1))!==null&&t!==void 0?t:0,r=(s=this.columnIndexMapper.getNearestNotHiddenIndex(r+1,1))!==null&&s!==void 0?s:this.countCols()-1,n.showColumns(e),this.render(),this.view.adjustElementsSize(!0),r-o+1===this.countCols()||this.selectColumns(o,r)},disabled:!1,hidden(){const t=$e(n.getHiddenColumns(),f=>this.toPhysicalColumn(f));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||t.length<1)return!0;e.length=0;const s=this.getSelectedRangeLast(),o=s.getTopStartCorner().col,r=s.getBottomEndCorner().col,a=this.columnIndexMapper,l=a.getRenderableFromVisualIndex(o),c=a.getRenderableFromVisualIndex(r),h=a.getNotTrimmedIndexes(),u=[];if(o!==r){const f=r-o+1,g=c-l+1;if(f>g){const p=h.slice(o,r+1);u.push(...p.filter(C=>t.includes(C)))}}else if(l===0&&l<o)u.push(...h.slice(0,o));else if(l===null)u.push(...h.slice(0,this.countCols()));else{const f=this.countCols()-1,g=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(f,-1));c===g&&f>r&&u.push(...h.slice(r+1))}return N(u,f=>{e.push(this.toVisualColumn(f))}),e.length===0}}}function t0(n,e,t){jY(n,e),e.set(n,t)}function jY(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function En(n,e){var t=n0(n,e,"get");return KY(n,t)}function KY(n,e){return e.get?e.get.call(n):e.value}function Ea(n,e,t){var s=n0(n,e,"set");return XY(n,s,t),t}function n0(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function XY(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}de.getSingleton().register("beforeHideColumns"),de.getSingleton().register("afterHideColumns"),de.getSingleton().register("beforeUnhideColumns"),de.getSingleton().register("afterUnhideColumns");const rp="hiddenColumns",qY=310;var gs=new WeakMap,ms=new WeakMap;class ZY extends et{constructor(){super(...arguments),t0(this,gs,{writable:!0,value:{}}),t0(this,ms,{writable:!0,value:null})}static get PLUGIN_KEY(){return rp}static get PLUGIN_PRIORITY(){return qY}isEnabled(){return!!this.hot.getSettings()[rp]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[rp];Fe(t)&&(Ea(this,gs,t),ct(t.copyPasteEnabled)&&(t.copyPasteEnabled=!0)),Ea(this,ms,new ql),En(this,ms).addLocalHook("init",()=>this.onMapInit()),this.hot.columnIndexMapper.registerMap(this.pluginName,En(this,ms)),this.addHook("afterContextMenuDefaultOptions",function(){return e.onAfterContextMenuDefaultOptions(...arguments)}),this.addHook("afterGetCellMeta",(s,o,r)=>this.onAfterGetCellMeta(s,o,r)),this.addHook("modifyColWidth",(s,o)=>this.onModifyColWidth(s,o)),this.addHook("afterGetColHeader",function(){return e.onAfterGetColHeader(...arguments)}),this.addHook("modifyCopyableRange",s=>this.onModifyCopyableRange(s)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Ea(this,gs,{}),super.disablePlugin(),this.resetCellsMeta()}showColumns(e){const t=this.getHiddenColumns(),s=this.isValidConfig(e);let o=t;const r=En(this,ms).getValues().slice(),a=e.length>0;if(s&&a){const c=e.map(h=>this.hot.toPhysicalColumn(h));N(c,h=>{r[h]=!1}),o=Qt(r,(h,u,f)=>(u&&h.push(this.hot.toVisualColumn(f)),h),[])}this.hot.runHooks("beforeUnhideColumns",t,o,s&&a)!==!1&&(s&&a&&En(this,ms).setValues(r),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",t,o,s&&a,s&&o.length<t.length))}showColumn(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];this.showColumns(t)}hideColumns(e){const t=this.getHiddenColumns(),s=this.isValidConfig(e);let o=t;s&&(o=Array.from(new Set(t.concat(e)))),this.hot.runHooks("beforeHideColumns",t,o,s)!==!1&&(s&&this.hot.batchExecution(()=>{N(e,a=>{En(this,ms).setValueAtIndex(this.hot.toPhysicalColumn(a),!0)})},!0),this.hot.runHooks("afterHideColumns",t,o,s,s&&o.length>t.length))}hideColumn(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];this.hideColumns(t)}getHiddenColumns(){return $e(En(this,ms).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return En(this,ms).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const t=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(s=>Number.isInteger(s)&&s>=0&&s<t):!1}resetCellsMeta(){N(this.hot.getCellsMeta(),e=>{e&&(e.skipColumnOnPaste=!1)})}onModifyColWidth(e,t){if(this.isHidden(t))return 0;if(En(this,gs).indicators&&(this.isHidden(t+1)||this.isHidden(t-1))&&typeof e=="number"&&this.hot.hasColHeaders())return e+15}onAfterGetCellMeta(e,t,s){if(En(this,gs).copyPasteEnabled===!1&&this.isHidden(t)&&(s.skipColumnOnPaste=!0),this.isHidden(t-1))s.className=s.className||"",s.className.indexOf("afterHiddenColumn")===-1&&(s.className+=" afterHiddenColumn");else if(s.className){const o=s.className.split(" ");if(o.length>0){const r=o.indexOf("afterHiddenColumn");r>-1&&o.splice(r,1),s.className=o.join(" ")}}}onModifyCopyableRange(e){if(En(this,gs).copyPasteEnabled)return e;const t=[],s=(o,r,a,l)=>{t.push({startRow:o,endRow:r,startCol:a,endCol:l})};return N(e,o=>{let r=!0,a=0;Ce(o.startCol,o.endCol,l=>{this.isHidden(l)?(r||s(o.startRow,o.endRow,a,l-1),r=!0):(r&&(a=l),l===o.endCol&&s(o.startRow,o.endRow,a,l),r=!1)})}),t}onAfterGetColHeader(e,t){if(!En(this,gs).indicators||e<0)return;const s=[];e>=1&&this.isHidden(e-1)&&s.push("afterHiddenColumn"),e<this.hot.countCols()-1&&this.isHidden(e+1)&&s.push("beforeHiddenColumn"),oe(t,s)}onAfterContextMenuDefaultOptions(e){e.items.push({name:We},YY(this),GY(this))}onMapInit(){Array.isArray(En(this,gs).columns)&&this.hideColumns(En(this,gs).columns)}destroy(){Ea(this,gs,null),Ea(this,ms,null),super.destroy()}}function QY(n){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let t=0;if(Array.isArray(e)){const[s,,o]=e;s-o!==0&&(t=1)}return this.getTranslatedPhrase(ng,t)},callback(){const{from:e,to:t}=this.getSelectedRangeLast(),s=Math.max(Math.min(e.row,t.row),0),o=Math.max(e.row,t.row),r=[];for(let c=s;c<=o;c+=1)r.push(c);n.hideRows(r);const a=r[r.length-1],l=this.rowIndexMapper.getNearestNotHiddenIndex(a,1,!0);Number.isInteger(l)&&l>=0?this.selectRows(l):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function JY(n){const e=[];return{key:"hidden_rows_show",name(){const t=e.length>1?1:0;return this.getTranslatedPhrase(sg,t)},callback(){var t,s;if(e.length===0)return;let o=e[0],r=e[e.length-1];o=(t=this.rowIndexMapper.getNearestNotHiddenIndex(o-1,-1))!==null&&t!==void 0?t:0,r=(s=this.rowIndexMapper.getNearestNotHiddenIndex(r+1,1))!==null&&s!==void 0?s:this.countRows()-1,n.showRows(e),this.render(),this.view.adjustElementsSize(!0),r-o+1===this.countRows()||this.selectRows(o,r)},disabled:!1,hidden(){const t=$e(n.getHiddenRows(),f=>this.toPhysicalRow(f));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||t.length<1)return!0;e.length=0;const s=this.getSelectedRangeLast(),o=s.getTopStartCorner().row,r=s.getBottomEndCorner().row,a=this.rowIndexMapper,l=a.getRenderableFromVisualIndex(o),c=a.getRenderableFromVisualIndex(r),h=a.getNotTrimmedIndexes(),u=[];if(o!==r){const f=r-o+1,g=c-l+1;if(f>g){const p=h.slice(o,r+1);u.push(...p.filter(C=>t.includes(C)))}}else if(l===0&&l<o)u.push(...h.slice(0,o));else if(l===null)u.push(...h.slice(0,this.countRows()));else{const f=this.countRows()-1,g=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(f,-1));c===g&&f>r&&u.push(...h.slice(r+1))}return N(u,f=>{e.push(this.toVisualRow(f))}),e.length===0}}}function s0(n,e,t){eG(n,e),e.set(n,t)}function eG(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vn(n,e){var t=o0(n,e,"get");return tG(n,t)}function tG(n,e){return e.get?e.get.call(n):e.value}function xa(n,e,t){var s=o0(n,e,"set");return nG(n,s,t),t}function o0(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function nG(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}de.getSingleton().register("beforeHideRows"),de.getSingleton().register("afterHideRows"),de.getSingleton().register("beforeUnhideRows"),de.getSingleton().register("afterUnhideRows");const ap="hiddenRows",sG=320;var $s=new WeakMap,ps=new WeakMap;class oG extends et{constructor(){super(...arguments),s0(this,$s,{writable:!0,value:{}}),s0(this,ps,{writable:!0,value:null})}static get PLUGIN_KEY(){return ap}static get PLUGIN_PRIORITY(){return sG}isEnabled(){return!!this.hot.getSettings()[ap]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[ap];Fe(t)&&(xa(this,$s,t),ct(t.copyPasteEnabled)&&(t.copyPasteEnabled=!0)),xa(this,ps,new ql),Vn(this,ps).addLocalHook("init",()=>this.onMapInit()),this.hot.rowIndexMapper.registerMap(this.pluginName,Vn(this,ps)),this.addHook("afterContextMenuDefaultOptions",function(){return e.onAfterContextMenuDefaultOptions(...arguments)}),this.addHook("afterGetCellMeta",(s,o,r)=>this.onAfterGetCellMeta(s,o,r)),this.addHook("modifyRowHeight",(s,o)=>this.onModifyRowHeight(s,o)),this.addHook("afterGetRowHeader",function(){return e.onAfterGetRowHeader(...arguments)}),this.addHook("modifyCopyableRange",s=>this.onModifyCopyableRange(s)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),xa(this,$s,{}),super.disablePlugin(),this.resetCellsMeta()}showRows(e){const t=this.getHiddenRows(),s=this.isValidConfig(e);let o=t;const r=Vn(this,ps).getValues().slice(),a=e.length>0;if(s&&a){const c=e.map(h=>this.hot.toPhysicalRow(h));N(c,h=>{r[h]=!1}),o=Qt(r,(h,u,f)=>(u&&h.push(this.hot.toVisualRow(f)),h),[])}this.hot.runHooks("beforeUnhideRows",t,o,s&&a)!==!1&&(s&&a&&Vn(this,ps).setValues(r),this.hot.runHooks("afterUnhideRows",t,o,s&&a,s&&o.length<t.length))}showRow(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];this.showRows(t)}hideRows(e){const t=this.getHiddenRows(),s=this.isValidConfig(e);let o=t;s&&(o=Array.from(new Set(t.concat(e)))),this.hot.runHooks("beforeHideRows",t,o,s)!==!1&&(s&&this.hot.batchExecution(()=>{N(e,a=>{Vn(this,ps).setValueAtIndex(this.hot.toPhysicalRow(a),!0)})},!0),this.hot.runHooks("afterHideRows",t,o,s,s&&o.length>t.length))}hideRow(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];this.hideRows(t)}getHiddenRows(){return $e(Vn(this,ps).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return Vn(this,ps).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const t=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(s=>Number.isInteger(s)&&s>=0&&s<t):!1}resetCellsMeta(){N(this.hot.getCellsMeta(),e=>{e&&(e.skipRowOnPaste=!1)})}onModifyRowHeight(e,t){return this.isHidden(t)?0:e}onAfterGetCellMeta(e,t,s){if(Vn(this,$s).copyPasteEnabled===!1&&this.isHidden(e)&&(s.skipRowOnPaste=!0),this.isHidden(e-1))s.className=s.className||"",s.className.indexOf("afterHiddenRow")===-1&&(s.className+=" afterHiddenRow");else if(s.className){const o=s.className.split(" ");if(o.length>0){const r=o.indexOf("afterHiddenRow");r>-1&&o.splice(r,1),s.className=o.join(" ")}}}onModifyCopyableRange(e){if(Vn(this,$s).copyPasteEnabled)return e;const t=[],s=(o,r,a,l)=>{t.push({startRow:o,endRow:r,startCol:a,endCol:l})};return N(e,o=>{let r=!0,a=0;Ce(o.startRow,o.endRow,l=>{this.isHidden(l)?(r||s(a,l-1,o.startCol,o.endCol),r=!0):(r&&(a=l),l===o.endRow&&s(a,l,o.startCol,o.endCol),r=!1)})}),t}onAfterGetRowHeader(e,t){if(!Vn(this,$s).indicators||e<0)return;const s=[];e>=1&&this.isHidden(e-1)&&s.push("afterHiddenRow"),e<this.hot.countRows()-1&&this.isHidden(e+1)&&s.push("beforeHiddenRow"),oe(t,s)}onAfterContextMenuDefaultOptions(e){e.items.push({name:We},QY(this),JY(this))}onMapInit(){Array.isArray(Vn(this,$s).rows)&&this.hideRows(Vn(this,$s).rows)}destroy(){xa(this,$s,null),xa(this,ps,null),super.destroy()}}function iG(n){return{key:"freeze_column",name(){return this.getTranslatedPhrase(Of)},callback(e,t){const[{start:{col:s}}]=t;n.freezeColumn(s),this.render(),this.view.adjustElementsSize(!0)},hidden(){const e=this.getSelectedRange();let t=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(t=!0),t}}}function rG(n){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(Af)},callback(e,t){const[{start:{col:s}}]=t;n.unfreezeColumn(s),this.render(),this.view.adjustElementsSize(!0)},hidden(){const e=this.getSelectedRange();let t=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(t=!0),t}}}de.getSingleton().register("beforeColumnFreeze"),de.getSingleton().register("afterColumnFreeze"),de.getSingleton().register("beforeColumnUnfreeze"),de.getSingleton().register("afterColumnUnfreeze");const i0="manualColumnFreeze",aG=110,Ta=new WeakMap;class lG extends et{static get PLUGIN_KEY(){return i0}static get PLUGIN_PRIORITY(){return aG}constructor(e){super(e),Ta.set(this,{afterFirstUse:!1})}isEnabled(){return!!this.hot.getSettings()[i0]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>this.addContextMenuEntry(e)),this.addHook("beforeColumnMove",(e,t)=>this.onBeforeColumnMove(e,t)),super.enablePlugin())}disablePlugin(){const e=Ta.get(this);e.afterFirstUse=!1,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const t=Ta.get(this),s=this.hot.getSettings(),o=s.fixedColumnsStart<this.hot.countCols()&&e>s.fixedColumnsStart-1;t.afterFirstUse||(t.afterFirstUse=!0),this.hot.runHooks("beforeColumnFreeze",e,o)!==!1&&(o&&(this.hot.columnIndexMapper.moveIndexes(e,s.fixedColumnsStart),s._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,o))}unfreezeColumn(e){const t=Ta.get(this),s=this.hot.getSettings(),o=s.fixedColumnsStart>0&&e<=s.fixedColumnsStart-1;t.afterFirstUse||(t.afterFirstUse=!0),this.hot.runHooks("beforeColumnUnfreeze",e,o)!==!1&&(o&&(s._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,s.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,o))}addContextMenuEntry(e){e.items.push({name:"---------"},iG(this),rG(this))}onBeforeColumnMove(e,t){if(Ta.get(this).afterFirstUse){const o=this.hot.getSettings().fixedColumnsStart;if(t<o||e.some(r=>r<o))return!1}}}const lp=0,r0=1,a0=2,Ji="px",l0=class{constructor(e){this.hot=e,this._element=null,this.state=lp,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=a0}build(){this.state===lp&&(this._element=this.hot.rootDocument.createElement("div"),this.state=r0)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=lp}isAppended(){return this.state===a0}isBuilt(){return this.state>=r0}setPosition(e,t){fn(e)&&(this._element.style.top=e+Ji),fn(t)&&(this._element.style[this.inlineProperty]=t+Ji)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,t){fn(e)&&(this._element.style.width=e+Ji),fn(t)&&(this._element.style.height=t+Ji)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,t){fn(e)&&(this._element.style.marginTop=e+Ji),fn(t)&&(this._element.style[`margin${jn(this.inlineProperty)}`]=t+Ji)}getOffset(){const e=this._element.style,t=`margin${jn(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[t]?parseInt(e[t],10):0}}},cG="ht__manualColumnMove--backlight",hG=class extends l0{build(){super.build(),oe(this._element,cG)}},uG="ht__manualColumnMove--guideline",dG=class extends l0{build(){super.build(),oe(this._element,uG)}};de.getSingleton().register("beforeColumnMove"),de.getSingleton().register("afterColumnMove");const cp="manualColumnMove",fG=120,fo=new WeakMap,c0="ht__manualColumnMove",rh="show-ui",hp="on-moving--columns",up="after-selection--columns";class gG extends et{static get PLUGIN_KEY(){return cp}static get PLUGIN_PRIORITY(){return fG}constructor(e){super(e),fo.set(this,{columnsToMove:[],countCols:0,fixedColumns:0,pressed:void 0,target:{eventPageX:void 0,coords:void 0,TD:void 0,col:void 0},cachedDropIndex:void 0}),this.eventManager=new bt(this),this.backlight=new hG(e),this.guideline=new dG(e)}isEnabled(){return!!this.hot.getSettings()[cp]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return e.onBeforeOnCellMouseDown(...arguments)}),this.addHook("beforeOnCellMouseOver",function(){return e.onBeforeOnCellMouseOver(...arguments)}),this.addHook("afterScrollVertically",()=>this.onAfterScrollVertically()),this.addHook("afterLoadData",function(){return e.onAfterLoadData(...arguments)}),this.buildPluginUI(),this.registerEvents(),oe(this.hot.rootElement,c0),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){De(this.hot.rootElement,c0),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),super.disablePlugin()}moveColumn(e,t){return this.moveColumns([e],t)}moveColumns(e,t){const s=fo.get(this),o=s.cachedDropIndex,r=this.isMovePossible(e,t),a=this.hot.runHooks("beforeColumnMove",e,t,o,r);if(s.cachedDropIndex=void 0,a===!1)return;r&&this.hot.columnIndexMapper.moveIndexes(e,t);const l=r&&this.isColumnOrderChanged(e,t);return this.hot.runHooks("afterColumnMove",e,t,o,r,l),l}dragColumn(e,t){return this.dragColumns([e],t)}dragColumns(e,t){const s=this.countFinalIndex(e,t),o=fo.get(this);return o.cachedDropIndex=t,this.moveColumns(e,s)}isMovePossible(e,t){const s=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),o=e.length+t>s,r=t<0,a=e.some(c=>c<0),l=e.some(c=>c>=s);return!(o||r||a||l)}isColumnOrderChanged(e,t){return e.some((s,o)=>s-o!==t)}countFinalIndex(e,t){const s=Qt(e,(o,r)=>(r<t&&(o+=1),o),0);return t-s}getColumnsWidth(e,t){const s=this.hot.columnIndexMapper;let o=0;for(let r=e;r<=t;r+=1){const a=s.getRenderableFromVisualIndex(r);r<0?o+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:a!==null&&(o+=this.hot.view._wt.wtTable.getStretchedColumnWidth(a)||0)}return o}moveBySettingsOrLoad(){const e=this.hot.getSettings()[cp];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const t=this.persistentStateLoad();t.length&&this.moveColumns(t,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,t){const s=[];return Ce(e,t,o=>{s.push(o)}),s}refreshPositions(){const e=fo.get(this),t=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(e.hoveredColumn)&&t>0&&this.hot.scrollViewportTo(void 0,this.hot.columnIndexMapper.getNearestNotHiddenIndex(t-1,-1));const s=this.hot.view._wt.wtTable,o=this.hot.view._wt.wtOverlays.scrollableElement,r=typeof o.scrollX=="number"?o.scrollX:o.scrollLeft;let a=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,e.hoveredColumn-1);const l=s.hider.offsetWidth,c=s.TBODY.offsetLeft,h=this.backlight.getOffset().start,u=this.backlight.getSize().width;let f=0,g=0;if(this.hot.isRtl()){const y=this.hot.rootWindow,b=at(this.hot.rootElement),T=y.innerWidth-e.rootElementOffset-b;g=y.innerWidth-e.target.eventPageX-T-(o.scrollX===void 0?r:0)}else g=e.target.eventPageX-(e.rootElementOffset-(o.scrollX===void 0?r:0));if(e.hasRowHeaders&&(f=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(e.hoveredColumn)&&(a+=r),a+=f,e.hoveredColumn<0)e.fixedColumnsStart>0?e.target.col=0:e.target.col=t>0?t-1:t;else if(e.target.TD.offsetWidth/2+a<=g){const y=e.hoveredColumn>=e.countCols?e.countCols-1:e.hoveredColumn;e.target.col=y+1,a+=e.target.TD.offsetWidth}else e.target.col=e.hoveredColumn;let p=g,C=a;g+u+h>=l?p=l-u-h:g+h<c+f&&(p=c+f+Math.abs(h)),a>=l-1?C=l-1:C===0?C=1:o.scrollX!==void 0&&e.hoveredColumn<e.fixedColumnsStart&&(C-=e.rootElementOffset<=o.scrollX?e.rootElementOffset:0),this.backlight.setPosition(null,p),this.guideline.setPosition(null,C)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",t=>this.onMouseMove(t)),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp())}unregisterEvents(){this.eventManager.clear()}onBeforeOnCellMouseDown(e,t,s,o){const r=this.hot.view._wt.wtTable,a=this.hot.selection.isSelectedByColumnHeader(),l=this.hot.getSelectedRangeLast(),c=fo.get(this),h=Ae(e.target,"sortAction");if(!l||!a||c.pressed||e.button!==0||h){c.pressed=!1,c.columnsToMove.length=0,De(this.hot.rootElement,[hp,rh]);return}const u=this.guideline.isBuilt()&&!this.guideline.isAppended(),f=this.backlight.isBuilt()&&!this.backlight.isAppended();u&&f&&(this.guideline.appendTo(r.hider),this.backlight.appendTo(r.hider));const{from:g,to:p}=l,C=Math.min(g.col,p.col),y=Math.max(g.col,p.col);if(t.row<0&&t.col>=C&&t.col<=y){o.column=!0,c.pressed=!0,c.target.eventPageX=e.pageX,c.target.eventOffsetX=e.offsetX,c.hoveredColumn=t.col,c.target.TD=s,c.target.col=t.col,c.columnsToMove=this.prepareColumnsToMoving(C,y),c.hasRowHeaders=!!this.hot.getSettings().rowHeaders,c.countCols=this.hot.countCols(),c.fixedColumnsStart=this.hot.getSettings().fixedColumnsStart,c.rootElementOffset=Ht(this.hot.rootElement).left;const b=c.hasRowHeaders?-1:0,T=r.holder.scrollTop+r.getColumnHeaderHeight(0)+1,M=t.col<c.fixedColumnsStart,_=Math.abs(this.hot.view._wt.wtOverlays.inlineStartOverlay.getScrollPosition()),I=Math.abs(e.offsetX-(this.hot.isRtl()?e.target.offsetWidth:0)),D=this.getColumnsWidth(C,t.col-1)+I,K=this.getColumnsWidth(b,C-1)+(M?_:0)+D;this.backlight.setPosition(T,K),this.backlight.setSize(this.getColumnsWidth(C,y),r.hider.offsetHeight-T),this.backlight.setOffset(null,-D),oe(this.hot.rootElement,hp)}else De(this.hot.rootElement,up),c.pressed=!1,c.columnsToMove.length=0}onMouseMove(e){const t=fo.get(this);if(t.pressed){if(e.target===this.backlight.element){const s=this.backlight.getSize().width;this.backlight.setSize(0),setTimeout(function(){this.backlight.setPosition(s)})}t.target.eventPageX=e.pageX,this.refreshPositions()}}onBeforeOnCellMouseOver(e,t,s,o){const r=this.hot.getSelectedRangeLast(),a=fo.get(this);!r||!a.pressed||(a.columnsToMove.indexOf(t.col)>-1?De(this.hot.rootElement,rh):oe(this.hot.rootElement,rh),o.row=!0,o.column=!0,o.cell=!0,a.hoveredColumn=t.col,a.target.TD=s)}onMouseUp(){const e=fo.get(this),t=e.target.col,s=e.columnsToMove.length;if(e.hoveredColumn=void 0,e.pressed=!1,e.backlightWidth=0,De(this.hot.rootElement,[hp,rh,up]),this.hot.selection.isSelectedByColumnHeader()&&oe(this.hot.rootElement,up),s<1||t===void 0)return;const o=e.columnsToMove[0],r=this.hot.toPhysicalColumn(o),a=this.dragColumns(e.columnsToMove,t);if(e.columnsToMove.length=0,a===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);const l=this.hot.toVisualColumn(r),c=l+s-1;this.hot.selectColumns(l,c)}}onAfterScrollVertically(){const e=this.hot.view._wt.wtTable,t=e.getColumnHeaderHeight(0)+1,s=e.holder.scrollTop,o=t+s;this.backlight.setPosition(o),this.backlight.setSize(null,e.hider.offsetHeight-o)}buildPluginUI(){this.backlight.build(),this.guideline.build()}onAfterLoadData(){this.moveBySettingsOrLoad()}destroy(){this.backlight.destroy(),this.guideline.destroy(),super.destroy()}}const ah="manualColumnResize",mG=130,h0="manualColumnWidths",dp=new WeakMap;class pG extends et{static get PLUGIN_KEY(){return ah}static get PLUGIN_PRIORITY(){return mG}constructor(e){super(e);const{rootDocument:t}=this.hot;this.currentTH=null,this.currentCol=null,this.selectedCols=[],this.currentWidth=null,this.newSize=null,this.startY=null,this.startWidth=null,this.startOffset=null,this.handle=t.createElement("DIV"),this.guide=t.createElement("DIV"),this.eventManager=new bt(this),this.pressed=null,this.isTriggeredByRMB=!1,this.dblclick=0,this.autoresizeTimeout=null,this.columnWidthsMap=void 0,dp.set(this,{config:void 0}),oe(this.handle,"manualColumnResizer"),oe(this.guide,"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[ah]}enablePlugin(){this.enabled||(this.columnWidthsMap=new to,this.columnWidthsMap.addLocalHook("init",()=>this.onMapInit()),this.hot.columnIndexMapper.registerMap(this.pluginName,this.columnWidthsMap),this.addHook("modifyColWidth",(e,t)=>this.onModifyColWidth(e,t)),this.addHook("beforeStretchingColumnWidth",(e,t)=>this.onBeforeStretchingColumnWidth(e,t)),this.addHook("beforeColumnResize",(e,t,s)=>this.onBeforeColumnResize(e,t,s)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){const e=dp.get(this);e.config=this.columnWidthsMap.getValues(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",h0,this.columnWidthsMap.getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",h0,e),e.value}setManualSize(e,t){const s=Math.max(t,20),o=this.hot.toPhysicalColumn(e);return this.columnWidthsMap.setValueAtIndex(o,s),s}clearManualSize(e){const t=this.hot.toPhysicalColumn(e);this.columnWidthsMap.setValueAtIndex(t,null)}onMapInit(){const e=dp.get(this),t=this.hot.getSettings()[ah],s=this.loadManualColumnWidths();typeof s<"u"?this.hot.batchExecution(()=>{s.forEach((o,r)=>{this.columnWidthsMap.setValueAtIndex(r,o)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((o,r)=>{this.columnWidthsMap.setValueAtIndex(r,o)})},!0),e.config=t):t===!0&&Array.isArray(e.config)&&this.hot.batchExecution(()=>{e.config.forEach((o,r)=>{this.columnWidthsMap.setValueAtIndex(r,o)})},!0)}setupHandlePosition(e){if(!e.parentNode)return;this.currentTH=e;const{_wt:t}=this.hot.view,s=t.wtTable.getCoords(this.currentTH),o=s.col;if(o<0)return;const r=vt(this.currentTH),a=this.currentTH.getBoundingClientRect(),l=o<t.getSetting("fixedColumnsStart");let c;l&&(c=t.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col)),c||(c=t.wtOverlays.topOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col)),this.currentCol=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o),this.selectedCols=[];const h=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&h){const u=this.hot.getSelectedRange();N(u,f=>{const g=f.getTopStartCorner().col,p=f.getBottomEndCorner().col;Ce(g,p,C=>{this.selectedCols.includes(C)||this.selectedCols.push(C)})})}this.selectedCols.includes(this.currentCol)||(this.selectedCols=[this.currentCol]),this.startOffset=c.start-6,this.startWidth=parseInt(a.width,10),this.handle.style.top=`${c.top}px`,this.handle.style[this.inlineDir]=`${this.startOffset+this.startWidth}px`,this.handle.style.height=`${r}px`,this.hot.rootElement.appendChild(this.handle)}refreshHandlePosition(){this.handle.style[this.inlineDir]=`${this.startOffset+this.currentWidth}px`}setupGuidePosition(){const e=parseInt(vt(this.handle),10),t=parseInt(this.handle.style.top,10)+e,s=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);oe(this.handle,"active"),oe(this.guide,"active"),this.guide.style.top=`${t}px`,this.refreshGuidePosition(),this.guide.style.height=`${s-e}px`,this.hot.rootElement.appendChild(this.guide)}refreshGuidePosition(){this.guide.style[this.inlineDir]=this.handle.style[this.inlineDir]}hideHandleAndGuide(){De(this.handle,"active"),De(this.guide,"active")}checkIfColumnHeader(e){return!!Io(e,["THEAD"],this.hot.rootElement)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}onMouseOver(e){if(!qy(e.target)&&this.isTriggeredByRMB!==!0&&this.checkIfColumnHeader(e.target)){const t=this.getClosestTHParent(e.target);if(!t)return;const s=t.getAttribute("colspan");t&&(s===null||s==="1")&&(this.pressed||this.setupHandlePosition(t))}}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},t=(s,o)=>{const r=this.hot.runHooks("beforeColumnResize",this.newSize,s,!0);r!==void 0&&(this.newSize=r),this.hot.getSettings().stretchH==="all"?this.clearManualSize(s):this.setManualSize(s,this.newSize),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",this.newSize,s,!0),o&&e()};this.dblclick>=2&&(this.selectedCols.length>1?(N(this.selectedCols,o=>{t(o)}),e()):N(this.selectedCols,o=>{t(o,!0)})),this.dblclick=0,this.autoresizeTimeout=null}onMouseDown(e){Ae(e.target,"manualColumnResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(()=>this.afterMouseDownTimeout(),500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startX=e.pageX,this.newSize=this.startWidth)}onMouseMove(e){if(this.pressed){const t=(e.pageX-this.startX)*this.hot.getDirectionFactor();this.currentWidth=this.startWidth+t,N(this.selectedCols,s=>{this.newSize=this.setManualSize(s,this.currentWidth)}),this.refreshHandlePosition(),this.refreshGuidePosition()}}onMouseUp(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},t=(s,o)=>{this.hot.runHooks("beforeColumnResize",this.newSize,s,!1),o&&e(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",this.newSize,s,!1)};this.pressed&&(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startWidth&&(this.selectedCols.length>1?(N(this.selectedCols,o=>{t(o)}),e()):N(this.selectedCols,o=>{t(o,!0)})),this.setupHandlePosition(this.currentTH))}onContextMenu(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(this.handle),this.hot.rootElement.removeChild(this.guide),this.pressed=!1,this.isTriggeredByRMB=!0,this.hot._registerImmediate(()=>{this.isTriggeredByRMB=!1})}bindEvents(){const{rootWindow:e,rootElement:t}=this.hot;this.eventManager.addEventListener(t,"mouseover",s=>this.onMouseOver(s)),this.eventManager.addEventListener(t,"mousedown",s=>this.onMouseDown(s)),this.eventManager.addEventListener(e,"mousemove",s=>this.onMouseMove(s)),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp()),this.eventManager.addEventListener(this.handle,"contextmenu",()=>this.onContextMenu())}onModifyColWidth(e,t){let s=e;if(this.enabled){const o=this.hot.toPhysicalColumn(t),r=this.columnWidthsMap.getValueAtIndex(o);this.hot.getSettings()[ah]&&r&&(s=r)}return s}onBeforeStretchingColumnWidth(e,t){let s=this.columnWidthsMap.getValueAtIndex(t);return s===null&&(s=e),s}onBeforeColumnResize(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}destroy(){super.destroy()}}const fp=0,u0=1,d0=2,er="px",f0=class{constructor(e){this.hot=e,this._element=null,this.state=fp}appendTo(e){e.appendChild(this._element),this.state=d0}build(){this.state===fp&&(this._element=this.hot.rootDocument.createElement("div"),this.state=u0)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=fp}isAppended(){return this.state===d0}isBuilt(){return this.state>=u0}setPosition(e,t){e!==void 0&&(this._element.style.top=e+er),t!==void 0&&(this._element.style.left=t+er)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,t){e&&(this._element.style.width=e+er),t&&(this._element.style.height=t+er)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,t){e&&(this._element.style.marginTop=e+er),t&&(this._element.style.marginLeft=t+er)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}},wG="ht__manualRowMove--backlight";class CG extends f0{build(){super.build(),oe(this._element,wG)}}const yG=CG,SG="ht__manualRowMove--guideline";class vG extends f0{build(){super.build(),oe(this._element,SG)}}const bG=vG;de.getSingleton().register("beforeRowMove"),de.getSingleton().register("afterRowMove");const gp="manualRowMove",RG=140,go=new WeakMap,g0="ht__manualRowMove",lh="show-ui",mp="on-moving--rows",pp="after-selection--rows";class EG extends et{static get PLUGIN_KEY(){return gp}static get PLUGIN_PRIORITY(){return RG}constructor(e){super(e),go.set(this,{rowsToMove:[],pressed:void 0,target:{eventPageY:void 0,coords:void 0,TD:void 0,row:void 0},cachedDropIndex:void 0}),this.eventManager=new bt(this),this.backlight=new yG(e),this.guideline=new bG(e)}isEnabled(){return!!this.hot.getSettings()[gp]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return e.onBeforeOnCellMouseDown(...arguments)}),this.addHook("beforeOnCellMouseOver",function(){return e.onBeforeOnCellMouseOver(...arguments)}),this.addHook("afterScrollHorizontally",()=>this.onAfterScrollHorizontally()),this.addHook("afterLoadData",function(){return e.onAfterLoadData(...arguments)}),this.buildPluginUI(),this.registerEvents(),oe(this.hot.rootElement,g0),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){De(this.hot.rootElement,g0),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),super.disablePlugin()}moveRow(e,t){return this.moveRows([e],t)}moveRows(e,t){const s=go.get(this),o=s.cachedDropIndex,r=this.isMovePossible(e,t),a=this.hot.runHooks("beforeRowMove",e,t,o,r);if(s.cachedDropIndex=void 0,a===!1)return;r&&this.hot.rowIndexMapper.moveIndexes(e,t);const l=r&&this.isRowOrderChanged(e,t);return this.hot.runHooks("afterRowMove",e,t,o,r,l),l}dragRow(e,t){return this.dragRows([e],t)}dragRows(e,t){const s=this.countFinalIndex(e,t),o=go.get(this);return o.cachedDropIndex=t,this.moveRows(e,s)}isMovePossible(e,t){const s=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),o=e.length+t>s,r=t<0,a=e.some(c=>c<0),l=e.some(c=>c>=s);return!(o||r||a||l)}isRowOrderChanged(e,t){return e.some((s,o)=>s-o!==t)}countFinalIndex(e,t){const s=Qt(e,(o,r)=>(r<t&&(o+=1),o),0);return t-s}getRowsHeight(e,t){const s=this.hot.rowIndexMapper;let o=0;for(let r=e;r<=t;r++){const a=s.getRenderableFromVisualIndex(r);a!==null&&(o+=this.hot.view._wt.wtTable.getRowHeight(a)||23)}return o}moveBySettingsOrLoad(){const e=this.hot.getSettings()[gp];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const t=this.persistentStateLoad();t.length&&this.moveRows(t,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),t=[];if(!e)return t;const{from:s,to:o}=e,r=Math.min(s.row,o.row),a=Math.max(s.row,o.row);return Ce(r,a,l=>{t.push(l)}),t}refreshPositions(){const e=go.get(this),t=e.target.coords,s=this.hot.view.getFirstFullyVisibleRow(),o=this.hot.view.getLastFullyVisibleRow(),r=this.hot.countRows();this.isFixedRowTop(t.row)&&s>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(s-1,-1)),this.isFixedRowBottom(t.row)&&o<r&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(o+1,1),void 0,!0);const a=this.hot.view._wt.wtTable,l=e.target.TD,c=this.hot.rootElement,h=Ht(c),u=bi(c),f=a.holder.scrollTop;let g;this.hot.rootWindow===u?g=u.scrollY:g=u.scrollTop;const p=h.top-g,C=e.target.eventPageY-p+f,y=a.hider.offsetHeight,b=a.TBODY.offsetTop,T=this.backlight.getOffset().top,M=this.backlight.getSize().height,_=l.offsetHeight/2,I=l.offsetHeight;let D=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,t.row-1);const K=C>=D+_;this.isFixedRowTop(t.row)&&(D+=a.holder.scrollTop),t.row<0?e.target.row=s>0?s-1:s:K?(e.target.row=t.row+1,D+=t.row===0?I-1:I):e.target.row=t.row;let H=C,Q=D;C+M+T>=y?H=y-M-T:C+T<b&&(H=b+Math.abs(T)),D>=y-1&&(Q=y-1),this.backlight.setPosition(H),this.guideline.setPosition(Q)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",t=>this.onMouseMove(t)),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp())}unregisterEvents(){this.eventManager.clear()}onBeforeOnCellMouseDown(e,t,s,o){const{wtTable:r,wtViewport:a}=this.hot.view._wt,l=this.hot.selection.isSelectedByRowHeader(),c=this.hot.getSelectedRangeLast(),h=go.get(this);if(!c||!l||h.pressed||e.button!==0){h.pressed=!1,h.rowsToMove.length=0,De(this.hot.rootElement,[mp,lh]);return}const u=this.guideline.isBuilt()&&!this.guideline.isAppended(),f=this.backlight.isBuilt()&&!this.backlight.isAppended();u&&f&&(this.guideline.appendTo(r.hider),this.backlight.appendTo(r.hider));const{from:g,to:p}=c,C=Math.min(g.row,p.row),y=Math.max(g.row,p.row);if(t.col<0&&t.row>=C&&t.row<=y){o.row=!0,h.pressed=!0,h.target.eventPageY=e.pageY,h.target.coords=t,h.target.TD=s,h.rowsToMove=this.prepareRowsToMoving();const b=r.holder.scrollLeft+a.getRowHeaderWidth();this.backlight.setPosition(null,b),this.backlight.setSize(r.hider.offsetWidth-b,this.getRowsHeight(C,y)),this.backlight.setOffset((this.getRowsHeight(C,t.row-1)+e.offsetY)*-1,null),oe(this.hot.rootElement,mp),this.refreshPositions()}else De(this.hot.rootElement,pp),h.pressed=!1,h.rowsToMove.length=0}onMouseMove(e){const t=go.get(this);if(t.pressed){if(e.target===this.backlight.element){const s=this.backlight.getSize().height;this.backlight.setSize(null,0),setTimeout(function(){this.backlight.setPosition(null,s)})}t.target.eventPageY=e.pageY,this.refreshPositions()}}onBeforeOnCellMouseOver(e,t,s,o){const r=this.hot.getSelectedRangeLast(),a=go.get(this);!r||!a.pressed||(a.rowsToMove.indexOf(t.row)>-1?De(this.hot.rootElement,lh):oe(this.hot.rootElement,lh),o.row=!0,o.column=!0,o.cell=!0,a.target.coords=t,a.target.TD=s)}onMouseUp(){const e=go.get(this),t=e.target.row,s=e.rowsToMove.length;if(e.pressed=!1,e.backlightHeight=0,De(this.hot.rootElement,[mp,lh,pp]),this.hot.selection.isSelectedByRowHeader()&&oe(this.hot.rootElement,pp),s<1||t===void 0)return;const o=e.rowsToMove[0],r=this.hot.toPhysicalRow(o),a=this.dragRows(e.rowsToMove,t);if(e.rowsToMove.length=0,a===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);const l=this.hot.toVisualRow(r),c=l+s-1;this.hot.selectRows(l,c)}}onAfterScrollHorizontally(){const e=this.hot.view._wt.wtTable,t=this.hot.view._wt.wtViewport.getRowHeaderWidth(),s=e.holder.scrollLeft,o=t+s;this.backlight.setPosition(null,o),this.backlight.setSize(e.hider.offsetWidth-o)}buildPluginUI(){this.backlight.build(),this.guideline.build()}onAfterLoadData(){this.moveBySettingsOrLoad()}destroy(){this.backlight.destroy(),this.guideline.destroy(),super.destroy()}}const ch="manualRowResize",xG=30,m0="manualRowHeights",wp=new WeakMap;class TG extends et{static get PLUGIN_KEY(){return ch}static get PLUGIN_PRIORITY(){return xG}constructor(e){super(e);const{rootDocument:t}=this.hot;this.currentTH=null,this.currentRow=null,this.selectedRows=[],this.currentHeight=null,this.newSize=null,this.startY=null,this.startHeight=null,this.startOffset=null,this.handle=t.createElement("DIV"),this.guide=t.createElement("DIV"),this.eventManager=new bt(this),this.pressed=null,this.isTriggeredByRMB=!1,this.dblclick=0,this.autoresizeTimeout=null,this.rowHeightsMap=void 0,wp.set(this,{config:void 0}),oe(this.handle,"manualRowResizer"),oe(this.guide,"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[ch]}enablePlugin(){this.enabled||(this.rowHeightsMap=new to,this.rowHeightsMap.addLocalHook("init",()=>this.onMapInit()),this.hot.rowIndexMapper.registerMap(this.pluginName,this.rowHeightsMap),this.addHook("modifyRowHeight",(e,t)=>this.onModifyRowHeight(e,t)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){const e=wp.get(this);e.config=this.rowHeightsMap.getValues(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",m0,this.rowHeightsMap.getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",m0,e),e.value}setManualSize(e,t){const s=this.hot.toPhysicalRow(e),o=Math.max(t,zS.DEFAULT_HEIGHT);return this.rowHeightsMap.setValueAtIndex(s,o),o}setupHandlePosition(e){this.currentTH=e;const{view:t}=this.hot,{_wt:s}=t,o=s.wtTable.getCoords(this.currentTH),r=o.row;if(r<0)return;const a=at(this.currentTH),l=this.currentTH.getBoundingClientRect(),c=r<s.getSetting("fixedRowsTop"),h=r>=t.countNotHiddenRowIndexes(0,1)-s.getSetting("fixedRowsBottom");let u;c?u=s.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,o.row,o.col):h&&(u=s.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,o.row,o.col)),u||(u=s.wtOverlays.inlineStartOverlay.getRelativeCellPosition(this.currentTH,o.row,o.col)),this.currentRow=this.hot.rowIndexMapper.getVisualFromRenderableIndex(r),this.selectedRows=[];const f=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&f){const g=this.hot.getSelectedRange();N(g,p=>{const C=p.getTopStartCorner().row,y=p.getBottomStartCorner().row;Ce(C,y,b=>{this.selectedRows.includes(b)||this.selectedRows.push(b)})})}this.selectedRows.includes(this.currentRow)||(this.selectedRows=[this.currentRow]),this.startOffset=u.top-6,this.startHeight=parseInt(l.height,10),this.handle.style.top=`${this.startOffset+this.startHeight}px`,this.handle.style[this.inlineDir]=`${u.start}px`,this.handle.style.width=`${a}px`,this.hot.rootElement.appendChild(this.handle)}refreshHandlePosition(){this.handle.style.top=`${this.startOffset+this.currentHeight}px`}setupGuidePosition(){const e=parseInt(at(this.handle),10),t=parseInt(this.handle.style[this.inlineDir],10)+e,s=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);oe(this.handle,"active"),oe(this.guide,"active"),this.guide.style.top=this.handle.style.top,this.guide.style[this.inlineDir]=`${t}px`,this.guide.style.width=`${s-e}px`,this.hot.rootElement.appendChild(this.guide)}refreshGuidePosition(){this.guide.style.top=this.handle.style.top}hideHandleAndGuide(){De(this.handle,"active"),De(this.guide,"active")}checkIfRowHeader(e){var t;return Io(e,["TH"],this.hot.rootElement)&&((t=e.parentNode)===null||t===void 0||(t=t.parentNode)===null||t===void 0?void 0:t.tagName)==="TBODY"}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const t=this.hot.view._wt.wtTable.getRowHeight(e);return t!==void 0&&this.newSize<t?t:this.newSize}onMouseOver(e){if(!qy(e.target)&&this.isTriggeredByRMB!==!0&&this.checkIfRowHeader(e.target)){const t=this.getClosestTHParent(e.target);t&&(this.pressed||this.setupHandlePosition(t))}}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},t=(s,o)=>{const r=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(s),s,!0);r!==void 0&&(this.newSize=r),this.setManualSize(s,this.newSize),this.hot.runHooks("afterRowResize",this.getActualRowHeight(s),s,!0),o&&e()};this.dblclick>=2&&(this.selectedRows.length>1?(N(this.selectedRows,o=>{t(o)}),e()):N(this.selectedRows,o=>{t(o,!0)})),this.dblclick=0,this.autoresizeTimeout=null}onMouseDown(e){Ae(e.target,"manualRowResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(()=>this.afterMouseDownTimeout(),500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startY=e.pageY,this.newSize=this.startHeight)}onMouseMove(e){this.pressed&&(this.currentHeight=this.startHeight+(e.pageY-this.startY),N(this.selectedRows,t=>{this.newSize=this.setManualSize(t,this.currentHeight)}),this.refreshHandlePosition(),this.refreshGuidePosition())}onMouseUp(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},t=(s,o)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(s),s,!1),o&&e(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(s),s,!1)};this.pressed&&(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startHeight&&(this.selectedRows.length>1?(N(this.selectedRows,o=>{t(o)}),e()):N(this.selectedRows,o=>{t(o,!0)})),this.setupHandlePosition(this.currentTH))}onContextMenu(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(this.handle),this.hot.rootElement.removeChild(this.guide),this.pressed=!1,this.isTriggeredByRMB=!0,this.hot._registerImmediate(()=>{this.isTriggeredByRMB=!1})}bindEvents(){const{rootElement:e,rootWindow:t}=this.hot;this.eventManager.addEventListener(e,"mouseover",s=>this.onMouseOver(s)),this.eventManager.addEventListener(e,"mousedown",s=>this.onMouseDown(s)),this.eventManager.addEventListener(t,"mousemove",s=>this.onMouseMove(s)),this.eventManager.addEventListener(t,"mouseup",()=>this.onMouseUp()),this.eventManager.addEventListener(this.handle,"contextmenu",()=>this.onContextMenu())}onModifyRowHeight(e,t){let s=e;if(this.enabled){const o=this.hot.toPhysicalRow(t),r=this.rowHeightsMap.getValueAtIndex(o);this.hot.getSettings()[ch]&&r&&(s=r)}return s}onMapInit(){const e=wp.get(this),t=this.hot.getSettings()[ch],s=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof s<"u"?s.forEach((o,r)=>{this.rowHeightsMap.setValueAtIndex(r,o)}):Array.isArray(t)?(t.forEach((o,r)=>{this.rowHeightsMap.setValueAtIndex(r,o)}),e.config=t):t===!0&&Array.isArray(e.config)&&e.config.forEach((o,r)=>{this.rowHeightsMap.setValueAtIndex(r,o)})},!0)}destroy(){super.destroy()}}class MG{constructor(e,t,s,o,r,a){this.row=e,this.col=t,this.rowspan=s,this.colspan=o,this.removed=!1,this.cellCoordsFactory=r,this.cellRangeFactory=a}static NEGATIVE_VALUES_WARNING(e){return rt`The merged cell declared with {row: ${e.row}, col: ${e.col},\x20
      rowspan: ${e.rowspan}, colspan: ${e.colspan}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){return rt`The merged cell declared at [${e.row}, ${e.col}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){return rt`The merged cell declared at [${e.row}, ${e.col}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){return rt`The merged cell declared at [${e.row}, ${e.col}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){return e.row<0||e.col<0||e.rowspan<0||e.colspan<0}static isSingleCell(e){return e.colspan===1&&e.rowspan===1}static containsZeroSpan(e){return e.colspan===0||e.rowspan===0}static isOutOfBounds(e,t,s){return e.row<0||e.col<0||e.row>=t||e.row+e.rowspan-1>=t||e.col>=s||e.col+e.colspan-1>=s}normalize(e){const t=e.countRows(),s=e.countCols();this.row<0?this.row=0:this.row>t-1&&(this.row=t-1),this.col<0?this.col=0:this.col>s-1&&(this.col=s-1),this.row+this.rowspan>t-1&&(this.rowspan=t-this.row),this.col+this.colspan>s-1&&(this.colspan=s-this.col)}includes(e,t){return this.row<=e&&this.col<=t&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=t}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,t){const s=e[0]||e[1],o=t+Math.abs(e[0]||e[1])-1,r=e[0]?"colspan":"rowspan",a=e[0]?"col":"row",l=Math.min(t,o),c=Math.max(t,o),h=this[a],u=this[a]+this[r]-1;if(h>=t&&(this[a]+=s),s>0)t<=u&&t>h&&(this[r]+=s);else if(s<0){if(l<=h&&c>=u)return this.removed=!0,!1;if(h>=l&&h<=c){const f=c-h+1,g=Math.abs(s)-f;this[a]-=g+s,this[r]-=f}else if(h<=l&&u>=c)this[r]+=s;else if(h<=l&&u>=l&&u<c){const f=u-l+1;this[r]-=f}}return!0}isFarther(e,t){return e?t==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:t==="up"?e.row>this.row:t==="right"?e.col+e.colspan-1<this.col+this.colspan-1:t==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))}}const ws=MG;function Cp(n,e,t,s){e?e.row===t&&e.col===s?(n.setAttribute("rowspan",e.rowspan.toString()),n.setAttribute("colspan",e.colspan.toString())):(n.removeAttribute("rowspan"),n.removeAttribute("colspan"),n.style.display="none"):(n.removeAttribute("rowspan"),n.removeAttribute("colspan"),n.style.display="")}class yp{constructor(e){this.plugin=e,this.mergedCells=[],this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){return rt`The merged cell declared at [${e.row}, ${e.col}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,t){const s=this.mergedCells;let o=!1;return N(s,r=>r.row<=e&&r.row+r.rowspan-1>=e&&r.col<=t&&r.col+r.colspan-1>=t?(o=r,!1):!0),o}getByRange(e){const t=this.mergedCells;let s=!1;return N(t,o=>o.row<=e.from.row&&o.row+o.rowspan-1>=e.to.row&&o.col<=e.from.col&&o.col+o.colspan-1>=e.to.col?(s=o,s):!0),s}getWithinRange(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const s=this.mergedCells,o=[];let r=e;if(!r.includesRange){const a=this.hot._createCellCoords(r.from.row,r.from.col),l=this.hot._createCellCoords(r.to.row,r.to.col);r=this.hot._createCellRange(a,a,l)}return N(s,a=>{const l=this.hot._createCellCoords(a.row,a.col),c=this.hot._createCellCoords(a.row+a.rowspan-1,a.col+a.colspan-1),h=this.hot._createCellRange(l,l,c);t?r.overlaps(h)&&o.push(a):r.includesRange(h)&&o.push(a)}),o.length?o:!1}add(e){const t=this.mergedCells,s=e.row,o=e.col,r=e.rowspan,a=e.colspan,l=new ws(s,o,r,a,this.hot._createCellCoords,this.hot._createCellRange),c=this.get(s,o),h=this.isOverlapping(l);return!c&&!h?(this.hot&&l.normalize(this.hot),t.push(l),l):(ut(yp.IS_OVERLAPPING_WARNING(l)),!1)}remove(e,t){const s=this.mergedCells,o=this.get(e,t),r=o?this.mergedCells.indexOf(o):-1;return o&&r!==-1?(s.splice(r,1),o):!1}clear(){const e=this.mergedCells,t=[],s=[];N(e,o=>{const r=this.hot.getCell(o.row,o.col);r&&t.push([r,this.get(o.row,o.col),o.row,o.col])}),this.mergedCells.length=0,N(t,(o,r)=>{Ce(0,o.rowspan-1,a=>{Ce(0,o.colspan-1,l=>{if(l!==0||a!==0){const c=this.hot.getCell(o.row+a,o.col+l);c&&s.push([c,null,null,null])}})}),t[r][1]=null}),N(t,o=>{Cp(...o)}),N(s,o=>{Cp(...o)})}isOverlapping(e){const t=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(e.row,e.col),this.hot._createCellCoords(e.row+e.rowspan-1,e.col+e.colspan-1));let s=!1;return N(this.mergedCells,o=>this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(o.row,o.col),this.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1)).overlaps(t)?(s=!0,!1):!0),s}isFirstRenderableMergedCell(e,t){const s=this.get(e,t);return s&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(s.row,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(s.col,1)===t}getFirstRenderableCoords(e,t){const s=this.get(e,t);if(!s||this.isFirstRenderableMergedCell(e,t))return this.hot._createCellCoords(e,t);const o=this.hot.rowIndexMapper.getNearestNotHiddenIndex(s.row,1),r=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s.col,1);return this.hot._createCellCoords(o,r)}shiftCollections(e,t,s){const o=[0,0];switch(e){case"right":o[0]+=s;break;case"left":o[0]-=s;break;case"down":o[1]+=s;break;case"up":o[1]-=s;break}N(this.mergedCells,r=>{r.shift(o,t)}),Td(this.mergedCells.length-1,0,r=>{const a=this.mergedCells[r];a&&a.removed&&this.mergedCells.splice(this.mergedCells.indexOf(a),1)})}}const _G=yp;class IG{constructor(e){this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection,this.currentFillData=null}correctSelectionAreaSize(e){if(e[0]===e[2]&&e[1]===e[3]){const t=this.mergedCellsCollection.get(e[0],e[1]);t&&(e[2]=e[0]+t.rowspan-1,e[3]=e[1]+t.colspan-1)}}getDirection(e,t){let s=null;return t[0]===e[0]&&t[1]===e[1]&&t[3]===e[3]?s="down":t[2]===e[2]&&t[1]===e[1]&&t[3]===e[3]?s="up":t[1]===e[1]&&t[2]===e[2]?s="right":s="left",s}snapDragArea(e,t,s,o){const r=t.slice(0),a=this.getAutofillSize(e,t,s),[l,c,h,u]=e,g=["up","down"].indexOf(s)>-1?h-l+1:u-c+1,p=Math.floor(a/g)*g,C=a-p,y=this.getFarthestCollection(e,t,s,o);if(y){if(s==="down"){const b=y.row+y.rowspan-l-C;r[2]+b>=this.plugin.hot.countRows()?r[2]-=C:r[2]+=C?b:0}else if(s==="right"){const b=y.col+y.colspan-c-C;r[3]+b>=this.plugin.hot.countCols()?r[3]-=C:r[3]+=C?b:0}else if(s==="up"){const b=h-C-y.row+1;r[0]+b<0?r[0]+=C:r[0]-=C?b:0}else if(s==="left"){const b=u-C-y.col+1;r[1]+b<0?r[1]+=C:r[1]-=C?b:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:s,foundMergedCells:o,fillSize:a,dragArea:r,cycleLength:g}),r}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),kt(this.currentFillData,e)}getAutofillSize(e,t,s){const[o,r,a,l]=e,[c,h,u,f]=t;switch(s){case"up":return o-c;case"down":return u-a;case"left":return r-h;case"right":return f-l;default:return null}}getDragArea(e,t,s){const[o,r,a,l]=e,[c,h,u,f]=t;switch(s){case"up":return[c,h,o-1,l];case"down":return[a+1,r,u,l];case"left":return[c,h,a,r-1];case"right":return[o,l+1,u,f];default:return null}}getFarthestCollection(e,t,s,o){const[r,a,l,c]=e,h=["up","down"].indexOf(s)>-1,u=h?l:c,f=h?r:a,g=this.getAutofillSize(e,t,s),p=h?l-r+1:c-a+1,C=Math.floor(g/p)*p,y=g-C;let b=null,T=null,M=null;switch(s){case"up":b="includesVertically",M=u-y+1;break;case"left":b="includesHorizontally",M=u-y+1;break;case"down":b="includesVertically",M=f+y-1;break;case"right":b="includesHorizontally",M=f+y-1;break}return N(o,_=>{_[b](M)&&_.isFarther(T,s)&&(T=_)}),T}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const t=this.getRangeFromChanges(e),s=this.currentFillData.foundMergedCells,o=this.currentFillData.dragDirection,r=(h,u)=>{switch(o){case"up":return h.row-u>=t.from.row;case"down":return h.row+h.rowspan-1+u<=t.to.row;case"left":return h.col-u>=t.from.column;case"right":return h.col+h.colspan-1+u<=t.to.column;default:return null}};let a=0,l=null,c=1;do for(let h=0;h<s.length;h+=1){if(l=s[h],a=c*this.currentFillData.cycleLength,r(l,a))switch(o){case"up":this.plugin.mergedCellsCollection.add({row:l.row-a,rowspan:l.rowspan,col:l.col,colspan:l.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:l.row+a,rowspan:l.rowspan,col:l.col,colspan:l.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:l.row,rowspan:l.rowspan,col:l.col-a,colspan:l.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:l.row,rowspan:l.rowspan,col:l.col+a,colspan:l.colspan});break}h===s.length-1&&(c+=1)}while(r(l,a));this.currentFillData=null,this.plugin.hot.render(),s.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const t={min:null,max:null},s={min:null,max:null};return N(e,o=>{const r=o[0],a=this.plugin.hot.propToCol(o[1]);(t.min===null||r<t.min)&&(t.min=r),(t.max===null||r>t.max)&&(t.max=r),(s.min===null||a<s.min)&&(s.min=a),(s.max===null||a>s.max)&&(s.max=a)}),{from:{row:t.min,column:s.min},to:{row:t.max,column:s.max}}}dragAreaOverlapsCollections(e,t,s){const o=this.getDragArea(e,t,s),[r,a,l,c]=o,h=this.plugin.hot._createCellCoords(r,a),u=this.plugin.hot._createCellCoords(l,c),f=this.plugin.hot._createCellRange(h,h,u);return!!this.mergedCellsCollection.getWithinRange(f,!0)}}const OG=IG;class AG{constructor(e){this.plugin=e,this.hot=e.hot,this.fullySelectedMergedCellClassName="fullySelectedMergedCell"}snapDelta(e,t,s){const o=t.to,r=o.row+e.row,a=o.col+e.col;e.row?this.jumpOverMergedCell(e,s,r):e.col&&this.jumpOverMergedCell(e,s,a)}jumpOverMergedCell(e,t,s){let o=e.row||e.col,r=null,a=null,l=null;e.row?(r=t.includesVertically(s),a=t.row,l=t.getLastRow()):e.col&&(r=t.includesHorizontally(s),a=t.col,l=t.getLastColumn()),o!==0&&(o>0?r&&s!==a&&(o+=l-s+1):r&&s!==l&&(o-=s-a+1),e.row?e.row=o:e.col&&(e.col=o))}getUpdatedSelectionRange(e,t){return this.hot._createCellRange(e.highlight,e.from,this.hot._createCellCoords(e.to.row+t.row,e.to.col+t.col))}getSelectedMergedCellClassName(e,t,s,o){const r=Math.min(s[0],s[2]),a=Math.min(s[1],s[3]),l=Math.max(s[0],s[2]),c=Math.max(s[1],s[3]);if(o===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,t))return;const u=this.plugin.mergedCellsCollection.get(e,t);if(!u)return;const f=u.getLastRow(),g=u.getLastColumn();if(r<=u.row&&a<=u.col&&l>=f&&c>=g)return`${this.fullySelectedMergedCellClassName}-${o}`;if(this.plugin.selectionCalculations.isMergeCellFullySelected(u,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,t){const s=[];if(!t||!e)return!1;for(let o=0;o<e.rowspan;o+=1)for(let r=0;r<e.colspan;r+=1)s.push(this.hot._createCellCoords(e.row+o,e.col+r));for(let o=0;o<s.length;o+=1){const r=[];for(let a=0;a<t.length;a+=1)r[a]=t[a].includes(s[o]);if(!r.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let t=0;t<=7;t+=1)e.push(`${this.fullySelectedMergedCellClassName}-${t}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}const PG=AG;function DG(n){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const t=n.mergedCellsCollection.get(e[0],e[1]);if(t.row===e[0]&&t.col===e[1]&&t.row+t.rowspan-1===e[2]&&t.col+t.colspan-1===e[3])return this.getTranslatedPhrase(Df)}return this.getTranslatedPhrase(Pf)},callback(){n.toggleMergeOnSelection()},disabled(){const e=this.getSelectedLast();return e?ws.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}de.getSingleton().register("beforeMergeCells"),de.getSingleton().register("afterMergeCells"),de.getSingleton().register("beforeUnmergeCells"),de.getSingleton().register("afterUnmergeCells");const Ma="mergeCells",NG=150,p0=new WeakMap,w0=Ma;class HG extends et{static get PLUGIN_KEY(){return Ma}static get PLUGIN_PRIORITY(){return NG}constructor(e){super(e),p0.set(this,{lastDesiredCoords:null}),this.mergedCellsCollection=null,this.autofillCalculations=null,this.selectionCalculations=null}isEnabled(){return!!this.hot.getSettings()[Ma]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new _G(this),this.autofillCalculations=new OG(this),this.selectionCalculations=new PG(this),this.addHook("afterInit",function(){return e.onAfterInit(...arguments)}),this.addHook("modifyTransformStart",function(){return e.onModifyTransformStart(...arguments)}),this.addHook("afterModifyTransformStart",function(){return e.onAfterModifyTransformStart(...arguments)}),this.addHook("modifyTransformEnd",function(){return e.onModifyTransformEnd(...arguments)}),this.addHook("modifyGetCellCoords",function(){return e.onModifyGetCellCoords(...arguments)}),this.addHook("beforeSetRangeStart",function(){return e.onBeforeSetRangeStart(...arguments)}),this.addHook("beforeSetRangeStartOnly",function(){return e.onBeforeSetRangeStart(...arguments)}),this.addHook("beforeSetRangeEnd",function(){return e.onBeforeSetRangeEnd(...arguments)}),this.addHook("afterIsMultipleSelection",function(){return e.onAfterIsMultipleSelection(...arguments)}),this.addHook("afterRenderer",function(){return e.onAfterRenderer(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return e.addMergeActionsToContextMenu(...arguments)}),this.addHook("afterGetCellMeta",function(){return e.onAfterGetCellMeta(...arguments)}),this.addHook("afterViewportRowCalculatorOverride",function(){return e.onAfterViewportRowCalculatorOverride(...arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return e.onAfterViewportColumnCalculatorOverride(...arguments)}),this.addHook("modifyAutofillRange",function(){return e.onModifyAutofillRange(...arguments)}),this.addHook("afterCreateCol",function(){return e.onAfterCreateCol(...arguments)}),this.addHook("afterRemoveCol",function(){return e.onAfterRemoveCol(...arguments)}),this.addHook("afterCreateRow",function(){return e.onAfterCreateRow(...arguments)}),this.addHook("afterRemoveRow",function(){return e.onAfterRemoveRow(...arguments)}),this.addHook("afterChange",function(){return e.onAfterChange(...arguments)}),this.addHook("beforeDrawBorders",function(){return e.onBeforeDrawAreaBorders(...arguments)}),this.addHook("afterDrawSelection",function(){return e.onAfterDrawSelection(...arguments)}),this.addHook("beforeRemoveCellClassNames",function(){return e.onBeforeRemoveCellClassNames(...arguments)}),this.addHook("beforeUndoStackChange",(t,s)=>{if(s==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){const e=this.hot.getSettings()[Ma];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(e),super.updatePlugin()}ifChromeForceRepaint(){if(!fS())return;const e=[];let t=[];this.mergedCellsCollection.mergedCells.forEach(s=>{const{row:o,rowspan:r}=s;for(let a=o+1;a<o+r;a++)t.push(a)}),t=[...new Set(t)],t.forEach(s=>{const o=this.hot.rowIndexMapper.getRenderableFromVisualIndex(s);this.hot.view._wt.wtOverlays.getOverlays(!0).map(r=>(r==null?void 0:r.name)==="master"?r:r.clone.wtTable).forEach(r=>{const a=r.getRow(o);a&&(a.style.background=Vr(a,"backgroundColor").replace(")",", 0.99)"),e.push(a))})}),this.hot._registerTimeout(()=>{e.forEach(s=>{s.style.background=Vr(s,"backgroundColor").replace(", 0.99)",")")})},1)}validateSetting(e){let t=!0;return e?(ws.containsNegativeValues(e)?(ut(ws.NEGATIVE_VALUES_WARNING(e)),t=!1):ws.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(ut(ws.IS_OUT_OF_BOUNDS_WARNING(e)),t=!1):ws.isSingleCell(e)?(ut(ws.IS_SINGLE_CELL(e)),t=!1):ws.containsZeroSpan(e)&&(ut(ws.ZERO_SPAN_WARNING(e)),t=!1),t):!1}generateFromSettings(e){if(Array.isArray(e)){const t=[];if(N(e,s=>{if(!this.validateSetting(s))return;const o=this.hot._createCellCoords(s.row,s.col),r=this.hot._createCellCoords(s.row+s.rowspan-1,s.col+s.colspan-1),a=this.hot._createCellRange(o,o,r);this.mergeRange(a,!0,!0),Ce(s.row,s.row+s.rowspan-1,l=>{Ce(s.col,s.col+s.colspan-1,c=>{l===s.row&&c===s.col||t.push([l,c,null])})})}),t.length===0)return;this.hot.setDataAtCell(t)}}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}toggleMergeOnSelection(){const e=this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:t,to:s}=e;this.toggleMerge(e),this.hot.selectCell(t.row,t.col,s.row,s.col,!1)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:t,to:s}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(t.row,t.col,s.row,s.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:t,to:s}=e;this.unmergeRange(e,!0),this.hot.selectCell(t.row,t.col,s.row,s.col,!1)}mergeRange(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const o=e.getTopStartCorner(),r=e.getBottomEndCorner(),a={row:o.row,col:o.col,rowspan:r.row-o.row+1,colspan:r.col-o.col+1},l=[];let c=null;return this.canMergeRange(a,t)?(this.hot.runHooks("beforeMergeCells",e,t),Ce(0,a.rowspan-1,u=>{Ce(0,a.colspan-1,f=>{let g=null;l[u]||(l[u]=[]),u===0&&f===0?g=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(a.row),this.hot.toPhysicalColumn(a.col)):this.hot.setCellMeta(a.row+u,a.col+f,"hidden",!0),l[u][f]=g})}),this.hot.setCellMeta(a.row,a.col,"spanned",!0),this.mergedCellsCollection.add(a)?(s?c=[a.row,a.col,l]:this.hot.populateFromArray(a.row,a.col,l,void 0,void 0,this.pluginName),t||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,a,t),c):!0):!1}unmergeRange(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const s=this.mergedCellsCollection.getWithinRange(e);s&&(this.hot.runHooks("beforeUnmergeCells",e,t),N(s,o=>{this.mergedCellsCollection.remove(o.row,o.col),Ce(0,o.rowspan-1,r=>{Ce(0,o.colspan-1,a=>{this.hot.removeCellMeta(o.row+r,o.col+a,"hidden"),this.hot.removeCellMeta(o.row+r,o.col+a,"copyable")})}),this.hot.removeCellMeta(o.row,o.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,t),this.hot.render())}toggleMerge(e){const t=this.mergedCellsCollection.get(e.from.row,e.from.col);t.row===e.from.row&&t.col===e.from.col&&t.row+t.rowspan-1===e.to.row&&t.col+t.colspan-1===e.to.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,t,s,o){const r=this.hot._createCellCoords(e,t),a=this.hot._createCellCoords(s,o);this.mergeRange(this.hot._createCellRange(r,r,a))}unmerge(e,t,s,o){const r=this.hot._createCellCoords(e,t),a=this.hot._createCellCoords(s,o);this.unmergeRange(this.hot._createCellRange(r,r,a))}onAfterInit(){this.generateFromSettings(this.hot.getSettings()[Ma]),this.hot.render()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{this.toggleMerge(this.hot.getSelectedRangeLast()),this.hot.render()},runOnlyIf:s=>!s.altKey,group:w0})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(w0)}onAfterIsMultipleSelection(e){if(e){const t=this.mergedCellsCollection.mergedCells,s=this.hot.getSelectedRangeLast();for(let o=0;o<t.length;o+=1)if(s.from.row===t[o].row&&s.from.col===t[o].col&&s.to.row===t[o].row+t[o].rowspan-1&&s.to.col===t[o].col+t[o].colspan-1)return!1}return e}onModifyTransformStart(e){const t=p0.get(this),s=this.hot.getSelectedRangeLast();let o={row:e.row,col:e.col},r=null;const a=this.hot._createCellCoords(s.highlight.row,s.highlight.col),l=this.mergedCellsCollection.get(a.row,a.col);if(t.lastDesiredCoords||(t.lastDesiredCoords=this.hot._createCellCoords(null,null)),l){const h=this.hot._createCellCoords(l.row,l.col),u=this.hot._createCellCoords(l.row+l.rowspan-1,l.col+l.colspan-1);this.hot._createCellRange(h,h,u).includes(t.lastDesiredCoords)||(t.lastDesiredCoords=this.hot._createCellCoords(null,null)),o.row=t.lastDesiredCoords.row?t.lastDesiredCoords.row-a.row:o.row,o.col=t.lastDesiredCoords.col?t.lastDesiredCoords.col-a.col:o.col,e.row>0?o.row=l.row+l.rowspan-1-a.row+e.row:e.row<0&&(o.row=a.row-l.row+e.row),e.col>0?o.col=l.col+l.colspan-1-a.col+e.col:e.col<0&&(o.col=a.col-l.col+e.col)}r=this.hot._createCellCoords(s.highlight.row+o.row,s.highlight.col+o.col);const c=this.mergedCellsCollection.get(r.row,r.col);if(c){const h=this.mergedCellsCollection.getFirstRenderableCoords(c.row,c.col);t.lastDesiredCoords=r,o={row:h.row-a.row,col:h.col-a.col}}o.row!==0&&(e.row=o.row),o.col!==0&&(e.col=o.col)}onModifyTransformEnd(e){const t=this.hot.getSelectedRangeLast(),s=dn(e),o=this.selectionCalculations.getUpdatedSelectionRange(t,e);let r=dn(s);const a=this.mergedCellsCollection.getWithinRange(o,!0);do r=dn(s),this.selectionCalculations.getUpdatedSelectionRange(t,s),N(a,l=>{this.selectionCalculations.snapDelta(s,t,l)});while(s.row!==r.row||s.col!==r.col);e.row=s.row,e.col=s.col}onModifyGetCellCoords(e,t){if(e<0||t<0)return;const s=this.mergedCellsCollection.get(e,t);if(!s)return;const{row:o,col:r,colspan:a,rowspan:l}=s;return[o,r,o+l-1,r+a-1]}addMergeActionsToContextMenu(e){e.items.push({name:"---------"},DG(this))}onAfterRenderer(e,t,s){const o=this.mergedCellsCollection.get(t,s),r=Fe(o)?dn(o):void 0;if(Fe(r)){const{rowIndexMapper:a,columnIndexMapper:l}=this.hot,{row:c,col:h,colspan:u,rowspan:f}=r,[g,p]=this.translateMergedCellToRenderable(c,f,h,u),C=a.getRenderableFromVisualIndex(t),y=l.getRenderableFromVisualIndex(s),b=g-C+1,T=p-y+1;r.row=a.getNearestNotHiddenIndex(r.row,1),r.col=l.getNearestNotHiddenIndex(r.col,1),r.rowspan=Math.min(r.rowspan,b),r.colspan=Math.min(r.colspan,T)}Cp(e,r,t,s)}onBeforeSetRangeStart(e){if(this.mergedCellsCollection.isFirstRenderableMergedCell(e.row,e.col)){const t=this.mergedCellsCollection.get(e.row,e.col);[e.row,e.col]=[t.row,t.col]}}onBeforeSetRangeEnd(e){const t=this.hot.getSelectedRangeLast();t.highlight=this.hot._createCellCoords(t.highlight.row,t.highlight.col),t.to=e;let s=!1;if(!(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()))do{s=!1;for(let o=0;o<this.mergedCellsCollection.mergedCells.length;o+=1){const a=this.mergedCellsCollection.mergedCells[o].getRange();t.expandByRange(a)&&(e.row=t.to.row,e.col=t.to.col,s=!0)}}while(s)}onAfterGetCellMeta(e,t,s){const o=this.mergedCellsCollection.get(e,t);o&&(o.row!==e||o.col!==t?s.copyable=!1:(s.rowspan=o.rowspan,s.colspan=o.colspan))}onAfterViewportRowCalculatorOverride(e){const t=this.hot.countCols();this.modifyViewportRowStart(e,t),this.modifyViewportRowEnd(e,t)}modifyViewportRowStart(e,t){const s=this.hot.rowIndexMapper,o=s.getVisualFromRenderableIndex(e.startRow);for(let r=0;r<t;r+=1){const a=this.mergedCellsCollection.get(o,r);if(Fe(a)){const l=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(a.row,1));if(l<e.startRow){e.startRow=l,this.modifyViewportRowStart(e,t);return}}}}modifyViewportRowEnd(e,t){const s=this.hot.rowIndexMapper,o=s.getVisualFromRenderableIndex(e.endRow);for(let r=0;r<t;r+=1){const a=this.mergedCellsCollection.get(o,r);if(Fe(a)){const l=a.row+a.rowspan-1,c=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(l,-1));if(c>e.endRow){e.endRow=c,this.modifyViewportRowEnd(e,t);return}}}}onAfterViewportColumnCalculatorOverride(e){const t=this.hot.countRows();this.modifyViewportColumnStart(e,t),this.modifyViewportColumnEnd(e,t)}modifyViewportColumnStart(e,t){const s=this.hot.columnIndexMapper,o=s.getVisualFromRenderableIndex(e.startColumn);for(let r=0;r<t;r+=1){const a=this.mergedCellsCollection.get(r,o);if(Fe(a)){const l=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(a.col,1));if(l<e.startColumn){e.startColumn=l,this.modifyViewportColumnStart(e,t);return}}}}modifyViewportColumnEnd(e,t){const s=this.hot.columnIndexMapper,o=s.getVisualFromRenderableIndex(e.endColumn);for(let r=0;r<t;r+=1){const a=this.mergedCellsCollection.get(r,o);if(Fe(a)){const l=a.col+a.colspan-1,c=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(l,-1));if(c>e.endColumn){e.endColumn=c,this.modifyViewportColumnEnd(e,t);return}}}}translateMergedCellToRenderable(e,t,s,o){const{rowIndexMapper:r,columnIndexMapper:a}=this.hot;let l,c;t===0?l=r.getNearestNotHiddenIndex(e,1):l=r.getNearestNotHiddenIndex(e+t-1,-1),o===0?c=a.getNearestNotHiddenIndex(s,1):c=a.getNearestNotHiddenIndex(s+o-1,-1);const h=e>=0?r.getRenderableFromVisualIndex(l):e,u=s>=0?a.getRenderableFromVisualIndex(c):s;return[h,u]}onModifyAutofillRange(e,t){this.autofillCalculations.correctSelectionAreaSize(t);const s=this.autofillCalculations.getDirection(t,e);let o=e;if(this.autofillCalculations.dragAreaOverlapsCollections(t,o,s))return o=t,o;const r=this.mergedCellsCollection.getWithinRange({from:{row:t[0],col:t[1]},to:{row:t[2],col:t[3]}});return r&&(o=this.autofillCalculations.snapDragArea(t,o,s,r)),o}onAfterCreateCol(e,t){this.mergedCellsCollection.shiftCollections("right",e,t)}onAfterRemoveCol(e,t){this.mergedCellsCollection.shiftCollections("left",e,t)}onAfterCreateRow(e,t,s){s!=="auto"&&this.mergedCellsCollection.shiftCollections("down",e,t)}onAfterRemoveRow(e,t){this.mergedCellsCollection.shiftCollections("up",e,t)}onAfterChange(e,t){t==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(e)}onBeforeDrawAreaBorders(e,t){if(t&&t==="area"){const s=this.hot.getSelectedRangeLast(),o=this.mergedCellsCollection.getWithinRange(s);N(o,r=>{s.getBottomEndCorner().row===r.getLastRow()&&s.getBottomEndCorner().col===r.getLastColumn()&&(e[2]=r.row,e[3]=r.col)})}}onAfterModifyTransformStart(e,t,s){if(!this.enabled)return;const o=this.mergedCellsCollection.get(e.row,e.col);if(!o)return;const r=t>0,a=t<0,l=s<0,c=s>0,h=o.row+o.rowspan-1===this.hot.countRows()-1,u=o.row===0,f=o.col+o.colspan-1===this.hot.countCols()-1,g=o.col===0;(r&&h||a&&u||c&&f||l&&g)&&(e.row=o.row,e.col=o.col)}onAfterDrawSelection(e,t,s,o){if(s)return this.selectionCalculations.getSelectedMergedCellClassName(e,t,s,o)}onBeforeRemoveCellClassNames(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}}function kG(n,e){return function(t,s){const[,...o]=t,[,...r]=s;return function a(l){const c=n[l],h=e[l],u=o[l],f=r[l],g=h.multiColumnSorting,C=(g.compareFunctionFactory?g.compareFunctionFactory:Bb(h.type))(c,h,g)(u,f);if(C===us){const y=l+1;if(typeof e[y]<"u")return a(y)}return C}(0)}}function C0(){ut(rt`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously. 
    Only \`multiColumnSorting\` will work.`)}const y0="sort";function LG(n,e,t){const s=[];return t===!1||n.isColumnSorted(e)&&n.getNumberOfSortedColumns()>1&&s.push(`${y0}-${n.getIndexOfColumnInSortQueue(e)+1}`),s}function VG(n){const e=n.className.split(" "),t=new RegExp(`^${y0}-[0-9]{1,2}$`);return e.filter(s=>t.test(s))}const Sp="multiColumnSorting",$G=170,FG="append",S0="columnSorting";Fb(Sp,kG);class BG extends Ub{static get PLUGIN_KEY(){return Sp}static get PLUGIN_PRIORITY(){return $G}constructor(e){super(e),this.pluginKey=Sp}isEnabled(){return super.isEnabled()}enablePlugin(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[S0]&&C0(),super.enablePlugin()}disablePlugin(){super.disablePlugin()}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var t=arguments.length,s=new Array(t>1?t-1:0),o=1;o<t;o++)s[o-1]=arguments[o];super.updateHeaderClasses(e,...s),De(e,VG(e)),this.enabled!==!1&&oe(e,LG(...s))}onUpdateSettings(e){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[S0]&&C0(),super.onUpdateSettings(e)}onAfterOnCellMouseDown(e,t){um(t.row,t.col,e)!==!1&&this.wasClickableHeaderClicked(e,t.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(t.col),this.sort(this.getNextSortConfig(t.col,FG))):this.sort(this.getColumnNextConfig(t.col)))}}const WG="multipleSelectionHandles",UG=160;class zG extends et{static get PLUGIN_KEY(){return WG}static get PLUGIN_PRIORITY(){return UG}constructor(e){super(e),this.dragged=[],this.eventManager=null,this.lastSetCell=null}isEnabled(){return os()}enablePlugin(){this.enabled||(this.eventManager||(this.eventManager=new bt(this)),this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:t}=this.hot;function s(o){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const r=e.dragged.indexOf(o);if(r===-1)return!1;r===0?e.dragged=e.dragged.slice(0,1):r===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(t,"touchstart",o=>{let r;if(Ae(o.target,"topSelectionHandle-HitArea"))return r=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:r.getWidth(),height:r.getHeight(),direction:r.getDirection()},o.preventDefault(),!1;if(Ae(o.target,"bottomSelectionHandle-HitArea"))return r=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:r.getWidth(),height:r.getHeight(),direction:r.getDirection()},o.preventDefault(),!1}),this.eventManager.addEventListener(t,"touchend",o=>{if(Ae(o.target,"topSelectionHandle-HitArea"))return s.call(e,"top"),e.touchStartRange=void 0,o.preventDefault(),!1;if(Ae(o.target,"bottomSelectionHandle-HitArea"))return s.call(e,"bottom"),e.touchStartRange=void 0,o.preventDefault(),!1}),this.eventManager.addEventListener(t,"touchmove",o=>{const{rootDocument:r}=this.hot;let a,l,c,h,u,f;if(e.dragged.length===0)return;const g=r.elementFromPoint(o.touches[0].clientX,o.touches[0].clientY);!g||g===e.lastSetCell||((g.nodeName==="TD"||g.nodeName==="TH")&&(a=e.hot.getCoords(g),a.col===-1&&(a.col=0),l=e.hot.getSelectedRangeLast(),c=l.getWidth(),h=l.getHeight(),u=l.getDirection(),c===1&&h===1&&e.hot.selection.setRangeEnd(a),f=e.getCurrentRangeCoords(l,a,e.touchStartRange.direction,u,e.dragged[0]),f.start!==null&&e.hot.selection.setRangeStart(f.start),e.hot.selection.setRangeEnd(f.end),e.lastSetCell=g),o.preventDefault())})}getCurrentRangeCoords(e,t,s,o,r){const a=e.getTopStartCorner(),l=e.getBottomEndCorner(),c=e.getBottomStartCorner(),h=e.getTopEndCorner();let u={start:null,end:null};switch(s){case"NE-SW":switch(o){case"NE-SW":case"NW-SE":r==="top"?u={start:this.hot._createCellCoords(t.row,e.highlight.col),end:this.hot._createCellCoords(c.row,t.col)}:u={start:this.hot._createCellCoords(e.highlight.row,t.col),end:this.hot._createCellCoords(t.row,a.col)};break;case"SE-NW":r==="bottom"&&(u={start:this.hot._createCellCoords(l.row,t.col),end:this.hot._createCellCoords(t.row,a.col)});break}break;case"NW-SE":switch(o){case"NE-SW":r==="top"?u={start:t,end:c}:u.end=t;break;case"NW-SE":r==="top"?u={start:t,end:l}:u.end=t;break;case"SE-NW":r==="top"?u={start:t,end:a}:u.end=t;break;case"SW-NE":r==="top"?u={start:t,end:h}:u.end=t;break}break;case"SW-NE":switch(o){case"NW-SE":r==="bottom"?u={start:this.hot._createCellCoords(t.row,a.col),end:this.hot._createCellCoords(c.row,t.col)}:u={start:this.hot._createCellCoords(a.row,t.col),end:this.hot._createCellCoords(t.row,l.col)};break;case"SW-NE":r==="top"?u={start:this.hot._createCellCoords(e.highlight.row,t.col),end:this.hot._createCellCoords(t.row,l.col)}:u={start:this.hot._createCellCoords(t.row,a.col),end:this.hot._createCellCoords(a.row,t.col)};break;case"SE-NW":r==="bottom"?u={start:this.hot._createCellCoords(t.row,h.col),end:this.hot._createCellCoords(a.row,t.col)}:r==="top"&&(u={start:c,end:t});break}break;case"SE-NW":switch(o){case"NW-SE":case"NE-SW":case"SW-NE":r==="top"&&(u.end=t);break;case"SE-NW":r==="top"?u.end=t:u={start:t,end:a};break}break}return u}isDragged(){return this.dragged.length>0}}function vp(){let{label:n="",colspan:e=1,origColspan:t=1,collapsible:s=!1,crossHiddenColumns:o=[],isCollapsed:r=!1,isHidden:a=!1,isRoot:l=!1,isPlaceholder:c=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:n,colspan:e,origColspan:t,collapsible:s,isCollapsed:r,crossHiddenColumns:o,isHidden:a,isRoot:l,isPlaceholder:c}}function v0(){return{label:"",isPlaceholder:!0}}function YG(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const t=[];if(e===0)return t;N(n,o=>{const r=[];let a=0;t.push(r),N(o,l=>{const c=vp();if(Fe(l)){const{label:u,colspan:f}=l;c.label=At(u),typeof f=="number"&&f>1&&(c.colspan=f,c.origColspan=f)}else c.label=At(l);a+=c.origColspan;let h=!1;if(a>=e&&(c.colspan=c.origColspan-(a-e),c.origColspan=c.colspan,h=!0),r.push(c),c.colspan>1)for(let u=0;u<c.colspan-1;u++)r.push(v0());return!h})});const s=Math.max(...$e(t,o=>o.length));return N(t,o=>{if(o.length<s){const r=$e(new Array(s-o.length),()=>vp());o.splice(o.length,0,...r)}}),t}function bp(n,e,t){GG(n,e),e.set(n,t)}function GG(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xn(n,e){var t=b0(n,e,"get");return jG(n,t)}function jG(n,e){return e.get?e.get.call(n):e.value}function _a(n,e,t){var s=b0(n,e,"set");return KG(n,s,t),t}function b0(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function KG(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}const R0=["label","collapsible"];var Fs=new WeakMap,ti=new WeakMap,Rp=new WeakMap;class XG{constructor(){bp(this,Fs,{writable:!0,value:[]}),bp(this,ti,{writable:!0,value:0}),bp(this,Rp,{writable:!0,value:1/0})}setColumnsLimit(e){_a(this,Rp,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];_a(this,Fs,YG(e,Xn(this,Rp))),_a(this,ti,Xn(this,Fs).length)}getData(){return Xn(this,Fs)}mergeWith(e){N(e,t=>{let{row:s,col:o,...r}=t;const a=this.getHeaderSettings(s,o);a!==null&&kt(a,r,R0)})}map(e){N(Xn(this,Fs),t=>{N(t,s=>{const o=e({...s});Fe(o)&&kt(s,o,R0)})})}getHeaderSettings(e,t){var s;if(e>=Xn(this,ti)||e<0)return null;const o=Xn(this,Fs)[e];return t>=o.length?null:(s=o[t])!==null&&s!==void 0?s:null}getHeadersSettings(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const o=[];if(e>=Xn(this,ti)||e<0)return o;const r=Xn(this,Fs)[e];let a=0;for(let l=t;l<r.length;l++){const c=r[l];if(c.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(a+=c.colspan,o.push(c),c.colspan>1&&(l+=c.colspan-1),a===s)break;if(a>s)throw new Error("The last column settings cannot overlap the other header layers")}return o}getLayersCount(){return Xn(this,ti)}getColumnsCount(){return Xn(this,ti)>0?Xn(this,Fs)[0].length:0}clear(){_a(this,Fs,[]),_a(this,ti,0)}}function Ep(n,e,t){return e=qG(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function qG(n){var e=ZG(n,"string");return typeof e=="symbol"?e:String(e)}function ZG(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const QG="DF-pre-order";function E0(n,e){let t=n.call(e,this);for(let s=0;s<this.childs.length;s++){if(t===!1)return!1;t=E0.call(this.childs[s],n,e)}return t}const JG="DF-post-order";function x0(n,e){for(let t=0;t<this.childs.length;t++)if(x0.call(this.childs[t],n,e)===!1)return!1;return n.call(e,this)}const T0="BF";function ej(n,e){const t=[this];function s(){if(t.length===0)return;const o=t.shift();t.push(...o.childs),n.call(e,o)!==!1&&s()}s()}const tj=T0,M0=new Map([[QG,E0],[JG,x0],[T0,ej]]);class hh{constructor(e){Ep(this,"data",{}),Ep(this,"parent",null),Ep(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const t=new hh({...e.data});for(let s=0;s<e.childs.length;s++)t.addChild(this.cloneTree(e.childs[s]));return t}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let t=0;t<e.childs.length;t++)this.addChild(e.childs[t])}walkDown(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:tj;if(!M0.has(t))throw new Error(`Traversal strategy "${t}" does not exist`);M0.get(t).call(this,e,this)}walkUp(e){const t=this,s=o=>{e.call(t,o)!==!1&&o.parent!==null&&s(o.parent)};s(this)}}function xp(n,e,t){nj(n,e),e.set(n,t)}function nj(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cn(n,e){var t=_0(n,e,"get");return sj(n,t)}function sj(n,e){return e.get?e.get.call(n):e.value}function oj(n,e,t){var s=_0(n,e,"set");return ij(n,s,t),t}function _0(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function ij(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}var tr=new WeakMap,ni=new WeakMap,nr=new WeakMap;class rj{constructor(e){xp(this,tr,{writable:!0,value:new Map}),xp(this,ni,{writable:!0,value:new Map}),xp(this,nr,{writable:!0,value:null}),oj(this,nr,e)}getRoots(){return Array.from(cn(this,tr).values())}getRootByColumn(e){let t;return cn(this,ni).has(e)&&(t=cn(this,tr).get(cn(this,ni).get(e))),t}getNode(e,t){const s=this.getRootByColumn(t);if(!s)return;const o=t-cn(this,ni).get(t);let r=0,a;return s.walkDown(l=>{const{data:{origColspan:c,headerLevel:h}}=l;if(e===h){if(o>=r&&o<=r+c-1)return a=l,a.data.isRoot=t===a.data.columnIndex,!1;r+=c}}),a}rebuildTreeIndex(){let e=0;cn(this,ni).clear(),N(cn(this,tr),t=>{let[,{data:{colspan:s}}]=t;for(let o=e;o<e+s;o++)cn(this,ni).set(o,e);e+=s})}buildTree(){this.clear();const e=cn(this,nr).getColumnsCount();let t=0;for(;t<e;){const s=cn(this,nr).getHeaderSettings(0,t),o=new hh;cn(this,tr).set(t,o),this.buildLeaves(o,t,0,s.origColspan),t+=s.origColspan}this.rebuildTreeIndex()}buildLeaves(e,t,s){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const r=cn(this,nr).getHeadersSettings(s,t,o);s+=1,N(r,a=>{const l={...a,headerLevel:s-1,columnIndex:t};let c;s===1?(e.data=l,c=e):(c=new hh(l),e.addChild(c)),s<cn(this,nr).getLayersCount()&&this.buildLeaves(c,t,s,a.origColspan),t+=a.origColspan})}clear(){cn(this,tr).clear(),cn(this,ni).clear()}}function I0(n,e){n.walkDown(t=>{let{data:s,childs:o}=t;if(!s.isHidden&&(e(s.columnIndex),o.length===0))for(let r=1;r<s.colspan;r++)e(s.columnIndex+r)})}function uh(n,e){let{childs:t}=n;if(t.length!==0)return t[0].data[e]}function dh(n){return uh(n,"origColspan")===n.data.origColspan}function Tp(n){const{data:e,childs:t}=n;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(dh(n))return Tp(t[0]);e.isCollapsed=!1;const o=t.slice(1),r=new Set;let a=0;if(o.length>0)N(o,l=>{l.replaceTreeWith(l.data.clonedTree),l.data.clonedTree=null;const c=l.data;a+=c.colspan,I0(l,h=>{r.add(h)})});else{const{colspan:l,origColspan:c,columnIndex:h}=e;a=c-l;for(let u=1;u<c;u++)r.add(h+u)}return n.walkUp(l=>{const{data:c}=l;c.colspan+=a,c.colspan>=c.origColspan?(c.colspan=c.origColspan,c.isCollapsed=!1):dh(l)&&(c.isCollapsed=uh(l,"isCollapsed"))}),{rollbackModification:()=>Mp(n),affectedColumns:Array.from(r),colspanCompensation:a}}function Mp(n){var e;const{data:t,childs:s}=n;if(t.isCollapsed||t.isHidden||t.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(dh(n))return Mp(s[0]);t.isCollapsed=!0;const r=s.slice(1),a=new Set;if(r.length>0)N(r,c=>{I0(c,h=>{a.add(h)}),c.data.clonedTree=c.cloneTree(),c.walkDown(h=>{let{data:u}=h;u.isHidden=!0})});else{const{origColspan:c,columnIndex:h}=t;for(let u=1;u<c;u++){const f=h+u;a.add(f)}}const l=t.colspan-((e=uh(n,"colspan"))!==null&&e!==void 0?e:1);return n.walkUp(c=>{const{data:h}=c;h.colspan-=l,h.colspan<=1?(h.colspan=1,h.isCollapsed=!0):dh(c)&&(h.isCollapsed=uh(c,"isCollapsed"))}),{rollbackModification:()=>Tp(n),affectedColumns:Array.from(a),colspanCompensation:l}}function aj(n,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(n.childs.length>0)throw new Error(rt`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:t}=n.data;if(t.includes(e))return;let s=!1;n.walkUp(o=>{const{data:{collapsible:r}}=o;if(r)return s=!0,!1}),!s&&n.walkUp(o=>{const{data:r}=o;r.crossHiddenColumns.push(e),r.colspan>1?r.colspan-=1:r.isHidden=!0})}function lj(n,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(n.childs.length>0)throw new Error(rt`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:t}=n.data;if(!t.includes(e))return;let s=!1;n.walkUp(o=>{const{data:{collapsible:r}}=o;if(r)return s=!0,!1}),!s&&n.walkUp(o=>{const{data:r}=o;r.crossHiddenColumns.splice(r.crossHiddenColumns.indexOf(e),1),!r.isHidden&&r.colspan<r.origColspan&&(r.colspan+=1),r.isHidden=!1})}const O0=new Map([["collapse",Mp],["expand",Tp],["hide-column",aj],["show-column",lj]]);function cj(n,e,t){if(!O0.has(n))throw new Error(`The node modifier action ("${n}") does not exist.`);return O0.get(n)(e,t)}function fh(n){const e=[];return N(n,t=>{t.walkDown(s=>{const o=s.data,{origColspan:r,columnIndex:a,headerLevel:l,crossHiddenColumns:c}=o,h=uj(e,l);let u=!1;for(let f=a;f<a+r;f++)if(c.includes(f)||u)h.push(v0());else{const p=hj(o);p.isRoot=!0,h.push(p),u=!0}})}),e}function hj(n){const{crossHiddenColumns:e,...t}=vp(n);return t}function uj(n,e){let t;return Array.isArray(n[e])?t=n[e]:(t=[],n[e]=t),t}function _p(n,e,t){dj(n,e),e.set(n,t)}function dj(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ia(n,e,t){var s=A0(n,e,"set");return fj(n,s,t),t}function fj(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}function _t(n,e){var t=A0(n,e,"get");return gj(n,t)}function A0(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function gj(n,e){return e.get?e.get.call(n):e.value}var Cs=new WeakMap,xn=new WeakMap,si=new WeakMap;class mj{constructor(){_p(this,Cs,{writable:!0,value:new XG}),_p(this,xn,{writable:!0,value:new rj(_t(this,Cs))}),_p(this,si,{writable:!0,value:[[]]})}setState(e){_t(this,Cs).setData(e);let t=!1;try{_t(this,xn).buildTree()}catch{_t(this,xn).clear(),_t(this,Cs).clear(),t=!0}return Ia(this,si,fh(_t(this,xn).getRoots())),t}setColumnsLimit(e){_t(this,Cs).setColumnsLimit(e)}mergeStateWith(e){const t=$e(e,s=>{let{row:o,...r}=s;return{row:o<0?this.rowCoordsToLevel(o):o,...r}});_t(this,Cs).mergeWith(t),_t(this,xn).buildTree(),Ia(this,si,fh(_t(this,xn).getRoots()))}mapState(e){_t(this,Cs).map(e),_t(this,xn).buildTree(),Ia(this,si,fh(_t(this,xn).getRoots()))}mapNodes(e){return Qt(_t(this,xn).getRoots(),(t,s)=>(s.walkDown(o=>{const r=e(o.data);r!==void 0&&t.push(r)}),t),[])}triggerNodeModification(e,t,s){t<0&&(t=this.rowCoordsToLevel(t));const o=_t(this,xn).getNode(t,s);let r;return o&&(r=cj(e,o,s),Ia(this,si,fh(_t(this,xn).getRoots()))),r}triggerColumnModification(e,t){return this.triggerNodeModification(e,-1,t)}rowCoordsToLevel(e){if(e>=0)return null;const t=e+Math.max(this.getLayersCount(),1);return t<0?null:t}levelToRowCoords(e){if(e<0)return null;const t=e-Math.max(this.getLayersCount(),1);return t>=0?null:t}getHeaderSettings(e,t){var s,o;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(s=(o=_t(this,si)[e])===null||o===void 0?void 0:o[t])!==null&&s!==void 0?s:null}getHeaderTreeNodeData(e,t){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const s=_t(this,xn).getNode(e,t);return s?{...s.data}:null}findLeftMostColumnIndex(e,t){var s;const{isRoot:o}=(s=this.getHeaderSettings(e,t))!==null&&s!==void 0?s:{isRoot:!0};if(o)return t;let r=t-1;for(;r>=0;){var a;const{isRoot:l}=(a=this.getHeaderSettings(e,r))!==null&&a!==void 0?a:{isRoot:!0};if(l)break;r-=1}return r}getLayersCount(){return _t(this,Cs).getLayersCount()}getColumnsCount(){return _t(this,Cs).getColumnsCount()}clear(){Ia(this,si,[]),_t(this,Cs).clear(),_t(this,xn).clear()}}function Oa(n,e,t){return e=pj(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function pj(n){var e=wj(n,"string");return typeof e=="symbol"?e:String(e)}function wj(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Cj{constructor(e,t){Oa(this,"hot",void 0),Oa(this,"nestedHeaderSettingsGetter",void 0),Oa(this,"layersCount",0),Oa(this,"container",void 0),Oa(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=t,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const e=this.container.querySelectorAll("tr:last-of-type th"),t=e.length;this.widthsMap.clear();for(let s=0;s<t;s++){const o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(s),r=this.hot.toPhysicalColumn(o);this.widthsMap.setValueAtIndex(r,e[s].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:t,columnIndexMapper:s}=this.hot,o=t.createDocumentFragment(),r=t.createElement("table"),a=!!this.hot.getSettings().dropdownMenu,l=s.getRenderableIndexesLength();for(let c=0;c<this.layersCount;c++){const h=t.createElement("tr");for(let u=0;u<l;u++){let f=s.getVisualFromRenderableIndex(u);f===null&&(f=u);const g=t.createElement("th"),p=this.nestedHeaderSettingsGetter(c,f);if(p&&(!p.isPlaceholder||p.isHidden)){let C=p.label;a&&(C+='<button class="changeType"></button>'),Si(g,C),g.colSpan=p.colspan,h.appendChild(g)}}r.appendChild(h)}o.appendChild(r),e.appendChild(o)}clear(){this.widthsMap.clear(),this.container=null}}const yj=Cj;function P0(n,e,t){return e=Sj(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Sj(n){var e=vj(n,"string");return typeof e=="symbol"?e:String(e)}function vj(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function D0(n,e,t){bj(n,e),e.set(n,t)}function bj(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gh(n,e,t){var s=N0(n,e,"set");return Rj(n,s,t),t}function Rj(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}function Tt(n,e){var t=N0(n,e,"get");return Ej(n,t)}function N0(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function Ej(n,e){return e.get?e.get.call(n):e.value}const H0="nestedHeaders",xj=280;var Dt=new WeakMap,mo=new WeakMap;class Tj extends et{constructor(){super(...arguments),D0(this,Dt,{writable:!0,value:new mj}),D0(this,mo,{writable:!0,value:null}),P0(this,"ghostTable",new yj(this.hot,(e,t)=>this.getHeaderSettings(e,t))),P0(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return H0}static get PLUGIN_PRIORITY(){return xj}isEnabled(){return!!this.hot.getSettings()[H0]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:t}=this.hot.getSettings();(!Array.isArray(t)||!Array.isArray(t[0]))&&ut(rt`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>this.onInit()),this.addHook("afterLoadData",function(){return e.onAfterLoadData(...arguments)}),this.addHook("beforeOnCellMouseDown",function(){return e.onBeforeOnCellMouseDown(...arguments)}),this.addHook("afterOnCellMouseDown",function(){return e.onAfterOnCellMouseDown(...arguments)}),this.addHook("beforeOnCellMouseOver",function(){return e.onBeforeOnCellMouseOver(...arguments)}),this.addHook("afterGetColumnHeaderRenderers",s=>this.onAfterGetColumnHeaderRenderers(s)),this.addHook("modifyColWidth",function(){return e.onModifyColWidth(...arguments)}),this.addHook("modifyColumnHeaderValue",function(){return e.onModifyColumnHeaderValue(...arguments)}),this.addHook("beforeHighlightingColumnHeader",function(){return e.onBeforeHighlightingColumnHeader(...arguments)}),this.addHook("beforeCopy",function(){return e.onBeforeCopy(...arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return e.onAfterViewportColumnCalculatorOverride(...arguments)}),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();Tt(this,Dt).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=Tt(this,Dt).setState(e)),this.detectedOverlappedHeaders&&ut(rt`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((t,s)=>{const o=t===!0?"hide-column":"show-column";Tt(this,Dt).triggerColumnModification(o,s)}),!Tt(this,mo)&&this.enabled&&gh(this,mo,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(t=>{t.forEach(s=>{let{op:o,index:r,newValue:a}=s;if(o==="replace"){const l=a===!0?"hide-column":"show-column";Tt(this,Dt).triggerColumnModification(l,r)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),Tt(this,Dt).clear(),Tt(this,mo).unsubscribe(),gh(this,mo,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return Tt(this,Dt)}getLayersCount(){return Tt(this,Dt).getLayersCount()}getHeaderSettings(e,t){return Tt(this,Dt).getHeaderSettings(e,t)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,t=e.getSetting("columnHeaders").length,s=e.wtTable.THEAD,o=e.wtOverlays.topOverlay.clone.wtTable.THEAD,r=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let a=0;a<t;a++){const l=s.childNodes[a];if(!l)break;const c=o.childNodes[a],h=r?r.childNodes[a]:null;for(let u=0,f=l.childNodes.length;u<f;u++)l.childNodes[u].removeAttribute("colspan"),De(l.childNodes[u],"hiddenHeader"),c&&c.childNodes[u]&&(c.childNodes[u].removeAttribute("colspan"),De(c.childNodes[u],"hiddenHeader")),r&&h&&h.childNodes[u]&&(h.childNodes[u].removeAttribute("colspan"),De(h.childNodes[u],"hiddenHeader"))}}headerRendererFactory(e){var t=this;const s=this.hot.view._wt.getSetting("fixedColumnsStart");return(o,r)=>{var a;const{columnIndexMapper:l,view:c}=this.hot;let h=l.getVisualFromRenderableIndex(o);h===null&&(h=o),r.removeAttribute("colspan"),De(r,"hiddenHeader");const{colspan:u,isHidden:f,isPlaceholder:g}=(a=Tt(this,Dt).getHeaderSettings(e,h))!==null&&a!==void 0?a:{label:""};if(g||f)oe(r,"hiddenHeader");else if(u>1){var p,C;const{wtOverlays:y}=c._wt,b=(p=y.topInlineStartCornerOverlay)===null||p===void 0?void 0:p.clone.wtTable.THEAD.contains(r),T=(C=y.inlineStartOverlay)===null||C===void 0?void 0:C.clone.wtTable.THEAD.contains(r),M=b||T?Math.min(u,s-o):u;M>1&&r.setAttribute("colspan",M)}this.hot.view.appendColHeader(h,r,function(){return t.getColumnHeaderValue(...arguments)},e)}}getColumnHeaderValue(e,t){var s;const{isHidden:o,isPlaceholder:r}=(s=Tt(this,Dt).getHeaderSettings(t,e))!==null&&s!==void 0?s:{};return r||o?"":this.hot.getColHeader(e,t)}onBeforeHighlightingColumnHeader(e,t,s){const o=Tt(this,Dt).getHeaderTreeNodeData(t,e);if(!o)return e;const{classNames:r,columnCursor:a,selectionType:l,selectionWidth:c}=s,{isRoot:h,colspan:u}=Tt(this,Dt).getHeaderSettings(t,e);if(l===Jr){if(!h)return o.columnIndex}else l===rc&&(u>c-a||!h)&&(r.length=0);return e}onBeforeCopy(e,t,s){let{columnHeadersCount:o}=s;if(o!==0)for(let a=0;a<t.length;a++){const{startRow:l,startCol:c,endRow:h,endCol:u}=t[a],f=h-l+1,g=c-u+1;if(l>=0||g===1)break;for(let p=c;p<=u;p++)for(let C=l;C<=h;C++){var r;const y=f+C,b=p-c;if(b===0)continue;((r=Tt(this,Dt).getHeaderTreeNodeData(C,p))===null||r===void 0?void 0:r.isRoot)===!1&&(e[y][b]="")}}}onBeforeOnCellMouseDown(e,t,s,o){this._getHeaderTreeNodeDataByCoords(t)&&(o.column=!0)}onAfterOnCellMouseDown(e,t){const s=this._getHeaderTreeNodeDataByCoords(t);if(!s)return;const{selection:o}=this.hot,r=o.isSelected()?o.getSelectedRange().current():null,a=[],{columnIndex:l,origColspan:c}=s,h=!o.inInSelection(t);e.shiftKey&&r?t.col<r.from.col?a.push(r.getTopEndCorner().col,l,t.row):t.col>r.from.col?a.push(r.getTopStartCorner().col,l+c-1,t.row):a.push(l,l+c-1,t.row):(yd(e)||Ho(e)&&h)&&a.push(l,l+c-1,t.row),o.selectColumns(...a)}onBeforeOnCellMouseOver(e,t,s,o){if(!this.hot.view.isMouseDown())return;const r=this._getHeaderTreeNodeDataByCoords(t);if(!r)return;const{columnIndex:a,origColspan:l}=r,c=this.hot.getSelectedRangeLast(),h=c.getTopStartCorner(),u=c.getBottomEndCorner(),{from:f}=c;o.column=!0,o.cell=!0;const g=[];t.col<f.col?g.push(u.col,a):t.col>f.col?g.push(h.col,a+l-1):g.push(a,a+l-1),this.hot.selectColumns(...g)}onAfterGetColumnHeaderRenderers(e){e.length=0;for(let t=0;t<Tt(this,Dt).getLayersCount();t++)e.push(this.headerRendererFactory(t))}onAfterViewportColumnCalculatorOverride(e){const t=Tt(this,Dt).getLayersCount();let s=e.startColumn,o=!!t;for(let r=0;r<t;r++){const a=Tt(this,Dt).findLeftMostColumnIndex(r,e.startColumn),l=this.hot.columnIndexMapper.getRenderableFromVisualIndex(a);if(a>=0&&(o=!1),fn(l)&&l<e.startColumn){s=l;break}}e.startColumn=o?Tt(this,Dt).getHeaderTreeNodeData(0,s).columnIndex:s}onModifyColWidth(e,t){const s=this.ghostTable.getWidth(t);return e>s?e:s}onModifyColumnHeaderValue(e,t,s){var o;const{label:r}=(o=Tt(this,Dt).getHeaderTreeNodeData(s,t))!==null&&o!==void 0?o:{label:""};return r}onInit(){this.updatePlugin()}onAfterLoadData(e,t){t||this.updatePlugin()}destroy(){gh(this,Dt,null),Tt(this,mo)!==null&&(Tt(this,mo).unsubscribe(),gh(this,mo,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return Tt(this,Dt).getHeaderTreeNodeData(e.row,e.col)}}class Mj{constructor(e,t){this.hot=t,this.data=null,this.plugin=e,this.parentReference=new WeakMap,this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},Ce(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,t,s){this.cache.levels[t]||(this.cache.levels[t]=[],this.cache.levelCount+=1),this.cache.levels[t].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:s,row:this.cache.rows.length-1,level:t}),this.hasChildren(e)&&N(e.__children,o=>{this.cacheNode(o,t+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,t,s,o){let r=!1,a=t;if(isNaN(a)&&a.end)return a;let l=e;return l||(l={__children:this.data},r=!0,a-=1),s!=null&&a===s?{result:l,end:!0}:o!=null&&l===o?{result:a,end:!0}:(a+=1,l.__children&&N(l.__children,c=>{if(this.parentReference.set(c,r?null:l),a=this.readTreeNodes(c,a,s,o),isNaN(a)&&a.end)return!1}),a)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return Be(this.data[0],(t,s)=>{e[s]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let t=null;isNaN(e)?t=e:t=this.getDataObject(e);const s=this.getRowParent(e);return s==null?this.data.indexOf(t):s.__children.indexOf(t)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let t=0,s=e;return isNaN(s)||(s=this.getDataObject(s)),!s||!s.__children?0:(N(s.__children,o=>{t+=1,o.__children&&(t+=this.countChildren(o))}),t)}getRowParent(e){let t;return isNaN(e)?t=e:t=this.getDataObject(e),this.getRowObjectParent(t)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let t=null;return isNaN(e)?t=e:t=this.getDataObject(e),t?this.getRowObjectLevel(t):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let t=e;return isNaN(t)||(t=this.getDataObject(t)),!!(t.__children&&t.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,t){var s;return((s=e.__children)===null||s===void 0?void 0:s[t])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var t;let s=e;return isNaN(s)||(s=this.getDataObject(s)),s&&!!s.__children&&((t=s.__children)===null||t===void 0?void 0:t.length)!==0}addChild(e,t){let s=t;this.hot.runHooks("beforeAddChild",e,s);let o=null;e&&(o=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",o+this.countChildren(e)+1,1);let r=e;e||(r=this.mockParent()),r.__children||(r.__children=[]),s||(s=this.mockNode()),r.__children.push(s),this.rewriteCache();const a=this.getRowIndex(s);this.hot.rowIndexMapper.insertIndexes(a,1),this.hot.runHooks("afterCreateRow",a,1),this.hot.runHooks("afterAddChild",e,s)}addChildAtIndex(e,t,s){let o=s,r;if(o||(o=this.mockNode()),this.hot.runHooks("beforeAddChild",e,o,t),e){const l=this.getRowIndex(e)+t+1;this.hot.runHooks("beforeCreateRow",l,1),e.__children.splice(t,null,o),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(l,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",l,1),r=l}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",t,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),r=this.getRowIndex(this.data[t]);o=this.getDataObject(r),this.hot.runHooks("afterAddChild",e,o,t)}addSibling(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const s=this.translateTrimmedRow(e),o=this.getRowParent(s),r=this.getRowIndexWithinParent(s);switch(t){case"below":this.addChildAtIndex(o,r+1,null);break;case"above":this.addChildAtIndex(o,r,null);break}}detachFromParent(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=null;const o=[];Array.isArray(e)?(Ce(e[0],e[2],g=>{const p=this.translateTrimmedRow(g);o.push(this.getDataObject(p))}),Ce(0,o.length-2,g=>{this.detachFromParent(o[g],!1)}),s=o[o.length-1]):s=e;const r=this.getRowIndex(s),a=this.countChildren(s),l=this.getRowIndexWithinParent(s),c=this.getRowParent(s),h=this.getRowParent(c),u=this.getRowIndex(h);let f=null;if(this.hot.runHooks("beforeDetachChild",c,s),l!=null){const g=Array.from(new Array(r+a+1).keys()).splice(-1*(a+1));if(this.hot.runHooks("beforeRemoveRow",r,a+1,g,this.plugin.pluginName),c.__children.splice(l,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",r,a+1,g,this.plugin.pluginName),h){f=u+this.countChildren(h);const p=this.getChild(h,this.countChildren(h)-1),C=this.getRowIndex(p);this.hot.runHooks("beforeCreateRow",C+1,a+1,this.plugin.pluginName),h.__children.push(s)}else f=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",f-2,a+1,this.plugin.pluginName),this.data.push(s)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",f-2,a+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",c,s,this.getRowIndex(s)),t&&this.hot.render()}filterData(e,t,s){const o=[];N(s,r=>{o.push(this.getDataObject(r))}),N(o,r=>{const a=this.getRowIndexWithinParent(r),l=this.getRowParent(r);l===null?this.data.splice(a,1):l.__children.splice(a,1)}),this.rewriteCache()}spliceData(e,t,s){const o=this.getDataObject(e-1);let r=null,a=e;o&&o.__children&&o.__children.length===0?(r=o,a=0):e<this.countAllRows()&&(r=this.getRowParent(e),a=this.getRowIndexWithinParent(e)),r?s?r.__children.splice(a,t,...s):r.__children.splice(a,t):s?this.data.splice(a,t,...s):this.data.splice(a,t),this.rewriteCache()}syncRowWithRawSource(e){let t=e,s=null;do s=this.getRowParent(s),s!==null&&(t=s);while(s!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(t),"__children",t.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,t,s,o){const r=t===this.hot.countRows(),a=this.getRowParent(e),l=this.getRowIndexWithinParent(e),c=a.__children.slice(l,l+1),h=e>t;let u=r?this.getRowParent(t-1):this.getRowParent(t);u==null&&(u=this.getRowParent(t-1)),u==null&&(u=this.getDataObject(t-1)),u?u.__children||(u.__children=[]):(u=this.getDataObject(t),u.__children=[]);const f=r||s||o?u.__children.length:this.getRowIndexWithinParent(t),g=a===u;u.__children.splice(f,0,c[0]),a.__children.splice(l+(h&&g?1:0),1),this.syncRowWithRawSource(a),g||this.syncRowWithRawSource(u)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}const _j=Mj;class Ij{constructor(e,t){this.hot=t,this.plugin=e}}const Ip=Ij;class Bs extends Ip{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,t){super(e,t),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,t){const s=this.hot.toPhysicalRow(e),o=this.dataManager.getRowLevel(s),r=this.dataManager.getDataObject(s),a=t.getElementsByTagName("DIV")[0],l=a.querySelector("span.rowHeader"),c=a.querySelectorAll('[class^="ht_nesting"]');if(N(c,h=>{h&&a.removeChild(h)}),oe(t,Bs.CSS_CLASSES.indicatorContainer),o){const{rootDocument:h}=this.hot,u=l.cloneNode(!0);a.innerHTML="",Ce(0,o-1,()=>{const f=h.createElement("SPAN");oe(f,Bs.CSS_CLASSES.emptyIndicator),a.appendChild(f)}),a.appendChild(u)}if(this.dataManager.hasChildren(r)){const h=this.hot.rootDocument.createElement("DIV");oe(t,Bs.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(s)?oe(h,`${Bs.CSS_CLASSES.button} ${Bs.CSS_CLASSES.expandButton}`):oe(h,`${Bs.CSS_CLASSES.button} ${Bs.CSS_CLASSES.collapseButton}`),a.appendChild(h)}}updateRowHeaderWidth(e){let t=e;t||(t=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*t+25),this.hot.render()}}const k0=Bs;class Oj extends Ip{constructor(e,t){var s;super(e,t),s=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;s.lastCollapsedRows=s.collapsedRows.slice(0),s.expandMultipleChildren(s.lastCollapsedRows,o)},shiftStash:function(o,r){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;r==null&&(r=1/0),N(s.lastCollapsedRows,(l,c)=>{l>=o&&l<r&&(s.lastCollapsedRows[c]=l+a)})},applyStash:function(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;s.collapseMultipleChildren(s.lastCollapsedRows,o),s.lastCollapsedRows=void 0},trimStash:(o,r)=>{Ce(o,o+r-1,a=>{const l=this.lastCollapsedRows.indexOf(a);l>-1&&this.lastCollapsedRows.splice(l,1)})}}}collapseChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const o=[];let r=null,a=null,l=null;return isNaN(e)?(r=e,a=this.dataManager.getRowIndex(r)):(r=this.dataManager.getDataObject(e),a=e),this.dataManager.hasChildren(r)&&N(r.__children,c=>{o.push(this.dataManager.getRowIndex(c))}),l=this.collapseRows(o,!0,!1),s&&this.trimRows(l),t&&this.renderAndAdjust(),this.collapsedRows.indexOf(a)===-1&&this.collapsedRows.push(a),l}collapseMultipleChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const o=[];N(e,r=>{o.push(...this.collapseChildren(r,!1,!1))}),s&&this.trimRows(o),t&&this.renderAndAdjust()}collapseRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],t)}collapseRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const o=[];return N(e,r=>{o.push(r),t&&this.collapseChildRows(r,o)}),s&&this.trimRows(o),o}collapseChildRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const o=this.dataManager.getDataObject(e);N(o.__children,r=>{const a=this.dataManager.getRowIndex(r);t.push(a),this.collapseChildRows(a,t)})}s&&this.trimRows(t)}expandRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],t)}expandRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const o=[];return N(e,r=>{o.push(r),t&&this.expandChildRows(r,o)}),s&&this.untrimRows(o),o}expandChildRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const o=this.dataManager.getDataObject(e);N(o.__children,r=>{if(!this.isAnyParentCollapsed(r)){const a=this.dataManager.getRowIndex(r);t.push(a),this.expandChildRows(a,t)}})}s&&this.untrimRows(t)}expandChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const o=[];let r=null,a=null,l=null;return isNaN(e)?(r=e,a=this.dataManager.getRowIndex(e)):(r=this.dataManager.getDataObject(e),a=e),this.collapsedRows.splice(this.collapsedRows.indexOf(a),1),this.dataManager.hasChildren(r)&&N(r.__children,c=>{const h=this.dataManager.getRowIndex(c);o.push(h)}),l=this.expandRows(o,!0,!1),s&&this.untrimRows(l),t&&this.renderAndAdjust(),l}expandMultipleChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const o=[];N(e,r=>{o.push(...this.expandChildren(r,!1,!1))}),s&&this.untrimRows(o),t&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),t=[];N(e,s=>{this.dataManager.hasChildren(s)&&t.push(s)}),this.collapseMultipleChildren(t),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),t=[];N(e,s=>{this.dataManager.hasChildren(s)&&t.push(s)}),this.expandMultipleChildren(t),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{N(e,t=>{this.plugin.collapsedRowsMap.setValueAtIndex(t,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{N(e,t=>{this.plugin.collapsedRowsMap.setValueAtIndex(t,!1)})},!0)}areChildrenCollapsed(e){let t=isNaN(e)?e:this.dataManager.getDataObject(e),s=!0;return t===null&&(t={__children:this.dataManager.data}),this.dataManager.hasChildren(t)&&N(t.__children,o=>{const r=this.dataManager.getRowIndex(o);if(!this.plugin.collapsedRowsMap.getValueAtIndex(r))return s=!1,!1}),s}isAnyParentCollapsed(e){let t=e;for(;t!==null;){t=this.dataManager.getRowParent(t);const s=this.dataManager.getRowIndex(t);if(this.collapsedRows.indexOf(s)>-1)return!0}return!1}toggleState(e,t){if(t.col>=0)return;const s=this.translateTrimmedRow(t.row);Ae(e.target,k0.CSS_CLASSES.button)&&(this.areChildrenCollapsed(s)?this.expandChildren(s):this.collapseChildren(s),is(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}const Aj=Oj,L0=new WeakMap;class Pj extends Ip{constructor(e,t){super(e,t),L0.set(this,{row_above:(s,o)=>{const r=o[o.length-1];this.dataManager.addSibling(r.start.row,"above")},row_below:(s,o)=>{const r=o[o.length-1];this.dataManager.addSibling(r.start.row,"below")}}),this.dataManager=this.plugin.dataManager}appendOptions(e){const t=[{key:"add_child",name(){return this.getTranslatedPhrase(Qf)},callback:()=>{const s=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),o=this.dataManager.getDataObject(s);this.dataManager.addChild(o)},disabled:()=>{const s=this.hot.getSelectedLast();return!s||s[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(Jf)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const s=this.hot.getSelectedLast(),o=this.dataManager.translateTrimmedRow(s[0]);return!this.dataManager.getRowParent(o)||!s||s[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return Ce(0,e.items.length-1,s=>{if(s===0)return N(t,(o,r)=>{e.items.splice(s+r,0,o)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){const t=L0.get(this);return Ce(0,e.items.length-1,s=>{const o=t[e.items[s].key];o!=null&&(e.items[s].callback=o)}),e}}const Dj=Pj;class Nj{constructor(e){this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,t,s,o){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:t,dropIndex:s,movePossible:o}))return!1;this.movedToCollapsed=!1;const a=s===this.hot.countRows(),l=a?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(s);let c=!0;const h=e.map(C=>{if(!c)return!1;const y=this.dataManager.translateTrimmedRow(C);return c=this.shouldAllowMoving(y,l),y}),u=h.indexOf(l)===-1;if(!c||!u)return!1;const f=this.getBaseParent(h),g=this.getTargetParent(a,l),p=f===g;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(g),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(h,l,p),this.moveRows(h,l,g),this.dataManager.rewriteCache(),this.moveCellsMeta(h,l),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,t,s,o,o&&this.isRowOrderChanged(e,t)),this.hot.render(),this.selectCells(e,s),!1}displayAPICompatibilityWarning(e){const{rows:t,finalIndex:s,dropIndex:o,movePossible:r}=e;let a=!1;return ct(o)&&(ut(rt`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",t,s,o,r,!1),a=!0),a}shouldAllowMoving(e,t){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===t||t===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,t){let s=this.dataManager.getRowParent(e?t-1:t);return s==null&&(s=this.dataManager.getRowParent(t-1)),s}shiftCollapsibleParentsLocations(e,t,s){s||(Math.max(...e)<=t?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],t,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(t,e[0],e.length))}moveRows(e,t,s){const o=t===this.dataManager.getRowIndex(s)+this.dataManager.countChildren(s)+1;this.hot.batchRender(()=>{e.forEach(r=>{this.dataManager.moveRow(r,t,this.movedToCollapsed,o)})})}moveCellsMeta(e,t){const s=[],o=Math.max(...e)<t;e.forEach(r=>{s.push(this.hot.getCellMetaAtRow(r))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(t-(o?s.length:0),0,...s)}selectCells(e,t){const s=e.length;let o=0,r=0,a=null,l=null;if(this.movedToCollapsed){let c=null;e[s-1]<t?c=this.dataManager.translateTrimmedRow(t-s):c=this.dataManager.translateTrimmedRow(t);const h=this.dataManager.getRowParent(c===null?this.hot.countSourceRows()-1:c-1),u=this.dataManager.getRowIndex(h);o=this.dataManager.untranslateTrimmedRow(u),r=o}else e[s-1]<t?(r=t-1,o=r-s+1):(o=t,r=o+s-1);a=this.hot.selection,l=this.hot.countCols()-1,a.setRangeStart(this.hot._createCellCoords(o,0)),a.setRangeEnd(this.hot._createCellCoords(r,l),!0)}isRowOrderChanged(e,t){return e.some((s,o)=>s-o!==t)}}const Op="nestedRows",Hj=300,Ws=new WeakMap,kj="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";class Lj extends et{static get PLUGIN_KEY(){return Op}static get PLUGIN_PRIORITY(){return Hj}constructor(e){super(e),this.dataManager=null,this.headersUI=null,this.collapsedRowsMap=null,Ws.set(this,{movedToCollapsed:!1,skipRender:null,skipCoreAPIModifiers:!1})}isEnabled(){return!!this.hot.getSettings()[Op]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new Xr),this.dataManager=new _j(this,this.hot),this.collapsingUI=new Aj(this,this.hot),this.headersUI=new k0(this,this.hot),this.contextMenuUI=new Dj(this,this.hot),this.rowMoveController=new Nj(this),this.addHook("afterInit",function(){return e.onAfterInit(...arguments)}),this.addHook("beforeViewRender",function(){return e.onBeforeViewRender(...arguments)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){return e.onFilterData(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return e.onAfterContextMenuDefaultOptions(...arguments)}),this.addHook("afterGetRowHeader",function(){return e.onAfterGetRowHeader(...arguments)}),this.addHook("beforeOnCellMouseDown",function(){return e.onBeforeOnCellMouseDown(...arguments)}),this.addHook("beforeRemoveRow",function(){return e.onBeforeRemoveRow(...arguments)}),this.addHook("afterRemoveRow",function(){return e.onAfterRemoveRow(...arguments)}),this.addHook("beforeAddChild",function(){return e.onBeforeAddChild(...arguments)}),this.addHook("afterAddChild",function(){return e.onAfterAddChild(...arguments)}),this.addHook("beforeDetachChild",function(){return e.onBeforeDetachChild(...arguments)}),this.addHook("afterDetachChild",function(){return e.onAfterDetachChild(...arguments)}),this.addHook("modifyRowHeaderWidth",function(){return e.onModifyRowHeaderWidth(...arguments)}),this.addHook("afterCreateRow",function(){return e.onAfterCreateRow(...arguments)}),this.addHook("beforeRowMove",function(){return e.onBeforeRowMove(...arguments)}),this.addHook("beforeLoadData",t=>this.onBeforeLoadData(t)),this.addHook("beforeUpdateData",t=>this.onBeforeLoadData(t)),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}onBeforeRowMove(e,t,s,o){return this.rowMoveController.onBeforeRowMove(e,t,s,o)}disableCoreAPIModifiers(){const e=Ws.get(this);e.skipCoreAPIModifiers=!0}enableCoreAPIModifiers(){const e=Ws.get(this);e.skipCoreAPIModifiers=!1}onBeforeOnCellMouseDown(e,t,s){this.collapsingUI.toggleState(e,t,s)}onModifyRowData(e){if(!Ws.get(this).skipCoreAPIModifiers)return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!Ws.get(this).skipCoreAPIModifiers)return this.dataManager.countAllRows()}onBeforeDataSplice(e,t,s){return Ws.get(this).skipCoreAPIModifiers||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,t,s),!1)}onFilterData(e,t,s){const o=Ws.get(this);return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(s[0],t),this.collapsingUI.collapsedRowsStash.shiftStash(s[0],null,-1*t),this.dataManager.filterData(e,t,s),o.skipRender=!0,this.dataManager.getData().slice()}onAfterContextMenuDefaultOptions(e){return this.contextMenuUI.appendOptions(e)}onAfterGetRowHeader(e,t){this.headersUI.appendLevelIndicators(e,t)}onModifyRowHeaderWidth(e){return this.headersUI.rowHeaderWidthCache||e}onAfterRemoveRow(e,t,s,o){if(o===this.pluginName)return;const r=Ws.get(this);setTimeout(()=>{r.skipRender=null,this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()},0)}onBeforeRemoveRow(e,t,s){const o=Array.from(s.reduce((r,a)=>{if(this.dataManager.isParent(a)){const l=this.dataManager.getDataObject(a).__children;return r.add(a),Array.isArray(l)&&l.forEach(c=>r.add(this.dataManager.getRowIndex(c))),r}return r.add(a)},new Set));s.length=0,s.push(...o)}onBeforeAddChild(){this.collapsingUI.collapsedRowsStash.stash()}onAfterAddChild(e,t){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(t)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}onBeforeDetachChild(){this.collapsingUI.collapsedRowsStash.stash()}onAfterDetachChild(e,t,s){this.collapsingUI.collapsedRowsStash.shiftStash(s,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}onAfterCreateRow(){this.dataManager.rewriteCache()}onAfterInit(){const e=Math.max(...this.dataManager.cache.levels);e>0&&this.headersUI.updateRowHeaderWidth(e)}onBeforeViewRender(e,t){Ws.get(this).skipRender&&(t.skipRender=!0)}destroy(){super.destroy()}onBeforeLoadData(e){if(!H$(e)){Sd(kj),this.hot.getSettings()[Op]=!1,this.disablePlugin();return}this.dataManager.setData(e),this.dataManager.rewriteCache()}}class Vj{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;this.rootWindow=t,this.prefix=e,this.savedKeys=[],this.loadSavedKeys()}saveValue(e,t){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(t)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,t){const s=typeof e>"u"?t:e,o=this.rootWindow.localStorage.getItem(`${this.prefix}_${s}`);return o===null?void 0:JSON.parse(o)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){N(this.savedKeys,(e,t)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[t]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),t=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=t||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}const $j=Vj;de.getSingleton().register("persistentStateSave"),de.getSingleton().register("persistentStateLoad"),de.getSingleton().register("persistentStateReset");const V0="persistentState",Fj=0;class Bj extends et{static get PLUGIN_KEY(){return V0}static get PLUGIN_PRIORITY(){return Fj}constructor(e){super(e),this.storage=void 0}isEnabled(){return!!this.hot.getSettings()[V0]}enablePlugin(){this.enabled||(this.storage||(this.storage=new $j(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,t)=>this.saveValue(e,t)),this.addHook("persistentStateLoad",(e,t)=>this.loadValue(e,t)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,t){t.value=this.storage.loadValue(e)}saveValue(e,t){this.storage.saveValue(e,t)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}const Ap="search",Wj=190,Uj="htSearchResult",zj=function(n,e,t,s,o){n.getCellMeta(e,t).isSearchResult=o},Yj=function(n,e,t){return ct(n)||n===null||!n.toLocaleLowerCase||n.length===0||ct(e)||e===null?!1:e.toString().toLocaleLowerCase(t.locale).indexOf(n.toLocaleLowerCase(t.locale))!==-1};class Gj extends et{static get PLUGIN_KEY(){return Ap}static get PLUGIN_PRIORITY(){return Wj}constructor(e){super(e),this.callback=zj,this.queryMethod=Yj,this.searchResultClass=Uj}isEnabled(){return this.hot.getSettings()[Ap]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[Ap];this.updatePluginSettings(t),this.addHook("beforeRenderer",function(){return e.onBeforeRenderer(...arguments)}),super.enablePlugin()}disablePlugin(){var e=this;const t=function(){return e.onBeforeRenderer(...arguments)};this.hot.addHook("beforeRenderer",t),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",t)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const o=this.hot.countRows(),r=this.hot.countCols(),a=[],l=this.hot;return Ce(0,o-1,c=>{Ce(0,r-1,h=>{const u=this.hot.getDataAtCell(c,h),f=this.hot.getCellMeta(c,h),g=f.search.callback||t,C=(f.search.queryMethod||s)(e,u,f);if(C){const y={row:c,col:h,data:u};a.push(y)}g&&g(l,c,h,u,C)})}),a}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){Fe(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}onBeforeRenderer(e,t,s,o,r,a){const l=a.className||[];let c=[];typeof l=="string"?c=l.split(" "):c.push(...l),this.isEnabled()&&a.isSearchResult?c.includes(this.searchResultClass)||c.push(`${this.searchResultClass}`):c.includes(this.searchResultClass)&&c.splice(c.indexOf(this.searchResultClass),1),a.className=c.join(" ")}destroy(){super.destroy()}}const jj="touchScroll",Kj=200;class Xj extends et{static get PLUGIN_KEY(){return jj}static get PLUGIN_PRIORITY(){return Kj}static get SETTING_KEYS(){return!0}constructor(e){super(e),this.scrollbars=[],this.clones=[],this.lockedCollection=!1,this.freezeOverlays=!1}isEnabled(){return KS()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>this.onAfterViewRender()),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>this.onBeforeTouchScroll()),this.addHook("afterMomentumScroll",()=>this.onAfterMomentumScroll())}onAfterViewRender(){if(this.lockedCollection)return;const{topOverlay:e,bottomOverlay:t,inlineStartOverlay:s,topInlineStartCornerOverlay:o,bottomInlineStartCornerOverlay:r}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(e),t.clone&&this.scrollbars.push(t),this.scrollbars.push(s),o&&this.scrollbars.push(o),r&&r.clone&&this.scrollbars.push(r),this.clones=[],e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),s.needFullRender&&this.clones.push(s.clone.wtTable.holder.parentNode),o&&this.clones.push(o.clone.wtTable.holder.parentNode),r&&r.clone&&this.clones.push(r.clone.wtTable.holder.parentNode)}onBeforeTouchScroll(){this.freezeOverlays=!0,N(this.clones,e=>{oe(e,"hide-tween")})}onAfterMomentumScroll(){this.freezeOverlays=!1,N(this.clones,e=>{De(e,"hide-tween"),oe(e,"show-tween")}),this.hot._registerTimeout(()=>{N(this.clones,e=>{De(e,"show-tween")})},400),N(this.scrollbars,e=>{e.refresh(),e.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}}const mh="trimRows",qj=330;class Zj extends et{static get PLUGIN_KEY(){return mh}static get PLUGIN_PRIORITY(){return qj}constructor(e){super(e),this.trimmedRowsMap=null}isEnabled(){return!!this.hot.getSettings()[mh]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new Xr),this.trimmedRowsMap.addLocalHook("init",()=>this.onMapInit()),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[mh];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),N(e,t=>{this.trimmedRowsMap.setValueAtIndex(t,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const t=this.getTrimmedRows(),s=this.isValidConfig(e);let o=t;s&&(o=Array.from(new Set(t.concat(e)))),this.hot.runHooks("beforeTrimRow",t,o,s)!==!1&&(s&&this.hot.batchExecution(()=>{N(e,a=>{this.trimmedRowsMap.setValueAtIndex(a,!0)})},!0),this.hot.runHooks("afterTrimRow",t,o,s,s&&o.length>t.length))}trimRow(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];this.trimRows(t)}untrimRows(e){const t=this.getTrimmedRows(),s=this.isValidConfig(e);let o=t;const r=this.trimmedRowsMap.getValues().slice(),a=e.length>0;s&&a&&(N(e,c=>{r[c]=!1}),o=Qt(r,(c,h,u)=>(h&&c.push(u),c),[])),this.hot.runHooks("beforeUntrimRow",t,o,s&&a)!==!1&&(s&&a&&this.trimmedRowsMap.setValues(r),this.hot.runHooks("afterUntrimRow",t,o,s&&a,s&&o.length<t.length))}untrimRow(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];this.untrimRows(t)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const t=this.hot.countSourceRows();return e.every(s=>Number.isInteger(s)&&s>=0&&s<t)}onMapInit(){const e=this.hot.getSettings()[mh];Array.isArray(e)&&this.hot.batchExecution(()=>{N(e,t=>{this.trimmedRowsMap.setValueAtIndex(t,!0)})},!0)}destroy(){super.destroy()}}const $0="undoRedo",Qj="undoRedo";function ue(n){const e=this;this.instance=n,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,n.addHook("afterChange",function(t,s){const o=t&&t.length;if(!o||!t.find(l=>{const[,,c,h]=l;return c!==h}))return;const a=()=>{const l=t.reduce((h,u)=>(h.push([...u]),h),[]);N(l,h=>{h[1]=n.propToCol(h[1])});const c=o>1?this.getSelected():[[l[0][0],l[0][1]]];return new ue.ChangeAction(l,c)};e.done(a,s)}),n.addHook("afterCreateRow",(t,s,o)=>{e.done(()=>new ue.CreateRowAction(t,s),o)}),n.addHook("beforeRemoveRow",(t,s,o,r)=>{const a=()=>{const l=n.toPhysicalRow(t),c=rn(e.instance.getSourceData(l,0,l+s-1,e.instance.countSourceCols()-1));return new ue.RemoveRowAction(l,c,n.getSettings().fixedRowsBottom,n.getSettings().fixedRowsTop,n.rowIndexMapper.getIndexesSequence())};e.done(a,r)}),n.addHook("afterCreateCol",(t,s,o)=>{e.done(()=>new ue.CreateColumnAction(t,s),o)}),n.addHook("beforeRemoveCol",(t,s,o,r)=>{const a=()=>{const l=e.instance.getSourceDataArray(),c=(e.instance.countCols()+t)%e.instance.countCols(),h=[],u=[],f=[];Ce(l.length-1,C=>{const y=[],b=l[C];Ce(c,c+(s-1),T=>{y.push(b[n.toPhysicalColumn(T)])}),h.push(y)}),Ce(s-1,C=>{f.push(n.toPhysicalColumn(c+C))}),Array.isArray(n.getSettings().colHeaders)&&Ce(s-1,C=>{u.push(n.getSettings().colHeaders[n.toPhysicalColumn(c+C)]||null)});const g=n.columnIndexMapper.getIndexesSequence(),p=n.rowIndexMapper.getIndexesSequence();return new ue.RemoveColumnAction(c,f,h,u,g,p,n.getSettings().fixedColumnsStart)};e.done(a,r)}),n.addHook("beforeCellAlignment",(t,s,o,r)=>{e.done(()=>new ue.CellAlignmentAction(t,s,o,r))}),n.addHook("beforeFilter",t=>{e.done(()=>new ue.FiltersAction(t))}),n.addHook("beforeRowMove",(t,s)=>{t!==!1&&e.done(()=>new ue.RowMoveAction(t,s))}),n.addHook("beforeMergeCells",(t,s)=>{s||e.done(()=>new ue.MergeCellsAction(n,t))}),n.addHook("afterUnmergeCells",(t,s)=>{s||e.done(()=>new ue.UnmergeCellsAction(n,t))}),n.addHook("afterInit",()=>{e.init()})}ue.prototype.done=function(n,e){if(this.ignoreNewActions||e==="UndoRedo.undo"||e==="UndoRedo.redo"||e==="auto")return;const s=this.doneActions.slice();if(this.instance.runHooks("beforeUndoStackChange",s,e)===!1)return;const r=n(),a=this.undoneActions.slice();this.doneActions.push(r),this.instance.runHooks("afterUndoStackChange",s,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",a,this.undoneActions.slice())},ue.prototype.undo=function(){if(this.isUndoAvailable()){const n=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",n);const e=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",n,this.doneActions.slice());const t=rn(e);if(this.instance.runHooks("beforeUndo",t)===!1)return;this.ignoreNewActions=!0;const o=this,r=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",r),e.undo(this.instance,()=>{o.ignoreNewActions=!1,o.undoneActions.push(e)}),this.instance.runHooks("afterRedoStackChange",r,this.undoneActions.slice()),this.instance.runHooks("afterUndo",t)}},ue.prototype.redo=function(){if(this.isRedoAvailable()){const n=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",n);const e=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",n,this.undoneActions.slice());const t=rn(e);if(this.instance.runHooks("beforeRedo",t)===!1)return;this.ignoreNewActions=!0;const o=this,r=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",r),e.redo(this.instance,()=>{o.ignoreNewActions=!1,o.doneActions.push(e)}),this.instance.runHooks("afterUndoStackChange",r,this.doneActions.slice()),this.instance.runHooks("afterRedo",t)}},ue.prototype.isUndoAvailable=function(){return this.doneActions.length>0},ue.prototype.isRedoAvailable=function(){return this.undoneActions.length>0},ue.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0},ue.prototype.isEnabled=function(){return this.enabled},ue.prototype.enable=function(){if(this.isEnabled())return;const n=this.instance;this.enabled=!0,t3(n),this.registerShortcuts(),n.addHook("afterChange",F0)},ue.prototype.disable=function(){if(!this.isEnabled())return;const n=this.instance;this.enabled=!1,n3(n),this.unregisterShortcuts(),n.removeHook("afterChange",F0)},ue.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null},ue.Action=function(){},ue.Action.prototype.undo=function(){},ue.Action.prototype.redo=function(){},ue.ChangeAction=function(n,e){this.changes=n,this.selected=e,this.actionType="change"},Qs(ue.ChangeAction,ue.Action),ue.ChangeAction.prototype.undo=function(n,e){const t=rn(this.changes),s=n.countEmptyRows(!0),o=n.countEmptyCols(!0);for(let r=0,a=t.length;r<a;r++)t[r].splice(3,1);n.addHookOnce("afterChange",e),n.setDataAtCell(t,null,null,"UndoRedo.undo");for(let r=0,a=t.length;r<a;r++){const[l,c]=t[r];n.getSettings().minSpareRows&&l+1+n.getSettings().minSpareRows===n.countRows()&&s===n.getSettings().minSpareRows&&(n.alter("remove_row",parseInt(l+1,10),n.getSettings().minSpareRows),n.undoRedo.doneActions.pop()),n.getSettings().minSpareCols&&c+1+n.getSettings().minSpareCols===n.countCols()&&o===n.getSettings().minSpareCols&&(n.alter("remove_col",parseInt(c+1,10),n.getSettings().minSpareCols),n.undoRedo.doneActions.pop())}n.selectCells(this.selected,!1,!1)},ue.ChangeAction.prototype.redo=function(n,e){const t=rn(this.changes);for(let s=0,o=t.length;s<o;s++)t[s].splice(2,1);n.addHookOnce("afterChange",e),n.setDataAtCell(t,null,null,"UndoRedo.redo"),this.selected&&n.selectCells(this.selected,!1,!1)},ue.CreateRowAction=function(n,e){this.index=n,this.amount=e,this.actionType="insert_row"},Qs(ue.CreateRowAction,ue.Action),ue.CreateRowAction.prototype.undo=function(n,e){const t=n.countRows(),s=n.getSettings().minSpareRows;this.index>=t&&this.index-s<t&&(this.index-=s),n.addHookOnce("afterRemoveRow",e),n.alter("remove_row",this.index,this.amount,"UndoRedo.undo")},ue.CreateRowAction.prototype.redo=function(n,e){n.addHookOnce("afterCreateRow",e),n.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")},ue.RemoveRowAction=function(n,e,t,s,o){this.index=n,this.data=e,this.actionType="remove_row",this.fixedRowsBottom=t,this.fixedRowsTop=s,this.rowIndexesSequence=o},Qs(ue.RemoveRowAction,ue.Action),ue.RemoveRowAction.prototype.undo=function(n,e){const t=n.getSettings(),s=[];t.fixedRowsBottom=this.fixedRowsBottom,t.fixedRowsTop=this.fixedRowsTop,this.data.forEach((o,r)=>{Object.keys(o).forEach(a=>{const l=parseInt(a,10);s.push([this.index+r,isNaN(l)?a:l,o[a]])})}),n.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),n.addHookOnce("afterViewRender",e),n.setSourceDataAtCell(s,null,null,"UndoRedo.undo"),n.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)},ue.RemoveRowAction.prototype.redo=function(n,e){n.addHookOnce("afterRemoveRow",e),n.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")},ue.CreateColumnAction=function(n,e){this.index=n,this.amount=e,this.actionType="insert_col"},Qs(ue.CreateColumnAction,ue.Action),ue.CreateColumnAction.prototype.undo=function(n,e){n.addHookOnce("afterRemoveCol",e),n.alter("remove_col",this.index,this.amount,"UndoRedo.undo")},ue.CreateColumnAction.prototype.redo=function(n,e){n.addHookOnce("afterCreateCol",e),n.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")},ue.RemoveColumnAction=function(n,e,t,s,o,r,a){this.index=n,this.indexes=e,this.data=t,this.amount=this.data[0].length,this.headers=s,this.columnPositions=o.slice(0),this.rowPositions=r.slice(0),this.actionType="remove_col",this.fixedColumnsStart=a},Qs(ue.RemoveColumnAction,ue.Action),ue.RemoveColumnAction.prototype.undo=function(n,e){const t=n.getSettings();t.fixedColumnsStart=this.fixedColumnsStart;const s=this.indexes.slice(0).sort(),o=(h,u,f)=>f[this.indexes.indexOf(s[u])],r=this.data.length,a=[];for(let h=0;h<r;h++)a.push($e(this.data[h],o));const l=$e(this.headers,o),c=[];n.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),N(n.getSourceDataArray(),(h,u)=>{N(s,(f,g)=>{h[f]=a[u][g],c.push([u,f,h[f]])})}),n.setSourceDataAtCell(c,void 0,void 0,"UndoRedo.undo"),typeof this.headers<"u"&&N(l,(h,u)=>{n.getSettings().colHeaders[s[u]]=h}),n.batchExecution(()=>{n.rowIndexMapper.setIndexesSequence(this.rowPositions),n.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),n.addHookOnce("afterViewRender",e),n.render()},ue.RemoveColumnAction.prototype.redo=function(n,e){n.addHookOnce("afterRemoveCol",e),n.alter("remove_col",this.index,this.amount,"UndoRedo.redo")},ue.CellAlignmentAction=function(n,e,t,s){this.stateBefore=n,this.range=e,this.type=t,this.alignment=s},ue.CellAlignmentAction.prototype.undo=function(n,e){N(this.range,t=>{t.forAll((s,o)=>{s>=0&&o>=0&&n.setCellMeta(s,o,"className",this.stateBefore[s][o]||" htLeft")})}),n.addHookOnce("afterViewRender",e),n.render()},ue.CellAlignmentAction.prototype.redo=function(n,e){oo(this.range,this.type,this.alignment,(t,s)=>n.getCellMeta(t,s),(t,s,o,r)=>n.setCellMeta(t,s,o,r)),n.addHookOnce("afterViewRender",e),n.render()},ue.FiltersAction=function(n){this.conditionsStack=n,this.actionType="filter"},Qs(ue.FiltersAction,ue.Action),ue.FiltersAction.prototype.undo=function(n,e){const t=n.getPlugin("filters");n.addHookOnce("afterViewRender",e),t.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),t.filter()},ue.FiltersAction.prototype.redo=function(n,e){const t=n.getPlugin("filters");n.addHookOnce("afterViewRender",e),t.conditionCollection.importAllConditions(this.conditionsStack),t.filter()};class Jj extends ue.Action{constructor(e,t){super(),this.cellRange=t;const s=this.cellRange.getTopStartCorner(),o=this.cellRange.getBottomEndCorner();this.rangeData=e.getData(s.row,s.col,o.row,o.col)}undo(e,t){const s=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),s.unmergeRange(this.cellRange,!0);const o=this.cellRange.getTopStartCorner();e.populateFromArray(o.row,o.col,this.rangeData,void 0,void 0,"MergeCells")}redo(e,t){const s=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),s.mergeRange(this.cellRange)}}ue.MergeCellsAction=Jj;class e3 extends ue.Action{constructor(e,t){super(),this.cellRange=t}undo(e,t){const s=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),s.mergeRange(this.cellRange,!0)}redo(e,t){const s=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),s.unmergeRange(this.cellRange,!0),e.render()}}ue.UnmergeCellsAction=e3,ue.RowMoveAction=function(n,e){this.rows=n.slice(),this.finalIndex=e,this.actionType="row_move"},Qs(ue.RowMoveAction,ue.Action),ue.RowMoveAction.prototype.undo=function(n,e){const t=n.getPlugin("manualRowMove"),s=[].concat(this.rows),o=s.filter(l=>l>this.finalIndex),r=s.filter(l=>l<=this.finalIndex),a=o.sort((l,c)=>c-l).concat(r.sort((l,c)=>l-c));n.addHookOnce("afterViewRender",e);for(let l=0;l<a.length;l+=1){const c=n.toVisualRow(a[l]);t.moveRow(c,a[l])}n.render(),n.deselectCell(),n.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)},ue.RowMoveAction.prototype.redo=function(n,e){const t=n.getPlugin("manualRowMove");n.addHookOnce("afterViewRender",e),t.moveRows(this.rows.slice(),this.finalIndex),n.render(),n.deselectCell(),n.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)},ue.prototype.init=function(){const n=this.instance.getSettings().undo,e=typeof n>"u"||n;this.instance.undoRedo||(this.instance.undoRedo=this),e?this.instance.undoRedo.enable():this.instance.undoRedo.disable()},ue.prototype.registerShortcuts=function(){const e=this.instance.getShortcutManager().getContext("grid"),s={runOnlyIf:o=>!o.altKey,group:$0};e.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],s)},ue.prototype.unregisterShortcuts=function(){this.instance.getShortcutManager().getContext("grid").removeShortcutsByGroup($0)};function F0(n,e){const t=this;if(e==="loadData")return t.undoRedo.clear()}function t3(n){n.undo=function(){return n.undoRedo.undo()},n.redo=function(){return n.undoRedo.redo()},n.isUndoAvailable=function(){return n.undoRedo.isUndoAvailable()},n.isRedoAvailable=function(){return n.undoRedo.isRedoAvailable()},n.clearUndo=function(){return n.undoRedo.clear()}}function n3(n){delete n.undo,delete n.redo,delete n.isUndoAvailable,delete n.isRedoAvailable,delete n.clearUndo}const Aa=de.getSingleton();Aa.add("afterUpdateSettings",function(){var n;(n=this.getPlugin("undoRedo"))===null||n===void 0||n.init()}),Aa.register("beforeUndo"),Aa.register("afterUndo"),Aa.register("beforeRedo"),Aa.register("afterRedo"),ue.PLUGIN_KEY=Qj,ue.SETTING_KEYS=!0;function s3(){Xe(ia),Xe(_W),Xe(ra),Xe(WW),Xe(ZW),Xe(Ub),Xe(x2),Xe(B2),Xe(kc),Xe(UU),Xe(rz),Xe(lz),Xe(Gc),Xe(vz),Xe(mY),Xe(zY),Xe(ZY),Xe(oG),Xe(lG),Xe(gG),Xe(pG),Xe(EG),Xe(TG),Xe(HG),Xe(BG),Xe(zG),Xe(Tj),Xe(Lj),Xe(Bj),Xe(Gj),Xe(Xj),Xe(Zj),Xe(ue)}function o3(){kB(),ZB(),iW(),gW(),s3()}o3();const i3=",",r3=m.defineComponent({components:{HotTable:Ug},computed:{...Re(pn,["datasets"]),...Re(jt,["axes"]),...Re(St,["canvas"]),tableData(){return this.datasets.activeDataset.plots.length>0?this.datasets.activeDataset.plots.map(n=>{const{xV:e,yV:t}=this.calculateXY(n.xPx,n.yPx);return{X:e,Y:t}}):[{X:null,Y:null}]}},data(){return{key:0,activeColor:nM.green.lighten5,hotTableSettings:{licenseKey:"non-commercial-and-evaluation",columnSorting:!0,colHeaders:["X","Y"],columns:[{data:"X",type:"numeric"},{data:"Y",type:"numeric"}]}}},methods:{calculateXY(n,e){return new Up(this.axes,{x:this.axes.xIsLog,y:this.axes.yIsLog}).calculateXYValues(n,e)},copyData:function(){const e=this.$refs.tableRef.hotInstance.getData().slice(0),t=this.convertToCsv(e);navigator.clipboard.writeText(t).then(()=>console.log("ã‚³ãƒ”ãƒ¼ãŒæˆåŠŸã—ã¾ã—ãŸã€‚")).catch(s=>console.error("ã‚³ãƒ”ãƒ¼ãŒå¤±æ•—ã—ã¾ã—ãŸã€‚",s))},convertToCsv(n){return console.log({data:n}),n.map(t=>t.join(i3)).join(`
`)}},watch:{tableData(){this.key++},axes(){this.key++}}});function a3(n,e,t,s,o,r){const a=m.resolveComponent("hot-table"),l=m.resolveComponent("v-btn");return m.openBlock(),m.createElementBlock("div",null,[(m.openBlock(),m.createBlock(a,{data:n.tableData,settings:n.hotTableSettings,key:n.key,ref:"tableRef",height:"35vh",class:"overflow-y-auto"},null,8,["data","settings"])),m.createVNode(l,{class:"mt-1",onClick:n.copyData,size:"small"},{default:m.withCtx(()=>[m.createTextVNode("Copy to Clipboard")]),_:1},8,["onClick"])])}const l3=qe(r3,[["render",a3]]),c3=m.defineComponent({components:{DataTable:l3,MagnifierMain:JE,CanvasHeader:Ax,CanvasMain:Lx,CanvasFooter:Ex,AxesSettings:sT,DatasetManager:HT,ExtractorSettings:_T,ImageSettings:AT},props:{initialGraphImagePath:{type:String,required:!0},initialExtractorStrategy:{type:String,required:!1},exportBtnText:String,exportBtnClick:{type:Function,required:!1}},data(){return{version:Gp,githubRunNumber:{}.VITE_APP_GITHUB_RUN_NUMBER}}}),r4="",h3={class:"c__wrapper"},u3={class:"c__left-sidebar"},d3={class:"c__main-area"},f3={class:"c__right-sidebar"},g3={class:"text-caption text-right"};function m3(n,e,t,s,o,r){const a=m.resolveComponent("image-settings"),l=m.resolveComponent("axes-settings"),c=m.resolveComponent("dataset-manager"),h=m.resolveComponent("data-table"),u=m.resolveComponent("canvas-header"),f=m.resolveComponent("canvas-main"),g=m.resolveComponent("canvas-footer"),p=m.resolveComponent("magnifier-main"),C=m.resolveComponent("extractor-settings"),y=m.resolveComponent("v-container");return m.openBlock(),m.createBlock(y,{fluid:""},{default:m.withCtx(()=>[m.createElementVNode("div",h3,[m.createElementVNode("div",u3,[m.createVNode(a),m.createVNode(l),m.createVNode(c,{exportBtnText:n.exportBtnText,exportBtnClick:n.exportBtnClick},null,8,["exportBtnText","exportBtnClick"]),m.createVNode(h)]),m.createElementVNode("div",d3,[m.createVNode(u),m.createVNode(f,{imagePath:n.initialGraphImagePath},null,8,["imagePath"]),m.createVNode(g)]),m.createElementVNode("div",f3,[m.createVNode(p),m.createVNode(C,{initialExtractorStrategy:n.initialExtractorStrategy},null,8,["initialExtractorStrategy"]),m.createElementVNode("p",g3," v"+m.toDisplayString(n.version)+"#"+m.toDisplayString(n.githubRunNumber),1)])])]),_:1})}const p3=qe(c3,[["render",m3]]),w3=m.defineComponent({name:"App",components:{MainScreen:p3},data:()=>({plots:[],version:Gp,links:[{text:"Release Note",url:"https://github.com/t29mato/starry-digitizer/releases"},{text:"Document",url:"https://starrydigitizer.readthedocs.io/"}],isProd:process.env.NODE_ENV==="production"}),methods:{importPlots(n){this.plots=n}}}),C3=m.createElementVNode("strong",null,"StarryDigitizer",-1),y3={class:"ml-2 mt-1"};function S3(n,e,t,s,o,r){const a=m.resolveComponent("main-screen"),l=m.resolveComponent("v-main"),c=m.resolveComponent("v-btn"),h=m.resolveComponent("v-col"),u=m.resolveComponent("v-row"),f=m.resolveComponent("v-footer"),g=m.resolveComponent("v-app");return m.openBlock(),m.createBlock(g,null,{default:m.withCtx(()=>[m.createVNode(l,null,{default:m.withCtx(()=>[m.createVNode(a,{initialGraphImagePath:"/sample_graph_curve.png"},null,8,["initialGraphImagePath"])]),_:1}),m.createVNode(f,{color:n.isProd?"primary":"orange"},{default:m.withCtx(()=>[m.createVNode(u,{justify:"center","no-gutters":""},{default:m.withCtx(()=>[(m.openBlock(!0),m.createElementBlock(m.Fragment,null,m.renderList(n.links,p=>(m.openBlock(),m.createBlock(c,{key:p.url,color:"white",variant:"text",rounded:"",class:"my-2",href:p.url,target:"_blank",size:"small"},{default:m.withCtx(()=>[m.createTextVNode(m.toDisplayString(p.text),1)]),_:2},1032,["href"]))),128)),m.createVNode(h,{class:"text-center text-white",cols:"12"},{default:m.withCtx(()=>[m.createTextVNode(m.toDisplayString(new Date().getFullYear())+" â€” ",1),C3,m.createElementVNode("span",y3,m.toDisplayString(n.version),1)]),_:1})]),_:1})]),_:1},8,["color"])]),_:1})}const v3=qe(w3,[["render",S3]]);st.App=v3,Object.defineProperty(st,Symbol.toStringTag,{value:"Module"})});
